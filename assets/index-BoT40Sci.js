var C2=Object.defineProperty;var Aw=n=>{throw TypeError(n)};var T2=(n,e,t)=>e in n?C2(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var M=(n,e,t)=>T2(n,typeof e!="symbol"?e+"":e,t),ev=(n,e,t)=>e.has(n)||Aw("Cannot "+t);var o=(n,e,t)=>(ev(n,e,"read from private field"),t?t.call(n):e.get(n)),x=(n,e,t)=>e.has(n)?Aw("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(n):e.set(n,t),m=(n,e,t,s)=>(ev(n,e,"write to private field"),s?s.call(n,t):e.set(n,t),t),A=(n,e,t)=>(ev(n,e,"access private method"),t);var At=(n,e,t,s)=>({set _(i){m(n,e,i,t)},get _(){return o(n,e,s)}});(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const r of i)if(r.type==="childList")for(const a of r.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&s(a)}).observe(document,{childList:!0,subtree:!0});function t(i){const r={};return i.integrity&&(r.integrity=i.integrity),i.referrerPolicy&&(r.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?r.credentials="include":i.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(i){if(i.ep)return;i.ep=!0;const r=t(i);fetch(i.href,r)}})();function _2(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var fA={exports:{}},E0={},pA={exports:{}},pe={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Gp=Symbol.for("react.element"),N2=Symbol.for("react.portal"),P2=Symbol.for("react.fragment"),M2=Symbol.for("react.strict_mode"),L2=Symbol.for("react.profiler"),D2=Symbol.for("react.provider"),I2=Symbol.for("react.context"),R2=Symbol.for("react.forward_ref"),F2=Symbol.for("react.suspense"),j2=Symbol.for("react.memo"),O2=Symbol.for("react.lazy"),kw=Symbol.iterator;function B2(n){return n===null||typeof n!="object"?null:(n=kw&&n[kw]||n["@@iterator"],typeof n=="function"?n:null)}var mA={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},gA=Object.assign,vA={};function _d(n,e,t){this.props=n,this.context=e,this.refs=vA,this.updater=t||mA}_d.prototype.isReactComponent={};_d.prototype.setState=function(n,e){if(typeof n!="object"&&typeof n!="function"&&n!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,n,e,"setState")};_d.prototype.forceUpdate=function(n){this.updater.enqueueForceUpdate(this,n,"forceUpdate")};function yA(){}yA.prototype=_d.prototype;function ab(n,e,t){this.props=n,this.context=e,this.refs=vA,this.updater=t||mA}var lb=ab.prototype=new yA;lb.constructor=ab;gA(lb,_d.prototype);lb.isPureReactComponent=!0;var Sw=Array.isArray,xA=Object.prototype.hasOwnProperty,cb={current:null},bA={key:!0,ref:!0,__self:!0,__source:!0};function wA(n,e,t){var s,i={},r=null,a=null;if(e!=null)for(s in e.ref!==void 0&&(a=e.ref),e.key!==void 0&&(r=""+e.key),e)xA.call(e,s)&&!bA.hasOwnProperty(s)&&(i[s]=e[s]);var l=arguments.length-2;if(l===1)i.children=t;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];i.children=c}if(n&&n.defaultProps)for(s in l=n.defaultProps,l)i[s]===void 0&&(i[s]=l[s]);return{$$typeof:Gp,type:n,key:r,ref:a,props:i,_owner:cb.current}}function z2(n,e){return{$$typeof:Gp,type:n.type,key:e,ref:n.ref,props:n.props,_owner:n._owner}}function ub(n){return typeof n=="object"&&n!==null&&n.$$typeof===Gp}function U2(n){var e={"=":"=0",":":"=2"};return"$"+n.replace(/[=:]/g,function(t){return e[t]})}var Ew=/\/+/g;function tv(n,e){return typeof n=="object"&&n!==null&&n.key!=null?U2(""+n.key):e.toString(36)}function Pm(n,e,t,s,i){var r=typeof n;(r==="undefined"||r==="boolean")&&(n=null);var a=!1;if(n===null)a=!0;else switch(r){case"string":case"number":a=!0;break;case"object":switch(n.$$typeof){case Gp:case N2:a=!0}}if(a)return a=n,i=i(a),n=s===""?"."+tv(a,0):s,Sw(i)?(t="",n!=null&&(t=n.replace(Ew,"$&/")+"/"),Pm(i,e,t,"",function(u){return u})):i!=null&&(ub(i)&&(i=z2(i,t+(!i.key||a&&a.key===i.key?"":(""+i.key).replace(Ew,"$&/")+"/")+n)),e.push(i)),1;if(a=0,s=s===""?".":s+":",Sw(n))for(var l=0;l<n.length;l++){r=n[l];var c=s+tv(r,l);a+=Pm(r,e,t,c,i)}else if(c=B2(n),typeof c=="function")for(n=c.call(n),l=0;!(r=n.next()).done;)r=r.value,c=s+tv(r,l++),a+=Pm(r,e,t,c,i);else if(r==="object")throw e=String(n),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return a}function im(n,e,t){if(n==null)return n;var s=[],i=0;return Pm(n,s,"","",function(r){return e.call(t,r,i++)}),s}function H2(n){if(n._status===-1){var e=n._result;e=e(),e.then(function(t){(n._status===0||n._status===-1)&&(n._status=1,n._result=t)},function(t){(n._status===0||n._status===-1)&&(n._status=2,n._result=t)}),n._status===-1&&(n._status=0,n._result=e)}if(n._status===1)return n._result.default;throw n._result}var xs={current:null},Mm={transition:null},$2={ReactCurrentDispatcher:xs,ReactCurrentBatchConfig:Mm,ReactCurrentOwner:cb};function AA(){throw Error("act(...) is not supported in production builds of React.")}pe.Children={map:im,forEach:function(n,e,t){im(n,function(){e.apply(this,arguments)},t)},count:function(n){var e=0;return im(n,function(){e++}),e},toArray:function(n){return im(n,function(e){return e})||[]},only:function(n){if(!ub(n))throw Error("React.Children.only expected to receive a single React element child.");return n}};pe.Component=_d;pe.Fragment=P2;pe.Profiler=L2;pe.PureComponent=ab;pe.StrictMode=M2;pe.Suspense=F2;pe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=$2;pe.act=AA;pe.cloneElement=function(n,e,t){if(n==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+n+".");var s=gA({},n.props),i=n.key,r=n.ref,a=n._owner;if(e!=null){if(e.ref!==void 0&&(r=e.ref,a=cb.current),e.key!==void 0&&(i=""+e.key),n.type&&n.type.defaultProps)var l=n.type.defaultProps;for(c in e)xA.call(e,c)&&!bA.hasOwnProperty(c)&&(s[c]=e[c]===void 0&&l!==void 0?l[c]:e[c])}var c=arguments.length-2;if(c===1)s.children=t;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];s.children=l}return{$$typeof:Gp,type:n.type,key:i,ref:r,props:s,_owner:a}};pe.createContext=function(n){return n={$$typeof:I2,_currentValue:n,_currentValue2:n,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},n.Provider={$$typeof:D2,_context:n},n.Consumer=n};pe.createElement=wA;pe.createFactory=function(n){var e=wA.bind(null,n);return e.type=n,e};pe.createRef=function(){return{current:null}};pe.forwardRef=function(n){return{$$typeof:R2,render:n}};pe.isValidElement=ub;pe.lazy=function(n){return{$$typeof:O2,_payload:{_status:-1,_result:n},_init:H2}};pe.memo=function(n,e){return{$$typeof:j2,type:n,compare:e===void 0?null:e}};pe.startTransition=function(n){var e=Mm.transition;Mm.transition={};try{n()}finally{Mm.transition=e}};pe.unstable_act=AA;pe.useCallback=function(n,e){return xs.current.useCallback(n,e)};pe.useContext=function(n){return xs.current.useContext(n)};pe.useDebugValue=function(){};pe.useDeferredValue=function(n){return xs.current.useDeferredValue(n)};pe.useEffect=function(n,e){return xs.current.useEffect(n,e)};pe.useId=function(){return xs.current.useId()};pe.useImperativeHandle=function(n,e,t){return xs.current.useImperativeHandle(n,e,t)};pe.useInsertionEffect=function(n,e){return xs.current.useInsertionEffect(n,e)};pe.useLayoutEffect=function(n,e){return xs.current.useLayoutEffect(n,e)};pe.useMemo=function(n,e){return xs.current.useMemo(n,e)};pe.useReducer=function(n,e,t){return xs.current.useReducer(n,e,t)};pe.useRef=function(n){return xs.current.useRef(n)};pe.useState=function(n){return xs.current.useState(n)};pe.useSyncExternalStore=function(n,e,t){return xs.current.useSyncExternalStore(n,e,t)};pe.useTransition=function(){return xs.current.useTransition()};pe.version="18.3.1";pA.exports=pe;var q=pA.exports;const V2=_2(q);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var W2=q,G2=Symbol.for("react.element"),X2=Symbol.for("react.fragment"),Y2=Object.prototype.hasOwnProperty,q2=W2.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,K2={key:!0,ref:!0,__self:!0,__source:!0};function kA(n,e,t){var s,i={},r=null,a=null;t!==void 0&&(r=""+t),e.key!==void 0&&(r=""+e.key),e.ref!==void 0&&(a=e.ref);for(s in e)Y2.call(e,s)&&!K2.hasOwnProperty(s)&&(i[s]=e[s]);if(n&&n.defaultProps)for(s in e=n.defaultProps,e)i[s]===void 0&&(i[s]=e[s]);return{$$typeof:G2,type:n,key:r,ref:a,props:i,_owner:q2.current}}E0.Fragment=X2;E0.jsx=kA;E0.jsxs=kA;fA.exports=E0;var g=fA.exports,jv={},SA={exports:{}},pn={},EA={exports:{}},CA={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(n){function e(R,X){var Y=R.length;R.push(X);e:for(;0<Y;){var ae=Y-1>>>1,te=R[ae];if(0<i(te,X))R[ae]=X,R[Y]=te,Y=ae;else break e}}function t(R){return R.length===0?null:R[0]}function s(R){if(R.length===0)return null;var X=R[0],Y=R.pop();if(Y!==X){R[0]=Y;e:for(var ae=0,te=R.length,he=te>>>1;ae<he;){var ht=2*(ae+1)-1,Ae=R[ht],_e=ht+1,ke=R[_e];if(0>i(Ae,Y))_e<te&&0>i(ke,Ae)?(R[ae]=ke,R[_e]=Y,ae=_e):(R[ae]=Ae,R[ht]=Y,ae=ht);else if(_e<te&&0>i(ke,Y))R[ae]=ke,R[_e]=Y,ae=_e;else break e}}return X}function i(R,X){var Y=R.sortIndex-X.sortIndex;return Y!==0?Y:R.id-X.id}if(typeof performance=="object"&&typeof performance.now=="function"){var r=performance;n.unstable_now=function(){return r.now()}}else{var a=Date,l=a.now();n.unstable_now=function(){return a.now()-l}}var c=[],u=[],d=1,h=null,f=3,p=!1,v=!1,b=!1,S=typeof setTimeout=="function"?setTimeout:null,y=typeof clearTimeout=="function"?clearTimeout:null,k=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function w(R){for(var X=t(u);X!==null;){if(X.callback===null)s(u);else if(X.startTime<=R)s(u),X.sortIndex=X.expirationTime,e(c,X);else break;X=t(u)}}function E(R){if(b=!1,w(R),!v)if(t(c)!==null)v=!0,G(C);else{var X=t(u);X!==null&&$(E,X.startTime-R)}}function C(R,X){v=!1,b&&(b=!1,y(P),P=-1),p=!0;var Y=f;try{for(w(X),h=t(c);h!==null&&(!(h.expirationTime>X)||R&&!F());){var ae=h.callback;if(typeof ae=="function"){h.callback=null,f=h.priorityLevel;var te=ae(h.expirationTime<=X);X=n.unstable_now(),typeof te=="function"?h.callback=te:h===t(c)&&s(c),w(X)}else s(c);h=t(c)}if(h!==null)var he=!0;else{var ht=t(u);ht!==null&&$(E,ht.startTime-X),he=!1}return he}finally{h=null,f=Y,p=!1}}var T=!1,_=null,P=-1,D=5,I=-1;function F(){return!(n.unstable_now()-I<D)}function K(){if(_!==null){var R=n.unstable_now();I=R;var X=!0;try{X=_(!0,R)}finally{X?Z():(T=!1,_=null)}}else T=!1}var Z;if(typeof k=="function")Z=function(){k(K)};else if(typeof MessageChannel<"u"){var Q=new MessageChannel,se=Q.port2;Q.port1.onmessage=K,Z=function(){se.postMessage(null)}}else Z=function(){S(K,0)};function G(R){_=R,T||(T=!0,Z())}function $(R,X){P=S(function(){R(n.unstable_now())},X)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(R){R.callback=null},n.unstable_continueExecution=function(){v||p||(v=!0,G(C))},n.unstable_forceFrameRate=function(R){0>R||125<R?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):D=0<R?Math.floor(1e3/R):5},n.unstable_getCurrentPriorityLevel=function(){return f},n.unstable_getFirstCallbackNode=function(){return t(c)},n.unstable_next=function(R){switch(f){case 1:case 2:case 3:var X=3;break;default:X=f}var Y=f;f=X;try{return R()}finally{f=Y}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(R,X){switch(R){case 1:case 2:case 3:case 4:case 5:break;default:R=3}var Y=f;f=R;try{return X()}finally{f=Y}},n.unstable_scheduleCallback=function(R,X,Y){var ae=n.unstable_now();switch(typeof Y=="object"&&Y!==null?(Y=Y.delay,Y=typeof Y=="number"&&0<Y?ae+Y:ae):Y=ae,R){case 1:var te=-1;break;case 2:te=250;break;case 5:te=1073741823;break;case 4:te=1e4;break;default:te=5e3}return te=Y+te,R={id:d++,callback:X,priorityLevel:R,startTime:Y,expirationTime:te,sortIndex:-1},Y>ae?(R.sortIndex=Y,e(u,R),t(c)===null&&R===t(u)&&(b?(y(P),P=-1):b=!0,$(E,Y-ae))):(R.sortIndex=te,e(c,R),v||p||(v=!0,G(C))),R},n.unstable_shouldYield=F,n.unstable_wrapCallback=function(R){var X=f;return function(){var Y=f;f=X;try{return R.apply(this,arguments)}finally{f=Y}}}})(CA);EA.exports=CA;var Q2=EA.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var J2=q,fn=Q2;function j(n){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+n,t=1;t<arguments.length;t++)e+="&args[]="+encodeURIComponent(arguments[t]);return"Minified React error #"+n+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var TA=new Set,Th={};function rc(n,e){xd(n,e),xd(n+"Capture",e)}function xd(n,e){for(Th[n]=e,n=0;n<e.length;n++)TA.add(e[n])}var Gr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Ov=Object.prototype.hasOwnProperty,Z2=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Cw={},Tw={};function eT(n){return Ov.call(Tw,n)?!0:Ov.call(Cw,n)?!1:Z2.test(n)?Tw[n]=!0:(Cw[n]=!0,!1)}function tT(n,e,t,s){if(t!==null&&t.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return s?!1:t!==null?!t.acceptsBooleans:(n=n.toLowerCase().slice(0,5),n!=="data-"&&n!=="aria-");default:return!1}}function sT(n,e,t,s){if(e===null||typeof e>"u"||tT(n,e,t,s))return!0;if(s)return!1;if(t!==null)switch(t.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function bs(n,e,t,s,i,r,a){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=s,this.attributeNamespace=i,this.mustUseProperty=t,this.propertyName=n,this.type=e,this.sanitizeURL=r,this.removeEmptyString=a}var Qt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(n){Qt[n]=new bs(n,0,!1,n,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(n){var e=n[0];Qt[e]=new bs(e,1,!1,n[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(n){Qt[n]=new bs(n,2,!1,n.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(n){Qt[n]=new bs(n,2,!1,n,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(n){Qt[n]=new bs(n,3,!1,n.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(n){Qt[n]=new bs(n,3,!0,n,null,!1,!1)});["capture","download"].forEach(function(n){Qt[n]=new bs(n,4,!1,n,null,!1,!1)});["cols","rows","size","span"].forEach(function(n){Qt[n]=new bs(n,6,!1,n,null,!1,!1)});["rowSpan","start"].forEach(function(n){Qt[n]=new bs(n,5,!1,n.toLowerCase(),null,!1,!1)});var db=/[\-:]([a-z])/g;function hb(n){return n[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(n){var e=n.replace(db,hb);Qt[e]=new bs(e,1,!1,n,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(n){var e=n.replace(db,hb);Qt[e]=new bs(e,1,!1,n,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(n){var e=n.replace(db,hb);Qt[e]=new bs(e,1,!1,n,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(n){Qt[n]=new bs(n,1,!1,n.toLowerCase(),null,!1,!1)});Qt.xlinkHref=new bs("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(n){Qt[n]=new bs(n,1,!1,n.toLowerCase(),null,!0,!0)});function fb(n,e,t,s){var i=Qt.hasOwnProperty(e)?Qt[e]:null;(i!==null?i.type!==0:s||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(sT(e,t,i,s)&&(t=null),s||i===null?eT(e)&&(t===null?n.removeAttribute(e):n.setAttribute(e,""+t)):i.mustUseProperty?n[i.propertyName]=t===null?i.type===3?!1:"":t:(e=i.attributeName,s=i.attributeNamespace,t===null?n.removeAttribute(e):(i=i.type,t=i===3||i===4&&t===!0?"":""+t,s?n.setAttributeNS(s,e,t):n.setAttribute(e,t))))}var Zr=J2.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,rm=Symbol.for("react.element"),Ac=Symbol.for("react.portal"),kc=Symbol.for("react.fragment"),pb=Symbol.for("react.strict_mode"),Bv=Symbol.for("react.profiler"),_A=Symbol.for("react.provider"),NA=Symbol.for("react.context"),mb=Symbol.for("react.forward_ref"),zv=Symbol.for("react.suspense"),Uv=Symbol.for("react.suspense_list"),gb=Symbol.for("react.memo"),no=Symbol.for("react.lazy"),PA=Symbol.for("react.offscreen"),_w=Symbol.iterator;function Dd(n){return n===null||typeof n!="object"?null:(n=_w&&n[_w]||n["@@iterator"],typeof n=="function"?n:null)}var it=Object.assign,sv;function Gd(n){if(sv===void 0)try{throw Error()}catch(t){var e=t.stack.trim().match(/\n( *(at )?)/);sv=e&&e[1]||""}return`
`+sv+n}var nv=!1;function iv(n,e){if(!n||nv)return"";nv=!0;var t=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var s=u}Reflect.construct(n,[],e)}else{try{e.call()}catch(u){s=u}n.call(e.prototype)}else{try{throw Error()}catch(u){s=u}n()}}catch(u){if(u&&s&&typeof u.stack=="string"){for(var i=u.stack.split(`
`),r=s.stack.split(`
`),a=i.length-1,l=r.length-1;1<=a&&0<=l&&i[a]!==r[l];)l--;for(;1<=a&&0<=l;a--,l--)if(i[a]!==r[l]){if(a!==1||l!==1)do if(a--,l--,0>l||i[a]!==r[l]){var c=`
`+i[a].replace(" at new "," at ");return n.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",n.displayName)),c}while(1<=a&&0<=l);break}}}finally{nv=!1,Error.prepareStackTrace=t}return(n=n?n.displayName||n.name:"")?Gd(n):""}function nT(n){switch(n.tag){case 5:return Gd(n.type);case 16:return Gd("Lazy");case 13:return Gd("Suspense");case 19:return Gd("SuspenseList");case 0:case 2:case 15:return n=iv(n.type,!1),n;case 11:return n=iv(n.type.render,!1),n;case 1:return n=iv(n.type,!0),n;default:return""}}function Hv(n){if(n==null)return null;if(typeof n=="function")return n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case kc:return"Fragment";case Ac:return"Portal";case Bv:return"Profiler";case pb:return"StrictMode";case zv:return"Suspense";case Uv:return"SuspenseList"}if(typeof n=="object")switch(n.$$typeof){case NA:return(n.displayName||"Context")+".Consumer";case _A:return(n._context.displayName||"Context")+".Provider";case mb:var e=n.render;return n=n.displayName,n||(n=e.displayName||e.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case gb:return e=n.displayName||null,e!==null?e:Hv(n.type)||"Memo";case no:e=n._payload,n=n._init;try{return Hv(n(e))}catch{}}return null}function iT(n){var e=n.type;switch(n.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return n=e.render,n=n.displayName||n.name||"",e.displayName||(n!==""?"ForwardRef("+n+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Hv(e);case 8:return e===pb?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function ma(n){switch(typeof n){case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function MA(n){var e=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function rT(n){var e=MA(n)?"checked":"value",t=Object.getOwnPropertyDescriptor(n.constructor.prototype,e),s=""+n[e];if(!n.hasOwnProperty(e)&&typeof t<"u"&&typeof t.get=="function"&&typeof t.set=="function"){var i=t.get,r=t.set;return Object.defineProperty(n,e,{configurable:!0,get:function(){return i.call(this)},set:function(a){s=""+a,r.call(this,a)}}),Object.defineProperty(n,e,{enumerable:t.enumerable}),{getValue:function(){return s},setValue:function(a){s=""+a},stopTracking:function(){n._valueTracker=null,delete n[e]}}}}function om(n){n._valueTracker||(n._valueTracker=rT(n))}function LA(n){if(!n)return!1;var e=n._valueTracker;if(!e)return!0;var t=e.getValue(),s="";return n&&(s=MA(n)?n.checked?"true":"false":n.value),n=s,n!==t?(e.setValue(n),!0):!1}function kg(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}function $v(n,e){var t=e.checked;return it({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:t??n._wrapperState.initialChecked})}function Nw(n,e){var t=e.defaultValue==null?"":e.defaultValue,s=e.checked!=null?e.checked:e.defaultChecked;t=ma(e.value!=null?e.value:t),n._wrapperState={initialChecked:s,initialValue:t,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function DA(n,e){e=e.checked,e!=null&&fb(n,"checked",e,!1)}function Vv(n,e){DA(n,e);var t=ma(e.value),s=e.type;if(t!=null)s==="number"?(t===0&&n.value===""||n.value!=t)&&(n.value=""+t):n.value!==""+t&&(n.value=""+t);else if(s==="submit"||s==="reset"){n.removeAttribute("value");return}e.hasOwnProperty("value")?Wv(n,e.type,t):e.hasOwnProperty("defaultValue")&&Wv(n,e.type,ma(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(n.defaultChecked=!!e.defaultChecked)}function Pw(n,e,t){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var s=e.type;if(!(s!=="submit"&&s!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+n._wrapperState.initialValue,t||e===n.value||(n.value=e),n.defaultValue=e}t=n.name,t!==""&&(n.name=""),n.defaultChecked=!!n._wrapperState.initialChecked,t!==""&&(n.name=t)}function Wv(n,e,t){(e!=="number"||kg(n.ownerDocument)!==n)&&(t==null?n.defaultValue=""+n._wrapperState.initialValue:n.defaultValue!==""+t&&(n.defaultValue=""+t))}var Xd=Array.isArray;function zc(n,e,t,s){if(n=n.options,e){e={};for(var i=0;i<t.length;i++)e["$"+t[i]]=!0;for(t=0;t<n.length;t++)i=e.hasOwnProperty("$"+n[t].value),n[t].selected!==i&&(n[t].selected=i),i&&s&&(n[t].defaultSelected=!0)}else{for(t=""+ma(t),e=null,i=0;i<n.length;i++){if(n[i].value===t){n[i].selected=!0,s&&(n[i].defaultSelected=!0);return}e!==null||n[i].disabled||(e=n[i])}e!==null&&(e.selected=!0)}}function Gv(n,e){if(e.dangerouslySetInnerHTML!=null)throw Error(j(91));return it({},e,{value:void 0,defaultValue:void 0,children:""+n._wrapperState.initialValue})}function Mw(n,e){var t=e.value;if(t==null){if(t=e.children,e=e.defaultValue,t!=null){if(e!=null)throw Error(j(92));if(Xd(t)){if(1<t.length)throw Error(j(93));t=t[0]}e=t}e==null&&(e=""),t=e}n._wrapperState={initialValue:ma(t)}}function IA(n,e){var t=ma(e.value),s=ma(e.defaultValue);t!=null&&(t=""+t,t!==n.value&&(n.value=t),e.defaultValue==null&&n.defaultValue!==t&&(n.defaultValue=t)),s!=null&&(n.defaultValue=""+s)}function Lw(n){var e=n.textContent;e===n._wrapperState.initialValue&&e!==""&&e!==null&&(n.value=e)}function RA(n){switch(n){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Xv(n,e){return n==null||n==="http://www.w3.org/1999/xhtml"?RA(e):n==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":n}var am,FA=function(n){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,t,s,i){MSApp.execUnsafeLocalFunction(function(){return n(e,t,s,i)})}:n}(function(n,e){if(n.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in n)n.innerHTML=e;else{for(am=am||document.createElement("div"),am.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=am.firstChild;n.firstChild;)n.removeChild(n.firstChild);for(;e.firstChild;)n.appendChild(e.firstChild)}});function _h(n,e){if(e){var t=n.firstChild;if(t&&t===n.lastChild&&t.nodeType===3){t.nodeValue=e;return}}n.textContent=e}var vh={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},oT=["Webkit","ms","Moz","O"];Object.keys(vh).forEach(function(n){oT.forEach(function(e){e=e+n.charAt(0).toUpperCase()+n.substring(1),vh[e]=vh[n]})});function jA(n,e,t){return e==null||typeof e=="boolean"||e===""?"":t||typeof e!="number"||e===0||vh.hasOwnProperty(n)&&vh[n]?(""+e).trim():e+"px"}function OA(n,e){n=n.style;for(var t in e)if(e.hasOwnProperty(t)){var s=t.indexOf("--")===0,i=jA(t,e[t],s);t==="float"&&(t="cssFloat"),s?n.setProperty(t,i):n[t]=i}}var aT=it({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Yv(n,e){if(e){if(aT[n]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(j(137,n));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(j(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(j(61))}if(e.style!=null&&typeof e.style!="object")throw Error(j(62))}}function qv(n,e){if(n.indexOf("-")===-1)return typeof e.is=="string";switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Kv=null;function vb(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var Qv=null,Uc=null,Hc=null;function Dw(n){if(n=qp(n)){if(typeof Qv!="function")throw Error(j(280));var e=n.stateNode;e&&(e=P0(e),Qv(n.stateNode,n.type,e))}}function BA(n){Uc?Hc?Hc.push(n):Hc=[n]:Uc=n}function zA(){if(Uc){var n=Uc,e=Hc;if(Hc=Uc=null,Dw(n),e)for(n=0;n<e.length;n++)Dw(e[n])}}function UA(n,e){return n(e)}function HA(){}var rv=!1;function $A(n,e,t){if(rv)return n(e,t);rv=!0;try{return UA(n,e,t)}finally{rv=!1,(Uc!==null||Hc!==null)&&(HA(),zA())}}function Nh(n,e){var t=n.stateNode;if(t===null)return null;var s=P0(t);if(s===null)return null;t=s[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(s=!s.disabled)||(n=n.type,s=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!s;break e;default:n=!1}if(n)return null;if(t&&typeof t!="function")throw Error(j(231,e,typeof t));return t}var Jv=!1;if(Gr)try{var Id={};Object.defineProperty(Id,"passive",{get:function(){Jv=!0}}),window.addEventListener("test",Id,Id),window.removeEventListener("test",Id,Id)}catch{Jv=!1}function lT(n,e,t,s,i,r,a,l,c){var u=Array.prototype.slice.call(arguments,3);try{e.apply(t,u)}catch(d){this.onError(d)}}var yh=!1,Sg=null,Eg=!1,Zv=null,cT={onError:function(n){yh=!0,Sg=n}};function uT(n,e,t,s,i,r,a,l,c){yh=!1,Sg=null,lT.apply(cT,arguments)}function dT(n,e,t,s,i,r,a,l,c){if(uT.apply(this,arguments),yh){if(yh){var u=Sg;yh=!1,Sg=null}else throw Error(j(198));Eg||(Eg=!0,Zv=u)}}function oc(n){var e=n,t=n;if(n.alternate)for(;e.return;)e=e.return;else{n=e;do e=n,e.flags&4098&&(t=e.return),n=e.return;while(n)}return e.tag===3?t:null}function VA(n){if(n.tag===13){var e=n.memoizedState;if(e===null&&(n=n.alternate,n!==null&&(e=n.memoizedState)),e!==null)return e.dehydrated}return null}function Iw(n){if(oc(n)!==n)throw Error(j(188))}function hT(n){var e=n.alternate;if(!e){if(e=oc(n),e===null)throw Error(j(188));return e!==n?null:n}for(var t=n,s=e;;){var i=t.return;if(i===null)break;var r=i.alternate;if(r===null){if(s=i.return,s!==null){t=s;continue}break}if(i.child===r.child){for(r=i.child;r;){if(r===t)return Iw(i),n;if(r===s)return Iw(i),e;r=r.sibling}throw Error(j(188))}if(t.return!==s.return)t=i,s=r;else{for(var a=!1,l=i.child;l;){if(l===t){a=!0,t=i,s=r;break}if(l===s){a=!0,s=i,t=r;break}l=l.sibling}if(!a){for(l=r.child;l;){if(l===t){a=!0,t=r,s=i;break}if(l===s){a=!0,s=r,t=i;break}l=l.sibling}if(!a)throw Error(j(189))}}if(t.alternate!==s)throw Error(j(190))}if(t.tag!==3)throw Error(j(188));return t.stateNode.current===t?n:e}function WA(n){return n=hT(n),n!==null?GA(n):null}function GA(n){if(n.tag===5||n.tag===6)return n;for(n=n.child;n!==null;){var e=GA(n);if(e!==null)return e;n=n.sibling}return null}var XA=fn.unstable_scheduleCallback,Rw=fn.unstable_cancelCallback,fT=fn.unstable_shouldYield,pT=fn.unstable_requestPaint,gt=fn.unstable_now,mT=fn.unstable_getCurrentPriorityLevel,yb=fn.unstable_ImmediatePriority,YA=fn.unstable_UserBlockingPriority,Cg=fn.unstable_NormalPriority,gT=fn.unstable_LowPriority,qA=fn.unstable_IdlePriority,C0=null,Ui=null;function vT(n){if(Ui&&typeof Ui.onCommitFiberRoot=="function")try{Ui.onCommitFiberRoot(C0,n,void 0,(n.current.flags&128)===128)}catch{}}var li=Math.clz32?Math.clz32:bT,yT=Math.log,xT=Math.LN2;function bT(n){return n>>>=0,n===0?32:31-(yT(n)/xT|0)|0}var lm=64,cm=4194304;function Yd(n){switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return n&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return n}}function Tg(n,e){var t=n.pendingLanes;if(t===0)return 0;var s=0,i=n.suspendedLanes,r=n.pingedLanes,a=t&268435455;if(a!==0){var l=a&~i;l!==0?s=Yd(l):(r&=a,r!==0&&(s=Yd(r)))}else a=t&~i,a!==0?s=Yd(a):r!==0&&(s=Yd(r));if(s===0)return 0;if(e!==0&&e!==s&&!(e&i)&&(i=s&-s,r=e&-e,i>=r||i===16&&(r&4194240)!==0))return e;if(s&4&&(s|=t&16),e=n.entangledLanes,e!==0)for(n=n.entanglements,e&=s;0<e;)t=31-li(e),i=1<<t,s|=n[t],e&=~i;return s}function wT(n,e){switch(n){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function AT(n,e){for(var t=n.suspendedLanes,s=n.pingedLanes,i=n.expirationTimes,r=n.pendingLanes;0<r;){var a=31-li(r),l=1<<a,c=i[a];c===-1?(!(l&t)||l&s)&&(i[a]=wT(l,e)):c<=e&&(n.expiredLanes|=l),r&=~l}}function ey(n){return n=n.pendingLanes&-1073741825,n!==0?n:n&1073741824?1073741824:0}function KA(){var n=lm;return lm<<=1,!(lm&4194240)&&(lm=64),n}function ov(n){for(var e=[],t=0;31>t;t++)e.push(n);return e}function Xp(n,e,t){n.pendingLanes|=e,e!==536870912&&(n.suspendedLanes=0,n.pingedLanes=0),n=n.eventTimes,e=31-li(e),n[e]=t}function kT(n,e){var t=n.pendingLanes&~e;n.pendingLanes=e,n.suspendedLanes=0,n.pingedLanes=0,n.expiredLanes&=e,n.mutableReadLanes&=e,n.entangledLanes&=e,e=n.entanglements;var s=n.eventTimes;for(n=n.expirationTimes;0<t;){var i=31-li(t),r=1<<i;e[i]=0,s[i]=-1,n[i]=-1,t&=~r}}function xb(n,e){var t=n.entangledLanes|=e;for(n=n.entanglements;t;){var s=31-li(t),i=1<<s;i&e|n[s]&e&&(n[s]|=e),t&=~i}}var Le=0;function QA(n){return n&=-n,1<n?4<n?n&268435455?16:536870912:4:1}var JA,bb,ZA,ek,tk,ty=!1,um=[],aa=null,la=null,ca=null,Ph=new Map,Mh=new Map,ro=[],ST="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Fw(n,e){switch(n){case"focusin":case"focusout":aa=null;break;case"dragenter":case"dragleave":la=null;break;case"mouseover":case"mouseout":ca=null;break;case"pointerover":case"pointerout":Ph.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Mh.delete(e.pointerId)}}function Rd(n,e,t,s,i,r){return n===null||n.nativeEvent!==r?(n={blockedOn:e,domEventName:t,eventSystemFlags:s,nativeEvent:r,targetContainers:[i]},e!==null&&(e=qp(e),e!==null&&bb(e)),n):(n.eventSystemFlags|=s,e=n.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),n)}function ET(n,e,t,s,i){switch(e){case"focusin":return aa=Rd(aa,n,e,t,s,i),!0;case"dragenter":return la=Rd(la,n,e,t,s,i),!0;case"mouseover":return ca=Rd(ca,n,e,t,s,i),!0;case"pointerover":var r=i.pointerId;return Ph.set(r,Rd(Ph.get(r)||null,n,e,t,s,i)),!0;case"gotpointercapture":return r=i.pointerId,Mh.set(r,Rd(Mh.get(r)||null,n,e,t,s,i)),!0}return!1}function sk(n){var e=Ia(n.target);if(e!==null){var t=oc(e);if(t!==null){if(e=t.tag,e===13){if(e=VA(t),e!==null){n.blockedOn=e,tk(n.priority,function(){ZA(t)});return}}else if(e===3&&t.stateNode.current.memoizedState.isDehydrated){n.blockedOn=t.tag===3?t.stateNode.containerInfo:null;return}}}n.blockedOn=null}function Lm(n){if(n.blockedOn!==null)return!1;for(var e=n.targetContainers;0<e.length;){var t=sy(n.domEventName,n.eventSystemFlags,e[0],n.nativeEvent);if(t===null){t=n.nativeEvent;var s=new t.constructor(t.type,t);Kv=s,t.target.dispatchEvent(s),Kv=null}else return e=qp(t),e!==null&&bb(e),n.blockedOn=t,!1;e.shift()}return!0}function jw(n,e,t){Lm(n)&&t.delete(e)}function CT(){ty=!1,aa!==null&&Lm(aa)&&(aa=null),la!==null&&Lm(la)&&(la=null),ca!==null&&Lm(ca)&&(ca=null),Ph.forEach(jw),Mh.forEach(jw)}function Fd(n,e){n.blockedOn===e&&(n.blockedOn=null,ty||(ty=!0,fn.unstable_scheduleCallback(fn.unstable_NormalPriority,CT)))}function Lh(n){function e(i){return Fd(i,n)}if(0<um.length){Fd(um[0],n);for(var t=1;t<um.length;t++){var s=um[t];s.blockedOn===n&&(s.blockedOn=null)}}for(aa!==null&&Fd(aa,n),la!==null&&Fd(la,n),ca!==null&&Fd(ca,n),Ph.forEach(e),Mh.forEach(e),t=0;t<ro.length;t++)s=ro[t],s.blockedOn===n&&(s.blockedOn=null);for(;0<ro.length&&(t=ro[0],t.blockedOn===null);)sk(t),t.blockedOn===null&&ro.shift()}var $c=Zr.ReactCurrentBatchConfig,_g=!0;function TT(n,e,t,s){var i=Le,r=$c.transition;$c.transition=null;try{Le=1,wb(n,e,t,s)}finally{Le=i,$c.transition=r}}function _T(n,e,t,s){var i=Le,r=$c.transition;$c.transition=null;try{Le=4,wb(n,e,t,s)}finally{Le=i,$c.transition=r}}function wb(n,e,t,s){if(_g){var i=sy(n,e,t,s);if(i===null)gv(n,e,s,Ng,t),Fw(n,s);else if(ET(i,n,e,t,s))s.stopPropagation();else if(Fw(n,s),e&4&&-1<ST.indexOf(n)){for(;i!==null;){var r=qp(i);if(r!==null&&JA(r),r=sy(n,e,t,s),r===null&&gv(n,e,s,Ng,t),r===i)break;i=r}i!==null&&s.stopPropagation()}else gv(n,e,s,null,t)}}var Ng=null;function sy(n,e,t,s){if(Ng=null,n=vb(s),n=Ia(n),n!==null)if(e=oc(n),e===null)n=null;else if(t=e.tag,t===13){if(n=VA(e),n!==null)return n;n=null}else if(t===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;n=null}else e!==n&&(n=null);return Ng=n,null}function nk(n){switch(n){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(mT()){case yb:return 1;case YA:return 4;case Cg:case gT:return 16;case qA:return 536870912;default:return 16}default:return 16}}var ra=null,Ab=null,Dm=null;function ik(){if(Dm)return Dm;var n,e=Ab,t=e.length,s,i="value"in ra?ra.value:ra.textContent,r=i.length;for(n=0;n<t&&e[n]===i[n];n++);var a=t-n;for(s=1;s<=a&&e[t-s]===i[r-s];s++);return Dm=i.slice(n,1<s?1-s:void 0)}function Im(n){var e=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&e===13&&(n=13)):n=e,n===10&&(n=13),32<=n||n===13?n:0}function dm(){return!0}function Ow(){return!1}function mn(n){function e(t,s,i,r,a){this._reactName=t,this._targetInst=i,this.type=s,this.nativeEvent=r,this.target=a,this.currentTarget=null;for(var l in n)n.hasOwnProperty(l)&&(t=n[l],this[l]=t?t(r):r[l]);return this.isDefaultPrevented=(r.defaultPrevented!=null?r.defaultPrevented:r.returnValue===!1)?dm:Ow,this.isPropagationStopped=Ow,this}return it(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var t=this.nativeEvent;t&&(t.preventDefault?t.preventDefault():typeof t.returnValue!="unknown"&&(t.returnValue=!1),this.isDefaultPrevented=dm)},stopPropagation:function(){var t=this.nativeEvent;t&&(t.stopPropagation?t.stopPropagation():typeof t.cancelBubble!="unknown"&&(t.cancelBubble=!0),this.isPropagationStopped=dm)},persist:function(){},isPersistent:dm}),e}var Nd={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},kb=mn(Nd),Yp=it({},Nd,{view:0,detail:0}),NT=mn(Yp),av,lv,jd,T0=it({},Yp,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Sb,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==jd&&(jd&&n.type==="mousemove"?(av=n.screenX-jd.screenX,lv=n.screenY-jd.screenY):lv=av=0,jd=n),av)},movementY:function(n){return"movementY"in n?n.movementY:lv}}),Bw=mn(T0),PT=it({},T0,{dataTransfer:0}),MT=mn(PT),LT=it({},Yp,{relatedTarget:0}),cv=mn(LT),DT=it({},Nd,{animationName:0,elapsedTime:0,pseudoElement:0}),IT=mn(DT),RT=it({},Nd,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),FT=mn(RT),jT=it({},Nd,{data:0}),zw=mn(jT),OT={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},BT={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},zT={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function UT(n){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(n):(n=zT[n])?!!e[n]:!1}function Sb(){return UT}var HT=it({},Yp,{key:function(n){if(n.key){var e=OT[n.key]||n.key;if(e!=="Unidentified")return e}return n.type==="keypress"?(n=Im(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?BT[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Sb,charCode:function(n){return n.type==="keypress"?Im(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?Im(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),$T=mn(HT),VT=it({},T0,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Uw=mn(VT),WT=it({},Yp,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Sb}),GT=mn(WT),XT=it({},Nd,{propertyName:0,elapsedTime:0,pseudoElement:0}),YT=mn(XT),qT=it({},T0,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),KT=mn(qT),QT=[9,13,27,32],Eb=Gr&&"CompositionEvent"in window,xh=null;Gr&&"documentMode"in document&&(xh=document.documentMode);var JT=Gr&&"TextEvent"in window&&!xh,rk=Gr&&(!Eb||xh&&8<xh&&11>=xh),Hw=" ",$w=!1;function ok(n,e){switch(n){case"keyup":return QT.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function ak(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var Sc=!1;function ZT(n,e){switch(n){case"compositionend":return ak(e);case"keypress":return e.which!==32?null:($w=!0,Hw);case"textInput":return n=e.data,n===Hw&&$w?null:n;default:return null}}function e_(n,e){if(Sc)return n==="compositionend"||!Eb&&ok(n,e)?(n=ik(),Dm=Ab=ra=null,Sc=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return rk&&e.locale!=="ko"?null:e.data;default:return null}}var t_={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Vw(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e==="input"?!!t_[n.type]:e==="textarea"}function lk(n,e,t,s){BA(s),e=Pg(e,"onChange"),0<e.length&&(t=new kb("onChange","change",null,t,s),n.push({event:t,listeners:e}))}var bh=null,Dh=null;function s_(n){xk(n,0)}function _0(n){var e=Tc(n);if(LA(e))return n}function n_(n,e){if(n==="change")return e}var ck=!1;if(Gr){var uv;if(Gr){var dv="oninput"in document;if(!dv){var Ww=document.createElement("div");Ww.setAttribute("oninput","return;"),dv=typeof Ww.oninput=="function"}uv=dv}else uv=!1;ck=uv&&(!document.documentMode||9<document.documentMode)}function Gw(){bh&&(bh.detachEvent("onpropertychange",uk),Dh=bh=null)}function uk(n){if(n.propertyName==="value"&&_0(Dh)){var e=[];lk(e,Dh,n,vb(n)),$A(s_,e)}}function i_(n,e,t){n==="focusin"?(Gw(),bh=e,Dh=t,bh.attachEvent("onpropertychange",uk)):n==="focusout"&&Gw()}function r_(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return _0(Dh)}function o_(n,e){if(n==="click")return _0(e)}function a_(n,e){if(n==="input"||n==="change")return _0(e)}function l_(n,e){return n===e&&(n!==0||1/n===1/e)||n!==n&&e!==e}var ui=typeof Object.is=="function"?Object.is:l_;function Ih(n,e){if(ui(n,e))return!0;if(typeof n!="object"||n===null||typeof e!="object"||e===null)return!1;var t=Object.keys(n),s=Object.keys(e);if(t.length!==s.length)return!1;for(s=0;s<t.length;s++){var i=t[s];if(!Ov.call(e,i)||!ui(n[i],e[i]))return!1}return!0}function Xw(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function Yw(n,e){var t=Xw(n);n=0;for(var s;t;){if(t.nodeType===3){if(s=n+t.textContent.length,n<=e&&s>=e)return{node:t,offset:e-n};n=s}e:{for(;t;){if(t.nextSibling){t=t.nextSibling;break e}t=t.parentNode}t=void 0}t=Xw(t)}}function dk(n,e){return n&&e?n===e?!0:n&&n.nodeType===3?!1:e&&e.nodeType===3?dk(n,e.parentNode):"contains"in n?n.contains(e):n.compareDocumentPosition?!!(n.compareDocumentPosition(e)&16):!1:!1}function hk(){for(var n=window,e=kg();e instanceof n.HTMLIFrameElement;){try{var t=typeof e.contentWindow.location.href=="string"}catch{t=!1}if(t)n=e.contentWindow;else break;e=kg(n.document)}return e}function Cb(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e&&(e==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||e==="textarea"||n.contentEditable==="true")}function c_(n){var e=hk(),t=n.focusedElem,s=n.selectionRange;if(e!==t&&t&&t.ownerDocument&&dk(t.ownerDocument.documentElement,t)){if(s!==null&&Cb(t)){if(e=s.start,n=s.end,n===void 0&&(n=e),"selectionStart"in t)t.selectionStart=e,t.selectionEnd=Math.min(n,t.value.length);else if(n=(e=t.ownerDocument||document)&&e.defaultView||window,n.getSelection){n=n.getSelection();var i=t.textContent.length,r=Math.min(s.start,i);s=s.end===void 0?r:Math.min(s.end,i),!n.extend&&r>s&&(i=s,s=r,r=i),i=Yw(t,r);var a=Yw(t,s);i&&a&&(n.rangeCount!==1||n.anchorNode!==i.node||n.anchorOffset!==i.offset||n.focusNode!==a.node||n.focusOffset!==a.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),n.removeAllRanges(),r>s?(n.addRange(e),n.extend(a.node,a.offset)):(e.setEnd(a.node,a.offset),n.addRange(e)))}}for(e=[],n=t;n=n.parentNode;)n.nodeType===1&&e.push({element:n,left:n.scrollLeft,top:n.scrollTop});for(typeof t.focus=="function"&&t.focus(),t=0;t<e.length;t++)n=e[t],n.element.scrollLeft=n.left,n.element.scrollTop=n.top}}var u_=Gr&&"documentMode"in document&&11>=document.documentMode,Ec=null,ny=null,wh=null,iy=!1;function qw(n,e,t){var s=t.window===t?t.document:t.nodeType===9?t:t.ownerDocument;iy||Ec==null||Ec!==kg(s)||(s=Ec,"selectionStart"in s&&Cb(s)?s={start:s.selectionStart,end:s.selectionEnd}:(s=(s.ownerDocument&&s.ownerDocument.defaultView||window).getSelection(),s={anchorNode:s.anchorNode,anchorOffset:s.anchorOffset,focusNode:s.focusNode,focusOffset:s.focusOffset}),wh&&Ih(wh,s)||(wh=s,s=Pg(ny,"onSelect"),0<s.length&&(e=new kb("onSelect","select",null,e,t),n.push({event:e,listeners:s}),e.target=Ec)))}function hm(n,e){var t={};return t[n.toLowerCase()]=e.toLowerCase(),t["Webkit"+n]="webkit"+e,t["Moz"+n]="moz"+e,t}var Cc={animationend:hm("Animation","AnimationEnd"),animationiteration:hm("Animation","AnimationIteration"),animationstart:hm("Animation","AnimationStart"),transitionend:hm("Transition","TransitionEnd")},hv={},fk={};Gr&&(fk=document.createElement("div").style,"AnimationEvent"in window||(delete Cc.animationend.animation,delete Cc.animationiteration.animation,delete Cc.animationstart.animation),"TransitionEvent"in window||delete Cc.transitionend.transition);function N0(n){if(hv[n])return hv[n];if(!Cc[n])return n;var e=Cc[n],t;for(t in e)if(e.hasOwnProperty(t)&&t in fk)return hv[n]=e[t];return n}var pk=N0("animationend"),mk=N0("animationiteration"),gk=N0("animationstart"),vk=N0("transitionend"),yk=new Map,Kw="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ba(n,e){yk.set(n,e),rc(e,[n])}for(var fv=0;fv<Kw.length;fv++){var pv=Kw[fv],d_=pv.toLowerCase(),h_=pv[0].toUpperCase()+pv.slice(1);ba(d_,"on"+h_)}ba(pk,"onAnimationEnd");ba(mk,"onAnimationIteration");ba(gk,"onAnimationStart");ba("dblclick","onDoubleClick");ba("focusin","onFocus");ba("focusout","onBlur");ba(vk,"onTransitionEnd");xd("onMouseEnter",["mouseout","mouseover"]);xd("onMouseLeave",["mouseout","mouseover"]);xd("onPointerEnter",["pointerout","pointerover"]);xd("onPointerLeave",["pointerout","pointerover"]);rc("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));rc("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));rc("onBeforeInput",["compositionend","keypress","textInput","paste"]);rc("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));rc("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));rc("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var qd="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),f_=new Set("cancel close invalid load scroll toggle".split(" ").concat(qd));function Qw(n,e,t){var s=n.type||"unknown-event";n.currentTarget=t,dT(s,e,void 0,n),n.currentTarget=null}function xk(n,e){e=(e&4)!==0;for(var t=0;t<n.length;t++){var s=n[t],i=s.event;s=s.listeners;e:{var r=void 0;if(e)for(var a=s.length-1;0<=a;a--){var l=s[a],c=l.instance,u=l.currentTarget;if(l=l.listener,c!==r&&i.isPropagationStopped())break e;Qw(i,l,u),r=c}else for(a=0;a<s.length;a++){if(l=s[a],c=l.instance,u=l.currentTarget,l=l.listener,c!==r&&i.isPropagationStopped())break e;Qw(i,l,u),r=c}}}if(Eg)throw n=Zv,Eg=!1,Zv=null,n}function We(n,e){var t=e[cy];t===void 0&&(t=e[cy]=new Set);var s=n+"__bubble";t.has(s)||(bk(e,n,2,!1),t.add(s))}function mv(n,e,t){var s=0;e&&(s|=4),bk(t,n,s,e)}var fm="_reactListening"+Math.random().toString(36).slice(2);function Rh(n){if(!n[fm]){n[fm]=!0,TA.forEach(function(t){t!=="selectionchange"&&(f_.has(t)||mv(t,!1,n),mv(t,!0,n))});var e=n.nodeType===9?n:n.ownerDocument;e===null||e[fm]||(e[fm]=!0,mv("selectionchange",!1,e))}}function bk(n,e,t,s){switch(nk(e)){case 1:var i=TT;break;case 4:i=_T;break;default:i=wb}t=i.bind(null,e,t,n),i=void 0,!Jv||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),s?i!==void 0?n.addEventListener(e,t,{capture:!0,passive:i}):n.addEventListener(e,t,!0):i!==void 0?n.addEventListener(e,t,{passive:i}):n.addEventListener(e,t,!1)}function gv(n,e,t,s,i){var r=s;if(!(e&1)&&!(e&2)&&s!==null)e:for(;;){if(s===null)return;var a=s.tag;if(a===3||a===4){var l=s.stateNode.containerInfo;if(l===i||l.nodeType===8&&l.parentNode===i)break;if(a===4)for(a=s.return;a!==null;){var c=a.tag;if((c===3||c===4)&&(c=a.stateNode.containerInfo,c===i||c.nodeType===8&&c.parentNode===i))return;a=a.return}for(;l!==null;){if(a=Ia(l),a===null)return;if(c=a.tag,c===5||c===6){s=r=a;continue e}l=l.parentNode}}s=s.return}$A(function(){var u=r,d=vb(t),h=[];e:{var f=yk.get(n);if(f!==void 0){var p=kb,v=n;switch(n){case"keypress":if(Im(t)===0)break e;case"keydown":case"keyup":p=$T;break;case"focusin":v="focus",p=cv;break;case"focusout":v="blur",p=cv;break;case"beforeblur":case"afterblur":p=cv;break;case"click":if(t.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":p=Bw;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":p=MT;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":p=GT;break;case pk:case mk:case gk:p=IT;break;case vk:p=YT;break;case"scroll":p=NT;break;case"wheel":p=KT;break;case"copy":case"cut":case"paste":p=FT;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":p=Uw}var b=(e&4)!==0,S=!b&&n==="scroll",y=b?f!==null?f+"Capture":null:f;b=[];for(var k=u,w;k!==null;){w=k;var E=w.stateNode;if(w.tag===5&&E!==null&&(w=E,y!==null&&(E=Nh(k,y),E!=null&&b.push(Fh(k,E,w)))),S)break;k=k.return}0<b.length&&(f=new p(f,v,null,t,d),h.push({event:f,listeners:b}))}}if(!(e&7)){e:{if(f=n==="mouseover"||n==="pointerover",p=n==="mouseout"||n==="pointerout",f&&t!==Kv&&(v=t.relatedTarget||t.fromElement)&&(Ia(v)||v[Xr]))break e;if((p||f)&&(f=d.window===d?d:(f=d.ownerDocument)?f.defaultView||f.parentWindow:window,p?(v=t.relatedTarget||t.toElement,p=u,v=v?Ia(v):null,v!==null&&(S=oc(v),v!==S||v.tag!==5&&v.tag!==6)&&(v=null)):(p=null,v=u),p!==v)){if(b=Bw,E="onMouseLeave",y="onMouseEnter",k="mouse",(n==="pointerout"||n==="pointerover")&&(b=Uw,E="onPointerLeave",y="onPointerEnter",k="pointer"),S=p==null?f:Tc(p),w=v==null?f:Tc(v),f=new b(E,k+"leave",p,t,d),f.target=S,f.relatedTarget=w,E=null,Ia(d)===u&&(b=new b(y,k+"enter",v,t,d),b.target=w,b.relatedTarget=S,E=b),S=E,p&&v)t:{for(b=p,y=v,k=0,w=b;w;w=hc(w))k++;for(w=0,E=y;E;E=hc(E))w++;for(;0<k-w;)b=hc(b),k--;for(;0<w-k;)y=hc(y),w--;for(;k--;){if(b===y||y!==null&&b===y.alternate)break t;b=hc(b),y=hc(y)}b=null}else b=null;p!==null&&Jw(h,f,p,b,!1),v!==null&&S!==null&&Jw(h,S,v,b,!0)}}e:{if(f=u?Tc(u):window,p=f.nodeName&&f.nodeName.toLowerCase(),p==="select"||p==="input"&&f.type==="file")var C=n_;else if(Vw(f))if(ck)C=a_;else{C=r_;var T=i_}else(p=f.nodeName)&&p.toLowerCase()==="input"&&(f.type==="checkbox"||f.type==="radio")&&(C=o_);if(C&&(C=C(n,u))){lk(h,C,t,d);break e}T&&T(n,f,u),n==="focusout"&&(T=f._wrapperState)&&T.controlled&&f.type==="number"&&Wv(f,"number",f.value)}switch(T=u?Tc(u):window,n){case"focusin":(Vw(T)||T.contentEditable==="true")&&(Ec=T,ny=u,wh=null);break;case"focusout":wh=ny=Ec=null;break;case"mousedown":iy=!0;break;case"contextmenu":case"mouseup":case"dragend":iy=!1,qw(h,t,d);break;case"selectionchange":if(u_)break;case"keydown":case"keyup":qw(h,t,d)}var _;if(Eb)e:{switch(n){case"compositionstart":var P="onCompositionStart";break e;case"compositionend":P="onCompositionEnd";break e;case"compositionupdate":P="onCompositionUpdate";break e}P=void 0}else Sc?ok(n,t)&&(P="onCompositionEnd"):n==="keydown"&&t.keyCode===229&&(P="onCompositionStart");P&&(rk&&t.locale!=="ko"&&(Sc||P!=="onCompositionStart"?P==="onCompositionEnd"&&Sc&&(_=ik()):(ra=d,Ab="value"in ra?ra.value:ra.textContent,Sc=!0)),T=Pg(u,P),0<T.length&&(P=new zw(P,n,null,t,d),h.push({event:P,listeners:T}),_?P.data=_:(_=ak(t),_!==null&&(P.data=_)))),(_=JT?ZT(n,t):e_(n,t))&&(u=Pg(u,"onBeforeInput"),0<u.length&&(d=new zw("onBeforeInput","beforeinput",null,t,d),h.push({event:d,listeners:u}),d.data=_))}xk(h,e)})}function Fh(n,e,t){return{instance:n,listener:e,currentTarget:t}}function Pg(n,e){for(var t=e+"Capture",s=[];n!==null;){var i=n,r=i.stateNode;i.tag===5&&r!==null&&(i=r,r=Nh(n,t),r!=null&&s.unshift(Fh(n,r,i)),r=Nh(n,e),r!=null&&s.push(Fh(n,r,i))),n=n.return}return s}function hc(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5);return n||null}function Jw(n,e,t,s,i){for(var r=e._reactName,a=[];t!==null&&t!==s;){var l=t,c=l.alternate,u=l.stateNode;if(c!==null&&c===s)break;l.tag===5&&u!==null&&(l=u,i?(c=Nh(t,r),c!=null&&a.unshift(Fh(t,c,l))):i||(c=Nh(t,r),c!=null&&a.push(Fh(t,c,l)))),t=t.return}a.length!==0&&n.push({event:e,listeners:a})}var p_=/\r\n?/g,m_=/\u0000|\uFFFD/g;function Zw(n){return(typeof n=="string"?n:""+n).replace(p_,`
`).replace(m_,"")}function pm(n,e,t){if(e=Zw(e),Zw(n)!==e&&t)throw Error(j(425))}function Mg(){}var ry=null,oy=null;function ay(n,e){return n==="textarea"||n==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var ly=typeof setTimeout=="function"?setTimeout:void 0,g_=typeof clearTimeout=="function"?clearTimeout:void 0,e1=typeof Promise=="function"?Promise:void 0,v_=typeof queueMicrotask=="function"?queueMicrotask:typeof e1<"u"?function(n){return e1.resolve(null).then(n).catch(y_)}:ly;function y_(n){setTimeout(function(){throw n})}function vv(n,e){var t=e,s=0;do{var i=t.nextSibling;if(n.removeChild(t),i&&i.nodeType===8)if(t=i.data,t==="/$"){if(s===0){n.removeChild(i),Lh(e);return}s--}else t!=="$"&&t!=="$?"&&t!=="$!"||s++;t=i}while(t);Lh(e)}function ua(n){for(;n!=null;n=n.nextSibling){var e=n.nodeType;if(e===1||e===3)break;if(e===8){if(e=n.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return n}function t1(n){n=n.previousSibling;for(var e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="$"||t==="$!"||t==="$?"){if(e===0)return n;e--}else t==="/$"&&e++}n=n.previousSibling}return null}var Pd=Math.random().toString(36).slice(2),Bi="__reactFiber$"+Pd,jh="__reactProps$"+Pd,Xr="__reactContainer$"+Pd,cy="__reactEvents$"+Pd,x_="__reactListeners$"+Pd,b_="__reactHandles$"+Pd;function Ia(n){var e=n[Bi];if(e)return e;for(var t=n.parentNode;t;){if(e=t[Xr]||t[Bi]){if(t=e.alternate,e.child!==null||t!==null&&t.child!==null)for(n=t1(n);n!==null;){if(t=n[Bi])return t;n=t1(n)}return e}n=t,t=n.parentNode}return null}function qp(n){return n=n[Bi]||n[Xr],!n||n.tag!==5&&n.tag!==6&&n.tag!==13&&n.tag!==3?null:n}function Tc(n){if(n.tag===5||n.tag===6)return n.stateNode;throw Error(j(33))}function P0(n){return n[jh]||null}var uy=[],_c=-1;function wa(n){return{current:n}}function Xe(n){0>_c||(n.current=uy[_c],uy[_c]=null,_c--)}function $e(n,e){_c++,uy[_c]=n.current,n.current=e}var ga={},ls=wa(ga),Rs=wa(!1),Ql=ga;function bd(n,e){var t=n.type.contextTypes;if(!t)return ga;var s=n.stateNode;if(s&&s.__reactInternalMemoizedUnmaskedChildContext===e)return s.__reactInternalMemoizedMaskedChildContext;var i={},r;for(r in t)i[r]=e[r];return s&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=e,n.__reactInternalMemoizedMaskedChildContext=i),i}function Fs(n){return n=n.childContextTypes,n!=null}function Lg(){Xe(Rs),Xe(ls)}function s1(n,e,t){if(ls.current!==ga)throw Error(j(168));$e(ls,e),$e(Rs,t)}function wk(n,e,t){var s=n.stateNode;if(e=e.childContextTypes,typeof s.getChildContext!="function")return t;s=s.getChildContext();for(var i in s)if(!(i in e))throw Error(j(108,iT(n)||"Unknown",i));return it({},t,s)}function Dg(n){return n=(n=n.stateNode)&&n.__reactInternalMemoizedMergedChildContext||ga,Ql=ls.current,$e(ls,n),$e(Rs,Rs.current),!0}function n1(n,e,t){var s=n.stateNode;if(!s)throw Error(j(169));t?(n=wk(n,e,Ql),s.__reactInternalMemoizedMergedChildContext=n,Xe(Rs),Xe(ls),$e(ls,n)):Xe(Rs),$e(Rs,t)}var Zi=null,M0=!1,yv=!1;function Ak(n){Zi===null?Zi=[n]:Zi.push(n)}function w_(n){M0=!0,Ak(n)}function Aa(){if(!yv&&Zi!==null){yv=!0;var n=0,e=Le;try{var t=Zi;for(Le=1;n<t.length;n++){var s=t[n];do s=s(!0);while(s!==null)}Zi=null,M0=!1}catch(i){throw Zi!==null&&(Zi=Zi.slice(n+1)),XA(yb,Aa),i}finally{Le=e,yv=!1}}return null}var Nc=[],Pc=0,Ig=null,Rg=0,Ln=[],Dn=0,Jl=null,Br=1,zr="";function Ca(n,e){Nc[Pc++]=Rg,Nc[Pc++]=Ig,Ig=n,Rg=e}function kk(n,e,t){Ln[Dn++]=Br,Ln[Dn++]=zr,Ln[Dn++]=Jl,Jl=n;var s=Br;n=zr;var i=32-li(s)-1;s&=~(1<<i),t+=1;var r=32-li(e)+i;if(30<r){var a=i-i%5;r=(s&(1<<a)-1).toString(32),s>>=a,i-=a,Br=1<<32-li(e)+i|t<<i|s,zr=r+n}else Br=1<<r|t<<i|s,zr=n}function Tb(n){n.return!==null&&(Ca(n,1),kk(n,1,0))}function _b(n){for(;n===Ig;)Ig=Nc[--Pc],Nc[Pc]=null,Rg=Nc[--Pc],Nc[Pc]=null;for(;n===Jl;)Jl=Ln[--Dn],Ln[Dn]=null,zr=Ln[--Dn],Ln[Dn]=null,Br=Ln[--Dn],Ln[Dn]=null}var dn=null,cn=null,Qe=!1,oi=null;function Sk(n,e){var t=Rn(5,null,null,0);t.elementType="DELETED",t.stateNode=e,t.return=n,e=n.deletions,e===null?(n.deletions=[t],n.flags|=16):e.push(t)}function i1(n,e){switch(n.tag){case 5:var t=n.type;return e=e.nodeType!==1||t.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(n.stateNode=e,dn=n,cn=ua(e.firstChild),!0):!1;case 6:return e=n.pendingProps===""||e.nodeType!==3?null:e,e!==null?(n.stateNode=e,dn=n,cn=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(t=Jl!==null?{id:Br,overflow:zr}:null,n.memoizedState={dehydrated:e,treeContext:t,retryLane:1073741824},t=Rn(18,null,null,0),t.stateNode=e,t.return=n,n.child=t,dn=n,cn=null,!0):!1;default:return!1}}function dy(n){return(n.mode&1)!==0&&(n.flags&128)===0}function hy(n){if(Qe){var e=cn;if(e){var t=e;if(!i1(n,e)){if(dy(n))throw Error(j(418));e=ua(t.nextSibling);var s=dn;e&&i1(n,e)?Sk(s,t):(n.flags=n.flags&-4097|2,Qe=!1,dn=n)}}else{if(dy(n))throw Error(j(418));n.flags=n.flags&-4097|2,Qe=!1,dn=n}}}function r1(n){for(n=n.return;n!==null&&n.tag!==5&&n.tag!==3&&n.tag!==13;)n=n.return;dn=n}function mm(n){if(n!==dn)return!1;if(!Qe)return r1(n),Qe=!0,!1;var e;if((e=n.tag!==3)&&!(e=n.tag!==5)&&(e=n.type,e=e!=="head"&&e!=="body"&&!ay(n.type,n.memoizedProps)),e&&(e=cn)){if(dy(n))throw Ek(),Error(j(418));for(;e;)Sk(n,e),e=ua(e.nextSibling)}if(r1(n),n.tag===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(j(317));e:{for(n=n.nextSibling,e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="/$"){if(e===0){cn=ua(n.nextSibling);break e}e--}else t!=="$"&&t!=="$!"&&t!=="$?"||e++}n=n.nextSibling}cn=null}}else cn=dn?ua(n.stateNode.nextSibling):null;return!0}function Ek(){for(var n=cn;n;)n=ua(n.nextSibling)}function wd(){cn=dn=null,Qe=!1}function Nb(n){oi===null?oi=[n]:oi.push(n)}var A_=Zr.ReactCurrentBatchConfig;function Od(n,e,t){if(n=t.ref,n!==null&&typeof n!="function"&&typeof n!="object"){if(t._owner){if(t=t._owner,t){if(t.tag!==1)throw Error(j(309));var s=t.stateNode}if(!s)throw Error(j(147,n));var i=s,r=""+n;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===r?e.ref:(e=function(a){var l=i.refs;a===null?delete l[r]:l[r]=a},e._stringRef=r,e)}if(typeof n!="string")throw Error(j(284));if(!t._owner)throw Error(j(290,n))}return n}function gm(n,e){throw n=Object.prototype.toString.call(e),Error(j(31,n==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":n))}function o1(n){var e=n._init;return e(n._payload)}function Ck(n){function e(y,k){if(n){var w=y.deletions;w===null?(y.deletions=[k],y.flags|=16):w.push(k)}}function t(y,k){if(!n)return null;for(;k!==null;)e(y,k),k=k.sibling;return null}function s(y,k){for(y=new Map;k!==null;)k.key!==null?y.set(k.key,k):y.set(k.index,k),k=k.sibling;return y}function i(y,k){return y=pa(y,k),y.index=0,y.sibling=null,y}function r(y,k,w){return y.index=w,n?(w=y.alternate,w!==null?(w=w.index,w<k?(y.flags|=2,k):w):(y.flags|=2,k)):(y.flags|=1048576,k)}function a(y){return n&&y.alternate===null&&(y.flags|=2),y}function l(y,k,w,E){return k===null||k.tag!==6?(k=Ev(w,y.mode,E),k.return=y,k):(k=i(k,w),k.return=y,k)}function c(y,k,w,E){var C=w.type;return C===kc?d(y,k,w.props.children,E,w.key):k!==null&&(k.elementType===C||typeof C=="object"&&C!==null&&C.$$typeof===no&&o1(C)===k.type)?(E=i(k,w.props),E.ref=Od(y,k,w),E.return=y,E):(E=Um(w.type,w.key,w.props,null,y.mode,E),E.ref=Od(y,k,w),E.return=y,E)}function u(y,k,w,E){return k===null||k.tag!==4||k.stateNode.containerInfo!==w.containerInfo||k.stateNode.implementation!==w.implementation?(k=Cv(w,y.mode,E),k.return=y,k):(k=i(k,w.children||[]),k.return=y,k)}function d(y,k,w,E,C){return k===null||k.tag!==7?(k=Kl(w,y.mode,E,C),k.return=y,k):(k=i(k,w),k.return=y,k)}function h(y,k,w){if(typeof k=="string"&&k!==""||typeof k=="number")return k=Ev(""+k,y.mode,w),k.return=y,k;if(typeof k=="object"&&k!==null){switch(k.$$typeof){case rm:return w=Um(k.type,k.key,k.props,null,y.mode,w),w.ref=Od(y,null,k),w.return=y,w;case Ac:return k=Cv(k,y.mode,w),k.return=y,k;case no:var E=k._init;return h(y,E(k._payload),w)}if(Xd(k)||Dd(k))return k=Kl(k,y.mode,w,null),k.return=y,k;gm(y,k)}return null}function f(y,k,w,E){var C=k!==null?k.key:null;if(typeof w=="string"&&w!==""||typeof w=="number")return C!==null?null:l(y,k,""+w,E);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case rm:return w.key===C?c(y,k,w,E):null;case Ac:return w.key===C?u(y,k,w,E):null;case no:return C=w._init,f(y,k,C(w._payload),E)}if(Xd(w)||Dd(w))return C!==null?null:d(y,k,w,E,null);gm(y,w)}return null}function p(y,k,w,E,C){if(typeof E=="string"&&E!==""||typeof E=="number")return y=y.get(w)||null,l(k,y,""+E,C);if(typeof E=="object"&&E!==null){switch(E.$$typeof){case rm:return y=y.get(E.key===null?w:E.key)||null,c(k,y,E,C);case Ac:return y=y.get(E.key===null?w:E.key)||null,u(k,y,E,C);case no:var T=E._init;return p(y,k,w,T(E._payload),C)}if(Xd(E)||Dd(E))return y=y.get(w)||null,d(k,y,E,C,null);gm(k,E)}return null}function v(y,k,w,E){for(var C=null,T=null,_=k,P=k=0,D=null;_!==null&&P<w.length;P++){_.index>P?(D=_,_=null):D=_.sibling;var I=f(y,_,w[P],E);if(I===null){_===null&&(_=D);break}n&&_&&I.alternate===null&&e(y,_),k=r(I,k,P),T===null?C=I:T.sibling=I,T=I,_=D}if(P===w.length)return t(y,_),Qe&&Ca(y,P),C;if(_===null){for(;P<w.length;P++)_=h(y,w[P],E),_!==null&&(k=r(_,k,P),T===null?C=_:T.sibling=_,T=_);return Qe&&Ca(y,P),C}for(_=s(y,_);P<w.length;P++)D=p(_,y,P,w[P],E),D!==null&&(n&&D.alternate!==null&&_.delete(D.key===null?P:D.key),k=r(D,k,P),T===null?C=D:T.sibling=D,T=D);return n&&_.forEach(function(F){return e(y,F)}),Qe&&Ca(y,P),C}function b(y,k,w,E){var C=Dd(w);if(typeof C!="function")throw Error(j(150));if(w=C.call(w),w==null)throw Error(j(151));for(var T=C=null,_=k,P=k=0,D=null,I=w.next();_!==null&&!I.done;P++,I=w.next()){_.index>P?(D=_,_=null):D=_.sibling;var F=f(y,_,I.value,E);if(F===null){_===null&&(_=D);break}n&&_&&F.alternate===null&&e(y,_),k=r(F,k,P),T===null?C=F:T.sibling=F,T=F,_=D}if(I.done)return t(y,_),Qe&&Ca(y,P),C;if(_===null){for(;!I.done;P++,I=w.next())I=h(y,I.value,E),I!==null&&(k=r(I,k,P),T===null?C=I:T.sibling=I,T=I);return Qe&&Ca(y,P),C}for(_=s(y,_);!I.done;P++,I=w.next())I=p(_,y,P,I.value,E),I!==null&&(n&&I.alternate!==null&&_.delete(I.key===null?P:I.key),k=r(I,k,P),T===null?C=I:T.sibling=I,T=I);return n&&_.forEach(function(K){return e(y,K)}),Qe&&Ca(y,P),C}function S(y,k,w,E){if(typeof w=="object"&&w!==null&&w.type===kc&&w.key===null&&(w=w.props.children),typeof w=="object"&&w!==null){switch(w.$$typeof){case rm:e:{for(var C=w.key,T=k;T!==null;){if(T.key===C){if(C=w.type,C===kc){if(T.tag===7){t(y,T.sibling),k=i(T,w.props.children),k.return=y,y=k;break e}}else if(T.elementType===C||typeof C=="object"&&C!==null&&C.$$typeof===no&&o1(C)===T.type){t(y,T.sibling),k=i(T,w.props),k.ref=Od(y,T,w),k.return=y,y=k;break e}t(y,T);break}else e(y,T);T=T.sibling}w.type===kc?(k=Kl(w.props.children,y.mode,E,w.key),k.return=y,y=k):(E=Um(w.type,w.key,w.props,null,y.mode,E),E.ref=Od(y,k,w),E.return=y,y=E)}return a(y);case Ac:e:{for(T=w.key;k!==null;){if(k.key===T)if(k.tag===4&&k.stateNode.containerInfo===w.containerInfo&&k.stateNode.implementation===w.implementation){t(y,k.sibling),k=i(k,w.children||[]),k.return=y,y=k;break e}else{t(y,k);break}else e(y,k);k=k.sibling}k=Cv(w,y.mode,E),k.return=y,y=k}return a(y);case no:return T=w._init,S(y,k,T(w._payload),E)}if(Xd(w))return v(y,k,w,E);if(Dd(w))return b(y,k,w,E);gm(y,w)}return typeof w=="string"&&w!==""||typeof w=="number"?(w=""+w,k!==null&&k.tag===6?(t(y,k.sibling),k=i(k,w),k.return=y,y=k):(t(y,k),k=Ev(w,y.mode,E),k.return=y,y=k),a(y)):t(y,k)}return S}var Ad=Ck(!0),Tk=Ck(!1),Fg=wa(null),jg=null,Mc=null,Pb=null;function Mb(){Pb=Mc=jg=null}function Lb(n){var e=Fg.current;Xe(Fg),n._currentValue=e}function fy(n,e,t){for(;n!==null;){var s=n.alternate;if((n.childLanes&e)!==e?(n.childLanes|=e,s!==null&&(s.childLanes|=e)):s!==null&&(s.childLanes&e)!==e&&(s.childLanes|=e),n===t)break;n=n.return}}function Vc(n,e){jg=n,Pb=Mc=null,n=n.dependencies,n!==null&&n.firstContext!==null&&(n.lanes&e&&(Is=!0),n.firstContext=null)}function On(n){var e=n._currentValue;if(Pb!==n)if(n={context:n,memoizedValue:e,next:null},Mc===null){if(jg===null)throw Error(j(308));Mc=n,jg.dependencies={lanes:0,firstContext:n}}else Mc=Mc.next=n;return e}var Ra=null;function Db(n){Ra===null?Ra=[n]:Ra.push(n)}function _k(n,e,t,s){var i=e.interleaved;return i===null?(t.next=t,Db(e)):(t.next=i.next,i.next=t),e.interleaved=t,Yr(n,s)}function Yr(n,e){n.lanes|=e;var t=n.alternate;for(t!==null&&(t.lanes|=e),t=n,n=n.return;n!==null;)n.childLanes|=e,t=n.alternate,t!==null&&(t.childLanes|=e),t=n,n=n.return;return t.tag===3?t.stateNode:null}var io=!1;function Ib(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Nk(n,e){n=n.updateQueue,e.updateQueue===n&&(e.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,effects:n.effects})}function Ur(n,e){return{eventTime:n,lane:e,tag:0,payload:null,callback:null,next:null}}function da(n,e,t){var s=n.updateQueue;if(s===null)return null;if(s=s.shared,xe&2){var i=s.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),s.pending=e,Yr(n,t)}return i=s.interleaved,i===null?(e.next=e,Db(s)):(e.next=i.next,i.next=e),s.interleaved=e,Yr(n,t)}function Rm(n,e,t){if(e=e.updateQueue,e!==null&&(e=e.shared,(t&4194240)!==0)){var s=e.lanes;s&=n.pendingLanes,t|=s,e.lanes=t,xb(n,t)}}function a1(n,e){var t=n.updateQueue,s=n.alternate;if(s!==null&&(s=s.updateQueue,t===s)){var i=null,r=null;if(t=t.firstBaseUpdate,t!==null){do{var a={eventTime:t.eventTime,lane:t.lane,tag:t.tag,payload:t.payload,callback:t.callback,next:null};r===null?i=r=a:r=r.next=a,t=t.next}while(t!==null);r===null?i=r=e:r=r.next=e}else i=r=e;t={baseState:s.baseState,firstBaseUpdate:i,lastBaseUpdate:r,shared:s.shared,effects:s.effects},n.updateQueue=t;return}n=t.lastBaseUpdate,n===null?t.firstBaseUpdate=e:n.next=e,t.lastBaseUpdate=e}function Og(n,e,t,s){var i=n.updateQueue;io=!1;var r=i.firstBaseUpdate,a=i.lastBaseUpdate,l=i.shared.pending;if(l!==null){i.shared.pending=null;var c=l,u=c.next;c.next=null,a===null?r=u:a.next=u,a=c;var d=n.alternate;d!==null&&(d=d.updateQueue,l=d.lastBaseUpdate,l!==a&&(l===null?d.firstBaseUpdate=u:l.next=u,d.lastBaseUpdate=c))}if(r!==null){var h=i.baseState;a=0,d=u=c=null,l=r;do{var f=l.lane,p=l.eventTime;if((s&f)===f){d!==null&&(d=d.next={eventTime:p,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var v=n,b=l;switch(f=e,p=t,b.tag){case 1:if(v=b.payload,typeof v=="function"){h=v.call(p,h,f);break e}h=v;break e;case 3:v.flags=v.flags&-65537|128;case 0:if(v=b.payload,f=typeof v=="function"?v.call(p,h,f):v,f==null)break e;h=it({},h,f);break e;case 2:io=!0}}l.callback!==null&&l.lane!==0&&(n.flags|=64,f=i.effects,f===null?i.effects=[l]:f.push(l))}else p={eventTime:p,lane:f,tag:l.tag,payload:l.payload,callback:l.callback,next:null},d===null?(u=d=p,c=h):d=d.next=p,a|=f;if(l=l.next,l===null){if(l=i.shared.pending,l===null)break;f=l,l=f.next,f.next=null,i.lastBaseUpdate=f,i.shared.pending=null}}while(!0);if(d===null&&(c=h),i.baseState=c,i.firstBaseUpdate=u,i.lastBaseUpdate=d,e=i.shared.interleaved,e!==null){i=e;do a|=i.lane,i=i.next;while(i!==e)}else r===null&&(i.shared.lanes=0);ec|=a,n.lanes=a,n.memoizedState=h}}function l1(n,e,t){if(n=e.effects,e.effects=null,n!==null)for(e=0;e<n.length;e++){var s=n[e],i=s.callback;if(i!==null){if(s.callback=null,s=t,typeof i!="function")throw Error(j(191,i));i.call(s)}}}var Kp={},Hi=wa(Kp),Oh=wa(Kp),Bh=wa(Kp);function Fa(n){if(n===Kp)throw Error(j(174));return n}function Rb(n,e){switch($e(Bh,e),$e(Oh,n),$e(Hi,Kp),n=e.nodeType,n){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Xv(null,"");break;default:n=n===8?e.parentNode:e,e=n.namespaceURI||null,n=n.tagName,e=Xv(e,n)}Xe(Hi),$e(Hi,e)}function kd(){Xe(Hi),Xe(Oh),Xe(Bh)}function Pk(n){Fa(Bh.current);var e=Fa(Hi.current),t=Xv(e,n.type);e!==t&&($e(Oh,n),$e(Hi,t))}function Fb(n){Oh.current===n&&(Xe(Hi),Xe(Oh))}var tt=wa(0);function Bg(n){for(var e=n;e!==null;){if(e.tag===13){var t=e.memoizedState;if(t!==null&&(t=t.dehydrated,t===null||t.data==="$?"||t.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var xv=[];function jb(){for(var n=0;n<xv.length;n++)xv[n]._workInProgressVersionPrimary=null;xv.length=0}var Fm=Zr.ReactCurrentDispatcher,bv=Zr.ReactCurrentBatchConfig,Zl=0,st=null,Ct=null,jt=null,zg=!1,Ah=!1,zh=0,k_=0;function Jt(){throw Error(j(321))}function Ob(n,e){if(e===null)return!1;for(var t=0;t<e.length&&t<n.length;t++)if(!ui(n[t],e[t]))return!1;return!0}function Bb(n,e,t,s,i,r){if(Zl=r,st=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Fm.current=n===null||n.memoizedState===null?T_:__,n=t(s,i),Ah){r=0;do{if(Ah=!1,zh=0,25<=r)throw Error(j(301));r+=1,jt=Ct=null,e.updateQueue=null,Fm.current=N_,n=t(s,i)}while(Ah)}if(Fm.current=Ug,e=Ct!==null&&Ct.next!==null,Zl=0,jt=Ct=st=null,zg=!1,e)throw Error(j(300));return n}function zb(){var n=zh!==0;return zh=0,n}function gi(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return jt===null?st.memoizedState=jt=n:jt=jt.next=n,jt}function Bn(){if(Ct===null){var n=st.alternate;n=n!==null?n.memoizedState:null}else n=Ct.next;var e=jt===null?st.memoizedState:jt.next;if(e!==null)jt=e,Ct=n;else{if(n===null)throw Error(j(310));Ct=n,n={memoizedState:Ct.memoizedState,baseState:Ct.baseState,baseQueue:Ct.baseQueue,queue:Ct.queue,next:null},jt===null?st.memoizedState=jt=n:jt=jt.next=n}return jt}function Uh(n,e){return typeof e=="function"?e(n):e}function wv(n){var e=Bn(),t=e.queue;if(t===null)throw Error(j(311));t.lastRenderedReducer=n;var s=Ct,i=s.baseQueue,r=t.pending;if(r!==null){if(i!==null){var a=i.next;i.next=r.next,r.next=a}s.baseQueue=i=r,t.pending=null}if(i!==null){r=i.next,s=s.baseState;var l=a=null,c=null,u=r;do{var d=u.lane;if((Zl&d)===d)c!==null&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),s=u.hasEagerState?u.eagerState:n(s,u.action);else{var h={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};c===null?(l=c=h,a=s):c=c.next=h,st.lanes|=d,ec|=d}u=u.next}while(u!==null&&u!==r);c===null?a=s:c.next=l,ui(s,e.memoizedState)||(Is=!0),e.memoizedState=s,e.baseState=a,e.baseQueue=c,t.lastRenderedState=s}if(n=t.interleaved,n!==null){i=n;do r=i.lane,st.lanes|=r,ec|=r,i=i.next;while(i!==n)}else i===null&&(t.lanes=0);return[e.memoizedState,t.dispatch]}function Av(n){var e=Bn(),t=e.queue;if(t===null)throw Error(j(311));t.lastRenderedReducer=n;var s=t.dispatch,i=t.pending,r=e.memoizedState;if(i!==null){t.pending=null;var a=i=i.next;do r=n(r,a.action),a=a.next;while(a!==i);ui(r,e.memoizedState)||(Is=!0),e.memoizedState=r,e.baseQueue===null&&(e.baseState=r),t.lastRenderedState=r}return[r,s]}function Mk(){}function Lk(n,e){var t=st,s=Bn(),i=e(),r=!ui(s.memoizedState,i);if(r&&(s.memoizedState=i,Is=!0),s=s.queue,Ub(Rk.bind(null,t,s,n),[n]),s.getSnapshot!==e||r||jt!==null&&jt.memoizedState.tag&1){if(t.flags|=2048,Hh(9,Ik.bind(null,t,s,i,e),void 0,null),Ot===null)throw Error(j(349));Zl&30||Dk(t,e,i)}return i}function Dk(n,e,t){n.flags|=16384,n={getSnapshot:e,value:t},e=st.updateQueue,e===null?(e={lastEffect:null,stores:null},st.updateQueue=e,e.stores=[n]):(t=e.stores,t===null?e.stores=[n]:t.push(n))}function Ik(n,e,t,s){e.value=t,e.getSnapshot=s,Fk(e)&&jk(n)}function Rk(n,e,t){return t(function(){Fk(e)&&jk(n)})}function Fk(n){var e=n.getSnapshot;n=n.value;try{var t=e();return!ui(n,t)}catch{return!0}}function jk(n){var e=Yr(n,1);e!==null&&ci(e,n,1,-1)}function c1(n){var e=gi();return typeof n=="function"&&(n=n()),e.memoizedState=e.baseState=n,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Uh,lastRenderedState:n},e.queue=n,n=n.dispatch=C_.bind(null,st,n),[e.memoizedState,n]}function Hh(n,e,t,s){return n={tag:n,create:e,destroy:t,deps:s,next:null},e=st.updateQueue,e===null?(e={lastEffect:null,stores:null},st.updateQueue=e,e.lastEffect=n.next=n):(t=e.lastEffect,t===null?e.lastEffect=n.next=n:(s=t.next,t.next=n,n.next=s,e.lastEffect=n)),n}function Ok(){return Bn().memoizedState}function jm(n,e,t,s){var i=gi();st.flags|=n,i.memoizedState=Hh(1|e,t,void 0,s===void 0?null:s)}function L0(n,e,t,s){var i=Bn();s=s===void 0?null:s;var r=void 0;if(Ct!==null){var a=Ct.memoizedState;if(r=a.destroy,s!==null&&Ob(s,a.deps)){i.memoizedState=Hh(e,t,r,s);return}}st.flags|=n,i.memoizedState=Hh(1|e,t,r,s)}function u1(n,e){return jm(8390656,8,n,e)}function Ub(n,e){return L0(2048,8,n,e)}function Bk(n,e){return L0(4,2,n,e)}function zk(n,e){return L0(4,4,n,e)}function Uk(n,e){if(typeof e=="function")return n=n(),e(n),function(){e(null)};if(e!=null)return n=n(),e.current=n,function(){e.current=null}}function Hk(n,e,t){return t=t!=null?t.concat([n]):null,L0(4,4,Uk.bind(null,e,n),t)}function Hb(){}function $k(n,e){var t=Bn();e=e===void 0?null:e;var s=t.memoizedState;return s!==null&&e!==null&&Ob(e,s[1])?s[0]:(t.memoizedState=[n,e],n)}function Vk(n,e){var t=Bn();e=e===void 0?null:e;var s=t.memoizedState;return s!==null&&e!==null&&Ob(e,s[1])?s[0]:(n=n(),t.memoizedState=[n,e],n)}function Wk(n,e,t){return Zl&21?(ui(t,e)||(t=KA(),st.lanes|=t,ec|=t,n.baseState=!0),e):(n.baseState&&(n.baseState=!1,Is=!0),n.memoizedState=t)}function S_(n,e){var t=Le;Le=t!==0&&4>t?t:4,n(!0);var s=bv.transition;bv.transition={};try{n(!1),e()}finally{Le=t,bv.transition=s}}function Gk(){return Bn().memoizedState}function E_(n,e,t){var s=fa(n);if(t={lane:s,action:t,hasEagerState:!1,eagerState:null,next:null},Xk(n))Yk(e,t);else if(t=_k(n,e,t,s),t!==null){var i=vs();ci(t,n,s,i),qk(t,e,s)}}function C_(n,e,t){var s=fa(n),i={lane:s,action:t,hasEagerState:!1,eagerState:null,next:null};if(Xk(n))Yk(e,i);else{var r=n.alternate;if(n.lanes===0&&(r===null||r.lanes===0)&&(r=e.lastRenderedReducer,r!==null))try{var a=e.lastRenderedState,l=r(a,t);if(i.hasEagerState=!0,i.eagerState=l,ui(l,a)){var c=e.interleaved;c===null?(i.next=i,Db(e)):(i.next=c.next,c.next=i),e.interleaved=i;return}}catch{}finally{}t=_k(n,e,i,s),t!==null&&(i=vs(),ci(t,n,s,i),qk(t,e,s))}}function Xk(n){var e=n.alternate;return n===st||e!==null&&e===st}function Yk(n,e){Ah=zg=!0;var t=n.pending;t===null?e.next=e:(e.next=t.next,t.next=e),n.pending=e}function qk(n,e,t){if(t&4194240){var s=e.lanes;s&=n.pendingLanes,t|=s,e.lanes=t,xb(n,t)}}var Ug={readContext:On,useCallback:Jt,useContext:Jt,useEffect:Jt,useImperativeHandle:Jt,useInsertionEffect:Jt,useLayoutEffect:Jt,useMemo:Jt,useReducer:Jt,useRef:Jt,useState:Jt,useDebugValue:Jt,useDeferredValue:Jt,useTransition:Jt,useMutableSource:Jt,useSyncExternalStore:Jt,useId:Jt,unstable_isNewReconciler:!1},T_={readContext:On,useCallback:function(n,e){return gi().memoizedState=[n,e===void 0?null:e],n},useContext:On,useEffect:u1,useImperativeHandle:function(n,e,t){return t=t!=null?t.concat([n]):null,jm(4194308,4,Uk.bind(null,e,n),t)},useLayoutEffect:function(n,e){return jm(4194308,4,n,e)},useInsertionEffect:function(n,e){return jm(4,2,n,e)},useMemo:function(n,e){var t=gi();return e=e===void 0?null:e,n=n(),t.memoizedState=[n,e],n},useReducer:function(n,e,t){var s=gi();return e=t!==void 0?t(e):e,s.memoizedState=s.baseState=e,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:e},s.queue=n,n=n.dispatch=E_.bind(null,st,n),[s.memoizedState,n]},useRef:function(n){var e=gi();return n={current:n},e.memoizedState=n},useState:c1,useDebugValue:Hb,useDeferredValue:function(n){return gi().memoizedState=n},useTransition:function(){var n=c1(!1),e=n[0];return n=S_.bind(null,n[1]),gi().memoizedState=n,[e,n]},useMutableSource:function(){},useSyncExternalStore:function(n,e,t){var s=st,i=gi();if(Qe){if(t===void 0)throw Error(j(407));t=t()}else{if(t=e(),Ot===null)throw Error(j(349));Zl&30||Dk(s,e,t)}i.memoizedState=t;var r={value:t,getSnapshot:e};return i.queue=r,u1(Rk.bind(null,s,r,n),[n]),s.flags|=2048,Hh(9,Ik.bind(null,s,r,t,e),void 0,null),t},useId:function(){var n=gi(),e=Ot.identifierPrefix;if(Qe){var t=zr,s=Br;t=(s&~(1<<32-li(s)-1)).toString(32)+t,e=":"+e+"R"+t,t=zh++,0<t&&(e+="H"+t.toString(32)),e+=":"}else t=k_++,e=":"+e+"r"+t.toString(32)+":";return n.memoizedState=e},unstable_isNewReconciler:!1},__={readContext:On,useCallback:$k,useContext:On,useEffect:Ub,useImperativeHandle:Hk,useInsertionEffect:Bk,useLayoutEffect:zk,useMemo:Vk,useReducer:wv,useRef:Ok,useState:function(){return wv(Uh)},useDebugValue:Hb,useDeferredValue:function(n){var e=Bn();return Wk(e,Ct.memoizedState,n)},useTransition:function(){var n=wv(Uh)[0],e=Bn().memoizedState;return[n,e]},useMutableSource:Mk,useSyncExternalStore:Lk,useId:Gk,unstable_isNewReconciler:!1},N_={readContext:On,useCallback:$k,useContext:On,useEffect:Ub,useImperativeHandle:Hk,useInsertionEffect:Bk,useLayoutEffect:zk,useMemo:Vk,useReducer:Av,useRef:Ok,useState:function(){return Av(Uh)},useDebugValue:Hb,useDeferredValue:function(n){var e=Bn();return Ct===null?e.memoizedState=n:Wk(e,Ct.memoizedState,n)},useTransition:function(){var n=Av(Uh)[0],e=Bn().memoizedState;return[n,e]},useMutableSource:Mk,useSyncExternalStore:Lk,useId:Gk,unstable_isNewReconciler:!1};function Gn(n,e){if(n&&n.defaultProps){e=it({},e),n=n.defaultProps;for(var t in n)e[t]===void 0&&(e[t]=n[t]);return e}return e}function py(n,e,t,s){e=n.memoizedState,t=t(s,e),t=t==null?e:it({},e,t),n.memoizedState=t,n.lanes===0&&(n.updateQueue.baseState=t)}var D0={isMounted:function(n){return(n=n._reactInternals)?oc(n)===n:!1},enqueueSetState:function(n,e,t){n=n._reactInternals;var s=vs(),i=fa(n),r=Ur(s,i);r.payload=e,t!=null&&(r.callback=t),e=da(n,r,i),e!==null&&(ci(e,n,i,s),Rm(e,n,i))},enqueueReplaceState:function(n,e,t){n=n._reactInternals;var s=vs(),i=fa(n),r=Ur(s,i);r.tag=1,r.payload=e,t!=null&&(r.callback=t),e=da(n,r,i),e!==null&&(ci(e,n,i,s),Rm(e,n,i))},enqueueForceUpdate:function(n,e){n=n._reactInternals;var t=vs(),s=fa(n),i=Ur(t,s);i.tag=2,e!=null&&(i.callback=e),e=da(n,i,s),e!==null&&(ci(e,n,s,t),Rm(e,n,s))}};function d1(n,e,t,s,i,r,a){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(s,r,a):e.prototype&&e.prototype.isPureReactComponent?!Ih(t,s)||!Ih(i,r):!0}function Kk(n,e,t){var s=!1,i=ga,r=e.contextType;return typeof r=="object"&&r!==null?r=On(r):(i=Fs(e)?Ql:ls.current,s=e.contextTypes,r=(s=s!=null)?bd(n,i):ga),e=new e(t,r),n.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=D0,n.stateNode=e,e._reactInternals=n,s&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=i,n.__reactInternalMemoizedMaskedChildContext=r),e}function h1(n,e,t,s){n=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(t,s),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(t,s),e.state!==n&&D0.enqueueReplaceState(e,e.state,null)}function my(n,e,t,s){var i=n.stateNode;i.props=t,i.state=n.memoizedState,i.refs={},Ib(n);var r=e.contextType;typeof r=="object"&&r!==null?i.context=On(r):(r=Fs(e)?Ql:ls.current,i.context=bd(n,r)),i.state=n.memoizedState,r=e.getDerivedStateFromProps,typeof r=="function"&&(py(n,e,r,t),i.state=n.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&D0.enqueueReplaceState(i,i.state,null),Og(n,t,i,s),i.state=n.memoizedState),typeof i.componentDidMount=="function"&&(n.flags|=4194308)}function Sd(n,e){try{var t="",s=e;do t+=nT(s),s=s.return;while(s);var i=t}catch(r){i=`
Error generating stack: `+r.message+`
`+r.stack}return{value:n,source:e,stack:i,digest:null}}function kv(n,e,t){return{value:n,source:null,stack:t??null,digest:e??null}}function gy(n,e){try{console.error(e.value)}catch(t){setTimeout(function(){throw t})}}var P_=typeof WeakMap=="function"?WeakMap:Map;function Qk(n,e,t){t=Ur(-1,t),t.tag=3,t.payload={element:null};var s=e.value;return t.callback=function(){$g||($g=!0,Cy=s),gy(n,e)},t}function Jk(n,e,t){t=Ur(-1,t),t.tag=3;var s=n.type.getDerivedStateFromError;if(typeof s=="function"){var i=e.value;t.payload=function(){return s(i)},t.callback=function(){gy(n,e)}}var r=n.stateNode;return r!==null&&typeof r.componentDidCatch=="function"&&(t.callback=function(){gy(n,e),typeof s!="function"&&(ha===null?ha=new Set([this]):ha.add(this));var a=e.stack;this.componentDidCatch(e.value,{componentStack:a!==null?a:""})}),t}function f1(n,e,t){var s=n.pingCache;if(s===null){s=n.pingCache=new P_;var i=new Set;s.set(e,i)}else i=s.get(e),i===void 0&&(i=new Set,s.set(e,i));i.has(t)||(i.add(t),n=V_.bind(null,n,e,t),e.then(n,n))}function p1(n){do{var e;if((e=n.tag===13)&&(e=n.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return n;n=n.return}while(n!==null);return null}function m1(n,e,t,s,i){return n.mode&1?(n.flags|=65536,n.lanes=i,n):(n===e?n.flags|=65536:(n.flags|=128,t.flags|=131072,t.flags&=-52805,t.tag===1&&(t.alternate===null?t.tag=17:(e=Ur(-1,1),e.tag=2,da(t,e,1))),t.lanes|=1),n)}var M_=Zr.ReactCurrentOwner,Is=!1;function ms(n,e,t,s){e.child=n===null?Tk(e,null,t,s):Ad(e,n.child,t,s)}function g1(n,e,t,s,i){t=t.render;var r=e.ref;return Vc(e,i),s=Bb(n,e,t,s,r,i),t=zb(),n!==null&&!Is?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~i,qr(n,e,i)):(Qe&&t&&Tb(e),e.flags|=1,ms(n,e,s,i),e.child)}function v1(n,e,t,s,i){if(n===null){var r=t.type;return typeof r=="function"&&!Kb(r)&&r.defaultProps===void 0&&t.compare===null&&t.defaultProps===void 0?(e.tag=15,e.type=r,Zk(n,e,r,s,i)):(n=Um(t.type,null,s,e,e.mode,i),n.ref=e.ref,n.return=e,e.child=n)}if(r=n.child,!(n.lanes&i)){var a=r.memoizedProps;if(t=t.compare,t=t!==null?t:Ih,t(a,s)&&n.ref===e.ref)return qr(n,e,i)}return e.flags|=1,n=pa(r,s),n.ref=e.ref,n.return=e,e.child=n}function Zk(n,e,t,s,i){if(n!==null){var r=n.memoizedProps;if(Ih(r,s)&&n.ref===e.ref)if(Is=!1,e.pendingProps=s=r,(n.lanes&i)!==0)n.flags&131072&&(Is=!0);else return e.lanes=n.lanes,qr(n,e,i)}return vy(n,e,t,s,i)}function eS(n,e,t){var s=e.pendingProps,i=s.children,r=n!==null?n.memoizedState:null;if(s.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},$e(Dc,on),on|=t;else{if(!(t&1073741824))return n=r!==null?r.baseLanes|t:t,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:n,cachePool:null,transitions:null},e.updateQueue=null,$e(Dc,on),on|=n,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},s=r!==null?r.baseLanes:t,$e(Dc,on),on|=s}else r!==null?(s=r.baseLanes|t,e.memoizedState=null):s=t,$e(Dc,on),on|=s;return ms(n,e,i,t),e.child}function tS(n,e){var t=e.ref;(n===null&&t!==null||n!==null&&n.ref!==t)&&(e.flags|=512,e.flags|=2097152)}function vy(n,e,t,s,i){var r=Fs(t)?Ql:ls.current;return r=bd(e,r),Vc(e,i),t=Bb(n,e,t,s,r,i),s=zb(),n!==null&&!Is?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~i,qr(n,e,i)):(Qe&&s&&Tb(e),e.flags|=1,ms(n,e,t,i),e.child)}function y1(n,e,t,s,i){if(Fs(t)){var r=!0;Dg(e)}else r=!1;if(Vc(e,i),e.stateNode===null)Om(n,e),Kk(e,t,s),my(e,t,s,i),s=!0;else if(n===null){var a=e.stateNode,l=e.memoizedProps;a.props=l;var c=a.context,u=t.contextType;typeof u=="object"&&u!==null?u=On(u):(u=Fs(t)?Ql:ls.current,u=bd(e,u));var d=t.getDerivedStateFromProps,h=typeof d=="function"||typeof a.getSnapshotBeforeUpdate=="function";h||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(l!==s||c!==u)&&h1(e,a,s,u),io=!1;var f=e.memoizedState;a.state=f,Og(e,s,a,i),c=e.memoizedState,l!==s||f!==c||Rs.current||io?(typeof d=="function"&&(py(e,t,d,s),c=e.memoizedState),(l=io||d1(e,t,l,s,f,c,u))?(h||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(e.flags|=4194308)):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=s,e.memoizedState=c),a.props=s,a.state=c,a.context=u,s=l):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),s=!1)}else{a=e.stateNode,Nk(n,e),l=e.memoizedProps,u=e.type===e.elementType?l:Gn(e.type,l),a.props=u,h=e.pendingProps,f=a.context,c=t.contextType,typeof c=="object"&&c!==null?c=On(c):(c=Fs(t)?Ql:ls.current,c=bd(e,c));var p=t.getDerivedStateFromProps;(d=typeof p=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(l!==h||f!==c)&&h1(e,a,s,c),io=!1,f=e.memoizedState,a.state=f,Og(e,s,a,i);var v=e.memoizedState;l!==h||f!==v||Rs.current||io?(typeof p=="function"&&(py(e,t,p,s),v=e.memoizedState),(u=io||d1(e,t,u,s,f,v,c)||!1)?(d||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(s,v,c),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(s,v,c)),typeof a.componentDidUpdate=="function"&&(e.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof a.componentDidUpdate!="function"||l===n.memoizedProps&&f===n.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||l===n.memoizedProps&&f===n.memoizedState||(e.flags|=1024),e.memoizedProps=s,e.memoizedState=v),a.props=s,a.state=v,a.context=c,s=u):(typeof a.componentDidUpdate!="function"||l===n.memoizedProps&&f===n.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||l===n.memoizedProps&&f===n.memoizedState||(e.flags|=1024),s=!1)}return yy(n,e,t,s,r,i)}function yy(n,e,t,s,i,r){tS(n,e);var a=(e.flags&128)!==0;if(!s&&!a)return i&&n1(e,t,!1),qr(n,e,r);s=e.stateNode,M_.current=e;var l=a&&typeof t.getDerivedStateFromError!="function"?null:s.render();return e.flags|=1,n!==null&&a?(e.child=Ad(e,n.child,null,r),e.child=Ad(e,null,l,r)):ms(n,e,l,r),e.memoizedState=s.state,i&&n1(e,t,!0),e.child}function sS(n){var e=n.stateNode;e.pendingContext?s1(n,e.pendingContext,e.pendingContext!==e.context):e.context&&s1(n,e.context,!1),Rb(n,e.containerInfo)}function x1(n,e,t,s,i){return wd(),Nb(i),e.flags|=256,ms(n,e,t,s),e.child}var xy={dehydrated:null,treeContext:null,retryLane:0};function by(n){return{baseLanes:n,cachePool:null,transitions:null}}function nS(n,e,t){var s=e.pendingProps,i=tt.current,r=!1,a=(e.flags&128)!==0,l;if((l=a)||(l=n!==null&&n.memoizedState===null?!1:(i&2)!==0),l?(r=!0,e.flags&=-129):(n===null||n.memoizedState!==null)&&(i|=1),$e(tt,i&1),n===null)return hy(e),n=e.memoizedState,n!==null&&(n=n.dehydrated,n!==null)?(e.mode&1?n.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(a=s.children,n=s.fallback,r?(s=e.mode,r=e.child,a={mode:"hidden",children:a},!(s&1)&&r!==null?(r.childLanes=0,r.pendingProps=a):r=F0(a,s,0,null),n=Kl(n,s,t,null),r.return=e,n.return=e,r.sibling=n,e.child=r,e.child.memoizedState=by(t),e.memoizedState=xy,n):$b(e,a));if(i=n.memoizedState,i!==null&&(l=i.dehydrated,l!==null))return L_(n,e,a,s,l,i,t);if(r){r=s.fallback,a=e.mode,i=n.child,l=i.sibling;var c={mode:"hidden",children:s.children};return!(a&1)&&e.child!==i?(s=e.child,s.childLanes=0,s.pendingProps=c,e.deletions=null):(s=pa(i,c),s.subtreeFlags=i.subtreeFlags&14680064),l!==null?r=pa(l,r):(r=Kl(r,a,t,null),r.flags|=2),r.return=e,s.return=e,s.sibling=r,e.child=s,s=r,r=e.child,a=n.child.memoizedState,a=a===null?by(t):{baseLanes:a.baseLanes|t,cachePool:null,transitions:a.transitions},r.memoizedState=a,r.childLanes=n.childLanes&~t,e.memoizedState=xy,s}return r=n.child,n=r.sibling,s=pa(r,{mode:"visible",children:s.children}),!(e.mode&1)&&(s.lanes=t),s.return=e,s.sibling=null,n!==null&&(t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)),e.child=s,e.memoizedState=null,s}function $b(n,e){return e=F0({mode:"visible",children:e},n.mode,0,null),e.return=n,n.child=e}function vm(n,e,t,s){return s!==null&&Nb(s),Ad(e,n.child,null,t),n=$b(e,e.pendingProps.children),n.flags|=2,e.memoizedState=null,n}function L_(n,e,t,s,i,r,a){if(t)return e.flags&256?(e.flags&=-257,s=kv(Error(j(422))),vm(n,e,a,s)):e.memoizedState!==null?(e.child=n.child,e.flags|=128,null):(r=s.fallback,i=e.mode,s=F0({mode:"visible",children:s.children},i,0,null),r=Kl(r,i,a,null),r.flags|=2,s.return=e,r.return=e,s.sibling=r,e.child=s,e.mode&1&&Ad(e,n.child,null,a),e.child.memoizedState=by(a),e.memoizedState=xy,r);if(!(e.mode&1))return vm(n,e,a,null);if(i.data==="$!"){if(s=i.nextSibling&&i.nextSibling.dataset,s)var l=s.dgst;return s=l,r=Error(j(419)),s=kv(r,s,void 0),vm(n,e,a,s)}if(l=(a&n.childLanes)!==0,Is||l){if(s=Ot,s!==null){switch(a&-a){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(s.suspendedLanes|a)?0:i,i!==0&&i!==r.retryLane&&(r.retryLane=i,Yr(n,i),ci(s,n,i,-1))}return qb(),s=kv(Error(j(421))),vm(n,e,a,s)}return i.data==="$?"?(e.flags|=128,e.child=n.child,e=W_.bind(null,n),i._reactRetry=e,null):(n=r.treeContext,cn=ua(i.nextSibling),dn=e,Qe=!0,oi=null,n!==null&&(Ln[Dn++]=Br,Ln[Dn++]=zr,Ln[Dn++]=Jl,Br=n.id,zr=n.overflow,Jl=e),e=$b(e,s.children),e.flags|=4096,e)}function b1(n,e,t){n.lanes|=e;var s=n.alternate;s!==null&&(s.lanes|=e),fy(n.return,e,t)}function Sv(n,e,t,s,i){var r=n.memoizedState;r===null?n.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:s,tail:t,tailMode:i}:(r.isBackwards=e,r.rendering=null,r.renderingStartTime=0,r.last=s,r.tail=t,r.tailMode=i)}function iS(n,e,t){var s=e.pendingProps,i=s.revealOrder,r=s.tail;if(ms(n,e,s.children,t),s=tt.current,s&2)s=s&1|2,e.flags|=128;else{if(n!==null&&n.flags&128)e:for(n=e.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&b1(n,t,e);else if(n.tag===19)b1(n,t,e);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break e;for(;n.sibling===null;){if(n.return===null||n.return===e)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}s&=1}if($e(tt,s),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(t=e.child,i=null;t!==null;)n=t.alternate,n!==null&&Bg(n)===null&&(i=t),t=t.sibling;t=i,t===null?(i=e.child,e.child=null):(i=t.sibling,t.sibling=null),Sv(e,!1,i,t,r);break;case"backwards":for(t=null,i=e.child,e.child=null;i!==null;){if(n=i.alternate,n!==null&&Bg(n)===null){e.child=i;break}n=i.sibling,i.sibling=t,t=i,i=n}Sv(e,!0,t,null,r);break;case"together":Sv(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Om(n,e){!(e.mode&1)&&n!==null&&(n.alternate=null,e.alternate=null,e.flags|=2)}function qr(n,e,t){if(n!==null&&(e.dependencies=n.dependencies),ec|=e.lanes,!(t&e.childLanes))return null;if(n!==null&&e.child!==n.child)throw Error(j(153));if(e.child!==null){for(n=e.child,t=pa(n,n.pendingProps),e.child=t,t.return=e;n.sibling!==null;)n=n.sibling,t=t.sibling=pa(n,n.pendingProps),t.return=e;t.sibling=null}return e.child}function D_(n,e,t){switch(e.tag){case 3:sS(e),wd();break;case 5:Pk(e);break;case 1:Fs(e.type)&&Dg(e);break;case 4:Rb(e,e.stateNode.containerInfo);break;case 10:var s=e.type._context,i=e.memoizedProps.value;$e(Fg,s._currentValue),s._currentValue=i;break;case 13:if(s=e.memoizedState,s!==null)return s.dehydrated!==null?($e(tt,tt.current&1),e.flags|=128,null):t&e.child.childLanes?nS(n,e,t):($e(tt,tt.current&1),n=qr(n,e,t),n!==null?n.sibling:null);$e(tt,tt.current&1);break;case 19:if(s=(t&e.childLanes)!==0,n.flags&128){if(s)return iS(n,e,t);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),$e(tt,tt.current),s)break;return null;case 22:case 23:return e.lanes=0,eS(n,e,t)}return qr(n,e,t)}var rS,wy,oS,aS;rS=function(n,e){for(var t=e.child;t!==null;){if(t.tag===5||t.tag===6)n.appendChild(t.stateNode);else if(t.tag!==4&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return;t=t.return}t.sibling.return=t.return,t=t.sibling}};wy=function(){};oS=function(n,e,t,s){var i=n.memoizedProps;if(i!==s){n=e.stateNode,Fa(Hi.current);var r=null;switch(t){case"input":i=$v(n,i),s=$v(n,s),r=[];break;case"select":i=it({},i,{value:void 0}),s=it({},s,{value:void 0}),r=[];break;case"textarea":i=Gv(n,i),s=Gv(n,s),r=[];break;default:typeof i.onClick!="function"&&typeof s.onClick=="function"&&(n.onclick=Mg)}Yv(t,s);var a;t=null;for(u in i)if(!s.hasOwnProperty(u)&&i.hasOwnProperty(u)&&i[u]!=null)if(u==="style"){var l=i[u];for(a in l)l.hasOwnProperty(a)&&(t||(t={}),t[a]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(Th.hasOwnProperty(u)?r||(r=[]):(r=r||[]).push(u,null));for(u in s){var c=s[u];if(l=i!=null?i[u]:void 0,s.hasOwnProperty(u)&&c!==l&&(c!=null||l!=null))if(u==="style")if(l){for(a in l)!l.hasOwnProperty(a)||c&&c.hasOwnProperty(a)||(t||(t={}),t[a]="");for(a in c)c.hasOwnProperty(a)&&l[a]!==c[a]&&(t||(t={}),t[a]=c[a])}else t||(r||(r=[]),r.push(u,t)),t=c;else u==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(r=r||[]).push(u,c)):u==="children"?typeof c!="string"&&typeof c!="number"||(r=r||[]).push(u,""+c):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(Th.hasOwnProperty(u)?(c!=null&&u==="onScroll"&&We("scroll",n),r||l===c||(r=[])):(r=r||[]).push(u,c))}t&&(r=r||[]).push("style",t);var u=r;(e.updateQueue=u)&&(e.flags|=4)}};aS=function(n,e,t,s){t!==s&&(e.flags|=4)};function Bd(n,e){if(!Qe)switch(n.tailMode){case"hidden":e=n.tail;for(var t=null;e!==null;)e.alternate!==null&&(t=e),e=e.sibling;t===null?n.tail=null:t.sibling=null;break;case"collapsed":t=n.tail;for(var s=null;t!==null;)t.alternate!==null&&(s=t),t=t.sibling;s===null?e||n.tail===null?n.tail=null:n.tail.sibling=null:s.sibling=null}}function Zt(n){var e=n.alternate!==null&&n.alternate.child===n.child,t=0,s=0;if(e)for(var i=n.child;i!==null;)t|=i.lanes|i.childLanes,s|=i.subtreeFlags&14680064,s|=i.flags&14680064,i.return=n,i=i.sibling;else for(i=n.child;i!==null;)t|=i.lanes|i.childLanes,s|=i.subtreeFlags,s|=i.flags,i.return=n,i=i.sibling;return n.subtreeFlags|=s,n.childLanes=t,e}function I_(n,e,t){var s=e.pendingProps;switch(_b(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Zt(e),null;case 1:return Fs(e.type)&&Lg(),Zt(e),null;case 3:return s=e.stateNode,kd(),Xe(Rs),Xe(ls),jb(),s.pendingContext&&(s.context=s.pendingContext,s.pendingContext=null),(n===null||n.child===null)&&(mm(e)?e.flags|=4:n===null||n.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,oi!==null&&(Ny(oi),oi=null))),wy(n,e),Zt(e),null;case 5:Fb(e);var i=Fa(Bh.current);if(t=e.type,n!==null&&e.stateNode!=null)oS(n,e,t,s,i),n.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!s){if(e.stateNode===null)throw Error(j(166));return Zt(e),null}if(n=Fa(Hi.current),mm(e)){s=e.stateNode,t=e.type;var r=e.memoizedProps;switch(s[Bi]=e,s[jh]=r,n=(e.mode&1)!==0,t){case"dialog":We("cancel",s),We("close",s);break;case"iframe":case"object":case"embed":We("load",s);break;case"video":case"audio":for(i=0;i<qd.length;i++)We(qd[i],s);break;case"source":We("error",s);break;case"img":case"image":case"link":We("error",s),We("load",s);break;case"details":We("toggle",s);break;case"input":Nw(s,r),We("invalid",s);break;case"select":s._wrapperState={wasMultiple:!!r.multiple},We("invalid",s);break;case"textarea":Mw(s,r),We("invalid",s)}Yv(t,r),i=null;for(var a in r)if(r.hasOwnProperty(a)){var l=r[a];a==="children"?typeof l=="string"?s.textContent!==l&&(r.suppressHydrationWarning!==!0&&pm(s.textContent,l,n),i=["children",l]):typeof l=="number"&&s.textContent!==""+l&&(r.suppressHydrationWarning!==!0&&pm(s.textContent,l,n),i=["children",""+l]):Th.hasOwnProperty(a)&&l!=null&&a==="onScroll"&&We("scroll",s)}switch(t){case"input":om(s),Pw(s,r,!0);break;case"textarea":om(s),Lw(s);break;case"select":case"option":break;default:typeof r.onClick=="function"&&(s.onclick=Mg)}s=i,e.updateQueue=s,s!==null&&(e.flags|=4)}else{a=i.nodeType===9?i:i.ownerDocument,n==="http://www.w3.org/1999/xhtml"&&(n=RA(t)),n==="http://www.w3.org/1999/xhtml"?t==="script"?(n=a.createElement("div"),n.innerHTML="<script><\/script>",n=n.removeChild(n.firstChild)):typeof s.is=="string"?n=a.createElement(t,{is:s.is}):(n=a.createElement(t),t==="select"&&(a=n,s.multiple?a.multiple=!0:s.size&&(a.size=s.size))):n=a.createElementNS(n,t),n[Bi]=e,n[jh]=s,rS(n,e,!1,!1),e.stateNode=n;e:{switch(a=qv(t,s),t){case"dialog":We("cancel",n),We("close",n),i=s;break;case"iframe":case"object":case"embed":We("load",n),i=s;break;case"video":case"audio":for(i=0;i<qd.length;i++)We(qd[i],n);i=s;break;case"source":We("error",n),i=s;break;case"img":case"image":case"link":We("error",n),We("load",n),i=s;break;case"details":We("toggle",n),i=s;break;case"input":Nw(n,s),i=$v(n,s),We("invalid",n);break;case"option":i=s;break;case"select":n._wrapperState={wasMultiple:!!s.multiple},i=it({},s,{value:void 0}),We("invalid",n);break;case"textarea":Mw(n,s),i=Gv(n,s),We("invalid",n);break;default:i=s}Yv(t,i),l=i;for(r in l)if(l.hasOwnProperty(r)){var c=l[r];r==="style"?OA(n,c):r==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&FA(n,c)):r==="children"?typeof c=="string"?(t!=="textarea"||c!=="")&&_h(n,c):typeof c=="number"&&_h(n,""+c):r!=="suppressContentEditableWarning"&&r!=="suppressHydrationWarning"&&r!=="autoFocus"&&(Th.hasOwnProperty(r)?c!=null&&r==="onScroll"&&We("scroll",n):c!=null&&fb(n,r,c,a))}switch(t){case"input":om(n),Pw(n,s,!1);break;case"textarea":om(n),Lw(n);break;case"option":s.value!=null&&n.setAttribute("value",""+ma(s.value));break;case"select":n.multiple=!!s.multiple,r=s.value,r!=null?zc(n,!!s.multiple,r,!1):s.defaultValue!=null&&zc(n,!!s.multiple,s.defaultValue,!0);break;default:typeof i.onClick=="function"&&(n.onclick=Mg)}switch(t){case"button":case"input":case"select":case"textarea":s=!!s.autoFocus;break e;case"img":s=!0;break e;default:s=!1}}s&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Zt(e),null;case 6:if(n&&e.stateNode!=null)aS(n,e,n.memoizedProps,s);else{if(typeof s!="string"&&e.stateNode===null)throw Error(j(166));if(t=Fa(Bh.current),Fa(Hi.current),mm(e)){if(s=e.stateNode,t=e.memoizedProps,s[Bi]=e,(r=s.nodeValue!==t)&&(n=dn,n!==null))switch(n.tag){case 3:pm(s.nodeValue,t,(n.mode&1)!==0);break;case 5:n.memoizedProps.suppressHydrationWarning!==!0&&pm(s.nodeValue,t,(n.mode&1)!==0)}r&&(e.flags|=4)}else s=(t.nodeType===9?t:t.ownerDocument).createTextNode(s),s[Bi]=e,e.stateNode=s}return Zt(e),null;case 13:if(Xe(tt),s=e.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(Qe&&cn!==null&&e.mode&1&&!(e.flags&128))Ek(),wd(),e.flags|=98560,r=!1;else if(r=mm(e),s!==null&&s.dehydrated!==null){if(n===null){if(!r)throw Error(j(318));if(r=e.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(j(317));r[Bi]=e}else wd(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Zt(e),r=!1}else oi!==null&&(Ny(oi),oi=null),r=!0;if(!r)return e.flags&65536?e:null}return e.flags&128?(e.lanes=t,e):(s=s!==null,s!==(n!==null&&n.memoizedState!==null)&&s&&(e.child.flags|=8192,e.mode&1&&(n===null||tt.current&1?Tt===0&&(Tt=3):qb())),e.updateQueue!==null&&(e.flags|=4),Zt(e),null);case 4:return kd(),wy(n,e),n===null&&Rh(e.stateNode.containerInfo),Zt(e),null;case 10:return Lb(e.type._context),Zt(e),null;case 17:return Fs(e.type)&&Lg(),Zt(e),null;case 19:if(Xe(tt),r=e.memoizedState,r===null)return Zt(e),null;if(s=(e.flags&128)!==0,a=r.rendering,a===null)if(s)Bd(r,!1);else{if(Tt!==0||n!==null&&n.flags&128)for(n=e.child;n!==null;){if(a=Bg(n),a!==null){for(e.flags|=128,Bd(r,!1),s=a.updateQueue,s!==null&&(e.updateQueue=s,e.flags|=4),e.subtreeFlags=0,s=t,t=e.child;t!==null;)r=t,n=s,r.flags&=14680066,a=r.alternate,a===null?(r.childLanes=0,r.lanes=n,r.child=null,r.subtreeFlags=0,r.memoizedProps=null,r.memoizedState=null,r.updateQueue=null,r.dependencies=null,r.stateNode=null):(r.childLanes=a.childLanes,r.lanes=a.lanes,r.child=a.child,r.subtreeFlags=0,r.deletions=null,r.memoizedProps=a.memoizedProps,r.memoizedState=a.memoizedState,r.updateQueue=a.updateQueue,r.type=a.type,n=a.dependencies,r.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext}),t=t.sibling;return $e(tt,tt.current&1|2),e.child}n=n.sibling}r.tail!==null&&gt()>Ed&&(e.flags|=128,s=!0,Bd(r,!1),e.lanes=4194304)}else{if(!s)if(n=Bg(a),n!==null){if(e.flags|=128,s=!0,t=n.updateQueue,t!==null&&(e.updateQueue=t,e.flags|=4),Bd(r,!0),r.tail===null&&r.tailMode==="hidden"&&!a.alternate&&!Qe)return Zt(e),null}else 2*gt()-r.renderingStartTime>Ed&&t!==1073741824&&(e.flags|=128,s=!0,Bd(r,!1),e.lanes=4194304);r.isBackwards?(a.sibling=e.child,e.child=a):(t=r.last,t!==null?t.sibling=a:e.child=a,r.last=a)}return r.tail!==null?(e=r.tail,r.rendering=e,r.tail=e.sibling,r.renderingStartTime=gt(),e.sibling=null,t=tt.current,$e(tt,s?t&1|2:t&1),e):(Zt(e),null);case 22:case 23:return Yb(),s=e.memoizedState!==null,n!==null&&n.memoizedState!==null!==s&&(e.flags|=8192),s&&e.mode&1?on&1073741824&&(Zt(e),e.subtreeFlags&6&&(e.flags|=8192)):Zt(e),null;case 24:return null;case 25:return null}throw Error(j(156,e.tag))}function R_(n,e){switch(_b(e),e.tag){case 1:return Fs(e.type)&&Lg(),n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 3:return kd(),Xe(Rs),Xe(ls),jb(),n=e.flags,n&65536&&!(n&128)?(e.flags=n&-65537|128,e):null;case 5:return Fb(e),null;case 13:if(Xe(tt),n=e.memoizedState,n!==null&&n.dehydrated!==null){if(e.alternate===null)throw Error(j(340));wd()}return n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 19:return Xe(tt),null;case 4:return kd(),null;case 10:return Lb(e.type._context),null;case 22:case 23:return Yb(),null;case 24:return null;default:return null}}var ym=!1,as=!1,F_=typeof WeakSet=="function"?WeakSet:Set,V=null;function Lc(n,e){var t=n.ref;if(t!==null)if(typeof t=="function")try{t(null)}catch(s){ct(n,e,s)}else t.current=null}function Ay(n,e,t){try{t()}catch(s){ct(n,e,s)}}var w1=!1;function j_(n,e){if(ry=_g,n=hk(),Cb(n)){if("selectionStart"in n)var t={start:n.selectionStart,end:n.selectionEnd};else e:{t=(t=n.ownerDocument)&&t.defaultView||window;var s=t.getSelection&&t.getSelection();if(s&&s.rangeCount!==0){t=s.anchorNode;var i=s.anchorOffset,r=s.focusNode;s=s.focusOffset;try{t.nodeType,r.nodeType}catch{t=null;break e}var a=0,l=-1,c=-1,u=0,d=0,h=n,f=null;t:for(;;){for(var p;h!==t||i!==0&&h.nodeType!==3||(l=a+i),h!==r||s!==0&&h.nodeType!==3||(c=a+s),h.nodeType===3&&(a+=h.nodeValue.length),(p=h.firstChild)!==null;)f=h,h=p;for(;;){if(h===n)break t;if(f===t&&++u===i&&(l=a),f===r&&++d===s&&(c=a),(p=h.nextSibling)!==null)break;h=f,f=h.parentNode}h=p}t=l===-1||c===-1?null:{start:l,end:c}}else t=null}t=t||{start:0,end:0}}else t=null;for(oy={focusedElem:n,selectionRange:t},_g=!1,V=e;V!==null;)if(e=V,n=e.child,(e.subtreeFlags&1028)!==0&&n!==null)n.return=e,V=n;else for(;V!==null;){e=V;try{var v=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(v!==null){var b=v.memoizedProps,S=v.memoizedState,y=e.stateNode,k=y.getSnapshotBeforeUpdate(e.elementType===e.type?b:Gn(e.type,b),S);y.__reactInternalSnapshotBeforeUpdate=k}break;case 3:var w=e.stateNode.containerInfo;w.nodeType===1?w.textContent="":w.nodeType===9&&w.documentElement&&w.removeChild(w.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(j(163))}}catch(E){ct(e,e.return,E)}if(n=e.sibling,n!==null){n.return=e.return,V=n;break}V=e.return}return v=w1,w1=!1,v}function kh(n,e,t){var s=e.updateQueue;if(s=s!==null?s.lastEffect:null,s!==null){var i=s=s.next;do{if((i.tag&n)===n){var r=i.destroy;i.destroy=void 0,r!==void 0&&Ay(e,t,r)}i=i.next}while(i!==s)}}function I0(n,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var t=e=e.next;do{if((t.tag&n)===n){var s=t.create;t.destroy=s()}t=t.next}while(t!==e)}}function ky(n){var e=n.ref;if(e!==null){var t=n.stateNode;switch(n.tag){case 5:n=t;break;default:n=t}typeof e=="function"?e(n):e.current=n}}function lS(n){var e=n.alternate;e!==null&&(n.alternate=null,lS(e)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(e=n.stateNode,e!==null&&(delete e[Bi],delete e[jh],delete e[cy],delete e[x_],delete e[b_])),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}function cS(n){return n.tag===5||n.tag===3||n.tag===4}function A1(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||cS(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function Sy(n,e,t){var s=n.tag;if(s===5||s===6)n=n.stateNode,e?t.nodeType===8?t.parentNode.insertBefore(n,e):t.insertBefore(n,e):(t.nodeType===8?(e=t.parentNode,e.insertBefore(n,t)):(e=t,e.appendChild(n)),t=t._reactRootContainer,t!=null||e.onclick!==null||(e.onclick=Mg));else if(s!==4&&(n=n.child,n!==null))for(Sy(n,e,t),n=n.sibling;n!==null;)Sy(n,e,t),n=n.sibling}function Ey(n,e,t){var s=n.tag;if(s===5||s===6)n=n.stateNode,e?t.insertBefore(n,e):t.appendChild(n);else if(s!==4&&(n=n.child,n!==null))for(Ey(n,e,t),n=n.sibling;n!==null;)Ey(n,e,t),n=n.sibling}var Wt=null,ri=!1;function to(n,e,t){for(t=t.child;t!==null;)uS(n,e,t),t=t.sibling}function uS(n,e,t){if(Ui&&typeof Ui.onCommitFiberUnmount=="function")try{Ui.onCommitFiberUnmount(C0,t)}catch{}switch(t.tag){case 5:as||Lc(t,e);case 6:var s=Wt,i=ri;Wt=null,to(n,e,t),Wt=s,ri=i,Wt!==null&&(ri?(n=Wt,t=t.stateNode,n.nodeType===8?n.parentNode.removeChild(t):n.removeChild(t)):Wt.removeChild(t.stateNode));break;case 18:Wt!==null&&(ri?(n=Wt,t=t.stateNode,n.nodeType===8?vv(n.parentNode,t):n.nodeType===1&&vv(n,t),Lh(n)):vv(Wt,t.stateNode));break;case 4:s=Wt,i=ri,Wt=t.stateNode.containerInfo,ri=!0,to(n,e,t),Wt=s,ri=i;break;case 0:case 11:case 14:case 15:if(!as&&(s=t.updateQueue,s!==null&&(s=s.lastEffect,s!==null))){i=s=s.next;do{var r=i,a=r.destroy;r=r.tag,a!==void 0&&(r&2||r&4)&&Ay(t,e,a),i=i.next}while(i!==s)}to(n,e,t);break;case 1:if(!as&&(Lc(t,e),s=t.stateNode,typeof s.componentWillUnmount=="function"))try{s.props=t.memoizedProps,s.state=t.memoizedState,s.componentWillUnmount()}catch(l){ct(t,e,l)}to(n,e,t);break;case 21:to(n,e,t);break;case 22:t.mode&1?(as=(s=as)||t.memoizedState!==null,to(n,e,t),as=s):to(n,e,t);break;default:to(n,e,t)}}function k1(n){var e=n.updateQueue;if(e!==null){n.updateQueue=null;var t=n.stateNode;t===null&&(t=n.stateNode=new F_),e.forEach(function(s){var i=G_.bind(null,n,s);t.has(s)||(t.add(s),s.then(i,i))})}}function $n(n,e){var t=e.deletions;if(t!==null)for(var s=0;s<t.length;s++){var i=t[s];try{var r=n,a=e,l=a;e:for(;l!==null;){switch(l.tag){case 5:Wt=l.stateNode,ri=!1;break e;case 3:Wt=l.stateNode.containerInfo,ri=!0;break e;case 4:Wt=l.stateNode.containerInfo,ri=!0;break e}l=l.return}if(Wt===null)throw Error(j(160));uS(r,a,i),Wt=null,ri=!1;var c=i.alternate;c!==null&&(c.return=null),i.return=null}catch(u){ct(i,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)dS(e,n),e=e.sibling}function dS(n,e){var t=n.alternate,s=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:if($n(e,n),hi(n),s&4){try{kh(3,n,n.return),I0(3,n)}catch(b){ct(n,n.return,b)}try{kh(5,n,n.return)}catch(b){ct(n,n.return,b)}}break;case 1:$n(e,n),hi(n),s&512&&t!==null&&Lc(t,t.return);break;case 5:if($n(e,n),hi(n),s&512&&t!==null&&Lc(t,t.return),n.flags&32){var i=n.stateNode;try{_h(i,"")}catch(b){ct(n,n.return,b)}}if(s&4&&(i=n.stateNode,i!=null)){var r=n.memoizedProps,a=t!==null?t.memoizedProps:r,l=n.type,c=n.updateQueue;if(n.updateQueue=null,c!==null)try{l==="input"&&r.type==="radio"&&r.name!=null&&DA(i,r),qv(l,a);var u=qv(l,r);for(a=0;a<c.length;a+=2){var d=c[a],h=c[a+1];d==="style"?OA(i,h):d==="dangerouslySetInnerHTML"?FA(i,h):d==="children"?_h(i,h):fb(i,d,h,u)}switch(l){case"input":Vv(i,r);break;case"textarea":IA(i,r);break;case"select":var f=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!r.multiple;var p=r.value;p!=null?zc(i,!!r.multiple,p,!1):f!==!!r.multiple&&(r.defaultValue!=null?zc(i,!!r.multiple,r.defaultValue,!0):zc(i,!!r.multiple,r.multiple?[]:"",!1))}i[jh]=r}catch(b){ct(n,n.return,b)}}break;case 6:if($n(e,n),hi(n),s&4){if(n.stateNode===null)throw Error(j(162));i=n.stateNode,r=n.memoizedProps;try{i.nodeValue=r}catch(b){ct(n,n.return,b)}}break;case 3:if($n(e,n),hi(n),s&4&&t!==null&&t.memoizedState.isDehydrated)try{Lh(e.containerInfo)}catch(b){ct(n,n.return,b)}break;case 4:$n(e,n),hi(n);break;case 13:$n(e,n),hi(n),i=n.child,i.flags&8192&&(r=i.memoizedState!==null,i.stateNode.isHidden=r,!r||i.alternate!==null&&i.alternate.memoizedState!==null||(Gb=gt())),s&4&&k1(n);break;case 22:if(d=t!==null&&t.memoizedState!==null,n.mode&1?(as=(u=as)||d,$n(e,n),as=u):$n(e,n),hi(n),s&8192){if(u=n.memoizedState!==null,(n.stateNode.isHidden=u)&&!d&&n.mode&1)for(V=n,d=n.child;d!==null;){for(h=V=d;V!==null;){switch(f=V,p=f.child,f.tag){case 0:case 11:case 14:case 15:kh(4,f,f.return);break;case 1:Lc(f,f.return);var v=f.stateNode;if(typeof v.componentWillUnmount=="function"){s=f,t=f.return;try{e=s,v.props=e.memoizedProps,v.state=e.memoizedState,v.componentWillUnmount()}catch(b){ct(s,t,b)}}break;case 5:Lc(f,f.return);break;case 22:if(f.memoizedState!==null){E1(h);continue}}p!==null?(p.return=f,V=p):E1(h)}d=d.sibling}e:for(d=null,h=n;;){if(h.tag===5){if(d===null){d=h;try{i=h.stateNode,u?(r=i.style,typeof r.setProperty=="function"?r.setProperty("display","none","important"):r.display="none"):(l=h.stateNode,c=h.memoizedProps.style,a=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=jA("display",a))}catch(b){ct(n,n.return,b)}}}else if(h.tag===6){if(d===null)try{h.stateNode.nodeValue=u?"":h.memoizedProps}catch(b){ct(n,n.return,b)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===n)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===n)break e;for(;h.sibling===null;){if(h.return===null||h.return===n)break e;d===h&&(d=null),h=h.return}d===h&&(d=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:$n(e,n),hi(n),s&4&&k1(n);break;case 21:break;default:$n(e,n),hi(n)}}function hi(n){var e=n.flags;if(e&2){try{e:{for(var t=n.return;t!==null;){if(cS(t)){var s=t;break e}t=t.return}throw Error(j(160))}switch(s.tag){case 5:var i=s.stateNode;s.flags&32&&(_h(i,""),s.flags&=-33);var r=A1(n);Ey(n,r,i);break;case 3:case 4:var a=s.stateNode.containerInfo,l=A1(n);Sy(n,l,a);break;default:throw Error(j(161))}}catch(c){ct(n,n.return,c)}n.flags&=-3}e&4096&&(n.flags&=-4097)}function O_(n,e,t){V=n,hS(n)}function hS(n,e,t){for(var s=(n.mode&1)!==0;V!==null;){var i=V,r=i.child;if(i.tag===22&&s){var a=i.memoizedState!==null||ym;if(!a){var l=i.alternate,c=l!==null&&l.memoizedState!==null||as;l=ym;var u=as;if(ym=a,(as=c)&&!u)for(V=i;V!==null;)a=V,c=a.child,a.tag===22&&a.memoizedState!==null?C1(i):c!==null?(c.return=a,V=c):C1(i);for(;r!==null;)V=r,hS(r),r=r.sibling;V=i,ym=l,as=u}S1(n)}else i.subtreeFlags&8772&&r!==null?(r.return=i,V=r):S1(n)}}function S1(n){for(;V!==null;){var e=V;if(e.flags&8772){var t=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:as||I0(5,e);break;case 1:var s=e.stateNode;if(e.flags&4&&!as)if(t===null)s.componentDidMount();else{var i=e.elementType===e.type?t.memoizedProps:Gn(e.type,t.memoizedProps);s.componentDidUpdate(i,t.memoizedState,s.__reactInternalSnapshotBeforeUpdate)}var r=e.updateQueue;r!==null&&l1(e,r,s);break;case 3:var a=e.updateQueue;if(a!==null){if(t=null,e.child!==null)switch(e.child.tag){case 5:t=e.child.stateNode;break;case 1:t=e.child.stateNode}l1(e,a,t)}break;case 5:var l=e.stateNode;if(t===null&&e.flags&4){t=l;var c=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&t.focus();break;case"img":c.src&&(t.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var d=u.memoizedState;if(d!==null){var h=d.dehydrated;h!==null&&Lh(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(j(163))}as||e.flags&512&&ky(e)}catch(f){ct(e,e.return,f)}}if(e===n){V=null;break}if(t=e.sibling,t!==null){t.return=e.return,V=t;break}V=e.return}}function E1(n){for(;V!==null;){var e=V;if(e===n){V=null;break}var t=e.sibling;if(t!==null){t.return=e.return,V=t;break}V=e.return}}function C1(n){for(;V!==null;){var e=V;try{switch(e.tag){case 0:case 11:case 15:var t=e.return;try{I0(4,e)}catch(c){ct(e,t,c)}break;case 1:var s=e.stateNode;if(typeof s.componentDidMount=="function"){var i=e.return;try{s.componentDidMount()}catch(c){ct(e,i,c)}}var r=e.return;try{ky(e)}catch(c){ct(e,r,c)}break;case 5:var a=e.return;try{ky(e)}catch(c){ct(e,a,c)}}}catch(c){ct(e,e.return,c)}if(e===n){V=null;break}var l=e.sibling;if(l!==null){l.return=e.return,V=l;break}V=e.return}}var B_=Math.ceil,Hg=Zr.ReactCurrentDispatcher,Vb=Zr.ReactCurrentOwner,Fn=Zr.ReactCurrentBatchConfig,xe=0,Ot=null,bt=null,Kt=0,on=0,Dc=wa(0),Tt=0,$h=null,ec=0,R0=0,Wb=0,Sh=null,Ds=null,Gb=0,Ed=1/0,Ki=null,$g=!1,Cy=null,ha=null,xm=!1,oa=null,Vg=0,Eh=0,Ty=null,Bm=-1,zm=0;function vs(){return xe&6?gt():Bm!==-1?Bm:Bm=gt()}function fa(n){return n.mode&1?xe&2&&Kt!==0?Kt&-Kt:A_.transition!==null?(zm===0&&(zm=KA()),zm):(n=Le,n!==0||(n=window.event,n=n===void 0?16:nk(n.type)),n):1}function ci(n,e,t,s){if(50<Eh)throw Eh=0,Ty=null,Error(j(185));Xp(n,t,s),(!(xe&2)||n!==Ot)&&(n===Ot&&(!(xe&2)&&(R0|=t),Tt===4&&oo(n,Kt)),js(n,s),t===1&&xe===0&&!(e.mode&1)&&(Ed=gt()+500,M0&&Aa()))}function js(n,e){var t=n.callbackNode;AT(n,e);var s=Tg(n,n===Ot?Kt:0);if(s===0)t!==null&&Rw(t),n.callbackNode=null,n.callbackPriority=0;else if(e=s&-s,n.callbackPriority!==e){if(t!=null&&Rw(t),e===1)n.tag===0?w_(T1.bind(null,n)):Ak(T1.bind(null,n)),v_(function(){!(xe&6)&&Aa()}),t=null;else{switch(QA(s)){case 1:t=yb;break;case 4:t=YA;break;case 16:t=Cg;break;case 536870912:t=qA;break;default:t=Cg}t=bS(t,fS.bind(null,n))}n.callbackPriority=e,n.callbackNode=t}}function fS(n,e){if(Bm=-1,zm=0,xe&6)throw Error(j(327));var t=n.callbackNode;if(Wc()&&n.callbackNode!==t)return null;var s=Tg(n,n===Ot?Kt:0);if(s===0)return null;if(s&30||s&n.expiredLanes||e)e=Wg(n,s);else{e=s;var i=xe;xe|=2;var r=mS();(Ot!==n||Kt!==e)&&(Ki=null,Ed=gt()+500,ql(n,e));do try{H_();break}catch(l){pS(n,l)}while(!0);Mb(),Hg.current=r,xe=i,bt!==null?e=0:(Ot=null,Kt=0,e=Tt)}if(e!==0){if(e===2&&(i=ey(n),i!==0&&(s=i,e=_y(n,i))),e===1)throw t=$h,ql(n,0),oo(n,s),js(n,gt()),t;if(e===6)oo(n,s);else{if(i=n.current.alternate,!(s&30)&&!z_(i)&&(e=Wg(n,s),e===2&&(r=ey(n),r!==0&&(s=r,e=_y(n,r))),e===1))throw t=$h,ql(n,0),oo(n,s),js(n,gt()),t;switch(n.finishedWork=i,n.finishedLanes=s,e){case 0:case 1:throw Error(j(345));case 2:Ta(n,Ds,Ki);break;case 3:if(oo(n,s),(s&130023424)===s&&(e=Gb+500-gt(),10<e)){if(Tg(n,0)!==0)break;if(i=n.suspendedLanes,(i&s)!==s){vs(),n.pingedLanes|=n.suspendedLanes&i;break}n.timeoutHandle=ly(Ta.bind(null,n,Ds,Ki),e);break}Ta(n,Ds,Ki);break;case 4:if(oo(n,s),(s&4194240)===s)break;for(e=n.eventTimes,i=-1;0<s;){var a=31-li(s);r=1<<a,a=e[a],a>i&&(i=a),s&=~r}if(s=i,s=gt()-s,s=(120>s?120:480>s?480:1080>s?1080:1920>s?1920:3e3>s?3e3:4320>s?4320:1960*B_(s/1960))-s,10<s){n.timeoutHandle=ly(Ta.bind(null,n,Ds,Ki),s);break}Ta(n,Ds,Ki);break;case 5:Ta(n,Ds,Ki);break;default:throw Error(j(329))}}}return js(n,gt()),n.callbackNode===t?fS.bind(null,n):null}function _y(n,e){var t=Sh;return n.current.memoizedState.isDehydrated&&(ql(n,e).flags|=256),n=Wg(n,e),n!==2&&(e=Ds,Ds=t,e!==null&&Ny(e)),n}function Ny(n){Ds===null?Ds=n:Ds.push.apply(Ds,n)}function z_(n){for(var e=n;;){if(e.flags&16384){var t=e.updateQueue;if(t!==null&&(t=t.stores,t!==null))for(var s=0;s<t.length;s++){var i=t[s],r=i.getSnapshot;i=i.value;try{if(!ui(r(),i))return!1}catch{return!1}}}if(t=e.child,e.subtreeFlags&16384&&t!==null)t.return=e,e=t;else{if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function oo(n,e){for(e&=~Wb,e&=~R0,n.suspendedLanes|=e,n.pingedLanes&=~e,n=n.expirationTimes;0<e;){var t=31-li(e),s=1<<t;n[t]=-1,e&=~s}}function T1(n){if(xe&6)throw Error(j(327));Wc();var e=Tg(n,0);if(!(e&1))return js(n,gt()),null;var t=Wg(n,e);if(n.tag!==0&&t===2){var s=ey(n);s!==0&&(e=s,t=_y(n,s))}if(t===1)throw t=$h,ql(n,0),oo(n,e),js(n,gt()),t;if(t===6)throw Error(j(345));return n.finishedWork=n.current.alternate,n.finishedLanes=e,Ta(n,Ds,Ki),js(n,gt()),null}function Xb(n,e){var t=xe;xe|=1;try{return n(e)}finally{xe=t,xe===0&&(Ed=gt()+500,M0&&Aa())}}function tc(n){oa!==null&&oa.tag===0&&!(xe&6)&&Wc();var e=xe;xe|=1;var t=Fn.transition,s=Le;try{if(Fn.transition=null,Le=1,n)return n()}finally{Le=s,Fn.transition=t,xe=e,!(xe&6)&&Aa()}}function Yb(){on=Dc.current,Xe(Dc)}function ql(n,e){n.finishedWork=null,n.finishedLanes=0;var t=n.timeoutHandle;if(t!==-1&&(n.timeoutHandle=-1,g_(t)),bt!==null)for(t=bt.return;t!==null;){var s=t;switch(_b(s),s.tag){case 1:s=s.type.childContextTypes,s!=null&&Lg();break;case 3:kd(),Xe(Rs),Xe(ls),jb();break;case 5:Fb(s);break;case 4:kd();break;case 13:Xe(tt);break;case 19:Xe(tt);break;case 10:Lb(s.type._context);break;case 22:case 23:Yb()}t=t.return}if(Ot=n,bt=n=pa(n.current,null),Kt=on=e,Tt=0,$h=null,Wb=R0=ec=0,Ds=Sh=null,Ra!==null){for(e=0;e<Ra.length;e++)if(t=Ra[e],s=t.interleaved,s!==null){t.interleaved=null;var i=s.next,r=t.pending;if(r!==null){var a=r.next;r.next=i,s.next=a}t.pending=s}Ra=null}return n}function pS(n,e){do{var t=bt;try{if(Mb(),Fm.current=Ug,zg){for(var s=st.memoizedState;s!==null;){var i=s.queue;i!==null&&(i.pending=null),s=s.next}zg=!1}if(Zl=0,jt=Ct=st=null,Ah=!1,zh=0,Vb.current=null,t===null||t.return===null){Tt=1,$h=e,bt=null;break}e:{var r=n,a=t.return,l=t,c=e;if(e=Kt,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var u=c,d=l,h=d.tag;if(!(d.mode&1)&&(h===0||h===11||h===15)){var f=d.alternate;f?(d.updateQueue=f.updateQueue,d.memoizedState=f.memoizedState,d.lanes=f.lanes):(d.updateQueue=null,d.memoizedState=null)}var p=p1(a);if(p!==null){p.flags&=-257,m1(p,a,l,r,e),p.mode&1&&f1(r,u,e),e=p,c=u;var v=e.updateQueue;if(v===null){var b=new Set;b.add(c),e.updateQueue=b}else v.add(c);break e}else{if(!(e&1)){f1(r,u,e),qb();break e}c=Error(j(426))}}else if(Qe&&l.mode&1){var S=p1(a);if(S!==null){!(S.flags&65536)&&(S.flags|=256),m1(S,a,l,r,e),Nb(Sd(c,l));break e}}r=c=Sd(c,l),Tt!==4&&(Tt=2),Sh===null?Sh=[r]:Sh.push(r),r=a;do{switch(r.tag){case 3:r.flags|=65536,e&=-e,r.lanes|=e;var y=Qk(r,c,e);a1(r,y);break e;case 1:l=c;var k=r.type,w=r.stateNode;if(!(r.flags&128)&&(typeof k.getDerivedStateFromError=="function"||w!==null&&typeof w.componentDidCatch=="function"&&(ha===null||!ha.has(w)))){r.flags|=65536,e&=-e,r.lanes|=e;var E=Jk(r,l,e);a1(r,E);break e}}r=r.return}while(r!==null)}vS(t)}catch(C){e=C,bt===t&&t!==null&&(bt=t=t.return);continue}break}while(!0)}function mS(){var n=Hg.current;return Hg.current=Ug,n===null?Ug:n}function qb(){(Tt===0||Tt===3||Tt===2)&&(Tt=4),Ot===null||!(ec&268435455)&&!(R0&268435455)||oo(Ot,Kt)}function Wg(n,e){var t=xe;xe|=2;var s=mS();(Ot!==n||Kt!==e)&&(Ki=null,ql(n,e));do try{U_();break}catch(i){pS(n,i)}while(!0);if(Mb(),xe=t,Hg.current=s,bt!==null)throw Error(j(261));return Ot=null,Kt=0,Tt}function U_(){for(;bt!==null;)gS(bt)}function H_(){for(;bt!==null&&!fT();)gS(bt)}function gS(n){var e=xS(n.alternate,n,on);n.memoizedProps=n.pendingProps,e===null?vS(n):bt=e,Vb.current=null}function vS(n){var e=n;do{var t=e.alternate;if(n=e.return,e.flags&32768){if(t=R_(t,e),t!==null){t.flags&=32767,bt=t;return}if(n!==null)n.flags|=32768,n.subtreeFlags=0,n.deletions=null;else{Tt=6,bt=null;return}}else if(t=I_(t,e,on),t!==null){bt=t;return}if(e=e.sibling,e!==null){bt=e;return}bt=e=n}while(e!==null);Tt===0&&(Tt=5)}function Ta(n,e,t){var s=Le,i=Fn.transition;try{Fn.transition=null,Le=1,$_(n,e,t,s)}finally{Fn.transition=i,Le=s}return null}function $_(n,e,t,s){do Wc();while(oa!==null);if(xe&6)throw Error(j(327));t=n.finishedWork;var i=n.finishedLanes;if(t===null)return null;if(n.finishedWork=null,n.finishedLanes=0,t===n.current)throw Error(j(177));n.callbackNode=null,n.callbackPriority=0;var r=t.lanes|t.childLanes;if(kT(n,r),n===Ot&&(bt=Ot=null,Kt=0),!(t.subtreeFlags&2064)&&!(t.flags&2064)||xm||(xm=!0,bS(Cg,function(){return Wc(),null})),r=(t.flags&15990)!==0,t.subtreeFlags&15990||r){r=Fn.transition,Fn.transition=null;var a=Le;Le=1;var l=xe;xe|=4,Vb.current=null,j_(n,t),dS(t,n),c_(oy),_g=!!ry,oy=ry=null,n.current=t,O_(t),pT(),xe=l,Le=a,Fn.transition=r}else n.current=t;if(xm&&(xm=!1,oa=n,Vg=i),r=n.pendingLanes,r===0&&(ha=null),vT(t.stateNode),js(n,gt()),e!==null)for(s=n.onRecoverableError,t=0;t<e.length;t++)i=e[t],s(i.value,{componentStack:i.stack,digest:i.digest});if($g)throw $g=!1,n=Cy,Cy=null,n;return Vg&1&&n.tag!==0&&Wc(),r=n.pendingLanes,r&1?n===Ty?Eh++:(Eh=0,Ty=n):Eh=0,Aa(),null}function Wc(){if(oa!==null){var n=QA(Vg),e=Fn.transition,t=Le;try{if(Fn.transition=null,Le=16>n?16:n,oa===null)var s=!1;else{if(n=oa,oa=null,Vg=0,xe&6)throw Error(j(331));var i=xe;for(xe|=4,V=n.current;V!==null;){var r=V,a=r.child;if(V.flags&16){var l=r.deletions;if(l!==null){for(var c=0;c<l.length;c++){var u=l[c];for(V=u;V!==null;){var d=V;switch(d.tag){case 0:case 11:case 15:kh(8,d,r)}var h=d.child;if(h!==null)h.return=d,V=h;else for(;V!==null;){d=V;var f=d.sibling,p=d.return;if(lS(d),d===u){V=null;break}if(f!==null){f.return=p,V=f;break}V=p}}}var v=r.alternate;if(v!==null){var b=v.child;if(b!==null){v.child=null;do{var S=b.sibling;b.sibling=null,b=S}while(b!==null)}}V=r}}if(r.subtreeFlags&2064&&a!==null)a.return=r,V=a;else e:for(;V!==null;){if(r=V,r.flags&2048)switch(r.tag){case 0:case 11:case 15:kh(9,r,r.return)}var y=r.sibling;if(y!==null){y.return=r.return,V=y;break e}V=r.return}}var k=n.current;for(V=k;V!==null;){a=V;var w=a.child;if(a.subtreeFlags&2064&&w!==null)w.return=a,V=w;else e:for(a=k;V!==null;){if(l=V,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:I0(9,l)}}catch(C){ct(l,l.return,C)}if(l===a){V=null;break e}var E=l.sibling;if(E!==null){E.return=l.return,V=E;break e}V=l.return}}if(xe=i,Aa(),Ui&&typeof Ui.onPostCommitFiberRoot=="function")try{Ui.onPostCommitFiberRoot(C0,n)}catch{}s=!0}return s}finally{Le=t,Fn.transition=e}}return!1}function _1(n,e,t){e=Sd(t,e),e=Qk(n,e,1),n=da(n,e,1),e=vs(),n!==null&&(Xp(n,1,e),js(n,e))}function ct(n,e,t){if(n.tag===3)_1(n,n,t);else for(;e!==null;){if(e.tag===3){_1(e,n,t);break}else if(e.tag===1){var s=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof s.componentDidCatch=="function"&&(ha===null||!ha.has(s))){n=Sd(t,n),n=Jk(e,n,1),e=da(e,n,1),n=vs(),e!==null&&(Xp(e,1,n),js(e,n));break}}e=e.return}}function V_(n,e,t){var s=n.pingCache;s!==null&&s.delete(e),e=vs(),n.pingedLanes|=n.suspendedLanes&t,Ot===n&&(Kt&t)===t&&(Tt===4||Tt===3&&(Kt&130023424)===Kt&&500>gt()-Gb?ql(n,0):Wb|=t),js(n,e)}function yS(n,e){e===0&&(n.mode&1?(e=cm,cm<<=1,!(cm&130023424)&&(cm=4194304)):e=1);var t=vs();n=Yr(n,e),n!==null&&(Xp(n,e,t),js(n,t))}function W_(n){var e=n.memoizedState,t=0;e!==null&&(t=e.retryLane),yS(n,t)}function G_(n,e){var t=0;switch(n.tag){case 13:var s=n.stateNode,i=n.memoizedState;i!==null&&(t=i.retryLane);break;case 19:s=n.stateNode;break;default:throw Error(j(314))}s!==null&&s.delete(e),yS(n,t)}var xS;xS=function(n,e,t){if(n!==null)if(n.memoizedProps!==e.pendingProps||Rs.current)Is=!0;else{if(!(n.lanes&t)&&!(e.flags&128))return Is=!1,D_(n,e,t);Is=!!(n.flags&131072)}else Is=!1,Qe&&e.flags&1048576&&kk(e,Rg,e.index);switch(e.lanes=0,e.tag){case 2:var s=e.type;Om(n,e),n=e.pendingProps;var i=bd(e,ls.current);Vc(e,t),i=Bb(null,e,s,n,i,t);var r=zb();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Fs(s)?(r=!0,Dg(e)):r=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,Ib(e),i.updater=D0,e.stateNode=i,i._reactInternals=e,my(e,s,n,t),e=yy(null,e,s,!0,r,t)):(e.tag=0,Qe&&r&&Tb(e),ms(null,e,i,t),e=e.child),e;case 16:s=e.elementType;e:{switch(Om(n,e),n=e.pendingProps,i=s._init,s=i(s._payload),e.type=s,i=e.tag=Y_(s),n=Gn(s,n),i){case 0:e=vy(null,e,s,n,t);break e;case 1:e=y1(null,e,s,n,t);break e;case 11:e=g1(null,e,s,n,t);break e;case 14:e=v1(null,e,s,Gn(s.type,n),t);break e}throw Error(j(306,s,""))}return e;case 0:return s=e.type,i=e.pendingProps,i=e.elementType===s?i:Gn(s,i),vy(n,e,s,i,t);case 1:return s=e.type,i=e.pendingProps,i=e.elementType===s?i:Gn(s,i),y1(n,e,s,i,t);case 3:e:{if(sS(e),n===null)throw Error(j(387));s=e.pendingProps,r=e.memoizedState,i=r.element,Nk(n,e),Og(e,s,null,t);var a=e.memoizedState;if(s=a.element,r.isDehydrated)if(r={element:s,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},e.updateQueue.baseState=r,e.memoizedState=r,e.flags&256){i=Sd(Error(j(423)),e),e=x1(n,e,s,t,i);break e}else if(s!==i){i=Sd(Error(j(424)),e),e=x1(n,e,s,t,i);break e}else for(cn=ua(e.stateNode.containerInfo.firstChild),dn=e,Qe=!0,oi=null,t=Tk(e,null,s,t),e.child=t;t;)t.flags=t.flags&-3|4096,t=t.sibling;else{if(wd(),s===i){e=qr(n,e,t);break e}ms(n,e,s,t)}e=e.child}return e;case 5:return Pk(e),n===null&&hy(e),s=e.type,i=e.pendingProps,r=n!==null?n.memoizedProps:null,a=i.children,ay(s,i)?a=null:r!==null&&ay(s,r)&&(e.flags|=32),tS(n,e),ms(n,e,a,t),e.child;case 6:return n===null&&hy(e),null;case 13:return nS(n,e,t);case 4:return Rb(e,e.stateNode.containerInfo),s=e.pendingProps,n===null?e.child=Ad(e,null,s,t):ms(n,e,s,t),e.child;case 11:return s=e.type,i=e.pendingProps,i=e.elementType===s?i:Gn(s,i),g1(n,e,s,i,t);case 7:return ms(n,e,e.pendingProps,t),e.child;case 8:return ms(n,e,e.pendingProps.children,t),e.child;case 12:return ms(n,e,e.pendingProps.children,t),e.child;case 10:e:{if(s=e.type._context,i=e.pendingProps,r=e.memoizedProps,a=i.value,$e(Fg,s._currentValue),s._currentValue=a,r!==null)if(ui(r.value,a)){if(r.children===i.children&&!Rs.current){e=qr(n,e,t);break e}}else for(r=e.child,r!==null&&(r.return=e);r!==null;){var l=r.dependencies;if(l!==null){a=r.child;for(var c=l.firstContext;c!==null;){if(c.context===s){if(r.tag===1){c=Ur(-1,t&-t),c.tag=2;var u=r.updateQueue;if(u!==null){u=u.shared;var d=u.pending;d===null?c.next=c:(c.next=d.next,d.next=c),u.pending=c}}r.lanes|=t,c=r.alternate,c!==null&&(c.lanes|=t),fy(r.return,t,e),l.lanes|=t;break}c=c.next}}else if(r.tag===10)a=r.type===e.type?null:r.child;else if(r.tag===18){if(a=r.return,a===null)throw Error(j(341));a.lanes|=t,l=a.alternate,l!==null&&(l.lanes|=t),fy(a,t,e),a=r.sibling}else a=r.child;if(a!==null)a.return=r;else for(a=r;a!==null;){if(a===e){a=null;break}if(r=a.sibling,r!==null){r.return=a.return,a=r;break}a=a.return}r=a}ms(n,e,i.children,t),e=e.child}return e;case 9:return i=e.type,s=e.pendingProps.children,Vc(e,t),i=On(i),s=s(i),e.flags|=1,ms(n,e,s,t),e.child;case 14:return s=e.type,i=Gn(s,e.pendingProps),i=Gn(s.type,i),v1(n,e,s,i,t);case 15:return Zk(n,e,e.type,e.pendingProps,t);case 17:return s=e.type,i=e.pendingProps,i=e.elementType===s?i:Gn(s,i),Om(n,e),e.tag=1,Fs(s)?(n=!0,Dg(e)):n=!1,Vc(e,t),Kk(e,s,i),my(e,s,i,t),yy(null,e,s,!0,n,t);case 19:return iS(n,e,t);case 22:return eS(n,e,t)}throw Error(j(156,e.tag))};function bS(n,e){return XA(n,e)}function X_(n,e,t,s){this.tag=n,this.key=t,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=s,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Rn(n,e,t,s){return new X_(n,e,t,s)}function Kb(n){return n=n.prototype,!(!n||!n.isReactComponent)}function Y_(n){if(typeof n=="function")return Kb(n)?1:0;if(n!=null){if(n=n.$$typeof,n===mb)return 11;if(n===gb)return 14}return 2}function pa(n,e){var t=n.alternate;return t===null?(t=Rn(n.tag,e,n.key,n.mode),t.elementType=n.elementType,t.type=n.type,t.stateNode=n.stateNode,t.alternate=n,n.alternate=t):(t.pendingProps=e,t.type=n.type,t.flags=0,t.subtreeFlags=0,t.deletions=null),t.flags=n.flags&14680064,t.childLanes=n.childLanes,t.lanes=n.lanes,t.child=n.child,t.memoizedProps=n.memoizedProps,t.memoizedState=n.memoizedState,t.updateQueue=n.updateQueue,e=n.dependencies,t.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},t.sibling=n.sibling,t.index=n.index,t.ref=n.ref,t}function Um(n,e,t,s,i,r){var a=2;if(s=n,typeof n=="function")Kb(n)&&(a=1);else if(typeof n=="string")a=5;else e:switch(n){case kc:return Kl(t.children,i,r,e);case pb:a=8,i|=8;break;case Bv:return n=Rn(12,t,e,i|2),n.elementType=Bv,n.lanes=r,n;case zv:return n=Rn(13,t,e,i),n.elementType=zv,n.lanes=r,n;case Uv:return n=Rn(19,t,e,i),n.elementType=Uv,n.lanes=r,n;case PA:return F0(t,i,r,e);default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case _A:a=10;break e;case NA:a=9;break e;case mb:a=11;break e;case gb:a=14;break e;case no:a=16,s=null;break e}throw Error(j(130,n==null?n:typeof n,""))}return e=Rn(a,t,e,i),e.elementType=n,e.type=s,e.lanes=r,e}function Kl(n,e,t,s){return n=Rn(7,n,s,e),n.lanes=t,n}function F0(n,e,t,s){return n=Rn(22,n,s,e),n.elementType=PA,n.lanes=t,n.stateNode={isHidden:!1},n}function Ev(n,e,t){return n=Rn(6,n,null,e),n.lanes=t,n}function Cv(n,e,t){return e=Rn(4,n.children!==null?n.children:[],n.key,e),e.lanes=t,e.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},e}function q_(n,e,t,s,i){this.tag=e,this.containerInfo=n,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=ov(0),this.expirationTimes=ov(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ov(0),this.identifierPrefix=s,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function Qb(n,e,t,s,i,r,a,l,c){return n=new q_(n,e,t,l,c),e===1?(e=1,r===!0&&(e|=8)):e=0,r=Rn(3,null,null,e),n.current=r,r.stateNode=n,r.memoizedState={element:s,isDehydrated:t,cache:null,transitions:null,pendingSuspenseBoundaries:null},Ib(r),n}function K_(n,e,t){var s=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Ac,key:s==null?null:""+s,children:n,containerInfo:e,implementation:t}}function wS(n){if(!n)return ga;n=n._reactInternals;e:{if(oc(n)!==n||n.tag!==1)throw Error(j(170));var e=n;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Fs(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(j(171))}if(n.tag===1){var t=n.type;if(Fs(t))return wk(n,t,e)}return e}function AS(n,e,t,s,i,r,a,l,c){return n=Qb(t,s,!0,n,i,r,a,l,c),n.context=wS(null),t=n.current,s=vs(),i=fa(t),r=Ur(s,i),r.callback=e??null,da(t,r,i),n.current.lanes=i,Xp(n,i,s),js(n,s),n}function j0(n,e,t,s){var i=e.current,r=vs(),a=fa(i);return t=wS(t),e.context===null?e.context=t:e.pendingContext=t,e=Ur(r,a),e.payload={element:n},s=s===void 0?null:s,s!==null&&(e.callback=s),n=da(i,e,a),n!==null&&(ci(n,i,a,r),Rm(n,i,a)),a}function Gg(n){if(n=n.current,!n.child)return null;switch(n.child.tag){case 5:return n.child.stateNode;default:return n.child.stateNode}}function N1(n,e){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var t=n.retryLane;n.retryLane=t!==0&&t<e?t:e}}function Jb(n,e){N1(n,e),(n=n.alternate)&&N1(n,e)}function Q_(){return null}var kS=typeof reportError=="function"?reportError:function(n){console.error(n)};function Zb(n){this._internalRoot=n}O0.prototype.render=Zb.prototype.render=function(n){var e=this._internalRoot;if(e===null)throw Error(j(409));j0(n,e,null,null)};O0.prototype.unmount=Zb.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var e=n.containerInfo;tc(function(){j0(null,n,null,null)}),e[Xr]=null}};function O0(n){this._internalRoot=n}O0.prototype.unstable_scheduleHydration=function(n){if(n){var e=ek();n={blockedOn:null,target:n,priority:e};for(var t=0;t<ro.length&&e!==0&&e<ro[t].priority;t++);ro.splice(t,0,n),t===0&&sk(n)}};function ew(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function B0(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11&&(n.nodeType!==8||n.nodeValue!==" react-mount-point-unstable "))}function P1(){}function J_(n,e,t,s,i){if(i){if(typeof s=="function"){var r=s;s=function(){var u=Gg(a);r.call(u)}}var a=AS(e,s,n,0,null,!1,!1,"",P1);return n._reactRootContainer=a,n[Xr]=a.current,Rh(n.nodeType===8?n.parentNode:n),tc(),a}for(;i=n.lastChild;)n.removeChild(i);if(typeof s=="function"){var l=s;s=function(){var u=Gg(c);l.call(u)}}var c=Qb(n,0,!1,null,null,!1,!1,"",P1);return n._reactRootContainer=c,n[Xr]=c.current,Rh(n.nodeType===8?n.parentNode:n),tc(function(){j0(e,c,t,s)}),c}function z0(n,e,t,s,i){var r=t._reactRootContainer;if(r){var a=r;if(typeof i=="function"){var l=i;i=function(){var c=Gg(a);l.call(c)}}j0(e,a,n,i)}else a=J_(t,e,n,i,s);return Gg(a)}JA=function(n){switch(n.tag){case 3:var e=n.stateNode;if(e.current.memoizedState.isDehydrated){var t=Yd(e.pendingLanes);t!==0&&(xb(e,t|1),js(e,gt()),!(xe&6)&&(Ed=gt()+500,Aa()))}break;case 13:tc(function(){var s=Yr(n,1);if(s!==null){var i=vs();ci(s,n,1,i)}}),Jb(n,1)}};bb=function(n){if(n.tag===13){var e=Yr(n,134217728);if(e!==null){var t=vs();ci(e,n,134217728,t)}Jb(n,134217728)}};ZA=function(n){if(n.tag===13){var e=fa(n),t=Yr(n,e);if(t!==null){var s=vs();ci(t,n,e,s)}Jb(n,e)}};ek=function(){return Le};tk=function(n,e){var t=Le;try{return Le=n,e()}finally{Le=t}};Qv=function(n,e,t){switch(e){case"input":if(Vv(n,t),e=t.name,t.type==="radio"&&e!=null){for(t=n;t.parentNode;)t=t.parentNode;for(t=t.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<t.length;e++){var s=t[e];if(s!==n&&s.form===n.form){var i=P0(s);if(!i)throw Error(j(90));LA(s),Vv(s,i)}}}break;case"textarea":IA(n,t);break;case"select":e=t.value,e!=null&&zc(n,!!t.multiple,e,!1)}};UA=Xb;HA=tc;var Z_={usingClientEntryPoint:!1,Events:[qp,Tc,P0,BA,zA,Xb]},zd={findFiberByHostInstance:Ia,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},eN={bundleType:zd.bundleType,version:zd.version,rendererPackageName:zd.rendererPackageName,rendererConfig:zd.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Zr.ReactCurrentDispatcher,findHostInstanceByFiber:function(n){return n=WA(n),n===null?null:n.stateNode},findFiberByHostInstance:zd.findFiberByHostInstance||Q_,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var bm=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!bm.isDisabled&&bm.supportsFiber)try{C0=bm.inject(eN),Ui=bm}catch{}}pn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Z_;pn.createPortal=function(n,e){var t=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!ew(e))throw Error(j(200));return K_(n,e,null,t)};pn.createRoot=function(n,e){if(!ew(n))throw Error(j(299));var t=!1,s="",i=kS;return e!=null&&(e.unstable_strictMode===!0&&(t=!0),e.identifierPrefix!==void 0&&(s=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=Qb(n,1,!1,null,null,t,!1,s,i),n[Xr]=e.current,Rh(n.nodeType===8?n.parentNode:n),new Zb(e)};pn.findDOMNode=function(n){if(n==null)return null;if(n.nodeType===1)return n;var e=n._reactInternals;if(e===void 0)throw typeof n.render=="function"?Error(j(188)):(n=Object.keys(n).join(","),Error(j(268,n)));return n=WA(e),n=n===null?null:n.stateNode,n};pn.flushSync=function(n){return tc(n)};pn.hydrate=function(n,e,t){if(!B0(e))throw Error(j(200));return z0(null,n,e,!0,t)};pn.hydrateRoot=function(n,e,t){if(!ew(n))throw Error(j(405));var s=t!=null&&t.hydratedSources||null,i=!1,r="",a=kS;if(t!=null&&(t.unstable_strictMode===!0&&(i=!0),t.identifierPrefix!==void 0&&(r=t.identifierPrefix),t.onRecoverableError!==void 0&&(a=t.onRecoverableError)),e=AS(e,null,n,1,t??null,i,!1,r,a),n[Xr]=e.current,Rh(n),s)for(n=0;n<s.length;n++)t=s[n],i=t._getVersion,i=i(t._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[t,i]:e.mutableSourceEagerHydrationData.push(t,i);return new O0(e)};pn.render=function(n,e,t){if(!B0(e))throw Error(j(200));return z0(null,n,e,!1,t)};pn.unmountComponentAtNode=function(n){if(!B0(n))throw Error(j(40));return n._reactRootContainer?(tc(function(){z0(null,null,n,!1,function(){n._reactRootContainer=null,n[Xr]=null})}),!0):!1};pn.unstable_batchedUpdates=Xb;pn.unstable_renderSubtreeIntoContainer=function(n,e,t,s){if(!B0(t))throw Error(j(200));if(n==null||n._reactInternals===void 0)throw Error(j(38));return z0(n,e,t,!1,s)};pn.version="18.3.1-next-f1338f8080-20240426";function SS(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(SS)}catch(n){console.error(n)}}SS(),SA.exports=pn;var tN=SA.exports,M1=tN;jv.createRoot=M1.createRoot,jv.hydrateRoot=M1.hydrateRoot;const ps=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),Py=[.001,0,0,.001,0,0],Tv=1.35,rn={ANY:1,DISPLAY:2,PRINT:4,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,IS_EDITING:128,OPLIST:256},ao={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},Vh="pdfjs_internal_editor_",oe={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15,POPUP:16,SIGNATURE:101,COMMENT:102},ve={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_THICKNESS:32,HIGHLIGHT_FREE:33,HIGHLIGHT_SHOW_ALL:34,DRAW_STEP:41},sN={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},My={TRIANGLES:1,LATTICE:2},kt={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},Hm={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},yt={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},pc={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},U0={ERRORS:0,WARNINGS:1,INFOS:5},Wh={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93,rawFillPath:94},Ud={moveTo:0,lineTo:1,curveTo:2,quadraticCurveTo:3,closePath:4},nN={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let H0=U0.WARNINGS;function iN(n){Number.isInteger(n)&&(H0=n)}function rN(){return H0}function $0(n){H0>=U0.INFOS&&console.info(`Info: ${n}`)}function ne(n){H0>=U0.WARNINGS&&console.warn(`Warning: ${n}`)}function Ce(n){throw new Error(n)}function Ee(n,e){n||Ce(e)}function oN(n){switch(n==null?void 0:n.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function ES(n,e=null,t=null){if(!n)return null;if(t&&typeof n=="string"){if(t.addDefaultProtocol&&n.startsWith("www.")){const i=n.match(/\./g);(i==null?void 0:i.length)>=2&&(n=`http://${n}`)}if(t.tryConvertEncoding)try{n=hN(n)}catch{}}const s=e?URL.parse(n,e):URL.parse(n);return oN(s)?s:null}function CS(n,e,t=!1){const s=URL.parse(n);return s?(s.hash=e,s.href):t&&ES(n,"http://example.com")?n.split("#",1)[0]+`${e?`#${e}`:""}`:""}function ie(n,e,t,s=!1){return Object.defineProperty(n,e,{value:t,enumerable:!s,configurable:!0,writable:!1}),t}const ac=function(){function e(t,s){this.message=t,this.name=s}return e.prototype=new Error,e.constructor=e,e}();class L1 extends ac{constructor(e,t){super(e,"PasswordException"),this.code=t}}class _v extends ac{constructor(e,t){super(e,"UnknownErrorException"),this.details=t}}class Ly extends ac{constructor(e){super(e,"InvalidPDFException")}}class Xg extends ac{constructor(e,t,s){super(e,"ResponseException"),this.status=t,this.missing=s}}class aN extends ac{constructor(e){super(e,"FormatError")}}class va extends ac{constructor(e){super(e,"AbortException")}}function lN(n){(typeof n!="object"||(n==null?void 0:n.length)===void 0)&&Ce("Invalid argument for bytesToString");const e=n.length,t=8192;if(e<t)return String.fromCharCode.apply(null,n);const s=[];for(let i=0;i<e;i+=t){const r=Math.min(i+t,e),a=n.subarray(i,r);s.push(String.fromCharCode.apply(null,a))}return s.join("")}function V0(n){typeof n!="string"&&Ce("Invalid argument for stringToBytes");const e=n.length,t=new Uint8Array(e);for(let s=0;s<e;++s)t[s]=n.charCodeAt(s)&255;return t}function cN(n){return String.fromCharCode(n>>24&255,n>>16&255,n>>8&255,n&255)}function uN(){const n=new Uint8Array(4);return n[0]=1,new Uint32Array(n.buffer,0,1)[0]===1}function dN(){try{return new Function(""),!0}catch{return!1}}class Nt{static get isLittleEndian(){return ie(this,"isLittleEndian",uN())}static get isEvalSupported(){return ie(this,"isEvalSupported",dN())}static get isOffscreenCanvasSupported(){return ie(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get isImageDecoderSupported(){return ie(this,"isImageDecoderSupported",typeof ImageDecoder<"u")}static get isFloat16ArraySupported(){return ie(this,"isFloat16ArraySupported",typeof Float16Array<"u")}static get isSanitizerSupported(){return ie(this,"isSanitizerSupported",typeof Sanitizer<"u")}static get platform(){const{platform:e,userAgent:t}=navigator;return ie(this,"platform",{isAndroid:t.includes("Android"),isLinux:e.includes("Linux"),isMac:e.includes("Mac"),isWindows:e.includes("Win"),isFirefox:t.includes("Firefox")})}static get isCSSRoundSupported(){var e,t;return ie(this,"isCSSRoundSupported",(t=(e=globalThis.CSS)==null?void 0:e.supports)==null?void 0:t.call(e,"width: round(1.5px, 1px)"))}}const Nv=Array.from(Array(256).keys(),n=>n.toString(16).padStart(2,"0"));var $r,$m,Dy;class z{static makeHexColor(e,t,s){return`#${Nv[e]}${Nv[t]}${Nv[s]}`}static domMatrixToTransform(e){return[e.a,e.b,e.c,e.d,e.e,e.f]}static scaleMinMax(e,t){let s;e[0]?(e[0]<0&&(s=t[0],t[0]=t[2],t[2]=s),t[0]*=e[0],t[2]*=e[0],e[3]<0&&(s=t[1],t[1]=t[3],t[3]=s),t[1]*=e[3],t[3]*=e[3]):(s=t[0],t[0]=t[1],t[1]=s,s=t[2],t[2]=t[3],t[3]=s,e[1]<0&&(s=t[1],t[1]=t[3],t[3]=s),t[1]*=e[1],t[3]*=e[1],e[2]<0&&(s=t[0],t[0]=t[2],t[2]=s),t[0]*=e[2],t[2]*=e[2]),t[0]+=e[4],t[1]+=e[5],t[2]+=e[4],t[3]+=e[5]}static transform(e,t){return[e[0]*t[0]+e[2]*t[1],e[1]*t[0]+e[3]*t[1],e[0]*t[2]+e[2]*t[3],e[1]*t[2]+e[3]*t[3],e[0]*t[4]+e[2]*t[5]+e[4],e[1]*t[4]+e[3]*t[5]+e[5]]}static multiplyByDOMMatrix(e,t){return[e[0]*t.a+e[2]*t.b,e[1]*t.a+e[3]*t.b,e[0]*t.c+e[2]*t.d,e[1]*t.c+e[3]*t.d,e[0]*t.e+e[2]*t.f+e[4],e[1]*t.e+e[3]*t.f+e[5]]}static applyTransform(e,t,s=0){const i=e[s],r=e[s+1];e[s]=i*t[0]+r*t[2]+t[4],e[s+1]=i*t[1]+r*t[3]+t[5]}static applyTransformToBezier(e,t,s=0){const i=t[0],r=t[1],a=t[2],l=t[3],c=t[4],u=t[5];for(let d=0;d<6;d+=2){const h=e[s+d],f=e[s+d+1];e[s+d]=h*i+f*a+c,e[s+d+1]=h*r+f*l+u}}static applyInverseTransform(e,t){const s=e[0],i=e[1],r=t[0]*t[3]-t[1]*t[2];e[0]=(s*t[3]-i*t[2]+t[2]*t[5]-t[4]*t[3])/r,e[1]=(-s*t[1]+i*t[0]+t[4]*t[1]-t[5]*t[0])/r}static axialAlignedBoundingBox(e,t,s){const i=t[0],r=t[1],a=t[2],l=t[3],c=t[4],u=t[5],d=e[0],h=e[1],f=e[2],p=e[3];let v=i*d+c,b=v,S=i*f+c,y=S,k=l*h+u,w=k,E=l*p+u,C=E;if(r!==0||a!==0){const T=r*d,_=r*f,P=a*h,D=a*p;v+=P,y+=P,S+=D,b+=D,k+=T,C+=T,E+=_,w+=_}s[0]=Math.min(s[0],v,S,b,y),s[1]=Math.min(s[1],k,E,w,C),s[2]=Math.max(s[2],v,S,b,y),s[3]=Math.max(s[3],k,E,w,C)}static inverseTransform(e){const t=e[0]*e[3]-e[1]*e[2];return[e[3]/t,-e[1]/t,-e[2]/t,e[0]/t,(e[2]*e[5]-e[4]*e[3])/t,(e[4]*e[1]-e[5]*e[0])/t]}static singularValueDecompose2dScale(e,t){const s=e[0],i=e[1],r=e[2],a=e[3],l=s**2+i**2,c=s*r+i*a,u=r**2+a**2,d=(l+u)/2,h=Math.sqrt(d**2-(l*u-c**2));t[0]=Math.sqrt(d+h||1),t[1]=Math.sqrt(d-h||1)}static normalizeRect(e){const t=e.slice(0);return e[0]>e[2]&&(t[0]=e[2],t[2]=e[0]),e[1]>e[3]&&(t[1]=e[3],t[3]=e[1]),t}static intersect(e,t){const s=Math.max(Math.min(e[0],e[2]),Math.min(t[0],t[2])),i=Math.min(Math.max(e[0],e[2]),Math.max(t[0],t[2]));if(s>i)return null;const r=Math.max(Math.min(e[1],e[3]),Math.min(t[1],t[3])),a=Math.min(Math.max(e[1],e[3]),Math.max(t[1],t[3]));return r>a?null:[s,r,i,a]}static pointBoundingBox(e,t,s){s[0]=Math.min(s[0],e),s[1]=Math.min(s[1],t),s[2]=Math.max(s[2],e),s[3]=Math.max(s[3],t)}static rectBoundingBox(e,t,s,i,r){r[0]=Math.min(r[0],e,s),r[1]=Math.min(r[1],t,i),r[2]=Math.max(r[2],e,s),r[3]=Math.max(r[3],t,i)}static bezierBoundingBox(e,t,s,i,r,a,l,c,u){u[0]=Math.min(u[0],e,l),u[1]=Math.min(u[1],t,c),u[2]=Math.max(u[2],e,l),u[3]=Math.max(u[3],t,c),A(this,$r,Dy).call(this,e,s,r,l,t,i,a,c,3*(-e+3*(s-r)+l),6*(e-2*s+r),3*(s-e),u),A(this,$r,Dy).call(this,e,s,r,l,t,i,a,c,3*(-t+3*(i-a)+c),6*(t-2*i+a),3*(i-t),u)}}$r=new WeakSet,$m=function(e,t,s,i,r,a,l,c,u,d){if(u<=0||u>=1)return;const h=1-u,f=u*u,p=f*u,v=h*(h*(h*e+3*u*t)+3*f*s)+p*i,b=h*(h*(h*r+3*u*a)+3*f*l)+p*c;d[0]=Math.min(d[0],v),d[1]=Math.min(d[1],b),d[2]=Math.max(d[2],v),d[3]=Math.max(d[3],b)},Dy=function(e,t,s,i,r,a,l,c,u,d,h,f){if(Math.abs(u)<1e-12){Math.abs(d)>=1e-12&&A(this,$r,$m).call(this,e,t,s,i,r,a,l,c,-h/d,f);return}const p=d**2-4*h*u;if(p<0)return;const v=Math.sqrt(p),b=2*u;A(this,$r,$m).call(this,e,t,s,i,r,a,l,c,(-d+v)/b,f),A(this,$r,$m).call(this,e,t,s,i,r,a,l,c,(-d-v)/b,f)},x(z,$r);function hN(n){return decodeURIComponent(escape(n))}let Pv=null,D1=null;function fN(n){return Pv||(Pv=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,D1=new Map([["","t"]])),n.replaceAll(Pv,(e,t,s)=>t?t.normalize("NFKC"):D1.get(s))}function TS(){if(typeof crypto.randomUUID=="function")return crypto.randomUUID();const n=new Uint8Array(32);return crypto.getRandomValues(n),lN(n)}const Ic="pdfjs_internal_id_";function pN(n,e,t){if(!Array.isArray(t)||t.length<2)return!1;const[s,i,...r]=t;if(!n(s)&&!Number.isInteger(s)||!e(i))return!1;const a=r.length;let l=!0;switch(i.name){case"XYZ":if(a<2||a>3)return!1;break;case"Fit":case"FitB":return a===0;case"FitH":case"FitBH":case"FitV":case"FitBV":if(a>1)return!1;break;case"FitR":if(a!==4)return!1;l=!1;break;default:return!1}for(const c of r)if(!(typeof c=="number"||l&&c===null))return!1;return!0}function Gt(n,e,t){return Math.min(Math.max(n,e),t)}typeof Math.sumPrecise!="function"&&(Math.sumPrecise=function(n){return n.reduce((e,t)=>e+t,0)});class Gh{static textContent(e){const t=[],s={items:t,styles:Object.create(null)};function i(r){var c;if(!r)return;let a=null;const l=r.name;if(l==="#text")a=r.value;else if(Gh.shouldBuildText(l))(c=r==null?void 0:r.attributes)!=null&&c.textContent?a=r.attributes.textContent:r.value&&(a=r.value);else return;if(a!==null&&t.push({str:a}),!!r.children)for(const u of r.children)i(u)}return i(e),s}static shouldBuildText(e){return!(e==="textarea"||e==="input"||e==="option"||e==="select")}}class _S{static setupStorage(e,t,s,i,r){const a=i.getValue(t,{value:null});switch(s.name){case"textarea":if(a.value!==null&&(e.textContent=a.value),r==="print")break;e.addEventListener("input",l=>{i.setValue(t,{value:l.target.value})});break;case"input":if(s.attributes.type==="radio"||s.attributes.type==="checkbox"){if(a.value===s.attributes.xfaOn?e.setAttribute("checked",!0):a.value===s.attributes.xfaOff&&e.removeAttribute("checked"),r==="print")break;e.addEventListener("change",l=>{i.setValue(t,{value:l.target.checked?l.target.getAttribute("xfaOn"):l.target.getAttribute("xfaOff")})})}else{if(a.value!==null&&e.setAttribute("value",a.value),r==="print")break;e.addEventListener("input",l=>{i.setValue(t,{value:l.target.value})})}break;case"select":if(a.value!==null){e.setAttribute("value",a.value);for(const l of s.children)l.attributes.value===a.value?l.attributes.selected=!0:l.attributes.hasOwnProperty("selected")&&delete l.attributes.selected}e.addEventListener("input",l=>{const c=l.target.options,u=c.selectedIndex===-1?"":c[c.selectedIndex].value;i.setValue(t,{value:u})});break}}static setAttributes({html:e,element:t,storage:s=null,intent:i,linkService:r}){const{attributes:a}=t,l=e instanceof HTMLAnchorElement;a.type==="radio"&&(a.name=`${a.name}-${i}`);for(const[c,u]of Object.entries(a))if(u!=null)switch(c){case"class":u.length&&e.setAttribute(c,u.join(" "));break;case"dataId":break;case"id":e.setAttribute("data-element-id",u);break;case"style":Object.assign(e.style,u);break;case"textContent":e.textContent=u;break;default:(!l||c!=="href"&&c!=="newWindow")&&e.setAttribute(c,u)}l&&r.addLinkAttributes(e,a.href,a.newWindow),s&&a.dataId&&this.setupStorage(e,a.dataId,t,s)}static render(e){var h,f;const t=e.annotationStorage,s=e.linkService,i=e.xfaHtml,r=e.intent||"display",a=document.createElement(i.name);i.attributes&&this.setAttributes({html:a,element:i,intent:r,linkService:s});const l=r!=="richText",c=e.div;if(c.append(a),e.viewport){const p=`matrix(${e.viewport.transform.join(",")})`;c.style.transform=p}l&&c.setAttribute("class","xfaLayer xfaFont");const u=[];if(i.children.length===0){if(i.value){const p=document.createTextNode(i.value);a.append(p),l&&Gh.shouldBuildText(i.name)&&u.push(p)}return{textDivs:u}}const d=[[i,-1,a]];for(;d.length>0;){const[p,v,b]=d.at(-1);if(v+1===p.children.length){d.pop();continue}const S=p.children[++d.at(-1)[1]];if(S===null)continue;const{name:y}=S;if(y==="#text"){const w=document.createTextNode(S.value);u.push(w),b.append(w);continue}const k=(h=S==null?void 0:S.attributes)!=null&&h.xmlns?document.createElementNS(S.attributes.xmlns,y):document.createElement(y);if(b.append(k),S.attributes&&this.setAttributes({html:k,element:S,storage:t,intent:r,linkService:s}),((f=S.children)==null?void 0:f.length)>0)d.push([S,-1,k]);else if(S.value){const w=document.createTextNode(S.value);l&&Gh.shouldBuildText(y)&&u.push(w),k.append(w)}}for(const p of c.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))p.setAttribute("readOnly",!0);return{textDivs:u}}static update(e){const t=`matrix(${e.viewport.transform.join(",")})`;e.div.style.transform=t,e.div.hidden=!1}}const Xi="http://www.w3.org/2000/svg",Ma=class Ma{};M(Ma,"CSS",96),M(Ma,"PDF",72),M(Ma,"PDF_TO_CSS_UNITS",Ma.CSS/Ma.PDF);let ya=Ma;async function Qp(n,e="text"){if(Kd(n,document.baseURI)){const t=await fetch(n);if(!t.ok)throw new Error(t.statusText);switch(e){case"arraybuffer":return t.arrayBuffer();case"blob":return t.blob();case"json":return t.json()}return t.text()}return new Promise((t,s)=>{const i=new XMLHttpRequest;i.open("GET",n,!0),i.responseType=e,i.onreadystatechange=()=>{if(i.readyState===XMLHttpRequest.DONE){if(i.status===200||i.status===0){switch(e){case"arraybuffer":case"blob":case"json":t(i.response);return}t(i.responseText);return}s(new Error(i.statusText))}},i.send(null)})}class Jp{constructor({viewBox:e,userUnit:t,scale:s,rotation:i,offsetX:r=0,offsetY:a=0,dontFlip:l=!1}){this.viewBox=e,this.userUnit=t,this.scale=s,this.rotation=i,this.offsetX=r,this.offsetY=a,s*=t;const c=(e[2]+e[0])/2,u=(e[3]+e[1])/2;let d,h,f,p;switch(i%=360,i<0&&(i+=360),i){case 180:d=-1,h=0,f=0,p=1;break;case 90:d=0,h=1,f=1,p=0;break;case 270:d=0,h=-1,f=-1,p=0;break;case 0:d=1,h=0,f=0,p=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}l&&(f=-f,p=-p);let v,b,S,y;d===0?(v=Math.abs(u-e[1])*s+r,b=Math.abs(c-e[0])*s+a,S=(e[3]-e[1])*s,y=(e[2]-e[0])*s):(v=Math.abs(c-e[0])*s+r,b=Math.abs(u-e[1])*s+a,S=(e[2]-e[0])*s,y=(e[3]-e[1])*s),this.transform=[d*s,h*s,f*s,p*s,v-d*s*c-f*s*u,b-h*s*c-p*s*u],this.width=S,this.height=y}get rawDims(){const e=this.viewBox;return ie(this,"rawDims",{pageWidth:e[2]-e[0],pageHeight:e[3]-e[1],pageX:e[0],pageY:e[1]})}clone({scale:e=this.scale,rotation:t=this.rotation,offsetX:s=this.offsetX,offsetY:i=this.offsetY,dontFlip:r=!1}={}){return new Jp({viewBox:this.viewBox.slice(),userUnit:this.userUnit,scale:e,rotation:t,offsetX:s,offsetY:i,dontFlip:r})}convertToViewportPoint(e,t){const s=[e,t];return z.applyTransform(s,this.transform),s}convertToViewportRectangle(e){const t=[e[0],e[1]];z.applyTransform(t,this.transform);const s=[e[2],e[3]];return z.applyTransform(s,this.transform),[t[0],t[1],s[0],s[1]]}convertToPdfPoint(e,t){const s=[e,t];return z.applyInverseTransform(s,this.transform),s}}class tw extends ac{constructor(e,t=0){super(e,"RenderingCancelledException"),this.extraDelay=t}}function W0(n){const e=n.length;let t=0;for(;t<e&&n[t].trim()==="";)t++;return n.substring(t,t+5).toLowerCase()==="data:"}function sw(n){return typeof n=="string"&&/\.pdf$/i.test(n)}function mN(n){return[n]=n.split(/[#?]/,1),n.substring(n.lastIndexOf("/")+1)}function gN(n,e="document.pdf"){if(typeof n!="string")return e;if(W0(n))return ne('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),e;const s=(l=>{try{return new URL(l)}catch{try{return new URL(decodeURIComponent(l))}catch{try{return new URL(l,"https://foo.bar")}catch{try{return new URL(decodeURIComponent(l),"https://foo.bar")}catch{return null}}}}})(n);if(!s)return e;const i=l=>{try{let c=decodeURIComponent(l);return c.includes("/")?(c=c.split("/").at(-1),c.test(/^\.pdf$/i)?c:l):c}catch{return l}},r=/\.pdf$/i,a=s.pathname.split("/").at(-1);if(r.test(a))return i(a);if(s.searchParams.size>0){const l=Array.from(s.searchParams.values()).reverse();for(const u of l)if(r.test(u))return i(u);const c=Array.from(s.searchParams.keys()).reverse();for(const u of c)if(r.test(u))return i(u)}if(s.hash){const c=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i.exec(s.hash);if(c)return i(c[0])}return e}class I1{constructor(){M(this,"started",Object.create(null));M(this,"times",[])}time(e){e in this.started&&ne(`Timer is already running for ${e}`),this.started[e]=Date.now()}timeEnd(e){e in this.started||ne(`Timer has not been started for ${e}`),this.times.push({name:e,start:this.started[e],end:Date.now()}),delete this.started[e]}toString(){const e=[];let t=0;for(const{name:s}of this.times)t=Math.max(s.length,t);for(const{name:s,start:i,end:r}of this.times)e.push(`${s.padEnd(t)} ${r-i}ms
`);return e.join("")}}function Kd(n,e){const t=e?URL.parse(n,e):URL.parse(n);return(t==null?void 0:t.protocol)==="http:"||(t==null?void 0:t.protocol)==="https:"}function zn(n){n.preventDefault()}function ut(n){n.preventDefault(),n.stopPropagation()}function vN(n){console.log("Deprecated API usage: "+n)}var Qh;class Yg{static toDateObject(e){if(e instanceof Date)return e;if(!e||typeof e!="string")return null;o(this,Qh)||m(this,Qh,new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const t=o(this,Qh).exec(e);if(!t)return null;const s=parseInt(t[1],10);let i=parseInt(t[2],10);i=i>=1&&i<=12?i-1:0;let r=parseInt(t[3],10);r=r>=1&&r<=31?r:1;let a=parseInt(t[4],10);a=a>=0&&a<=23?a:0;let l=parseInt(t[5],10);l=l>=0&&l<=59?l:0;let c=parseInt(t[6],10);c=c>=0&&c<=59?c:0;const u=t[7]||"Z";let d=parseInt(t[8],10);d=d>=0&&d<=23?d:0;let h=parseInt(t[9],10)||0;return h=h>=0&&h<=59?h:0,u==="-"?(a+=d,l+=h):u==="+"&&(a-=d,l-=h),new Date(Date.UTC(s,i,r,a,l,c))}}Qh=new WeakMap,x(Yg,Qh);function yN(n,{scale:e=1,rotation:t=0}){const{width:s,height:i}=n.attributes.style,r=[0,0,parseInt(s),parseInt(i)];return new Jp({viewBox:r,userUnit:1,scale:e,rotation:t})}function Zp(n){if(n.startsWith("#")){const e=parseInt(n.slice(1),16);return[(e&16711680)>>16,(e&65280)>>8,e&255]}return n.startsWith("rgb(")?n.slice(4,-1).split(",").map(e=>parseInt(e)):n.startsWith("rgba(")?n.slice(5,-1).split(",").map(e=>parseInt(e)).slice(0,3):(ne(`Not a valid color format: "${n}"`),[0,0,0])}function xN(n){const e=document.createElement("span");e.style.visibility="hidden",e.style.colorScheme="only light",document.body.append(e);for(const t of n.keys()){e.style.color=t;const s=window.getComputedStyle(e).color;n.set(t,Zp(s))}e.remove()}function et(n){const{a:e,b:t,c:s,d:i,e:r,f:a}=n.getTransform();return[e,t,s,i,r,a]}function fi(n){const{a:e,b:t,c:s,d:i,e:r,f:a}=n.getTransform().invertSelf();return[e,t,s,i,r,a]}function sc(n,e,t=!1,s=!0){if(e instanceof Jp){const{pageWidth:i,pageHeight:r}=e.rawDims,{style:a}=n,l=Nt.isCSSRoundSupported,c=`var(--total-scale-factor) * ${i}px`,u=`var(--total-scale-factor) * ${r}px`,d=l?`round(down, ${c}, var(--scale-round-x))`:`calc(${c})`,h=l?`round(down, ${u}, var(--scale-round-y))`:`calc(${u})`;!t||e.rotation%180===0?(a.width=d,a.height=h):(a.width=h,a.height=d)}s&&n.setAttribute("data-main-rotation",e.rotation)}class $i{constructor(){const{pixelRatio:e}=$i;this.sx=e,this.sy=e}get scaled(){return this.sx!==1||this.sy!==1}get symmetric(){return this.sx===this.sy}limitCanvas(e,t,s,i,r=-1){let a=1/0,l=1/0,c=1/0;s=$i.capPixels(s,r),s>0&&(a=Math.sqrt(s/(e*t))),i!==-1&&(l=i/e,c=i/t);const u=Math.min(a,l,c);return this.sx>u||this.sy>u?(this.sx=u,this.sy=u,!0):!1}static get pixelRatio(){return globalThis.devicePixelRatio||1}static capPixels(e,t){if(t>=0){const s=Math.ceil(window.screen.availWidth*window.screen.availHeight*this.pixelRatio**2*(1+t/100));return e>0?Math.min(e,s):s}return e}}const Iy=["image/apng","image/avif","image/bmp","image/gif","image/jpeg","image/png","image/svg+xml","image/webp","image/x-icon"];class bN{static get isDarkMode(){var e;return ie(this,"isDarkMode",!!((e=window==null?void 0:window.matchMedia)!=null&&e.call(window,"(prefers-color-scheme: dark)").matches))}}class wN{static get commentForegroundColor(){const e=document.createElement("span");e.classList.add("comment","sidebar");const{style:t}=e;t.width=t.height="0",t.display="none",t.color="var(--comment-fg-color)",document.body.append(e);const{color:s}=window.getComputedStyle(e);return e.remove(),ie(this,"commentForegroundColor",Zp(s))}}function AN(n,e,t,s){s=Math.min(Math.max(s??1,0),1);const i=255*(1-s);return n=Math.round(n*s+i),e=Math.round(e*s+i),t=Math.round(t*s+i),[n,e,t]}function R1(n,e){const t=n[0]/255,s=n[1]/255,i=n[2]/255,r=Math.max(t,s,i),a=Math.min(t,s,i),l=(r+a)/2;if(r===a)e[0]=e[1]=0;else{const c=r-a;switch(e[1]=l<.5?c/(r+a):c/(2-r-a),r){case t:e[0]=((s-i)/c+(s<i?6:0))*60;break;case s:e[0]=((i-t)/c+2)*60;break;case i:e[0]=((t-s)/c+4)*60;break}}e[2]=l}function Ry(n,e){const t=n[0],s=n[1],i=n[2],r=(1-Math.abs(2*i-1))*s,a=r*(1-Math.abs(t/60%2-1)),l=i-r/2;switch(Math.floor(t/60)){case 0:e[0]=r+l,e[1]=a+l,e[2]=l;break;case 1:e[0]=a+l,e[1]=r+l,e[2]=l;break;case 2:e[0]=l,e[1]=r+l,e[2]=a+l;break;case 3:e[0]=l,e[1]=a+l,e[2]=r+l;break;case 4:e[0]=a+l,e[1]=l,e[2]=r+l;break;case 5:case 6:e[0]=r+l,e[1]=l,e[2]=a+l;break}}function F1(n){return n<=.03928?n/12.92:((n+.055)/1.055)**2.4}function j1(n,e,t){Ry(n,t),t.map(F1);const s=.2126*t[0]+.7152*t[1]+.0722*t[2];Ry(e,t),t.map(F1);const i=.2126*t[0]+.7152*t[1]+.0722*t[2];return s>i?(s+.05)/(i+.05):(i+.05)/(s+.05)}const O1=new Map;function kN(n,e){const t=n[0]+n[1]*256+n[2]*65536+e[0]*16777216+e[1]*4294967296+e[2]*1099511627776;let s=O1.get(t);if(s)return s;const i=new Float32Array(9),r=i.subarray(0,3),a=i.subarray(3,6);R1(n,a);const l=i.subarray(6,9);R1(e,l);const c=l[2]<.5,u=c?12:4.5;if(a[2]=c?Math.sqrt(a[2]):1-Math.sqrt(1-a[2]),j1(a,l,r)<u){let d,h;c?(d=a[2],h=1):(d=0,h=a[2]);const f=.005;for(;h-d>f;){const p=a[2]=(d+h)/2;c===j1(a,l,r)<u?d=p:h=p}a[2]=c?h:d}return Ry(a,r),s=z.makeHexColor(Math.round(r[0]*255),Math.round(r[1]*255),Math.round(r[2]*255)),O1.set(t,s),s}function NS({html:n,dir:e,className:t},s){const i=document.createDocumentFragment();if(typeof n=="string"){const r=document.createElement("p");r.dir=e||"auto";const a=n.split(/(?:\r\n?|\n)/);for(let l=0,c=a.length;l<c;++l){const u=a[l];r.append(document.createTextNode(u)),l<c-1&&r.append(document.createElement("br"))}i.append(r)}else _S.render({xfaHtml:n,div:i,intent:"richText"});i.firstElementChild.classList.add("richText",t),s.append(i)}function PS(n){const e=new Path2D;if(!n)return e;for(let t=0,s=n.length;t<s;)switch(n[t++]){case Ud.moveTo:e.moveTo(n[t++],n[t++]);break;case Ud.lineTo:e.lineTo(n[t++],n[t++]);break;case Ud.curveTo:e.bezierCurveTo(n[t++],n[t++],n[t++],n[t++],n[t++],n[t++]);break;case Ud.quadraticCurveTo:e.quadraticCurveTo(n[t++],n[t++],n[t++],n[t++]);break;case Ud.closePath:e.closePath();break;default:ne(`Unrecognized drawing path operator: ${n[t-1]}`);break}return e}var tr,Xn,Xc,uo,ja,Cd,MS,LS;const ye=class ye{constructor(){x(this,Cd)}get pagesNumber(){return o(ye,uo)}set pagesNumber(e){o(ye,uo)!==e&&(m(ye,uo,e),e===0&&(m(ye,Xn,null),m(ye,tr,null)))}addListener(e){o(ye,ja).push(e)}removeListener(e){const t=o(ye,ja).indexOf(e);t>=0&&o(ye,ja).splice(t,1)}movePages(e,t,s){A(this,Cd,LS).call(this,!0);const i=o(ye,Xn),r=o(ye,tr);o(ye,Xc).set(r);const a=t.length,l=new Uint32Array(a);let c=0;for(let p=0;p<a;p++){const v=t[p]-1;l[p]=i[v],v<s&&(c+=1)}const u=o(ye,uo);let d=s-c;const h=u-a;d=Gt(d,0,h);for(let p=0,v=0;p<u;p++)e.has(p+1)||(i[v++]=i[p]);i.copyWithin(d+a,d,h),i.set(l,d);let f=!1;for(let p=0,v=u;p<v;p++){const b=i[p];f||(f=b!==p+1),r[b-1]=p+1}A(this,Cd,MS).call(this),f||(this.pagesNumber=0)}hasBeenAltered(){return o(ye,Xn)!==null}getPageMappingForSaving(){return{pageIndices:o(ye,tr)?o(ye,tr).map(e=>e-1):null}}getPrevPageNumber(e){return o(ye,Xc)[o(ye,Xn)[e-1]-1]}getPageNumber(e){var t;return((t=o(ye,tr))==null?void 0:t[e-1])??e}getPageId(e){var t;return((t=o(ye,Xn))==null?void 0:t[e-1])??e}static get instance(){return ie(this,"instance",new ye)}getMapping(){return o(ye,Xn).subarray(0,this.pagesNumber)}};tr=new WeakMap,Xn=new WeakMap,Xc=new WeakMap,uo=new WeakMap,ja=new WeakMap,Cd=new WeakSet,MS=function(){for(const e of o(ye,ja))e()},LS=function(e){if(o(ye,Xn))return;const t=o(ye,uo),s=new Uint32Array(3*t),i=m(ye,Xn,s.subarray(0,t)),r=m(ye,tr,s.subarray(t,2*t));if(e)for(let a=0;a<t;a++)i[a]=r[a]=a+1;m(ye,Xc,s.subarray(2*t))},x(ye,tr,null),x(ye,Xn,null),x(ye,Xc,null),x(ye,uo,0),x(ye,ja,[]);let Xh=ye;var ho,fo,yn,xn,Jh,po,Yc,qc,Zh,o0,DS,qt,IS,RS,mc,Qd;const Qi=class Qi{constructor(e){x(this,qt);x(this,ho,null);x(this,fo,null);x(this,yn);x(this,xn,null);x(this,Jh,null);x(this,po,null);x(this,Yc,null);x(this,qc,null);m(this,yn,e),o(Qi,Zh)||m(Qi,Zh,Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button",signature:"pdfjs-editor-remove-signature-button"}))}render(){const e=m(this,ho,document.createElement("div"));e.classList.add("editToolbar","hidden"),e.setAttribute("role","toolbar");const t=o(this,yn)._uiManager._signal;t instanceof AbortSignal&&!t.aborted&&(e.addEventListener("contextmenu",zn,{signal:t}),e.addEventListener("pointerdown",A(Qi,o0,DS),{signal:t}));const s=m(this,xn,document.createElement("div"));s.className="buttons",e.append(s);const i=o(this,yn).toolbarPosition;if(i){const{style:r}=e,a=o(this,yn)._uiManager.direction==="ltr"?1-i[0]:i[0];r.insetInlineEnd=`${100*a}%`,r.top=`calc(${100*i[1]}% + var(--editor-toolbar-vert-offset))`}return e}get div(){return o(this,ho)}hide(){var e;o(this,ho).classList.add("hidden"),(e=o(this,fo))==null||e.hideDropdown()}show(){var e,t;o(this,ho).classList.remove("hidden"),(e=o(this,Jh))==null||e.shown(),(t=o(this,po))==null||t.shown()}addDeleteButton(){const{editorType:e,_uiManager:t}=o(this,yn),s=document.createElement("button");s.classList.add("basic","deleteButton"),s.tabIndex=0,s.setAttribute("data-l10n-id",o(Qi,Zh)[e]),A(this,qt,mc).call(this,s)&&s.addEventListener("click",i=>{t.delete()},{signal:t._signal}),o(this,xn).append(s)}async addAltText(e){const t=await e.render();A(this,qt,mc).call(this,t),o(this,xn).append(t,o(this,qt,Qd)),m(this,Jh,e)}addComment(e,t=null){if(o(this,po))return;const s=e.renderForToolbar();if(!s)return;A(this,qt,mc).call(this,s);const i=m(this,Yc,o(this,qt,Qd));t?(o(this,xn).insertBefore(s,t),o(this,xn).insertBefore(i,t)):o(this,xn).append(s,i),m(this,po,e),e.toolbar=this}addColorPicker(e){if(o(this,fo))return;m(this,fo,e);const t=e.renderButton();A(this,qt,mc).call(this,t),o(this,xn).append(t,o(this,qt,Qd))}async addEditSignatureButton(e){const t=m(this,qc,await e.renderEditButton(o(this,yn)));A(this,qt,mc).call(this,t),o(this,xn).append(t,o(this,qt,Qd))}removeButton(e){var t,s;switch(e){case"comment":(t=o(this,po))==null||t.removeToolbarCommentButton(),m(this,po,null),(s=o(this,Yc))==null||s.remove(),m(this,Yc,null);break}}async addButton(e,t){switch(e){case"colorPicker":t&&this.addColorPicker(t);break;case"altText":t&&await this.addAltText(t);break;case"editSignature":t&&await this.addEditSignatureButton(t);break;case"delete":this.addDeleteButton();break;case"comment":t&&this.addComment(t);break}}async addButtonBefore(e,t,s){if(!t&&e==="comment")return;const i=o(this,xn).querySelector(s);i&&e==="comment"&&this.addComment(t,i)}updateEditSignatureButton(e){o(this,qc)&&(o(this,qc).title=e)}remove(){var e;o(this,ho).remove(),(e=o(this,fo))==null||e.destroy(),m(this,fo,null)}};ho=new WeakMap,fo=new WeakMap,yn=new WeakMap,xn=new WeakMap,Jh=new WeakMap,po=new WeakMap,Yc=new WeakMap,qc=new WeakMap,Zh=new WeakMap,o0=new WeakSet,DS=function(e){e.stopPropagation()},qt=new WeakSet,IS=function(e){o(this,yn)._focusEventsAllowed=!1,ut(e)},RS=function(e){o(this,yn)._focusEventsAllowed=!0,ut(e)},mc=function(e){const t=o(this,yn)._uiManager._signal;return!(t instanceof AbortSignal)||t.aborted?!1:(e.addEventListener("focusin",A(this,qt,IS).bind(this),{capture:!0,signal:t}),e.addEventListener("focusout",A(this,qt,RS).bind(this),{capture:!0,signal:t}),e.addEventListener("contextmenu",zn,{signal:t}),!0)},Qd=function(){const e=document.createElement("div");return e.className="divider",e},x(Qi,o0),x(Qi,Zh,null);let Fy=Qi;var ef,Oa,sr,Kr,FS,jS,jy;class SN{constructor(e){x(this,Kr);x(this,ef,null);x(this,Oa,null);x(this,sr);m(this,sr,e)}show(e,t,s){const[i,r]=A(this,Kr,jS).call(this,t,s),{style:a}=o(this,Oa)||m(this,Oa,A(this,Kr,FS).call(this));e.append(o(this,Oa)),a.insetInlineEnd=`${100*i}%`,a.top=`calc(${100*r}% + var(--editor-toolbar-vert-offset))`}hide(){o(this,Oa).remove()}}ef=new WeakMap,Oa=new WeakMap,sr=new WeakMap,Kr=new WeakSet,FS=function(){const e=m(this,Oa,document.createElement("div"));e.className="editToolbar",e.setAttribute("role","toolbar");const t=o(this,sr)._signal;t instanceof AbortSignal&&!t.aborted&&e.addEventListener("contextmenu",zn,{signal:t});const s=m(this,ef,document.createElement("div"));return s.className="buttons",e.append(s),o(this,sr).hasCommentManager()&&A(this,Kr,jy).call(this,"commentButton","pdfjs-comment-floating-button","pdfjs-comment-floating-button-label",()=>{o(this,sr).commentSelection("floating_button")}),A(this,Kr,jy).call(this,"highlightButton","pdfjs-highlight-floating-button1","pdfjs-highlight-floating-button-label",()=>{o(this,sr).highlightSelection("floating_button")}),e},jS=function(e,t){let s=0,i=0;for(const r of e){const a=r.y+r.height;if(a<s)continue;const l=r.x+(t?r.width:0);if(a>s){i=l,s=a;continue}t?l>i&&(i=l):l<i&&(i=l)}return[t?1-i:i,s]},jy=function(e,t,s,i){const r=document.createElement("button");r.classList.add("basic",e),r.tabIndex=0,r.setAttribute("data-l10n-id",t);const a=document.createElement("span");r.append(a),a.className="visuallyHidden",a.setAttribute("data-l10n-id",s);const l=o(this,sr)._signal;l instanceof AbortSignal&&!l.aborted&&(r.addEventListener("contextmenu",zn,{signal:l}),r.addEventListener("click",i,{signal:l})),o(this,ef).append(r)};function OS(n,e,t){for(const s of t)e.addEventListener(s,n[s].bind(n))}var Ba,za,Kc,Ua;const De=class De{static initializeAndAddPointerId(e){(o(De,za)||m(De,za,new Set)).add(e)}static setPointer(e,t){o(De,Ba)||m(De,Ba,t),o(De,Ua)??m(De,Ua,e)}static setTimeStamp(e){m(De,Kc,e)}static isSamePointerId(e){return o(De,Ba)===e}static isSamePointerIdOrRemove(e){var t;return o(De,Ba)===e?!0:((t=o(De,za))==null||t.delete(e),!1)}static isSamePointerType(e){return o(De,Ua)===e}static isInitializedAndDifferentPointerType(e){return o(De,Ua)!==null&&!De.isSamePointerType(e)}static isSameTimeStamp(e){return o(De,Kc)===e}static isUsingMultiplePointers(){var e;return((e=o(De,za))==null?void 0:e.size)>=1}static clearPointerType(){m(De,Ua,null)}static clearPointerIds(){m(De,Ba,NaN),m(De,za,null)}static clearTimeStamp(){m(De,Kc,NaN)}};Ba=new WeakMap,za=new WeakMap,Kc=new WeakMap,Ua=new WeakMap,x(De,Ba,NaN),x(De,za,null),x(De,Kc,NaN),x(De,Ua,null);let ts=De;var a0;class EN{constructor(){x(this,a0,0)}get id(){return`${Vh}${At(this,a0)._++}`}}a0=new WeakMap;var Qc,tf,ss,Jc,Vm;const uw=class uw{constructor(){x(this,Jc);x(this,Qc,TS());x(this,tf,0);x(this,ss,null)}static get _isSVGFittingCanvas(){const e='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',s=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),i=new Image;i.src=e;const r=i.decode().then(()=>(s.drawImage(i,0,0,1,1,0,0,1,3),new Uint32Array(s.getImageData(0,0,1,1).data.buffer)[0]===0));return ie(this,"_isSVGFittingCanvas",r)}async getFromFile(e){const{lastModified:t,name:s,size:i,type:r}=e;return A(this,Jc,Vm).call(this,`${t}_${s}_${i}_${r}`,e)}async getFromUrl(e){return A(this,Jc,Vm).call(this,e,e)}async getFromBlob(e,t){const s=await t;return A(this,Jc,Vm).call(this,e,s)}async getFromId(e){o(this,ss)||m(this,ss,new Map);const t=o(this,ss).get(e);if(!t)return null;if(t.bitmap)return t.refCounter+=1,t;if(t.file)return this.getFromFile(t.file);if(t.blobPromise){const{blobPromise:s}=t;return delete t.blobPromise,this.getFromBlob(t.id,s)}return this.getFromUrl(t.url)}getFromCanvas(e,t){o(this,ss)||m(this,ss,new Map);let s=o(this,ss).get(e);if(s!=null&&s.bitmap)return s.refCounter+=1,s;const i=new OffscreenCanvas(t.width,t.height);return i.getContext("2d").drawImage(t,0,0),s={bitmap:i.transferToImageBitmap(),id:`image_${o(this,Qc)}_${At(this,tf)._++}`,refCounter:1,isSvg:!1},o(this,ss).set(e,s),o(this,ss).set(s.id,s),s}getSvgUrl(e){const t=o(this,ss).get(e);return t!=null&&t.isSvg?t.svgUrl:null}deleteId(e){var i;o(this,ss)||m(this,ss,new Map);const t=o(this,ss).get(e);if(!t||(t.refCounter-=1,t.refCounter!==0))return;const{bitmap:s}=t;if(!t.url&&!t.file){const r=new OffscreenCanvas(s.width,s.height);r.getContext("bitmaprenderer").transferFromImageBitmap(s),t.blobPromise=r.convertToBlob()}(i=s.close)==null||i.call(s),t.bitmap=null}isValidId(e){return e.startsWith(`image_${o(this,Qc)}_`)}};Qc=new WeakMap,tf=new WeakMap,ss=new WeakMap,Jc=new WeakSet,Vm=async function(e,t){o(this,ss)||m(this,ss,new Map);let s=o(this,ss).get(e);if(s===null)return null;if(s!=null&&s.bitmap)return s.refCounter+=1,s;try{s||(s={bitmap:null,id:`image_${o(this,Qc)}_${At(this,tf)._++}`,refCounter:0,isSvg:!1});let i;if(typeof t=="string"?(s.url=t,i=await Qp(t,"blob")):t instanceof File?i=s.file=t:t instanceof Blob&&(i=t),i.type==="image/svg+xml"){const r=uw._isSVGFittingCanvas,a=new FileReader,l=new Image,c=new Promise((u,d)=>{l.onload=()=>{s.bitmap=l,s.isSvg=!0,u()},a.onload=async()=>{const h=s.svgUrl=a.result;l.src=await r?`${h}#svgView(preserveAspectRatio(none))`:h},l.onerror=a.onerror=d});a.readAsDataURL(i),await c}else s.bitmap=await createImageBitmap(i);s.refCounter=1}catch(i){ne(i),s=null}return o(this,ss).set(e,s),s&&o(this,ss).set(s.id,s),s};let Oy=uw;var ft,mo,sf,Je;class CN{constructor(e=128){x(this,ft,[]);x(this,mo,!1);x(this,sf);x(this,Je,-1);m(this,sf,e)}add({cmd:e,undo:t,post:s,mustExec:i,type:r=NaN,overwriteIfSameType:a=!1,keepUndo:l=!1}){if(i&&e(),o(this,mo))return;const c={cmd:e,undo:t,post:s,type:r};if(o(this,Je)===-1){o(this,ft).length>0&&(o(this,ft).length=0),m(this,Je,0),o(this,ft).push(c);return}if(a&&o(this,ft)[o(this,Je)].type===r){l&&(c.undo=o(this,ft)[o(this,Je)].undo),o(this,ft)[o(this,Je)]=c;return}const u=o(this,Je)+1;u===o(this,sf)?o(this,ft).splice(0,1):(m(this,Je,u),u<o(this,ft).length&&o(this,ft).splice(u)),o(this,ft).push(c)}undo(){if(o(this,Je)===-1)return;m(this,mo,!0);const{undo:e,post:t}=o(this,ft)[o(this,Je)];e(),t==null||t(),m(this,mo,!1),m(this,Je,o(this,Je)-1)}redo(){if(o(this,Je)<o(this,ft).length-1){m(this,Je,o(this,Je)+1),m(this,mo,!0);const{cmd:e,post:t}=o(this,ft)[o(this,Je)];e(),t==null||t(),m(this,mo,!1)}}hasSomethingToUndo(){return o(this,Je)!==-1}hasSomethingToRedo(){return o(this,Je)<o(this,ft).length-1}cleanType(e){if(o(this,Je)!==-1){for(let t=o(this,Je);t>=0;t--)if(o(this,ft)[t].type!==e){o(this,ft).splice(t+1,o(this,Je)-t),m(this,Je,t);return}o(this,ft).length=0,m(this,Je,-1)}}destroy(){m(this,ft,null)}}ft=new WeakMap,mo=new WeakMap,sf=new WeakMap,Je=new WeakMap;var l0,BS;class em{constructor(e){x(this,l0);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:t}=Nt.platform;for(const[s,i,r={}]of e)for(const a of s){const l=a.startsWith("mac+");t&&l?(this.callbacks.set(a.slice(4),{callback:i,options:r}),this.allKeys.add(a.split("+").at(-1))):!t&&!l&&(this.callbacks.set(a,{callback:i,options:r}),this.allKeys.add(a.split("+").at(-1)))}}exec(e,t){if(!this.allKeys.has(t.key))return;const s=this.callbacks.get(A(this,l0,BS).call(this,t));if(!s)return;const{callback:i,options:{bubbles:r=!1,args:a=[],checker:l=null}}=s;l&&!l(e,t)||(i.bind(e,...a,t)(),r||ut(t))}}l0=new WeakSet,BS=function(e){e.altKey&&this.buffer.push("alt"),e.ctrlKey&&this.buffer.push("ctrl"),e.metaKey&&this.buffer.push("meta"),e.shiftKey&&this.buffer.push("shift"),this.buffer.push(e.key);const t=this.buffer.join("+");return this.buffer.length=0,t};const c0=class c0{get _colors(){const e=new Map([["CanvasText",null],["Canvas",null]]);return xN(e),ie(this,"_colors",e)}convert(e){const t=Zp(e);if(!window.matchMedia("(forced-colors: active)").matches)return t;for(const[s,i]of this._colors)if(i.every((r,a)=>r===t[a]))return c0._colorsMapping.get(s);return t}getHexCode(e){const t=this._colors.get(e);return t?z.makeHexColor(...t):e}};M(c0,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]));let By=c0;var Zc,Bs,eu,Ze,pt,tu,bn,su,wn,ns,go,vo,nu,yo,vi,An,Ha,nf,rf,iu,of,yi,xo,ru,bo,xi,u0,wo,ou,af,Ao,$a,au,ko,lf,xt,Ne,nr,So,Eo,cf,lu,uf,Co,bi,ir,df,hf,kn,O,Wm,zy,zS,US,Jd,HS,$S,VS,Uy,WS,GS,XS,YS,cs,Yi,qS,KS,Hy,QS,Zd,$y;const Fc=class Fc{constructor(e,t,s,i,r,a,l,c,u,d,h,f,p,v,b,S){x(this,O);x(this,Zc,new AbortController);x(this,Bs,null);x(this,eu,null);x(this,Ze,new Map);x(this,pt,new Map);x(this,tu,null);x(this,bn,null);x(this,su,null);x(this,wn,new CN);x(this,ns,null);x(this,go,null);x(this,vo,null);x(this,nu,0);x(this,yo,new Set);x(this,vi,null);x(this,An,null);x(this,Ha,new Set);M(this,"_editorUndoBar",null);x(this,nf,!1);x(this,rf,!1);x(this,iu,!1);x(this,of,null);x(this,yi,null);x(this,xo,null);x(this,ru,null);x(this,bo,!1);x(this,xi,null);x(this,u0,new EN);x(this,wo,!1);x(this,ou,!1);x(this,af,!1);x(this,Ao,null);x(this,$a,null);x(this,au,null);x(this,ko,null);x(this,lf,null);x(this,xt,oe.NONE);x(this,Ne,new Set);x(this,nr,null);x(this,So,null);x(this,Eo,null);x(this,cf,null);x(this,lu,null);x(this,uf,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1});x(this,Co,[0,0]);x(this,bi,null);x(this,ir,null);x(this,df,null);x(this,hf,null);x(this,kn,null);const y=this._signal=o(this,Zc).signal;m(this,ir,e),m(this,df,t),m(this,hf,s),m(this,tu,i),m(this,ns,r),m(this,So,a),m(this,lu,c),this._eventBus=l,l._on("editingaction",this.onEditingAction.bind(this),{signal:y}),l._on("pagechanging",this.onPageChanging.bind(this),{signal:y}),l._on("scalechanging",this.onScaleChanging.bind(this),{signal:y}),l._on("rotationchanging",this.onRotationChanging.bind(this),{signal:y}),l._on("setpreference",this.onSetPreference.bind(this),{signal:y}),l._on("switchannotationeditorparams",k=>this.updateParams(k.type,k.value),{signal:y}),l._on("pagesedited",this.onPagesEdited.bind(this),{signal:y}),window.addEventListener("pointerdown",()=>{m(this,ou,!0)},{capture:!0,signal:y}),window.addEventListener("pointerup",()=>{m(this,ou,!1)},{capture:!0,signal:y}),A(this,O,HS).call(this),A(this,O,YS).call(this),A(this,O,Uy).call(this),m(this,bn,c.annotationStorage),m(this,of,c.filterFactory),m(this,Eo,u),m(this,ru,d||null),m(this,nf,h),m(this,rf,f),m(this,iu,p),m(this,lf,v||null),this.viewParameters={realScale:ya.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1,this._editorUndoBar=b||null,this._supportsPinchToZoom=S!==!1,r==null||r.setSidebarUiManager(this)}static get _keyboardManager(){const e=Fc.prototype,t=a=>o(a,ir).contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&a.hasSomethingToControl(),s=(a,{target:l})=>{if(l instanceof HTMLInputElement){const{type:c}=l;return c!=="text"&&c!=="number"}return!0},i=this.TRANSLATE_SMALL,r=this.TRANSLATE_BIG;return ie(this,"_keyboardManager",new em([[["ctrl+a","mac+meta+a"],e.selectAll,{checker:s}],[["ctrl+z","mac+meta+z"],e.undo,{checker:s}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],e.redo,{checker:s}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],e.delete,{checker:s}],[["Enter","mac+Enter"],e.addNewEditorFromKeyboard,{checker:(a,{target:l})=>!(l instanceof HTMLButtonElement)&&o(a,ir).contains(l)&&!a.isEnterHandled}],[[" ","mac+ "],e.addNewEditorFromKeyboard,{checker:(a,{target:l})=>!(l instanceof HTMLButtonElement)&&o(a,ir).contains(document.activeElement)}],[["Escape","mac+Escape"],e.unselectAll],[["ArrowLeft","mac+ArrowLeft"],e.translateSelectedEditors,{args:[-i,0],checker:t}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e.translateSelectedEditors,{args:[-r,0],checker:t}],[["ArrowRight","mac+ArrowRight"],e.translateSelectedEditors,{args:[i,0],checker:t}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e.translateSelectedEditors,{args:[r,0],checker:t}],[["ArrowUp","mac+ArrowUp"],e.translateSelectedEditors,{args:[0,-i],checker:t}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e.translateSelectedEditors,{args:[0,-r],checker:t}],[["ArrowDown","mac+ArrowDown"],e.translateSelectedEditors,{args:[0,i],checker:t}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e.translateSelectedEditors,{args:[0,r],checker:t}]]))}destroy(){var e,t,s,i,r,a,l,c,u;(e=o(this,kn))==null||e.resolve(),m(this,kn,null),(t=o(this,Zc))==null||t.abort(),m(this,Zc,null),this._signal=null;for(const d of o(this,pt).values())d.destroy();o(this,pt).clear(),o(this,Ze).clear(),o(this,Ha).clear(),(s=o(this,ko))==null||s.clear(),m(this,Bs,null),o(this,Ne).clear(),o(this,wn).destroy(),(i=o(this,tu))==null||i.destroy(),(r=o(this,ns))==null||r.destroy(),(a=o(this,So))==null||a.destroy(),(l=o(this,xi))==null||l.hide(),m(this,xi,null),(c=o(this,au))==null||c.destroy(),m(this,au,null),m(this,eu,null),o(this,yi)&&(clearTimeout(o(this,yi)),m(this,yi,null)),o(this,bi)&&(clearTimeout(o(this,bi)),m(this,bi,null)),(u=this._editorUndoBar)==null||u.destroy(),m(this,lu,null)}combinedSignal(e){return AbortSignal.any([this._signal,e.signal])}get mlManager(){return o(this,lf)}get useNewAltTextFlow(){return o(this,rf)}get useNewAltTextWhenAddingImage(){return o(this,iu)}get hcmFilter(){return ie(this,"hcmFilter",o(this,Eo)?o(this,of).addHCMFilter(o(this,Eo).foreground,o(this,Eo).background):"none")}get direction(){return ie(this,"direction",getComputedStyle(o(this,ir)).direction)}get _highlightColors(){return ie(this,"_highlightColors",o(this,ru)?new Map(o(this,ru).split(",").map(e=>(e=e.split("=").map(t=>t.trim()),e[1]=e[1].toUpperCase(),e))):null)}get highlightColors(){const{_highlightColors:e}=this;if(!e)return ie(this,"highlightColors",null);const t=new Map,s=!!o(this,Eo);for(const[i,r]of e){const a=i.endsWith("_HCM");if(s&&a){t.set(i.replace("_HCM",""),r);continue}!s&&!a&&t.set(i,r)}return ie(this,"highlightColors",t)}get highlightColorNames(){return ie(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,e=>e.reverse())):null)}getNonHCMColor(e){if(!this._highlightColors)return e;const t=this.highlightColorNames.get(e);return this._highlightColors.get(t)||e}getNonHCMColorName(e){return this.highlightColorNames.get(e)||e}setCurrentDrawingSession(e){e?(this.unselectAll(),this.disableUserSelect(!0)):this.disableUserSelect(!1),m(this,vo,e)}setMainHighlightColorPicker(e){m(this,au,e)}editAltText(e,t=!1){var s;(s=o(this,tu))==null||s.editAltText(this,e,t)}hasCommentManager(){return!!o(this,ns)}editComment(e,t,s,i){var r;(r=o(this,ns))==null||r.showDialog(this,e,t,s,i)}selectComment(e,t){const s=o(this,pt).get(e),i=s==null?void 0:s.getEditorByUID(t);i==null||i.toggleComment(!0,!0)}updateComment(e){var t;(t=o(this,ns))==null||t.updateComment(e.getData())}updatePopupColor(e){var t;(t=o(this,ns))==null||t.updatePopupColor(e)}removeComment(e){var t;(t=o(this,ns))==null||t.removeComments([e.uid])}deleteComment(e,t){const s=()=>{e.comment=t},i=()=>{var r;(r=this._editorUndoBar)==null||r.show(s,"comment"),this.toggleComment(null),e.comment=null};this.addCommands({cmd:i,undo:s,mustExec:!0})}toggleComment(e,t,s=void 0){var i;(i=o(this,ns))==null||i.toggleCommentPopup(e,t,s)}makeCommentColor(e,t){var s;return e&&((s=o(this,ns))==null?void 0:s.makeCommentColor(e,t))||null}getCommentDialogElement(){var e;return((e=o(this,ns))==null?void 0:e.dialogElement)||null}async waitForEditorsRendered(e){if(o(this,pt).has(e-1))return;const{resolve:t,promise:s}=Promise.withResolvers(),i=r=>{r.pageNumber===e&&(this._eventBus._off("editorsrendered",i),t())};this._eventBus.on("editorsrendered",i),await s}getSignature(e){var t;(t=o(this,So))==null||t.getSignature({uiManager:this,editor:e})}get signatureManager(){return o(this,So)}switchToMode(e,t){this._eventBus.on("annotationeditormodechanged",t,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:e})}setPreference(e,t){this._eventBus.dispatch("setpreference",{source:this,name:e,value:t})}onSetPreference({name:e,value:t}){switch(e){case"enableNewAltTextWhenAddingImage":m(this,iu,t);break}}onPagesEdited({pagesMapper:e}){for(const i of o(this,Ze).values())i.updatePageIndex(e.getPrevPageNumber(i.pageIndex+1)-1);const t=o(this,pt),s=m(this,pt,new Map);for(const[i,r]of t){const a=e.getPrevPageNumber(i+1)-1;if(a===-1){r.destroy();continue}s.set(a,r),r.updatePageIndex(a)}}onPageChanging({pageNumber:e}){m(this,nu,e-1)}focusMainContainer(){o(this,ir).focus()}findParent(e,t){for(const s of o(this,pt).values()){const{x:i,y:r,width:a,height:l}=s.div.getBoundingClientRect();if(e>=i&&e<=i+a&&t>=r&&t<=r+l)return s}return null}disableUserSelect(e=!1){o(this,df).classList.toggle("noUserSelect",e)}addShouldRescale(e){o(this,Ha).add(e)}removeShouldRescale(e){o(this,Ha).delete(e)}onScaleChanging({scale:e}){var t;this.commitOrRemove(),this.viewParameters.realScale=e*ya.PDF_TO_CSS_UNITS;for(const s of o(this,Ha))s.onScaleChanging();(t=o(this,vo))==null||t.onScaleChanging()}onRotationChanging({pagesRotation:e}){this.commitOrRemove(),this.viewParameters.rotation=e}highlightSelection(e="",t=!1){const s=document.getSelection();if(!s||s.isCollapsed)return;const{anchorNode:i,anchorOffset:r,focusNode:a,focusOffset:l}=s,c=s.toString(),d=A(this,O,Wm).call(this,s).closest(".textLayer"),h=this.getSelectionBoxes(d);if(!h)return;s.empty();const f=A(this,O,zy).call(this,d),p=o(this,xt)===oe.NONE,v=()=>{const b=f==null?void 0:f.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:e,boxes:h,anchorNode:i,anchorOffset:r,focusNode:a,focusOffset:l,text:c});p&&this.showAllEditors("highlight",!0,!0),t&&(b==null||b.editComment())};if(p){this.switchToMode(oe.HIGHLIGHT,v);return}v()}commentSelection(e=""){this.highlightSelection(e,!0)}getAndRemoveDataFromAnnotationStorage(e){if(!o(this,bn))return null;const t=`${Vh}${e}`,s=o(this,bn).getRawValue(t);return s&&o(this,bn).remove(t),s}addToAnnotationStorage(e){!e.isEmpty()&&o(this,bn)&&!o(this,bn).has(e.id)&&o(this,bn).setValue(e.id,e)}a11yAlert(e,t=null){const s=o(this,hf);s&&(s.setAttribute("data-l10n-id",e),t?s.setAttribute("data-l10n-args",JSON.stringify(t)):s.removeAttribute("data-l10n-args"))}blur(){if(this.isShiftKeyDown=!1,o(this,bo)&&(m(this,bo,!1),A(this,O,Jd).call(this,"main_toolbar")),!this.hasSelection)return;const{activeElement:e}=document;for(const t of o(this,Ne))if(t.div.contains(e)){m(this,$a,[t,e]),t._focusEventsAllowed=!1;break}}focus(){if(!o(this,$a))return;const[e,t]=o(this,$a);m(this,$a,null),t.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:this._signal}),t.focus()}addEditListeners(){A(this,O,Uy).call(this),this.setEditingState(!0)}removeEditListeners(){A(this,O,WS).call(this),this.setEditingState(!1)}dragOver(e){for(const{type:t}of e.dataTransfer.items)for(const s of o(this,An))if(s.isHandlingMimeForPasting(t)){e.dataTransfer.dropEffect="copy",e.preventDefault();return}}drop(e){for(const t of e.dataTransfer.items)for(const s of o(this,An))if(s.isHandlingMimeForPasting(t.type)){s.paste(t,this.currentLayer),e.preventDefault();return}}copy(e){var s;if(e.preventDefault(),(s=o(this,Bs))==null||s.commitOrRemove(),!this.hasSelection)return;const t=[];for(const i of o(this,Ne)){const r=i.serialize(!0);r&&t.push(r)}t.length!==0&&e.clipboardData.setData("application/pdfjs",JSON.stringify(t))}cut(e){this.copy(e),this.delete()}async paste(e){e.preventDefault();const{clipboardData:t}=e;for(const r of t.items)for(const a of o(this,An))if(a.isHandlingMimeForPasting(r.type)){a.paste(r,this.currentLayer);return}let s=t.getData("application/pdfjs");if(!s)return;try{s=JSON.parse(s)}catch(r){ne(`paste: "${r.message}".`);return}if(!Array.isArray(s))return;this.unselectAll();const i=this.currentLayer;try{const r=[];for(const c of s){const u=await i.deserialize(c);if(!u)return;r.push(u)}const a=()=>{for(const c of r)A(this,O,Hy).call(this,c);A(this,O,$y).call(this,r)},l=()=>{for(const c of r)c.remove()};this.addCommands({cmd:a,undo:l,mustExec:!0})}catch(r){ne(`paste: "${r.message}".`)}}keydown(e){!this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!0),o(this,xt)!==oe.NONE&&!this.isEditorHandlingKeyboard&&Fc._keyboardManager.exec(this,e)}keyup(e){this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!1,o(this,bo)&&(m(this,bo,!1),A(this,O,Jd).call(this,"main_toolbar")))}onEditingAction({name:e}){switch(e){case"undo":case"redo":case"delete":case"selectAll":this[e]();break;case"highlightSelection":this.highlightSelection("context_menu");break;case"commentSelection":this.commentSelection("context_menu");break}}setEditingState(e){e?(A(this,O,$S).call(this),A(this,O,GS).call(this),A(this,O,cs).call(this,{isEditing:o(this,xt)!==oe.NONE,isEmpty:A(this,O,Zd).call(this),hasSomethingToUndo:o(this,wn).hasSomethingToUndo(),hasSomethingToRedo:o(this,wn).hasSomethingToRedo(),hasSelectedEditor:!1})):(A(this,O,VS).call(this),A(this,O,XS).call(this),A(this,O,cs).call(this,{isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(e){if(!o(this,An)){m(this,An,e);for(const t of o(this,An))A(this,O,Yi).call(this,t.defaultPropertiesToUpdate)}}getId(){return o(this,u0).id}get currentLayer(){return o(this,pt).get(o(this,nu))}getLayer(e){return o(this,pt).get(e)}get currentPageIndex(){return o(this,nu)}addLayer(e){o(this,pt).set(e.pageIndex,e),o(this,wo)?e.enable():e.disable()}removeLayer(e){o(this,pt).delete(e.pageIndex)}async updateMode(e,t=null,s=!1,i=!1,r=!1,a=!1){var l,c,u,d,h,f;if(o(this,xt)!==e&&!(o(this,kn)&&(await o(this,kn).promise,!o(this,kn)))){if(m(this,kn,Promise.withResolvers()),(l=o(this,vo))==null||l.commitOrRemove(),o(this,xt)===oe.POPUP&&((c=o(this,ns))==null||c.hideSidebar()),(u=o(this,ns))==null||u.destroyPopup(),m(this,xt,e),e===oe.NONE){this.setEditingState(!1),A(this,O,KS).call(this);for(const p of o(this,Ze).values())p.hideStandaloneCommentButton();(d=this._editorUndoBar)==null||d.hide(),this.toggleComment(null),o(this,kn).resolve();return}for(const p of o(this,Ze).values())p.addStandaloneCommentButton();e===oe.SIGNATURE&&await((h=o(this,So))==null?void 0:h.loadSignatures()),s&&ts.clearPointerType(),this.setEditingState(!0),await A(this,O,qS).call(this),this.unselectAll();for(const p of o(this,pt).values())p.updateMode(e);if(e===oe.POPUP){o(this,eu)||m(this,eu,await o(this,lu).getAnnotationsByType(new Set(o(this,An).map(b=>b._editorType))));const p=new Set,v=[];for(const b of o(this,Ze).values()){const{annotationElementId:S,hasComment:y,deleted:k}=b;S&&p.add(S),y&&!k&&v.push(b.getData())}for(const b of o(this,eu)){const{id:S,popupRef:y,contentsObj:k}=b;y&&(k!=null&&k.str)&&!p.has(S)&&!o(this,yo).has(S)&&v.push(b)}(f=o(this,ns))==null||f.showSidebar(v)}if(!t){i&&this.addNewEditorFromKeyboard(),o(this,kn).resolve();return}for(const p of o(this,Ze).values())p.uid===t?(this.setSelected(p),a?p.editComment():r?p.enterInEditMode():p.focus()):p.unselect();o(this,kn).resolve()}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(e){e.mode!==o(this,xt)&&this._eventBus.dispatch("switchannotationeditormode",{source:this,...e})}updateParams(e,t){if(o(this,An)){switch(e){case ve.CREATE:this.currentLayer.addNewEditor(t);return;case ve.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(o(this,cf)||m(this,cf,new Map)).set(e,t),this.showAllEditors("highlight",t);break}if(this.hasSelection)for(const s of o(this,Ne))s.updateParams(e,t);else for(const s of o(this,An))s.updateDefaultParams(e,t)}}showAllEditors(e,t,s=!1){var r;for(const a of o(this,Ze).values())a.editorType===e&&a.show(t);(((r=o(this,cf))==null?void 0:r.get(ve.HIGHLIGHT_SHOW_ALL))??!0)!==t&&A(this,O,Yi).call(this,[[ve.HIGHLIGHT_SHOW_ALL,t]])}enableWaiting(e=!1){if(o(this,af)!==e){m(this,af,e);for(const t of o(this,pt).values())e?t.disableClick():t.enableClick(),t.div.classList.toggle("waiting",e)}}*getEditors(e){for(const t of o(this,Ze).values())t.pageIndex===e&&(yield t)}getEditor(e){return o(this,Ze).get(e)}addEditor(e){o(this,Ze).set(e.id,e)}removeEditor(e){var t,s;e.div.contains(document.activeElement)&&(o(this,yi)&&clearTimeout(o(this,yi)),m(this,yi,setTimeout(()=>{this.focusMainContainer(),m(this,yi,null)},0))),o(this,Ze).delete(e.id),e.annotationElementId&&((t=o(this,ko))==null||t.delete(e.annotationElementId)),this.unselect(e),(!e.annotationElementId||!o(this,yo).has(e.annotationElementId))&&((s=o(this,bn))==null||s.remove(e.id))}addDeletedAnnotationElement(e){o(this,yo).add(e.annotationElementId),this.addChangedExistingAnnotation(e),e.deleted=!0}isDeletedAnnotationElement(e){return o(this,yo).has(e)}removeDeletedAnnotationElement(e){o(this,yo).delete(e.annotationElementId),this.removeChangedExistingAnnotation(e),e.deleted=!1}setActiveEditor(e){o(this,Bs)!==e&&(m(this,Bs,e),e&&A(this,O,Yi).call(this,e.propertiesToUpdate))}updateUI(e){o(this,O,QS)===e&&A(this,O,Yi).call(this,e.propertiesToUpdate)}updateUIForDefaultProperties(e){A(this,O,Yi).call(this,e.defaultPropertiesToUpdate)}toggleSelected(e){if(o(this,Ne).has(e)){o(this,Ne).delete(e),e.unselect(),A(this,O,cs).call(this,{hasSelectedEditor:this.hasSelection});return}o(this,Ne).add(e),e.select(),A(this,O,Yi).call(this,e.propertiesToUpdate),A(this,O,cs).call(this,{hasSelectedEditor:!0})}setSelected(e){var t;this.updateToolbar({mode:e.mode,editId:e.uid}),(t=o(this,vo))==null||t.commitOrRemove();for(const s of o(this,Ne))s!==e&&s.unselect();o(this,Ne).clear(),o(this,Ne).add(e),e.select(),A(this,O,Yi).call(this,e.propertiesToUpdate),A(this,O,cs).call(this,{hasSelectedEditor:!0})}isSelected(e){return o(this,Ne).has(e)}get firstSelectedEditor(){return o(this,Ne).values().next().value}unselect(e){e.unselect(),o(this,Ne).delete(e),A(this,O,cs).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return o(this,Ne).size!==0}get isEnterHandled(){return o(this,Ne).size===1&&this.firstSelectedEditor.isEnterHandled}undo(){var e;o(this,wn).undo(),A(this,O,cs).call(this,{hasSomethingToUndo:o(this,wn).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:A(this,O,Zd).call(this)}),(e=this._editorUndoBar)==null||e.hide()}redo(){o(this,wn).redo(),A(this,O,cs).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:o(this,wn).hasSomethingToRedo(),isEmpty:A(this,O,Zd).call(this)})}addCommands(e){o(this,wn).add(e),A(this,O,cs).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:A(this,O,Zd).call(this)})}cleanUndoStack(e){o(this,wn).cleanType(e)}delete(){var r;this.commitOrRemove();const e=(r=this.currentLayer)==null?void 0:r.endDrawingSession(!0);if(!this.hasSelection&&!e)return;const t=e?[e]:[...o(this,Ne)],s=()=>{var a;(a=this._editorUndoBar)==null||a.show(i,t.length===1?t[0].editorType:t.length);for(const l of t)l.remove()},i=()=>{for(const a of t)A(this,O,Hy).call(this,a)};this.addCommands({cmd:s,undo:i,mustExec:!0})}commitOrRemove(){var e;(e=o(this,Bs))==null||e.commitOrRemove()}hasSomethingToControl(){return o(this,Bs)||this.hasSelection}selectAll(){for(const e of o(this,Ne))e.commit();A(this,O,$y).call(this,o(this,Ze).values())}unselectAll(){var e;if(!(o(this,Bs)&&(o(this,Bs).commitOrRemove(),o(this,xt)!==oe.NONE))&&!((e=o(this,vo))!=null&&e.commitOrRemove())&&this.hasSelection){for(const t of o(this,Ne))t.unselect();o(this,Ne).clear(),A(this,O,cs).call(this,{hasSelectedEditor:!1})}}translateSelectedEditors(e,t,s=!1){if(s||this.commitOrRemove(),!this.hasSelection)return;o(this,Co)[0]+=e,o(this,Co)[1]+=t;const[i,r]=o(this,Co),a=[...o(this,Ne)],l=1e3;o(this,bi)&&clearTimeout(o(this,bi)),m(this,bi,setTimeout(()=>{m(this,bi,null),o(this,Co)[0]=o(this,Co)[1]=0,this.addCommands({cmd:()=>{for(const c of a)o(this,Ze).has(c.id)&&(c.translateInPage(i,r),c.translationDone())},undo:()=>{for(const c of a)o(this,Ze).has(c.id)&&(c.translateInPage(-i,-r),c.translationDone())},mustExec:!1})},l));for(const c of a)c.translateInPage(e,t),c.translationDone()}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),m(this,vi,new Map);for(const e of o(this,Ne))o(this,vi).set(e,{savedX:e.x,savedY:e.y,savedPageIndex:e.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!o(this,vi))return!1;this.disableUserSelect(!1);const e=o(this,vi);m(this,vi,null);let t=!1;for(const[{x:i,y:r,pageIndex:a},l]of e)l.newX=i,l.newY=r,l.newPageIndex=a,t||(t=i!==l.savedX||r!==l.savedY||a!==l.savedPageIndex);if(!t)return!1;const s=(i,r,a,l)=>{if(o(this,Ze).has(i.id)){const c=o(this,pt).get(l);c?i._setParentAndPosition(c,r,a):(i.pageIndex=l,i.x=r,i.y=a)}};return this.addCommands({cmd:()=>{for(const[i,{newX:r,newY:a,newPageIndex:l}]of e)s(i,r,a,l)},undo:()=>{for(const[i,{savedX:r,savedY:a,savedPageIndex:l}]of e)s(i,r,a,l)},mustExec:!0}),!0}dragSelectedEditors(e,t){if(o(this,vi))for(const s of o(this,vi).keys())s.drag(e,t)}rebuild(e){if(e.parent===null){const t=this.getLayer(e.pageIndex);t?(t.changeParent(e),t.addOrRebuild(e)):(this.addEditor(e),this.addToAnnotationStorage(e),e.rebuild())}else e.parent.addOrRebuild(e)}get isEditorHandlingKeyboard(){var e;return((e=this.getActive())==null?void 0:e.shouldGetKeyboardEvents())||o(this,Ne).size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(e){return o(this,Bs)===e}getActive(){return o(this,Bs)}getMode(){return o(this,xt)}isEditingMode(){return o(this,xt)!==oe.NONE}get imageManager(){return ie(this,"imageManager",new Oy)}getSelectionBoxes(e){if(!e)return null;const t=document.getSelection();for(let u=0,d=t.rangeCount;u<d;u++)if(!e.contains(t.getRangeAt(u).commonAncestorContainer))return null;const{x:s,y:i,width:r,height:a}=e.getBoundingClientRect();let l;switch(e.getAttribute("data-main-rotation")){case"90":l=(u,d,h,f)=>({x:(d-i)/a,y:1-(u+h-s)/r,width:f/a,height:h/r});break;case"180":l=(u,d,h,f)=>({x:1-(u+h-s)/r,y:1-(d+f-i)/a,width:h/r,height:f/a});break;case"270":l=(u,d,h,f)=>({x:1-(d+f-i)/a,y:(u-s)/r,width:f/a,height:h/r});break;default:l=(u,d,h,f)=>({x:(u-s)/r,y:(d-i)/a,width:h/r,height:f/a});break}const c=[];for(let u=0,d=t.rangeCount;u<d;u++){const h=t.getRangeAt(u);if(!h.collapsed)for(const{x:f,y:p,width:v,height:b}of h.getClientRects())v===0||b===0||c.push(l(f,p,v,b))}return c.length===0?null:c}addChangedExistingAnnotation({annotationElementId:e,id:t}){(o(this,su)||m(this,su,new Map)).set(e,t)}removeChangedExistingAnnotation({annotationElementId:e}){var t;(t=o(this,su))==null||t.delete(e)}renderAnnotationElement(e){var i;const t=(i=o(this,su))==null?void 0:i.get(e.data.id);if(!t)return;const s=o(this,bn).getRawValue(t);s&&(o(this,xt)===oe.NONE&&!s.hasBeenModified||s.renderAnnotationElement(e))}setMissingCanvas(e,t,s){var r;const i=(r=o(this,ko))==null?void 0:r.get(e);i&&(i.setCanvas(t,s),o(this,ko).delete(e))}addMissingCanvas(e,t){(o(this,ko)||m(this,ko,new Map)).set(e,t)}};Zc=new WeakMap,Bs=new WeakMap,eu=new WeakMap,Ze=new WeakMap,pt=new WeakMap,tu=new WeakMap,bn=new WeakMap,su=new WeakMap,wn=new WeakMap,ns=new WeakMap,go=new WeakMap,vo=new WeakMap,nu=new WeakMap,yo=new WeakMap,vi=new WeakMap,An=new WeakMap,Ha=new WeakMap,nf=new WeakMap,rf=new WeakMap,iu=new WeakMap,of=new WeakMap,yi=new WeakMap,xo=new WeakMap,ru=new WeakMap,bo=new WeakMap,xi=new WeakMap,u0=new WeakMap,wo=new WeakMap,ou=new WeakMap,af=new WeakMap,Ao=new WeakMap,$a=new WeakMap,au=new WeakMap,ko=new WeakMap,lf=new WeakMap,xt=new WeakMap,Ne=new WeakMap,nr=new WeakMap,So=new WeakMap,Eo=new WeakMap,cf=new WeakMap,lu=new WeakMap,uf=new WeakMap,Co=new WeakMap,bi=new WeakMap,ir=new WeakMap,df=new WeakMap,hf=new WeakMap,kn=new WeakMap,O=new WeakSet,Wm=function({anchorNode:e}){return e.nodeType===Node.TEXT_NODE?e.parentElement:e},zy=function(e){const{currentLayer:t}=this;if(t.hasTextLayer(e))return t;for(const s of o(this,pt).values())if(s.hasTextLayer(e))return s;return null},zS=function(){const e=document.getSelection();if(!e||e.isCollapsed)return;const s=A(this,O,Wm).call(this,e).closest(".textLayer"),i=this.getSelectionBoxes(s);i&&(o(this,xi)||m(this,xi,new SN(this)),o(this,xi).show(s,i,this.direction==="ltr"))},US=function(){var r,a,l;const e=document.getSelection();if(!e||e.isCollapsed){o(this,nr)&&((r=o(this,xi))==null||r.hide(),m(this,nr,null),A(this,O,cs).call(this,{hasSelectedText:!1}));return}const{anchorNode:t}=e;if(t===o(this,nr))return;const i=A(this,O,Wm).call(this,e).closest(".textLayer");if(!i){o(this,nr)&&((a=o(this,xi))==null||a.hide(),m(this,nr,null),A(this,O,cs).call(this,{hasSelectedText:!1}));return}if((l=o(this,xi))==null||l.hide(),m(this,nr,t),A(this,O,cs).call(this,{hasSelectedText:!0}),!(o(this,xt)!==oe.HIGHLIGHT&&o(this,xt)!==oe.NONE)&&(o(this,xt)===oe.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),m(this,bo,this.isShiftKeyDown),!this.isShiftKeyDown)){const c=o(this,xt)===oe.HIGHLIGHT?A(this,O,zy).call(this,i):null;if(c==null||c.toggleDrawing(),o(this,ou)){const u=new AbortController,d=this.combinedSignal(u),h=f=>{f.type==="pointerup"&&f.button!==0||(u.abort(),c==null||c.toggleDrawing(!0),f.type==="pointerup"&&A(this,O,Jd).call(this,"main_toolbar"))};window.addEventListener("pointerup",h,{signal:d}),window.addEventListener("blur",h,{signal:d})}else c==null||c.toggleDrawing(!0),A(this,O,Jd).call(this,"main_toolbar")}},Jd=function(e=""){o(this,xt)===oe.HIGHLIGHT?this.highlightSelection(e):o(this,nf)&&A(this,O,zS).call(this)},HS=function(){document.addEventListener("selectionchange",A(this,O,US).bind(this),{signal:this._signal})},$S=function(){if(o(this,xo))return;m(this,xo,new AbortController);const e=this.combinedSignal(o(this,xo));window.addEventListener("focus",this.focus.bind(this),{signal:e}),window.addEventListener("blur",this.blur.bind(this),{signal:e})},VS=function(){var e;(e=o(this,xo))==null||e.abort(),m(this,xo,null)},Uy=function(){if(o(this,Ao))return;m(this,Ao,new AbortController);const e=this.combinedSignal(o(this,Ao));window.addEventListener("keydown",this.keydown.bind(this),{signal:e}),window.addEventListener("keyup",this.keyup.bind(this),{signal:e})},WS=function(){var e;(e=o(this,Ao))==null||e.abort(),m(this,Ao,null)},GS=function(){if(o(this,go))return;m(this,go,new AbortController);const e=this.combinedSignal(o(this,go));document.addEventListener("copy",this.copy.bind(this),{signal:e}),document.addEventListener("cut",this.cut.bind(this),{signal:e}),document.addEventListener("paste",this.paste.bind(this),{signal:e})},XS=function(){var e;(e=o(this,go))==null||e.abort(),m(this,go,null)},YS=function(){const e=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:e}),document.addEventListener("drop",this.drop.bind(this),{signal:e})},cs=function(e){Object.entries(e).some(([s,i])=>o(this,uf)[s]!==i)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(o(this,uf),e)}),o(this,xt)===oe.HIGHLIGHT&&e.hasSelectedEditor===!1&&A(this,O,Yi).call(this,[[ve.HIGHLIGHT_FREE,!0]]))},Yi=function(e){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:e})},qS=async function(){if(!o(this,wo)){m(this,wo,!0);const e=[];for(const t of o(this,pt).values())e.push(t.enable());await Promise.all(e);for(const t of o(this,Ze).values())t.enable()}},KS=function(){if(this.unselectAll(),o(this,wo)){m(this,wo,!1);for(const e of o(this,pt).values())e.disable();for(const e of o(this,Ze).values())e.disable()}},Hy=function(e){const t=o(this,pt).get(e.pageIndex);t?t.addOrRebuild(e):(this.addEditor(e),this.addToAnnotationStorage(e))},QS=function(){let e=null;for(e of o(this,Ne));return e},Zd=function(){if(o(this,Ze).size===0)return!0;if(o(this,Ze).size===1)for(const e of o(this,Ze).values())return e.isEmpty();return!1},$y=function(e){for(const t of o(this,Ne))t.unselect();o(this,Ne).clear();for(const t of e)t.isEmpty()||(o(this,Ne).add(t),t.select());A(this,O,cs).call(this,{hasSelectedEditor:this.hasSelection})},M(Fc,"TRANSLATE_SMALL",1),M(Fc,"TRANSLATE_BIG",10);let nc=Fc;var Pt,wi,Yn,cu,Ai,zs,uu,ki,Ss,rr,Va,Si,To,ai,eh,Gm;const us=class us{constructor(e){x(this,ai);x(this,Pt,null);x(this,wi,!1);x(this,Yn,null);x(this,cu,null);x(this,Ai,null);x(this,zs,null);x(this,uu,!1);x(this,ki,null);x(this,Ss,null);x(this,rr,null);x(this,Va,null);x(this,Si,!1);m(this,Ss,e),m(this,Si,e._uiManager.useNewAltTextFlow),o(us,To)||m(us,To,Object.freeze({added:"pdfjs-editor-new-alt-text-added-button","added-label":"pdfjs-editor-new-alt-text-added-button-label",missing:"pdfjs-editor-new-alt-text-missing-button","missing-label":"pdfjs-editor-new-alt-text-missing-button-label",review:"pdfjs-editor-new-alt-text-to-review-button","review-label":"pdfjs-editor-new-alt-text-to-review-button-label"}))}static initialize(e){us._l10n??(us._l10n=e)}async render(){const e=m(this,Yn,document.createElement("button"));e.className="altText",e.tabIndex="0";const t=m(this,cu,document.createElement("span"));e.append(t),o(this,Si)?(e.classList.add("new"),e.setAttribute("data-l10n-id",o(us,To).missing),t.setAttribute("data-l10n-id",o(us,To)["missing-label"])):(e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button"),t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button-label"));const s=o(this,Ss)._uiManager._signal;e.addEventListener("contextmenu",zn,{signal:s}),e.addEventListener("pointerdown",r=>r.stopPropagation(),{signal:s});const i=r=>{r.preventDefault(),o(this,Ss)._uiManager.editAltText(o(this,Ss)),o(this,Si)&&o(this,Ss)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:o(this,ai,eh)}})};return e.addEventListener("click",i,{capture:!0,signal:s}),e.addEventListener("keydown",r=>{r.target===e&&r.key==="Enter"&&(m(this,uu,!0),i(r))},{signal:s}),await A(this,ai,Gm).call(this),e}finish(){o(this,Yn)&&(o(this,Yn).focus({focusVisible:o(this,uu)}),m(this,uu,!1))}isEmpty(){return o(this,Si)?o(this,Pt)===null:!o(this,Pt)&&!o(this,wi)}hasData(){return o(this,Si)?o(this,Pt)!==null||!!o(this,rr):this.isEmpty()}get guessedText(){return o(this,rr)}async setGuessedText(e){o(this,Pt)===null&&(m(this,rr,e),m(this,Va,await us._l10n.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer",{generatedAltText:e})),A(this,ai,Gm).call(this))}toggleAltTextBadge(e=!1){var t;if(!o(this,Si)||o(this,Pt)){(t=o(this,ki))==null||t.remove(),m(this,ki,null);return}if(!o(this,ki)){const s=m(this,ki,document.createElement("div"));s.className="noAltTextBadge",o(this,Ss).div.append(s)}o(this,ki).classList.toggle("hidden",!e)}serialize(e){let t=o(this,Pt);return!e&&o(this,rr)===t&&(t=o(this,Va)),{altText:t,decorative:o(this,wi),guessedText:o(this,rr),textWithDisclaimer:o(this,Va)}}get data(){return{altText:o(this,Pt),decorative:o(this,wi)}}set data({altText:e,decorative:t,guessedText:s,textWithDisclaimer:i,cancel:r=!1}){s&&(m(this,rr,s),m(this,Va,i)),!(o(this,Pt)===e&&o(this,wi)===t)&&(r||(m(this,Pt,e),m(this,wi,t)),A(this,ai,Gm).call(this))}toggle(e=!1){o(this,Yn)&&(!e&&o(this,zs)&&(clearTimeout(o(this,zs)),m(this,zs,null)),o(this,Yn).disabled=!e)}shown(){o(this,Ss)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:o(this,ai,eh)}})}destroy(){var e,t;(e=o(this,Yn))==null||e.remove(),m(this,Yn,null),m(this,cu,null),m(this,Ai,null),(t=o(this,ki))==null||t.remove(),m(this,ki,null)}};Pt=new WeakMap,wi=new WeakMap,Yn=new WeakMap,cu=new WeakMap,Ai=new WeakMap,zs=new WeakMap,uu=new WeakMap,ki=new WeakMap,Ss=new WeakMap,rr=new WeakMap,Va=new WeakMap,Si=new WeakMap,To=new WeakMap,ai=new WeakSet,eh=function(){return o(this,Pt)&&"added"||o(this,Pt)===null&&this.guessedText&&"review"||"missing"},Gm=async function(){var i,r,a;const e=o(this,Yn);if(!e)return;if(o(this,Si)){if(e.classList.toggle("done",!!o(this,Pt)),e.setAttribute("data-l10n-id",o(us,To)[o(this,ai,eh)]),(i=o(this,cu))==null||i.setAttribute("data-l10n-id",o(us,To)[`${o(this,ai,eh)}-label`]),!o(this,Pt)){(r=o(this,Ai))==null||r.remove();return}}else{if(!o(this,Pt)&&!o(this,wi)){e.classList.remove("done"),(a=o(this,Ai))==null||a.remove();return}e.classList.add("done"),e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-edit-button")}let t=o(this,Ai);if(!t){m(this,Ai,t=document.createElement("span")),t.className="tooltip",t.setAttribute("role","tooltip"),t.id=`alt-text-tooltip-${o(this,Ss).id}`;const l=100,c=o(this,Ss)._uiManager._signal;c.addEventListener("abort",()=>{clearTimeout(o(this,zs)),m(this,zs,null)},{once:!0}),e.addEventListener("mouseenter",()=>{m(this,zs,setTimeout(()=>{m(this,zs,null),o(this,Ai).classList.add("show"),o(this,Ss)._reportTelemetry({action:"alt_text_tooltip"})},l))},{signal:c}),e.addEventListener("mouseleave",()=>{var u;o(this,zs)&&(clearTimeout(o(this,zs)),m(this,zs,null)),(u=o(this,Ai))==null||u.classList.remove("show")},{signal:c})}o(this,wi)?t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-decorative-tooltip"):(t.removeAttribute("data-l10n-id"),t.textContent=o(this,Pt)),t.parentNode||e.append(t);const s=o(this,Ss).getElementForAltText();s==null||s.setAttribute("aria-describedby",t.id)},x(us,To,null),M(us,"_l10n",null);let qg=us;var zt,Sn,Wa,He,ff,_o,En,No,Po,Ga,pf,Vy;class wm{constructor(e){x(this,pf);x(this,zt,null);x(this,Sn,null);x(this,Wa,!1);x(this,He,null);x(this,ff,null);x(this,_o,null);x(this,En,null);x(this,No,null);x(this,Po,!1);x(this,Ga,null);m(this,He,e)}renderForToolbar(){const e=m(this,Sn,document.createElement("button"));return e.className="comment",A(this,pf,Vy).call(this,e,!1)}renderForStandalone(){const e=m(this,zt,document.createElement("button"));e.className="annotationCommentButton";const t=o(this,He).commentButtonPosition;if(t){const{style:s}=e;s.insetInlineEnd=`calc(${100*(o(this,He)._uiManager.direction==="ltr"?1-t[0]:t[0])}% - var(--comment-button-dim))`,s.top=`calc(${100*t[1]}% - var(--comment-button-dim))`;const i=o(this,He).commentButtonColor;i&&(s.backgroundColor=i)}return A(this,pf,Vy).call(this,e,!0)}focusButton(){setTimeout(()=>{var e;(e=o(this,zt)??o(this,Sn))==null||e.focus()},0)}onUpdatedColor(){if(!o(this,zt))return;const e=o(this,He).commentButtonColor;e&&(o(this,zt).style.backgroundColor=e),o(this,He)._uiManager.updatePopupColor(o(this,He))}get commentButtonWidth(){var e;return(((e=o(this,zt))==null?void 0:e.getBoundingClientRect().width)??0)/o(this,He).parent.boundingClientRect.width}get commentPopupPositionInLayer(){if(o(this,Ga))return o(this,Ga);if(!o(this,zt))return null;const{x:e,y:t,height:s}=o(this,zt).getBoundingClientRect(),{x:i,y:r,width:a,height:l}=o(this,He).parent.boundingClientRect;return[(e-i)/a,(t+s-r)/l]}set commentPopupPositionInLayer(e){m(this,Ga,e)}hasDefaultPopupPosition(){return o(this,Ga)===null}removeStandaloneCommentButton(){var e;(e=o(this,zt))==null||e.remove(),m(this,zt,null)}removeToolbarCommentButton(){var e;(e=o(this,Sn))==null||e.remove(),m(this,Sn,null)}setCommentButtonStates({selected:e,hasPopup:t}){o(this,zt)&&(o(this,zt).classList.toggle("selected",e),o(this,zt).ariaExpanded=t)}edit(e){const t=this.commentPopupPositionInLayer;let s,i;if(t)[s,i]=t;else{[s,i]=o(this,He).commentButtonPosition;const{width:d,height:h,x:f,y:p}=o(this,He);s=f+s*d,i=p+i*h}const r=o(this,He).parent.boundingClientRect,{x:a,y:l,width:c,height:u}=r;o(this,He)._uiManager.editComment(o(this,He),a+s*c,l+i*u,{...e,parentDimensions:r})}finish(){o(this,Sn)&&(o(this,Sn).focus({focusVisible:o(this,Wa)}),m(this,Wa,!1))}isDeleted(){return o(this,Po)||o(this,En)===""}isEmpty(){return o(this,En)===null}hasBeenEdited(){return this.isDeleted()||o(this,En)!==o(this,ff)}serialize(){return this.data}get data(){return{text:o(this,En),richText:o(this,_o),date:o(this,No),deleted:this.isDeleted()}}set data(e){if(e!==o(this,En)&&m(this,_o,null),e===null){m(this,En,""),m(this,Po,!0);return}m(this,En,e),m(this,No,new Date),m(this,Po,!1)}restoreData({text:e,richText:t,date:s}){m(this,En,e),m(this,_o,t),m(this,No,s),m(this,Po,!1)}setInitialText(e,t=null){m(this,ff,e),this.data=e,m(this,No,null),m(this,_o,t)}shown(){}destroy(){var e,t;(e=o(this,Sn))==null||e.remove(),m(this,Sn,null),(t=o(this,zt))==null||t.remove(),m(this,zt,null),m(this,En,""),m(this,_o,null),m(this,No,null),m(this,He,null),m(this,Wa,!1),m(this,Po,!1)}}zt=new WeakMap,Sn=new WeakMap,Wa=new WeakMap,He=new WeakMap,ff=new WeakMap,_o=new WeakMap,En=new WeakMap,No=new WeakMap,Po=new WeakMap,Ga=new WeakMap,pf=new WeakSet,Vy=function(e,t){if(!o(this,He)._uiManager.hasCommentManager())return null;e.tabIndex="0",e.ariaHasPopup="dialog",t?(e.ariaControls="commentPopup",e.setAttribute("data-l10n-id","pdfjs-show-comment-button")):(e.ariaControlsElements=[o(this,He)._uiManager.getCommentDialogElement()],e.setAttribute("data-l10n-id","pdfjs-editor-add-comment-button"));const s=o(this,He)._uiManager._signal;if(!(s instanceof AbortSignal)||s.aborted)return e;e.addEventListener("contextmenu",zn,{signal:s}),t&&(e.addEventListener("focusin",r=>{o(this,He)._focusEventsAllowed=!1,ut(r)},{capture:!0,signal:s}),e.addEventListener("focusout",r=>{o(this,He)._focusEventsAllowed=!0,ut(r)},{capture:!0,signal:s})),e.addEventListener("pointerdown",r=>r.stopPropagation(),{signal:s});const i=r=>{r.preventDefault(),e===o(this,Sn)?this.edit():o(this,He).toggleComment(!0)};return e.addEventListener("click",i,{capture:!0,signal:s}),e.addEventListener("keydown",r=>{r.target===e&&r.key==="Enter"&&(m(this,Wa,!0),i(r))},{signal:s}),e.addEventListener("pointerenter",()=>{o(this,He).toggleComment(!1,!0)},{signal:s}),e.addEventListener("pointerleave",()=>{o(this,He).toggleComment(!1,!1)},{signal:s}),e};var du,Xa,mf,gf,vf,yf,xf,or,Ya,ar,qa,lr,xa,JS,ZS,eE;const dw=class dw{constructor({container:e,isPinchingDisabled:t=null,isPinchingStopped:s=null,onPinchStart:i=null,onPinching:r=null,onPinchEnd:a=null,signal:l}){x(this,xa);x(this,du);x(this,Xa,!1);x(this,mf,null);x(this,gf);x(this,vf);x(this,yf);x(this,xf);x(this,or,null);x(this,Ya);x(this,ar,null);x(this,qa);x(this,lr,null);m(this,du,e),m(this,mf,s),m(this,gf,t),m(this,vf,i),m(this,yf,r),m(this,xf,a),m(this,qa,new AbortController),m(this,Ya,AbortSignal.any([l,o(this,qa).signal])),e.addEventListener("touchstart",A(this,xa,JS).bind(this),{passive:!1,signal:o(this,Ya)})}get MIN_TOUCH_DISTANCE_TO_PINCH(){return 35/$i.pixelRatio}destroy(){var e,t;(e=o(this,qa))==null||e.abort(),m(this,qa,null),(t=o(this,or))==null||t.abort(),m(this,or,null)}};du=new WeakMap,Xa=new WeakMap,mf=new WeakMap,gf=new WeakMap,vf=new WeakMap,yf=new WeakMap,xf=new WeakMap,or=new WeakMap,Ya=new WeakMap,ar=new WeakMap,qa=new WeakMap,lr=new WeakMap,xa=new WeakSet,JS=function(e){var i,r,a;if((i=o(this,gf))!=null&&i.call(this))return;if(e.touches.length===1){if(o(this,or))return;const l=m(this,or,new AbortController),c=AbortSignal.any([o(this,Ya),l.signal]),u=o(this,du),d={capture:!0,signal:c,passive:!1},h=f=>{var p;f.pointerType==="touch"&&((p=o(this,or))==null||p.abort(),m(this,or,null))};u.addEventListener("pointerdown",f=>{f.pointerType==="touch"&&(ut(f),h(f))},d),u.addEventListener("pointerup",h,d),u.addEventListener("pointercancel",h,d);return}if(!o(this,lr)){m(this,lr,new AbortController);const l=AbortSignal.any([o(this,Ya),o(this,lr).signal]),c=o(this,du),u={signal:l,capture:!1,passive:!1};c.addEventListener("touchmove",A(this,xa,ZS).bind(this),u);const d=A(this,xa,eE).bind(this);c.addEventListener("touchend",d,u),c.addEventListener("touchcancel",d,u),u.capture=!0,c.addEventListener("pointerdown",ut,u),c.addEventListener("pointermove",ut,u),c.addEventListener("pointercancel",ut,u),c.addEventListener("pointerup",ut,u),(r=o(this,vf))==null||r.call(this)}if(ut(e),e.touches.length!==2||(a=o(this,mf))!=null&&a.call(this)){m(this,ar,null);return}let[t,s]=e.touches;t.identifier>s.identifier&&([t,s]=[s,t]),m(this,ar,{touch0X:t.screenX,touch0Y:t.screenY,touch1X:s.screenX,touch1Y:s.screenY})},ZS=function(e){var E;if(!o(this,ar)||e.touches.length!==2)return;ut(e);let[t,s]=e.touches;t.identifier>s.identifier&&([t,s]=[s,t]);const{screenX:i,screenY:r}=t,{screenX:a,screenY:l}=s,c=o(this,ar),{touch0X:u,touch0Y:d,touch1X:h,touch1Y:f}=c,p=h-u,v=f-d,b=a-i,S=l-r,y=Math.hypot(b,S)||1,k=Math.hypot(p,v)||1;if(!o(this,Xa)&&Math.abs(k-y)<=dw.MIN_TOUCH_DISTANCE_TO_PINCH)return;if(c.touch0X=i,c.touch0Y=r,c.touch1X=a,c.touch1Y=l,!o(this,Xa)){m(this,Xa,!0);return}const w=[(i+a)/2,(r+l)/2];(E=o(this,yf))==null||E.call(this,w,k,y)},eE=function(e){var t;e.touches.length>=2||(o(this,lr)&&(o(this,lr).abort(),m(this,lr,null),(t=o(this,xf))==null||t.call(this)),o(this,ar)&&(ut(e),m(this,ar,null),m(this,Xa,!1)))};let Kg=dw;var Ka,qn,qe,Pe,cr,hu,Mo,bf,Ut,Qa,ur,Cn,Lo,wf,Ja,Us,Af,Za,dr,Ei,fu,pu,Tn,el,kf,d0,J,Wy,Sf,Gy,Xm,tE,sE,Xy,Ym,Yy,nE,iE,rE,qy,oE,Ky,aE,lE,cE,Qy,th;const re=class re{constructor(e){x(this,J);x(this,Ka,null);x(this,qn,null);x(this,qe,null);x(this,Pe,null);x(this,cr,null);x(this,hu,!1);x(this,Mo,null);x(this,bf,"");x(this,Ut,null);x(this,Qa,null);x(this,ur,null);x(this,Cn,null);x(this,Lo,null);x(this,wf,"");x(this,Ja,!1);x(this,Us,null);x(this,Af,!1);x(this,Za,!1);x(this,dr,!1);x(this,Ei,null);x(this,fu,0);x(this,pu,0);x(this,Tn,null);x(this,el,null);M(this,"isSelected",!1);M(this,"_isCopy",!1);M(this,"_editToolbar",null);M(this,"_initialOptions",Object.create(null));M(this,"_initialData",null);M(this,"_isVisible",!0);M(this,"_uiManager",null);M(this,"_focusEventsAllowed",!0);x(this,kf,!1);x(this,d0,re._zIndex++);this.parent=e.parent,this.id=e.id,this.width=this.height=null,this.pageIndex=e.parent.pageIndex,this.name=e.name,this.div=null,this._uiManager=e.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=e.isCentered,this._structTreeParentId=null,this.annotationElementId=e.annotationElementId||null,this.creationDate=e.creationDate||new Date,this.modificationDate=e.modificationDate||null,this.canAddComment=!0;const{rotation:t,rawDims:{pageWidth:s,pageHeight:i,pageX:r,pageY:a}}=this.parent.viewport;this.rotation=t,this.pageRotation=(360+t-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[s,i],this.pageTranslation=[r,a];const[l,c]=this.parentDimensions;this.x=e.x/l,this.y=e.y/c,this.isAttachedToDOM=!1,this.deleted=!1}static get _resizerKeyboardManager(){const e=re.prototype._resizeWithKeyboard,t=nc.TRANSLATE_SMALL,s=nc.TRANSLATE_BIG;return ie(this,"_resizerKeyboardManager",new em([[["ArrowLeft","mac+ArrowLeft"],e,{args:[-t,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e,{args:[-s,0]}],[["ArrowRight","mac+ArrowRight"],e,{args:[t,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e,{args:[s,0]}],[["ArrowUp","mac+ArrowUp"],e,{args:[0,-t]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e,{args:[0,-s]}],[["ArrowDown","mac+ArrowDown"],e,{args:[0,t]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e,{args:[0,s]}],[["Escape","mac+Escape"],re.prototype._stopResizingWithKeyboard]]))}updatePageIndex(e){this.pageIndex=e}get editorType(){return Object.getPrototypeOf(this).constructor._type}get mode(){return Object.getPrototypeOf(this).constructor._editorType}static get isDrawer(){return!1}static get _defaultLineColor(){return ie(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(e){const t=new TN({id:e.parent.getNextId(),parent:e.parent,uiManager:e._uiManager});t.annotationElementId=e.annotationElementId,t.deleted=!0,t._uiManager.addToAnnotationStorage(t)}static initialize(e,t){if(re._l10n??(re._l10n=e),re._l10nResizer||(re._l10nResizer=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"})),re._borderLineWidth!==-1)return;const s=getComputedStyle(document.documentElement);re._borderLineWidth=parseFloat(s.getPropertyValue("--outline-width"))||0}static updateDefaultParams(e,t){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(e){return!1}static paste(e,t){Ce("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return o(this,kf)}set _isDraggable(e){var t;m(this,kf,e),(t=this.div)==null||t.classList.toggle("draggable",e)}get uid(){return this.annotationElementId||this.id}get isEnterHandled(){return!0}center(){const[e,t]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*t/(e*2),this.y+=this.width*e/(t*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*t/(e*2),this.y-=this.width*e/(t*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(e){this._uiManager.addCommands(e)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=o(this,d0)}setParent(e){var t;e!==null?(this.pageIndex=e.pageIndex,this.pageDimensions=e.pageDimensions):(A(this,J,th).call(this),(t=o(this,Cn))==null||t.remove(),m(this,Cn,null)),this.parent=e}focusin(e){this._focusEventsAllowed&&(o(this,Ja)?m(this,Ja,!1):this.parent.setSelected(this))}focusout(e){var s;if(!this._focusEventsAllowed||!this.isAttachedToDOM)return;const t=e.relatedTarget;t!=null&&t.closest(`#${this.id}`)||(e.preventDefault(),(s=this.parent)!=null&&s.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.isInEditMode()&&this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(e,t,s,i){const[r,a]=this.parentDimensions;[s,i]=this.screenToPageTranslation(s,i),this.x=(e+s)/r,this.y=(t+i)/a,this.fixAndSetPosition()}_moveAfterPaste(e,t){const[s,i]=this.parentDimensions;this.setAt(e*s,t*i,this.width*s,this.height*i),this._onTranslated()}translate(e,t){A(this,J,Wy).call(this,this.parentDimensions,e,t)}translateInPage(e,t){o(this,Us)||m(this,Us,[this.x,this.y,this.width,this.height]),A(this,J,Wy).call(this,this.pageDimensions,e,t),this.div.scrollIntoView({block:"nearest"})}translationDone(){this._onTranslated(this.x,this.y)}drag(e,t){o(this,Us)||m(this,Us,[this.x,this.y,this.width,this.height]);const{div:s,parentDimensions:[i,r]}=this;if(this.x+=e/i,this.y+=t/r,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:h,y:f}=this.div.getBoundingClientRect();this.parent.findNewParent(this,h,f)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:a,y:l}=this;const[c,u]=this.getBaseTranslation();a+=c,l+=u;const{style:d}=s;d.left=`${(100*a).toFixed(2)}%`,d.top=`${(100*l).toFixed(2)}%`,this._onTranslating(a,l),s.scrollIntoView({block:"nearest"})}_onTranslating(e,t){}_onTranslated(e,t){}get _hasBeenMoved(){return!!o(this,Us)&&(o(this,Us)[0]!==this.x||o(this,Us)[1]!==this.y)}get _hasBeenResized(){return!!o(this,Us)&&(o(this,Us)[2]!==this.width||o(this,Us)[3]!==this.height)}getBaseTranslation(){const[e,t]=this.parentDimensions,{_borderLineWidth:s}=re,i=s/e,r=s/t;switch(this.rotation){case 90:return[-i,r];case 180:return[i,r];case 270:return[i,-r];default:return[-i,-r]}}get _mustFixPosition(){return!0}fixAndSetPosition(e=this.rotation){const{div:{style:t},pageDimensions:[s,i]}=this;let{x:r,y:a,width:l,height:c}=this;if(l*=s,c*=i,r*=s,a*=i,this._mustFixPosition)switch(e){case 0:r=Gt(r,0,s-l),a=Gt(a,0,i-c);break;case 90:r=Gt(r,0,s-c),a=Gt(a,l,i);break;case 180:r=Gt(r,l,s),a=Gt(a,c,i);break;case 270:r=Gt(r,c,s),a=Gt(a,0,i-l);break}this.x=r/=s,this.y=a/=i;const[u,d]=this.getBaseTranslation();r+=u,a+=d,t.left=`${(100*r).toFixed(2)}%`,t.top=`${(100*a).toFixed(2)}%`,this.moveInDOM()}screenToPageTranslation(e,t){var s;return A(s=re,Sf,Gy).call(s,e,t,this.parentRotation)}pageTranslationToScreen(e,t){var s;return A(s=re,Sf,Gy).call(s,e,t,360-this.parentRotation)}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:e,pageDimensions:[t,s]}=this;return[t*e,s*e]}setDims(){const{div:{style:e},width:t,height:s}=this;e.width=`${(100*t).toFixed(2)}%`,e.height=`${(100*s).toFixed(2)}%`}getInitialTranslation(){return[0,0]}_onResized(){}static _round(e){return Math.round(e*1e4)/1e4}_onResizing(){}altTextFinish(){var e;(e=o(this,qe))==null||e.finish()}get toolbarButtons(){return null}async addEditToolbar(){if(this._editToolbar||o(this,Za))return this._editToolbar;this._editToolbar=new Fy(this),this.div.append(this._editToolbar.render());const{toolbarButtons:e}=this;if(e)for(const[t,s]of e)await this._editToolbar.addButton(t,s);return this.hasComment||this._editToolbar.addButton("comment",this.addCommentButton()),this._editToolbar.addButton("delete"),this._editToolbar}addCommentButtonInToolbar(){var e;(e=this._editToolbar)==null||e.addButtonBefore("comment",this.addCommentButton(),".deleteButton")}removeCommentButtonFromToolbar(){var e;(e=this._editToolbar)==null||e.removeButton("comment")}removeEditToolbar(){var e,t;(e=this._editToolbar)==null||e.remove(),this._editToolbar=null,(t=o(this,qe))==null||t.destroy()}addContainer(e){var s;const t=(s=this._editToolbar)==null?void 0:s.div;t?t.before(e):this.div.append(e)}getClientDimensions(){return this.div.getBoundingClientRect()}createAltText(){return o(this,qe)||(qg.initialize(re._l10n),m(this,qe,new qg(this)),o(this,Ka)&&(o(this,qe).data=o(this,Ka),m(this,Ka,null))),o(this,qe)}get altTextData(){var e;return(e=o(this,qe))==null?void 0:e.data}set altTextData(e){o(this,qe)&&(o(this,qe).data=e)}get guessedAltText(){var e;return(e=o(this,qe))==null?void 0:e.guessedText}async setGuessedAltText(e){var t;await((t=o(this,qe))==null?void 0:t.setGuessedText(e))}serializeAltText(e){var t;return(t=o(this,qe))==null?void 0:t.serialize(e)}hasAltText(){return!!o(this,qe)&&!o(this,qe).isEmpty()}hasAltTextData(){var e;return((e=o(this,qe))==null?void 0:e.hasData())??!1}focusCommentButton(){var e;(e=o(this,Pe))==null||e.focusButton()}addCommentButton(){return this.canAddComment?o(this,Pe)||m(this,Pe,new wm(this)):null}addStandaloneCommentButton(){if(this._uiManager.hasCommentManager()){if(o(this,cr)){this._uiManager.isEditingMode()&&o(this,cr).classList.remove("hidden");return}this.hasComment&&(m(this,cr,o(this,Pe).renderForStandalone()),this.div.append(o(this,cr)))}}removeStandaloneCommentButton(){o(this,Pe).removeStandaloneCommentButton(),m(this,cr,null)}hideStandaloneCommentButton(){var e;(e=o(this,cr))==null||e.classList.add("hidden")}get comment(){if(!o(this,Pe))return null;const{data:{richText:e,text:t,date:s,deleted:i}}=o(this,Pe);return{text:t,richText:e,date:s,deleted:i,color:this.getNonHCMColor(),opacity:this.opacity??1}}set comment(e){o(this,Pe)||m(this,Pe,new wm(this)),typeof e=="object"&&e!==null?o(this,Pe).restoreData(e):o(this,Pe).data=e,this.hasComment?(this.removeCommentButtonFromToolbar(),this.addStandaloneCommentButton(),this._uiManager.updateComment(this)):(this.addCommentButtonInToolbar(),this.removeStandaloneCommentButton(),this._uiManager.removeComment(this))}setCommentData({comment:e,popupRef:t,richText:s}){if(!t||(o(this,Pe)||m(this,Pe,new wm(this)),o(this,Pe).setInitialText(e,s),!this.annotationElementId))return;const i=this._uiManager.getAndRemoveDataFromAnnotationStorage(this.annotationElementId);i&&this.updateFromAnnotationLayer(i)}get hasEditedComment(){var e;return(e=o(this,Pe))==null?void 0:e.hasBeenEdited()}get hasDeletedComment(){var e;return(e=o(this,Pe))==null?void 0:e.isDeleted()}get hasComment(){return!!o(this,Pe)&&!o(this,Pe).isEmpty()&&!o(this,Pe).isDeleted()}async editComment(e){o(this,Pe)||m(this,Pe,new wm(this)),o(this,Pe).edit(e)}toggleComment(e,t=void 0){this.hasComment&&this._uiManager.toggleComment(this,e,t)}setSelectedCommentButton(e){o(this,Pe).setSelectedButton(e)}addComment(e){if(this.hasEditedComment){const[,,,i]=e.rect,[r]=this.pageDimensions,[a]=this.pageTranslation,l=a+r+1,c=i-100,u=l+180;e.popup={contents:this.comment.text,deleted:this.comment.deleted,rect:[l,c,u,i]}}}updateFromAnnotationLayer({popup:{contents:e,deleted:t}}){o(this,Pe).data=t?null:e}get parentBoundingClientRect(){return this.parent.boundingClientRect}render(){var a;const e=this.div=document.createElement("div");e.setAttribute("data-editor-rotation",(360-this.rotation)%360),e.className=this.name,e.setAttribute("id",this.id),e.tabIndex=o(this,hu)?-1:0,e.setAttribute("role","application"),this.defaultL10nId&&e.setAttribute("data-l10n-id",this.defaultL10nId),this._isVisible||e.classList.add("hidden"),this.setInForeground(),A(this,J,Ky).call(this);const[t,s]=this.parentDimensions;this.parentRotation%180!==0&&(e.style.maxWidth=`${(100*s/t).toFixed(2)}%`,e.style.maxHeight=`${(100*t/s).toFixed(2)}%`);const[i,r]=this.getInitialTranslation();return this.translate(i,r),OS(this,e,["keydown","pointerdown","dblclick"]),this.isResizable&&this._uiManager._supportsPinchToZoom&&(o(this,el)||m(this,el,new Kg({container:e,isPinchingDisabled:()=>!this.isSelected,onPinchStart:A(this,J,nE).bind(this),onPinching:A(this,J,iE).bind(this),onPinchEnd:A(this,J,rE).bind(this),signal:this._uiManager._signal}))),this.addStandaloneCommentButton(),(a=this._uiManager._editorUndoBar)==null||a.hide(),e}pointerdown(e){const{isMac:t}=Nt.platform;if(e.button!==0||e.ctrlKey&&t){e.preventDefault();return}if(m(this,Ja,!0),this._isDraggable){A(this,J,oE).call(this,e);return}A(this,J,qy).call(this,e)}_onStartDragging(){}_onStopDragging(){}moveInDOM(){o(this,Ei)&&clearTimeout(o(this,Ei)),m(this,Ei,setTimeout(()=>{var e;m(this,Ei,null),(e=this.parent)==null||e.moveEditorInDOM(this)},0))}_setParentAndPosition(e,t,s){e.changeParent(this),this.x=t,this.y=s,this.fixAndSetPosition(),this._onTranslated()}getRect(e,t,s=this.rotation){const i=this.parentScale,[r,a]=this.pageDimensions,[l,c]=this.pageTranslation,u=e/i,d=t/i,h=this.x*r,f=this.y*a,p=this.width*r,v=this.height*a;switch(s){case 0:return[h+u+l,a-f-d-v+c,h+u+p+l,a-f-d+c];case 90:return[h+d+l,a-f+u+c,h+d+v+l,a-f+u+p+c];case 180:return[h-u-p+l,a-f+d+c,h-u+l,a-f+d+v+c];case 270:return[h-d-v+l,a-f-u-p+c,h-d+l,a-f-u+c];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(e,t){const[s,i,r,a]=e,l=r-s,c=a-i;switch(this.rotation){case 0:return[s,t-a,l,c];case 90:return[s,t-i,c,l];case 180:return[r,t-i,l,c];case 270:return[r,t-a,c,l];default:throw new Error("Invalid rotation")}}getPDFRect(){return this.getRect(0,0)}getNonHCMColor(){return this.color&&re._colorManager.convert(this._uiManager.getNonHCMColor(this.color))}onUpdatedColor(){var e;(e=o(this,Pe))==null||e.onUpdatedColor()}getData(){const{comment:{text:e,color:t,date:s,opacity:i,deleted:r,richText:a},uid:l,pageIndex:c,creationDate:u,modificationDate:d}=this;return{id:l,pageIndex:c,rect:this.getPDFRect(),richText:a,contentsObj:{str:e},creationDate:u,modificationDate:s||d,popupRef:!r,color:t,opacity:i}}onceAdded(e){}isEmpty(){return!1}enableEditMode(){return this.isInEditMode()?!1:(this.parent.setEditingState(!1),m(this,Za,!0),!0)}disableEditMode(){return this.isInEditMode()?(this.parent.setEditingState(!0),m(this,Za,!1),!0):!1}isInEditMode(){return o(this,Za)}shouldGetKeyboardEvents(){return o(this,dr)}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}get isOnScreen(){const{top:e,left:t,bottom:s,right:i}=this.getClientDimensions(),{innerHeight:r,innerWidth:a}=window;return t<a&&i>0&&e<r&&s>0}rebuild(){A(this,J,Ky).call(this)}rotate(e){}resize(){}serializeDeleted(){var e;return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:((e=this._initialData)==null?void 0:e.popupRef)||""}}serialize(e=!1,t=null){var s;return{annotationType:this.mode,pageIndex:this.pageIndex,rect:this.getPDFRect(),rotation:this.rotation,structTreeParentId:this._structTreeParentId,popupRef:((s=this._initialData)==null?void 0:s.popupRef)||""}}static async deserialize(e,t,s){const i=new this.prototype.constructor({parent:t,id:t.getNextId(),uiManager:s,annotationElementId:e.annotationElementId,creationDate:e.creationDate,modificationDate:e.modificationDate});i.rotation=e.rotation,m(i,Ka,e.accessibilityData),i._isCopy=e.isCopy||!1;const[r,a]=i.pageDimensions,[l,c,u,d]=i.getRectInCurrentCoords(e.rect,a);return i.x=l/r,i.y=c/a,i.width=u/r,i.height=d/a,i}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||this.serialize()!==null)}remove(){var e,t,s;if((e=o(this,Lo))==null||e.abort(),m(this,Lo,null),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),this.hideCommentPopup(),o(this,Ei)&&(clearTimeout(o(this,Ei)),m(this,Ei,null)),A(this,J,th).call(this),this.removeEditToolbar(),o(this,Tn)){for(const i of o(this,Tn).values())clearTimeout(i);m(this,Tn,null)}this.parent=null,(t=o(this,el))==null||t.destroy(),m(this,el,null),(s=o(this,Cn))==null||s.remove(),m(this,Cn,null)}get isResizable(){return!1}makeResizable(){this.isResizable&&(A(this,J,tE).call(this),o(this,Ut).classList.remove("hidden"))}get toolbarPosition(){return null}get commentButtonPosition(){return this._uiManager.direction==="ltr"?[1,0]:[0,0]}get commentButtonPositionInPage(){const{commentButtonPosition:[e,t]}=this,[s,i,r,a]=this.getPDFRect();return[re._round(s+(r-s)*e),re._round(i+(a-i)*(1-t))]}get commentButtonColor(){return this._uiManager.makeCommentColor(this.getNonHCMColor(),this.opacity)}get commentPopupPosition(){return o(this,Pe).commentPopupPositionInLayer}set commentPopupPosition(e){o(this,Pe).commentPopupPositionInLayer=e}hasDefaultPopupPosition(){return o(this,Pe).hasDefaultPopupPosition()}get commentButtonWidth(){return o(this,Pe).commentButtonWidth}get elementBeforePopup(){return this.div}setCommentButtonStates(e){var t;(t=o(this,Pe))==null||t.setCommentButtonStates(e)}keydown(e){if(!this.isResizable||e.target!==this.div||e.key!=="Enter")return;this._uiManager.setSelected(this),m(this,ur,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const t=o(this,Ut).children;if(!o(this,qn)){m(this,qn,Array.from(t));const a=A(this,J,aE).bind(this),l=A(this,J,lE).bind(this),c=this._uiManager._signal;for(const u of o(this,qn)){const d=u.getAttribute("data-resizer-name");u.setAttribute("role","spinbutton"),u.addEventListener("keydown",a,{signal:c}),u.addEventListener("blur",l,{signal:c}),u.addEventListener("focus",A(this,J,cE).bind(this,d),{signal:c}),u.setAttribute("data-l10n-id",re._l10nResizer[d])}}const s=o(this,qn)[0];let i=0;for(const a of t){if(a===s)break;i++}const r=(360-this.rotation+this.parentRotation)%360/90*(o(this,qn).length/4);if(r!==i){if(r<i)for(let l=0;l<i-r;l++)o(this,Ut).append(o(this,Ut).firstElementChild);else if(r>i)for(let l=0;l<r-i;l++)o(this,Ut).firstElementChild.before(o(this,Ut).lastElementChild);let a=0;for(const l of t){const u=o(this,qn)[a++].getAttribute("data-resizer-name");l.setAttribute("data-l10n-id",re._l10nResizer[u])}}A(this,J,Qy).call(this,0),m(this,dr,!0),o(this,Ut).firstElementChild.focus({focusVisible:!0}),e.preventDefault(),e.stopImmediatePropagation()}_resizeWithKeyboard(e,t){o(this,dr)&&A(this,J,Yy).call(this,o(this,wf),{deltaX:e,deltaY:t,fromKeyboard:!0})}_stopResizingWithKeyboard(){A(this,J,th).call(this),this.div.focus()}select(){var e,t,s;if(this.isSelected&&this._editToolbar){this._editToolbar.show();return}if(this.isSelected=!0,this.makeResizable(),(e=this.div)==null||e.classList.add("selectedEditor"),!this._editToolbar){this.addEditToolbar().then(()=>{var i,r;(i=this.div)!=null&&i.classList.contains("selectedEditor")&&((r=this._editToolbar)==null||r.show())});return}(t=this._editToolbar)==null||t.show(),(s=o(this,qe))==null||s.toggleAltTextBadge(!1)}focus(){this.div&&!this.div.contains(document.activeElement)&&setTimeout(()=>{var e;return(e=this.div)==null?void 0:e.focus({preventScroll:!0})},0)}unselect(){var e,t,s,i,r;this.isSelected&&(this.isSelected=!1,(e=o(this,Ut))==null||e.classList.add("hidden"),(t=this.div)==null||t.classList.remove("selectedEditor"),(s=this.div)!=null&&s.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),(i=this._editToolbar)==null||i.hide(),(r=o(this,qe))==null||r.toggleAltTextBadge(!0),this.hideCommentPopup())}hideCommentPopup(){this.hasComment&&this._uiManager.toggleComment(null)}updateParams(e,t){}disableEditing(){}enableEditing(){}get canChangeContent(){return!1}enterInEditMode(){this.canChangeContent&&(this.enableEditMode(),this.div.focus())}dblclick(e){e.target.nodeName!=="BUTTON"&&(this.enterInEditMode(),this.parent.updateToolbar({mode:this.constructor._editorType,editId:this.uid}))}getElementForAltText(){return this.div}get contentDiv(){return this.div}get isEditing(){return o(this,Af)}set isEditing(e){m(this,Af,e),this.parent&&(e?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(e,t=!1){if(t){o(this,Tn)||m(this,Tn,new Map);const{action:s}=e;let i=o(this,Tn).get(s);i&&clearTimeout(i),i=setTimeout(()=>{this._reportTelemetry(e),o(this,Tn).delete(s),o(this,Tn).size===0&&m(this,Tn,null)},re._telemetryTimeout),o(this,Tn).set(s,i);return}e.type||(e.type=this.editorType),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:e}})}show(e=this._isVisible){this.div.classList.toggle("hidden",!e),this._isVisible=e}enable(){this.div&&(this.div.tabIndex=0),m(this,hu,!1)}disable(){this.div&&(this.div.tabIndex=-1),m(this,hu,!0)}updateFakeAnnotationElement(e){if(!o(this,Cn)&&!this.deleted){m(this,Cn,e.addFakeAnnotation(this));return}if(this.deleted){o(this,Cn).remove(),m(this,Cn,null);return}(this.hasEditedComment||this._hasBeenMoved||this._hasBeenResized)&&o(this,Cn).updateEdited({rect:this.getPDFRect(),popup:this.comment})}renderAnnotationElement(e){if(this.deleted)return e.hide(),null;let t=e.container.querySelector(".annotationContent");if(!t)t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),e.container.prepend(t);else if(t.nodeName==="CANVAS"){const s=t;t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),s.before(t)}return t}resetAnnotationElement(e){const{firstElementChild:t}=e.container;(t==null?void 0:t.nodeName)==="DIV"&&t.classList.contains("annotationContent")&&t.remove()}};Ka=new WeakMap,qn=new WeakMap,qe=new WeakMap,Pe=new WeakMap,cr=new WeakMap,hu=new WeakMap,Mo=new WeakMap,bf=new WeakMap,Ut=new WeakMap,Qa=new WeakMap,ur=new WeakMap,Cn=new WeakMap,Lo=new WeakMap,wf=new WeakMap,Ja=new WeakMap,Us=new WeakMap,Af=new WeakMap,Za=new WeakMap,dr=new WeakMap,Ei=new WeakMap,fu=new WeakMap,pu=new WeakMap,Tn=new WeakMap,el=new WeakMap,kf=new WeakMap,d0=new WeakMap,J=new WeakSet,Wy=function([e,t],s,i){[s,i]=this.screenToPageTranslation(s,i),this.x+=s/e,this.y+=i/t,this._onTranslating(this.x,this.y),this.fixAndSetPosition()},Sf=new WeakSet,Gy=function(e,t,s){switch(s){case 90:return[t,-e];case 180:return[-e,-t];case 270:return[-t,e];default:return[e,t]}},Xm=function(e){switch(e){case 90:{const[t,s]=this.pageDimensions;return[0,-t/s,s/t,0]}case 180:return[-1,0,0,-1];case 270:{const[t,s]=this.pageDimensions;return[0,t/s,-s/t,0]}default:return[1,0,0,1]}},tE=function(){if(o(this,Ut))return;m(this,Ut,document.createElement("div")),o(this,Ut).classList.add("resizers");const e=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],t=this._uiManager._signal;for(const s of e){const i=document.createElement("div");o(this,Ut).append(i),i.classList.add("resizer",s),i.setAttribute("data-resizer-name",s),i.addEventListener("pointerdown",A(this,J,sE).bind(this,s),{signal:t}),i.addEventListener("contextmenu",zn,{signal:t}),i.tabIndex=-1}this.div.prepend(o(this,Ut))},sE=function(e,t){var d;t.preventDefault();const{isMac:s}=Nt.platform;if(t.button!==0||t.ctrlKey&&s)return;(d=o(this,qe))==null||d.toggle(!1);const i=this._isDraggable;this._isDraggable=!1,m(this,Qa,[t.screenX,t.screenY]);const r=new AbortController,a=this._uiManager.combinedSignal(r);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",A(this,J,Yy).bind(this,e),{passive:!0,capture:!0,signal:a}),window.addEventListener("touchmove",ut,{passive:!1,signal:a}),window.addEventListener("contextmenu",zn,{signal:a}),m(this,ur,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const l=this.parent.div.style.cursor,c=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(t.target).cursor;const u=()=>{var h;r.abort(),this.parent.togglePointerEvents(!0),(h=o(this,qe))==null||h.toggle(!0),this._isDraggable=i,this.parent.div.style.cursor=l,this.div.style.cursor=c,A(this,J,Ym).call(this)};window.addEventListener("pointerup",u,{signal:a}),window.addEventListener("blur",u,{signal:a})},Xy=function(e,t,s,i){this.width=s,this.height=i,this.x=e,this.y=t,this.setDims(),this.fixAndSetPosition(),this._onResized()},Ym=function(){if(!o(this,ur))return;const{savedX:e,savedY:t,savedWidth:s,savedHeight:i}=o(this,ur);m(this,ur,null);const r=this.x,a=this.y,l=this.width,c=this.height;r===e&&a===t&&l===s&&c===i||this.addCommands({cmd:A(this,J,Xy).bind(this,r,a,l,c),undo:A(this,J,Xy).bind(this,e,t,s,i),mustExec:!0})},Yy=function(e,t){const[s,i]=this.parentDimensions,r=this.x,a=this.y,l=this.width,c=this.height,u=re.MIN_SIZE/s,d=re.MIN_SIZE/i,h=A(this,J,Xm).call(this,this.rotation),f=(G,$)=>[h[0]*G+h[2]*$,h[1]*G+h[3]*$],p=A(this,J,Xm).call(this,360-this.rotation),v=(G,$)=>[p[0]*G+p[2]*$,p[1]*G+p[3]*$];let b,S,y=!1,k=!1;switch(e){case"topLeft":y=!0,b=(G,$)=>[0,0],S=(G,$)=>[G,$];break;case"topMiddle":b=(G,$)=>[G/2,0],S=(G,$)=>[G/2,$];break;case"topRight":y=!0,b=(G,$)=>[G,0],S=(G,$)=>[0,$];break;case"middleRight":k=!0,b=(G,$)=>[G,$/2],S=(G,$)=>[0,$/2];break;case"bottomRight":y=!0,b=(G,$)=>[G,$],S=(G,$)=>[0,0];break;case"bottomMiddle":b=(G,$)=>[G/2,$],S=(G,$)=>[G/2,0];break;case"bottomLeft":y=!0,b=(G,$)=>[0,$],S=(G,$)=>[G,0];break;case"middleLeft":k=!0,b=(G,$)=>[0,$/2],S=(G,$)=>[G,$/2];break}const w=b(l,c),E=S(l,c);let C=f(...E);const T=re._round(r+C[0]),_=re._round(a+C[1]);let P=1,D=1,I,F;if(t.fromKeyboard)({deltaX:I,deltaY:F}=t);else{const{screenX:G,screenY:$}=t,[R,X]=o(this,Qa);[I,F]=this.screenToPageTranslation(G-R,$-X),o(this,Qa)[0]=G,o(this,Qa)[1]=$}if([I,F]=v(I/s,F/i),y){const G=Math.hypot(l,c);P=D=Math.max(Math.min(Math.hypot(E[0]-w[0]-I,E[1]-w[1]-F)/G,1/l,1/c),u/l,d/c)}else k?P=Gt(Math.abs(E[0]-w[0]-I),u,1)/l:D=Gt(Math.abs(E[1]-w[1]-F),d,1)/c;const K=re._round(l*P),Z=re._round(c*D);C=f(...S(K,Z));const Q=T-C[0],se=_-C[1];o(this,Us)||m(this,Us,[this.x,this.y,this.width,this.height]),this.width=K,this.height=Z,this.x=Q,this.y=se,this.setDims(),this.fixAndSetPosition(),this._onResizing()},nE=function(){var e;m(this,ur,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height}),(e=o(this,qe))==null||e.toggle(!1),this.parent.togglePointerEvents(!1)},iE=function(e,t,s){let r=.7*(s/t)+1-.7;if(r===1)return;const a=A(this,J,Xm).call(this,this.rotation),l=(T,_)=>[a[0]*T+a[2]*_,a[1]*T+a[3]*_],[c,u]=this.parentDimensions,d=this.x,h=this.y,f=this.width,p=this.height,v=re.MIN_SIZE/c,b=re.MIN_SIZE/u;r=Math.max(Math.min(r,1/f,1/p),v/f,b/p);const S=re._round(f*r),y=re._round(p*r);if(S===f&&y===p)return;o(this,Us)||m(this,Us,[d,h,f,p]);const k=l(f/2,p/2),w=re._round(d+k[0]),E=re._round(h+k[1]),C=l(S/2,y/2);this.x=w-C[0],this.y=E-C[1],this.width=S,this.height=y,this.setDims(),this.fixAndSetPosition(),this._onResizing()},rE=function(){var e;(e=o(this,qe))==null||e.toggle(!0),this.parent.togglePointerEvents(!0),A(this,J,Ym).call(this)},qy=function(e){const{isMac:t}=Nt.platform;e.ctrlKey&&!t||e.shiftKey||e.metaKey&&t?this.parent.toggleSelected(this):this.parent.setSelected(this)},oE=function(e){const{isSelected:t}=this;this._uiManager.setUpDragSession();let s=!1;const i=new AbortController,r=this._uiManager.combinedSignal(i),a={capture:!0,passive:!1,signal:r},l=u=>{i.abort(),m(this,Mo,null),m(this,Ja,!1),this._uiManager.endDragSession()||A(this,J,qy).call(this,u),s&&this._onStopDragging()};t&&(m(this,fu,e.clientX),m(this,pu,e.clientY),m(this,Mo,e.pointerId),m(this,bf,e.pointerType),window.addEventListener("pointermove",u=>{s||(s=!0,this._uiManager.toggleComment(this,!0,!1),this._onStartDragging());const{clientX:d,clientY:h,pointerId:f}=u;if(f!==o(this,Mo)){ut(u);return}const[p,v]=this.screenToPageTranslation(d-o(this,fu),h-o(this,pu));m(this,fu,d),m(this,pu,h),this._uiManager.dragSelectedEditors(p,v)},a),window.addEventListener("touchmove",ut,a),window.addEventListener("pointerdown",u=>{u.pointerType===o(this,bf)&&(o(this,el)||u.isPrimary)&&l(u),ut(u)},a));const c=u=>{if(!o(this,Mo)||o(this,Mo)===u.pointerId){l(u);return}ut(u)};window.addEventListener("pointerup",c,{signal:r}),window.addEventListener("blur",c,{signal:r})},Ky=function(){if(o(this,Lo)||!this.div)return;m(this,Lo,new AbortController);const e=this._uiManager.combinedSignal(o(this,Lo));this.div.addEventListener("focusin",this.focusin.bind(this),{signal:e}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:e})},aE=function(e){re._resizerKeyboardManager.exec(this,e)},lE=function(e){var t;o(this,dr)&&((t=e.relatedTarget)==null?void 0:t.parentNode)!==o(this,Ut)&&A(this,J,th).call(this)},cE=function(e){m(this,wf,o(this,dr)?e:"")},Qy=function(e){if(o(this,qn))for(const t of o(this,qn))t.tabIndex=e},th=function(){m(this,dr,!1),A(this,J,Qy).call(this,-1),A(this,J,Ym).call(this)},x(re,Sf),M(re,"_l10n",null),M(re,"_l10nResizer",null),M(re,"_borderLineWidth",-1),M(re,"_colorManager",new By),M(re,"_zIndex",1),M(re,"_telemetryTimeout",1e3);let Ve=re;class TN extends Ve{constructor(e){super(e),this.annotationElementId=e.annotationElementId,this.deleted=!0}serialize(){return this.serializeDeleted()}}const B1=3285377520,gn=4294901760,pi=65535;class uE{constructor(e){this.h1=e?e&4294967295:B1,this.h2=e?e&4294967295:B1}update(e){let t,s;if(typeof e=="string"){t=new Uint8Array(e.length*2),s=0;for(let b=0,S=e.length;b<S;b++){const y=e.charCodeAt(b);y<=255?t[s++]=y:(t[s++]=y>>>8,t[s++]=y&255)}}else if(ArrayBuffer.isView(e))t=e.slice(),s=t.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");const i=s>>2,r=s-i*4,a=new Uint32Array(t.buffer,0,i);let l=0,c=0,u=this.h1,d=this.h2;const h=3432918353,f=461845907,p=h&pi,v=f&pi;for(let b=0;b<i;b++)b&1?(l=a[b],l=l*h&gn|l*p&pi,l=l<<15|l>>>17,l=l*f&gn|l*v&pi,u^=l,u=u<<13|u>>>19,u=u*5+3864292196):(c=a[b],c=c*h&gn|c*p&pi,c=c<<15|c>>>17,c=c*f&gn|c*v&pi,d^=c,d=d<<13|d>>>19,d=d*5+3864292196);switch(l=0,r){case 3:l^=t[i*4+2]<<16;case 2:l^=t[i*4+1]<<8;case 1:l^=t[i*4],l=l*h&gn|l*p&pi,l=l<<15|l>>>17,l=l*f&gn|l*v&pi,i&1?u^=l:d^=l}this.h1=u,this.h2=d}hexdigest(){let e=this.h1,t=this.h2;return e^=t>>>1,e=e*3981806797&gn|e*36045&pi,t=t*4283543511&gn|((t<<16|e>>>16)*2950163797&gn)>>>16,e^=t>>>1,e=e*444984403&gn|e*60499&pi,t=t*3301882366&gn|((t<<16|e>>>16)*3120437893&gn)>>>16,e^=t>>>1,(e>>>0).toString(16).padStart(8,"0")+(t>>>0).toString(16).padStart(8,"0")}}const Jy=Object.freeze({map:null,hash:"",transfer:void 0});var tl,sl,hr,Ht,h0,dE;class nw{constructor(){x(this,h0);x(this,tl,!1);x(this,sl,null);x(this,hr,null);x(this,Ht,new Map);this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(e,t){const s=o(this,Ht).get(e);return s===void 0?t:Object.assign(t,s)}getRawValue(e){return o(this,Ht).get(e)}remove(e){const t=o(this,Ht).get(e);if(t!==void 0&&(t instanceof Ve&&o(this,hr).delete(t.annotationElementId),o(this,Ht).delete(e),o(this,Ht).size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function")){for(const s of o(this,Ht).values())if(s instanceof Ve)return;this.onAnnotationEditor(null)}}setValue(e,t){const s=o(this,Ht).get(e);let i=!1;if(s!==void 0)for(const[r,a]of Object.entries(t))s[r]!==a&&(i=!0,s[r]=a);else i=!0,o(this,Ht).set(e,t);i&&A(this,h0,dE).call(this),t instanceof Ve&&((o(this,hr)||m(this,hr,new Map)).set(t.annotationElementId,t),typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(t.constructor._type))}has(e){return o(this,Ht).has(e)}get size(){return o(this,Ht).size}resetModified(){o(this,tl)&&(m(this,tl,!1),typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new hE(this)}get serializable(){if(o(this,Ht).size===0)return Jy;const e=new Map,t=new uE,s=[],i=Object.create(null);let r=!1;for(const[a,l]of o(this,Ht)){const c=l instanceof Ve?l.serialize(!1,i):l;l.page&&(l.pageIndex=l.page._pageIndex,delete l.page),c&&(e.set(a,c),t.update(`${a}:${JSON.stringify(c)}`),r||(r=!!c.bitmap))}if(r)for(const a of e.values())a.bitmap&&s.push(a.bitmap);return e.size>0?{map:e,hash:t.hexdigest(),transfer:s}:Jy}get editorStats(){let e=null;const t=new Map;let s=0,i=0;for(const r of o(this,Ht).values()){if(!(r instanceof Ve)){r.popup&&(r.popup.deleted?i+=1:s+=1);continue}r.isCommentDeleted?i+=1:r.hasEditedComment&&(s+=1);const a=r.telemetryFinalData;if(!a)continue;const{type:l}=a;t.has(l)||t.set(l,Object.getPrototypeOf(r).constructor),e||(e=Object.create(null));const c=e[l]||(e[l]=new Map);for(const[u,d]of Object.entries(a)){if(u==="type")continue;let h=c.get(u);h||(h=new Map,c.set(u,h));const f=h.get(d)??0;h.set(d,f+1)}}if((i>0||s>0)&&(e||(e=Object.create(null)),e.comments={deleted:i,edited:s}),!e)return null;for(const[r,a]of t)e[r]=a.computeTelemetryFinalData(e[r]);return e}resetModifiedIds(){m(this,sl,null)}updateEditor(e,t){var i;const s=(i=o(this,hr))==null?void 0:i.get(e);return s?(s.updateFromAnnotationLayer(t),!0):!1}getEditor(e){var t;return((t=o(this,hr))==null?void 0:t.get(e))||null}get modifiedIds(){if(o(this,sl))return o(this,sl);const e=[];if(o(this,hr))for(const t of o(this,hr).values())t.serialize()&&e.push(t.annotationElementId);return m(this,sl,{ids:new Set(e),hash:e.join(",")})}[Symbol.iterator](){return o(this,Ht).entries()}}tl=new WeakMap,sl=new WeakMap,hr=new WeakMap,Ht=new WeakMap,h0=new WeakSet,dE=function(){o(this,tl)||(m(this,tl,!0),typeof this.onSetModified=="function"&&this.onSetModified())};var Ef;class hE extends nw{constructor(t){super();x(this,Ef);const{map:s,hash:i,transfer:r}=t.serializable,a=structuredClone(s,r?{transfer:r}:null);m(this,Ef,{map:a,hash:i,transfer:r})}get print(){Ce("Should not call PrintAnnotationStorage.print")}get serializable(){return o(this,Ef)}get modifiedIds(){return ie(this,"modifiedIds",{ids:new Set,hash:""})}}Ef=new WeakMap;var mu;class _N{constructor({ownerDocument:e=globalThis.document,styleElement:t=null}){x(this,mu,new Set);this._document=e,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(e){this.nativeFontFaces.add(e),this._document.fonts.add(e)}removeNativeFontFace(e){this.nativeFontFaces.delete(e),this._document.fonts.delete(e)}insertRule(e){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const t=this.styleElement.sheet;t.insertRule(e,t.cssRules.length)}clear(){for(const e of this.nativeFontFaces)this._document.fonts.delete(e);this.nativeFontFaces.clear(),o(this,mu).clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:e,disableFontFace:t,_inspectFont:s}){if(!(!e||o(this,mu).has(e.loadedName))){if(Ee(!t,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:i,src:r,style:a}=e,l=new FontFace(i,r,a);this.addNativeFontFace(l);try{await l.load(),o(this,mu).add(i),s==null||s(e)}catch{ne(`Cannot load system font: ${e.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(l)}return}Ce("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(e){if(e.attached||e.missingFile&&!e.systemFontInfo)return;if(e.attached=!0,e.systemFontInfo){await this.loadSystemFont(e);return}if(this.isFontLoadingAPISupported){const s=e.createNativeFontFace();if(s){this.addNativeFontFace(s);try{await s.loaded}catch(i){throw ne(`Failed to load font '${s.family}': '${i}'.`),e.disableFontFace=!0,i}}return}const t=e.createFontFaceRule();if(t){if(this.insertRule(t),this.isSyncFontLoadingSupported)return;await new Promise(s=>{const i=this._queueLoadingCallback(s);this._prepareFontLoadEvent(e,i)})}}get isFontLoadingAPISupported(){var t;const e=!!((t=this._document)!=null&&t.fonts);return ie(this,"isFontLoadingAPISupported",e)}get isSyncFontLoadingSupported(){return ie(this,"isSyncFontLoadingSupported",ps||Nt.platform.isFirefox)}_queueLoadingCallback(e){function t(){for(Ee(!i.done,"completeRequest() cannot be called twice."),i.done=!0;s.length>0&&s[0].done;){const r=s.shift();setTimeout(r.callback,0)}}const{loadingRequests:s}=this,i={done:!1,complete:t,callback:e};return s.push(i),i}get _loadTestFont(){const e=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return ie(this,"_loadTestFont",e)}_prepareFontLoadEvent(e,t){function s(E,C){return E.charCodeAt(C)<<24|E.charCodeAt(C+1)<<16|E.charCodeAt(C+2)<<8|E.charCodeAt(C+3)&255}function i(E,C,T,_){const P=E.substring(0,C),D=E.substring(C+T);return P+_+D}let r,a;const l=this._document.createElement("canvas");l.width=1,l.height=1;const c=l.getContext("2d");let u=0;function d(E,C){if(++u>30){ne("Load test font never loaded."),C();return}if(c.font="30px "+E,c.fillText(".",0,20),c.getImageData(0,0,1,1).data[3]>0){C();return}setTimeout(d.bind(null,E,C))}const h=`lt${Date.now()}${this.loadTestFontId++}`;let f=this._loadTestFont;f=i(f,976,h.length,h);const v=16,b=1482184792;let S=s(f,v);for(r=0,a=h.length-3;r<a;r+=4)S=S-b+s(h,r)|0;r<h.length&&(S=S-b+s(h+"XXX",r)|0),f=i(f,v,4,cN(S));const y=`url(data:font/opentype;base64,${btoa(f)});`,k=`@font-face {font-family:"${h}";src:${y}}`;this.insertRule(k);const w=this._document.createElement("div");w.style.visibility="hidden",w.style.width=w.style.height="10px",w.style.position="absolute",w.style.top=w.style.left="0px";for(const E of[e.loadedName,h]){const C=this._document.createElement("span");C.textContent="Hi",C.style.fontFamily=E,w.append(C)}this._document.body.append(w),d(h,()=>{w.remove(),t.complete()})}}mu=new WeakMap;var Ie;class NN{constructor(e,t=null,s,i){x(this,Ie);this.compiledGlyphs=Object.create(null),m(this,Ie,e),this._inspectFont=t,s&&Object.assign(this,s),i&&(this.charProcOperatorList=i)}createNativeFontFace(){var t;if(!this.data||this.disableFontFace)return null;let e;if(!this.cssFontInfo)e=new FontFace(this.loadedName,this.data,{});else{const s={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(s.style=`oblique ${this.cssFontInfo.italicAngle}deg`),e=new FontFace(this.cssFontInfo.fontFamily,this.data,s)}return(t=this._inspectFont)==null||t.call(this,this),e}createFontFaceRule(){var s;if(!this.data||this.disableFontFace)return null;const e=`url(data:${this.mimetype};base64,${this.data.toBase64()});`;let t;if(!this.cssFontInfo)t=`@font-face {font-family:"${this.loadedName}";src:${e}}`;else{let i=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(i+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),t=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${i}src:${e}}`}return(s=this._inspectFont)==null||s.call(this,this,e),t}getPathGenerator(e,t){if(this.compiledGlyphs[t]!==void 0)return this.compiledGlyphs[t];const s=this.loadedName+"_path_"+t;let i;try{i=e.get(s)}catch(a){ne(`getPathGenerator - ignoring character: "${a}".`)}const r=PS(i==null?void 0:i.path);return this.fontExtraProperties||e.delete(s),this.compiledGlyphs[t]=r}get black(){return o(this,Ie).black}get bold(){return o(this,Ie).bold}get disableFontFace(){return o(this,Ie).disableFontFace??!1}set disableFontFace(e){ie(this,"disableFontFace",!!e)}get fontExtraProperties(){return o(this,Ie).fontExtraProperties??!1}get isInvalidPDFjsFont(){return o(this,Ie).isInvalidPDFjsFont}get isType3Font(){return o(this,Ie).isType3Font}get italic(){return o(this,Ie).italic}get missingFile(){return o(this,Ie).missingFile}get remeasure(){return o(this,Ie).remeasure}get vertical(){return o(this,Ie).vertical}get ascent(){return o(this,Ie).ascent}get defaultWidth(){return o(this,Ie).defaultWidth}get descent(){return o(this,Ie).descent}get bbox(){return o(this,Ie).bbox}set bbox(e){ie(this,"bbox",e)}get fontMatrix(){return o(this,Ie).fontMatrix}get fallbackName(){return o(this,Ie).fallbackName}get loadedName(){return o(this,Ie).loadedName}get mimetype(){return o(this,Ie).mimetype}get name(){return o(this,Ie).name}get data(){return o(this,Ie).data}clearData(){o(this,Ie).clearData()}get cssFontInfo(){return o(this,Ie).cssFontInfo}get systemFontInfo(){return o(this,Ie).systemFontInfo}get defaultVMetrics(){return o(this,Ie).defaultVMetrics}}Ie=new WeakMap;var gu,vu,Cf,yu,qm;const jc=class jc{constructor(e){x(this,yu);x(this,gu);x(this,vu);x(this,Cf);m(this,gu,e),m(this,vu,new DataView(o(this,gu))),m(this,Cf,new TextDecoder)}static write(e){const t=new TextEncoder,s={};let i=0;for(const u of jc.strings){const d=t.encode(e[u]);s[u]=d,i+=4+d.length}const r=new ArrayBuffer(i),a=new Uint8Array(r),l=new DataView(r);let c=0;for(const u of jc.strings){const d=s[u],h=d.length;l.setUint32(c,h),a.set(d,c+4),c+=4+h}return Ee(c===r.byteLength,"CssFontInfo.write: Buffer overflow"),r}get fontFamily(){return A(this,yu,qm).call(this,0)}get fontWeight(){return A(this,yu,qm).call(this,1)}get italicAngle(){return A(this,yu,qm).call(this,2)}};gu=new WeakMap,vu=new WeakMap,Cf=new WeakMap,yu=new WeakSet,qm=function(e){Ee(e<jc.strings.length,"Invalid string index");let t=0;for(let i=0;i<e;i++)t+=o(this,vu).getUint32(t)+4;const s=o(this,vu).getUint32(t);return o(this,Cf).decode(new Uint8Array(o(this,gu),t+4,s))},M(jc,"strings",["fontFamily","fontWeight","italicAngle"]);let Qg=jc;var Do,Ci,nl,il,sh;const Oc=class Oc{constructor(e){x(this,il);x(this,Do);x(this,Ci);x(this,nl);m(this,Do,e),m(this,Ci,new DataView(o(this,Do))),m(this,nl,new TextDecoder)}static write(e){const t=new TextEncoder,s={};let i=0;for(const f of Oc.strings){const p=t.encode(e[f]);s[f]=p,i+=4+p.length}i+=4;let r,a,l=1+i;e.style&&(r=t.encode(e.style.style),a=t.encode(e.style.weight),l+=4+r.length+4+a.length);const c=new ArrayBuffer(l),u=new Uint8Array(c),d=new DataView(c);let h=0;d.setUint8(h++,e.guessFallback?1:0),d.setUint32(h,0),h+=4,i=0;for(const f of Oc.strings){const p=s[f],v=p.length;i+=4+v,d.setUint32(h,v),u.set(p,h+4),h+=4+v}return d.setUint32(h-i-4,i),e.style&&(d.setUint32(h,r.length),u.set(r,h+4),h+=4+r.length,d.setUint32(h,a.length),u.set(a,h+4),h+=4+a.length),Ee(h<=c.byteLength,"SubstitionInfo.write: Buffer overflow"),c.transferToFixedLength(h)}get guessFallback(){return o(this,Ci).getUint8(0)!==0}get css(){return A(this,il,sh).call(this,0)}get loadedName(){return A(this,il,sh).call(this,1)}get baseFontName(){return A(this,il,sh).call(this,2)}get src(){return A(this,il,sh).call(this,3)}get style(){let e=1;e+=4+o(this,Ci).getUint32(e);const t=o(this,Ci).getUint32(e),s=o(this,nl).decode(new Uint8Array(o(this,Do),e+4,t));e+=4+t;const i=o(this,Ci).getUint32(e),r=o(this,nl).decode(new Uint8Array(o(this,Do),e+4,i));return{style:s,weight:r}}};Do=new WeakMap,Ci=new WeakMap,nl=new WeakMap,il=new WeakSet,sh=function(e){Ee(e<Oc.strings.length,"Invalid string index");let t=5;for(let i=0;i<e;i++)t+=o(this,Ci).getUint32(t)+4;const s=o(this,Ci).getUint32(t);return o(this,nl).decode(new Uint8Array(o(this,Do),t+4,s))},M(Oc,"strings",["css","loadedName","baseFontName","src"]);let Jg=Oc;var xu,bu,wu,Au,Hs,Ti,Tf,Re,lt,Vn,Km,nh;const le=class le{constructor({data:e,extra:t}){x(this,lt);x(this,Ti);x(this,Tf);x(this,Re);m(this,Ti,e),m(this,Tf,new TextDecoder),m(this,Re,new DataView(o(this,Ti))),t&&Object.assign(this,t)}get black(){return A(this,lt,Vn).call(this,0)}get bold(){return A(this,lt,Vn).call(this,1)}get disableFontFace(){return A(this,lt,Vn).call(this,2)}get fontExtraProperties(){return A(this,lt,Vn).call(this,3)}get isInvalidPDFjsFont(){return A(this,lt,Vn).call(this,4)}get isType3Font(){return A(this,lt,Vn).call(this,5)}get italic(){return A(this,lt,Vn).call(this,6)}get missingFile(){return A(this,lt,Vn).call(this,7)}get remeasure(){return A(this,lt,Vn).call(this,8)}get vertical(){return A(this,lt,Vn).call(this,9)}get ascent(){return A(this,lt,Km).call(this,0)}get defaultWidth(){return A(this,lt,Km).call(this,1)}get descent(){return A(this,lt,Km).call(this,2)}get bbox(){let e=o(le,bu);if(o(this,Re).getUint8(e)===0)return;e+=1;const s=[];for(let i=0;i<4;i++)s.push(o(this,Re).getInt16(e,!0)),e+=2;return s}get fontMatrix(){let e=o(le,wu);if(o(this,Re).getUint8(e)===0)return;e+=1;const s=[];for(let i=0;i<6;i++)s.push(o(this,Re).getFloat64(e,!0)),e+=8;return s}get defaultVMetrics(){let e=o(le,Au);if(o(this,Re).getUint8(e)===0)return;e+=1;const s=[];for(let i=0;i<3;i++)s.push(o(this,Re).getInt16(e,!0)),e+=2;return s}get fallbackName(){return A(this,lt,nh).call(this,0)}get loadedName(){return A(this,lt,nh).call(this,1)}get mimetype(){return A(this,lt,nh).call(this,2)}get name(){return A(this,lt,nh).call(this,3)}get data(){let e=o(le,Hs);const t=o(this,Re).getUint32(e);e+=4+t;const s=o(this,Re).getUint32(e);e+=4+s;const i=o(this,Re).getUint32(e);e+=4+i;const r=o(this,Re).getUint32(e);if(r!==0)return new Uint8Array(o(this,Ti),e+4,r)}clearData(){let e=o(le,Hs);const t=o(this,Re).getUint32(e);e+=4+t;const s=o(this,Re).getUint32(e);e+=4+s;const i=o(this,Re).getUint32(e);e+=4+i;const r=o(this,Re).getUint32(e);new Uint8Array(o(this,Ti),e+4,r).fill(0),o(this,Re).setUint32(e,0)}get cssFontInfo(){let e=o(le,Hs);const t=o(this,Re).getUint32(e);e+=4+t;const s=o(this,Re).getUint32(e);e+=4+s;const i=o(this,Re).getUint32(e);if(i===0)return null;const r=new Uint8Array(i);return r.set(new Uint8Array(o(this,Ti),e+4,i)),new Qg(r.buffer)}get systemFontInfo(){let e=o(le,Hs);const t=o(this,Re).getUint32(e);e+=4+t;const s=o(this,Re).getUint32(e);if(s===0)return null;const i=new Uint8Array(s);return i.set(new Uint8Array(o(this,Ti),e+4,s)),new Jg(i.buffer)}static write(e){const t=e.systemFontInfo?Jg.write(e.systemFontInfo):null,s=e.cssFontInfo?Qg.write(e.cssFontInfo):null,i=new TextEncoder,r={};let a=0;for(const b of le.strings)r[b]=i.encode(e[b]),a+=4+r[b].length;const l=o(le,Hs)+4+a+4+(t?t.byteLength:0)+4+(s?s.byteLength:0)+4+(e.data?e.data.length:0),c=new ArrayBuffer(l),u=new Uint8Array(c),d=new DataView(c);let h=0;const f=le.bools.length;let p=0,v=0;for(let b=0;b<f;b++){const S=e[le.bools[b]];p|=(S===void 0?0:S?2:1)<<v,v+=2,(v===8||b===f-1)&&(d.setUint8(h++,p),p=0,v=0)}Ee(h===o(le,xu),"FontInfo.write: Boolean properties offset mismatch");for(const b of le.numbers)d.setFloat64(h,e[b]),h+=8;if(Ee(h===o(le,bu),"FontInfo.write: Number properties offset mismatch"),e.bbox){d.setUint8(h++,4);for(const b of e.bbox)d.setInt16(h,b,!0),h+=2}else d.setUint8(h++,0),h+=2*4;if(Ee(h===o(le,wu),"FontInfo.write: BBox properties offset mismatch"),e.fontMatrix){d.setUint8(h++,6);for(const b of e.fontMatrix)d.setFloat64(h,b,!0),h+=8}else d.setUint8(h++,0),h+=8*6;if(Ee(h===o(le,Au),"FontInfo.write: FontMatrix properties offset mismatch"),e.defaultVMetrics){d.setUint8(h++,1);for(const b of e.defaultVMetrics)d.setInt16(h,b,!0),h+=2}else d.setUint8(h++,0),h+=3*2;Ee(h===o(le,Hs),"FontInfo.write: DefaultVMetrics properties offset mismatch"),d.setUint32(o(le,Hs),0),h+=4;for(const b of le.strings){const S=r[b],y=S.length;d.setUint32(h,y),u.set(S,h+4),h+=4+y}if(d.setUint32(o(le,Hs),h-o(le,Hs)-4),!t)d.setUint32(h,0),h+=4;else{const b=t.byteLength;d.setUint32(h,b),Ee(h+4+b<=c.byteLength,"FontInfo.write: Buffer overflow at systemFontInfo"),u.set(new Uint8Array(t),h+4),h+=4+b}if(!s)d.setUint32(h,0),h+=4;else{const b=s.byteLength;d.setUint32(h,b),Ee(h+4+b<=c.byteLength,"FontInfo.write: Buffer overflow at cssFontInfo"),u.set(new Uint8Array(s),h+4),h+=4+b}return e.data===void 0?(d.setUint32(h,0),h+=4):(d.setUint32(h,e.data.length),u.set(e.data,h+4),h+=4+e.data.length),Ee(h<=c.byteLength,"FontInfo.write: Buffer overflow"),c.transferToFixedLength(h)}};xu=new WeakMap,bu=new WeakMap,wu=new WeakMap,Au=new WeakMap,Hs=new WeakMap,Ti=new WeakMap,Tf=new WeakMap,Re=new WeakMap,lt=new WeakSet,Vn=function(e){Ee(e<le.bools.length,"Invalid boolean index");const t=Math.floor(e/4),s=e*2%8,i=o(this,Re).getUint8(t)>>s&3;return i===0?void 0:i===2},Km=function(e){return Ee(e<le.numbers.length,"Invalid number index"),o(this,Re).getFloat64(o(le,xu)+e*8)},nh=function(e){Ee(e<le.strings.length,"Invalid string index");let t=o(le,Hs)+4;for(let r=0;r<e;r++)t+=o(this,Re).getUint32(t)+4;const s=o(this,Re).getUint32(t),i=new Uint8Array(s);return i.set(new Uint8Array(o(this,Ti),t+4,s)),o(this,Tf).decode(i)},M(le,"bools",["black","bold","disableFontFace","fontExtraProperties","isInvalidPDFjsFont","isType3Font","italic","missingFile","remeasure","vertical"]),M(le,"numbers",["ascent","defaultWidth","descent"]),M(le,"strings",["fallbackName","loadedName","mimetype","name"]),x(le,xu,Math.ceil(le.bools.length*2/8)),x(le,bu,o(le,xu)+le.numbers.length*8),x(le,wu,o(le,bu)+1+2*4),x(le,Au,o(le,wu)+1+8*6),x(le,Hs,o(le,Au)+1+2*3);let Zy=le;var _f,Nf,Pf,Mf,Lf,Df,If,Rf;const Ue=class Ue{constructor(e){this.buffer=e,this.view=new DataView(e),this.data=new Uint8Array(e)}static write(e){let t,s=null,i=[],r=[],a=[],l=[],c=null,u=null;switch(e[0]){case"RadialAxial":t=e[1]==="axial"?1:2,s=e[2],a=e[3],t===1?i.push(...e[4],...e[5]):i.push(e[4][0],e[4][1],e[6],e[5][0],e[5][1],e[7]);break;case"Mesh":t=3,c=e[1],i=e[2],r=e[3],l=e[4]||[],s=e[6],u=e[7];break;default:throw new Error(`Unsupported pattern type: ${e[0]}`)}const d=Math.floor(i.length/2),h=Math.floor(r.length/3),f=a.length,p=l.length;let v=0;for(const C of l)v+=1,v=Math.ceil(v/4)*4,v+=4+C.coords.length*4,v+=4+C.colors.length*4,C.verticesPerRow!==void 0&&(v+=4);const b=20+d*8+h*3+f*8+(s?16:0)+(u?3:0)+v,S=new ArrayBuffer(b),y=new DataView(S),k=new Uint8Array(S);y.setUint8(o(Ue,_f),t),y.setUint8(o(Ue,Nf),s?1:0),y.setUint8(o(Ue,Pf),u?1:0),y.setUint8(o(Ue,Mf),c),y.setUint32(o(Ue,Lf),d,!0),y.setUint32(o(Ue,Df),h,!0),y.setUint32(o(Ue,If),f,!0),y.setUint32(o(Ue,Rf),p,!0);let w=20;new Float32Array(S,w,d*2).set(i),w+=d*8,k.set(r,w),w+=h*3;for(const[C,T]of a)y.setFloat32(w,C,!0),w+=4,y.setUint32(w,parseInt(T.slice(1),16),!0),w+=4;if(s)for(const C of s)y.setFloat32(w,C,!0),w+=4;u&&(k.set(u,w),w+=3);for(let C=0;C<l.length;C++){const T=l[C];y.setUint8(w,T.type),w+=1,w=Math.ceil(w/4)*4,y.setUint32(w,T.coords.length,!0),w+=4,new Int32Array(S,w,T.coords.length).set(T.coords),w+=T.coords.length*4,y.setUint32(w,T.colors.length,!0),w+=4,new Int32Array(S,w,T.colors.length).set(T.colors),w+=T.colors.length*4,T.verticesPerRow!==void 0&&(y.setUint32(w,T.verticesPerRow,!0),w+=4)}return S}getIR(){const e=this.view,t=this.data[o(Ue,_f)],s=!!this.data[o(Ue,Nf)],i=!!this.data[o(Ue,Pf)],r=e.getUint32(o(Ue,Lf),!0),a=e.getUint32(o(Ue,Df),!0),l=e.getUint32(o(Ue,If),!0),c=e.getUint32(o(Ue,Rf),!0);let u=20;const d=new Float32Array(this.buffer,u,r*2);u+=r*8;const h=new Uint8Array(this.buffer,u,a*3);u+=a*3;const f=[];for(let S=0;S<l;++S){const y=e.getFloat32(u,!0);u+=4;const k=e.getUint32(u,!0);u+=4,f.push([y,`#${k.toString(16).padStart(6,"0")}`])}let p=null;if(s){p=[];for(let S=0;S<4;++S)p.push(e.getFloat32(u,!0)),u+=4}let v=null;i&&(v=new Uint8Array(this.buffer,u,3),u+=3);const b=[];for(let S=0;S<c;++S){const y=e.getUint8(u);u+=1,u=Math.ceil(u/4)*4;const k=e.getUint32(u,!0);u+=4;const w=new Int32Array(this.buffer,u,k);u+=k*4;const E=e.getUint32(u,!0);u+=4;const C=new Int32Array(this.buffer,u,E);u+=E*4;const T={type:y,coords:w,colors:C};y===My.LATTICE&&(T.verticesPerRow=e.getUint32(u,!0),u+=4),b.push(T)}if(t===1)return["RadialAxial","axial",p,f,Array.from(d.slice(0,2)),Array.from(d.slice(2,4)),null,null];if(t===2)return["RadialAxial","radial",p,f,[d[0],d[1]],[d[3],d[4]],d[2],d[5]];if(t===3){const S=this.data[o(Ue,Mf)];let y=null;if(d.length>0){let k=d[0],w=d[0],E=d[1],C=d[1];for(let T=0;T<d.length;T+=2){const _=d[T],P=d[T+1];k=k>_?_:k,E=E>P?P:E,w=w<_?_:w,C=C<P?P:C}y=[k,E,w,C]}return["Mesh",S,d,h,b,y,p,v]}throw new Error(`Unsupported pattern kind: ${t}`)}};_f=new WeakMap,Nf=new WeakMap,Pf=new WeakMap,Mf=new WeakMap,Lf=new WeakMap,Df=new WeakMap,If=new WeakMap,Rf=new WeakMap,x(Ue,_f,0),x(Ue,Nf,1),x(Ue,Pf,2),x(Ue,Mf,3),x(Ue,Lf,4),x(Ue,Df,8),x(Ue,If,12),x(Ue,Rf,16);let ex=Ue;var ku;class PN{constructor(e){x(this,ku);m(this,ku,e)}static write(e){let t,s;return Nt.isFloat16ArraySupported?(s=new ArrayBuffer(e.length*2),t=new Float16Array(s)):(s=new ArrayBuffer(e.length*4),t=new Float32Array(s)),t.set(e),s}get path(){return Nt.isFloat16ArraySupported?new Float16Array(o(this,ku)):new Float32Array(o(this,ku))}}ku=new WeakMap;function MN(n){if(n instanceof URL)return n.href;if(typeof n=="string"){if(ps)return n;const e=URL.parse(n,window.location);if(e)return e.href}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function LN(n){if(ps&&typeof Buffer<"u"&&n instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(n instanceof Uint8Array&&n.byteLength===n.buffer.byteLength)return n;if(typeof n=="string")return V0(n);if(n instanceof ArrayBuffer||ArrayBuffer.isView(n)||typeof n=="object"&&!isNaN(n==null?void 0:n.length))return new Uint8Array(n);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}function Am(n){if(typeof n!="string")return null;if(n.endsWith("/"))return n;throw new Error(`Invalid factory url: "${n}" must include trailing slash.`)}const tx=n=>typeof n=="object"&&Number.isInteger(n==null?void 0:n.num)&&n.num>=0&&Number.isInteger(n==null?void 0:n.gen)&&n.gen>=0,DN=n=>typeof n=="object"&&typeof(n==null?void 0:n.name)=="string",IN=pN.bind(null,tx,DN);var fr,f0;class RN{constructor(){x(this,fr,new Map);x(this,f0,Promise.resolve())}postMessage(e,t){const s={data:structuredClone(e,t?{transfer:t}:null)};o(this,f0).then(()=>{for(const[i]of o(this,fr))i.call(this,s)})}addEventListener(e,t,s=null){let i=null;if((s==null?void 0:s.signal)instanceof AbortSignal){const{signal:r}=s;if(r.aborted){ne("LoopbackPort - cannot use an `aborted` signal.");return}const a=()=>this.removeEventListener(e,t);i=()=>r.removeEventListener("abort",a),r.addEventListener("abort",a)}o(this,fr).set(t,i)}removeEventListener(e,t){const s=o(this,fr).get(t);s==null||s(),o(this,fr).delete(t)}terminate(){for(const[,e]of o(this,fr))e==null||e();o(this,fr).clear()}}fr=new WeakMap,f0=new WeakMap;const km={DATA:1,ERROR:2},vt={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function z1(){}function As(n){if(n instanceof va||n instanceof Ly||n instanceof L1||n instanceof Xg||n instanceof _v)return n;switch(n instanceof Error||typeof n=="object"&&n!==null||Ce('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),n.name){case"AbortException":return new va(n.message);case"InvalidPDFException":return new Ly(n.message);case"PasswordException":return new L1(n.message,n.code);case"ResponseException":return new Xg(n.message,n.status,n.missing);case"UnknownErrorException":return new _v(n.message,n.details)}return new _v(n.message,n.toString())}var Su,jn,fE,pE,mE,Qm;class ih{constructor(e,t,s){x(this,jn);x(this,Su,new AbortController);this.sourceName=e,this.targetName=t,this.comObj=s,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),s.addEventListener("message",A(this,jn,fE).bind(this),{signal:o(this,Su).signal})}on(e,t){const s=this.actionHandler;if(s[e])throw new Error(`There is already an actionName called "${e}"`);s[e]=t}send(e,t,s){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,data:t},s)}sendWithPromise(e,t,s){const i=this.callbackId++,r=Promise.withResolvers();this.callbackCapabilities[i]=r;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,callbackId:i,data:t},s)}catch(a){r.reject(a)}return r.promise}sendWithStream(e,t,s,i){const r=this.streamId++,a=this.sourceName,l=this.targetName,c=this.comObj;return new ReadableStream({start:u=>{const d=Promise.withResolvers();return this.streamControllers[r]={controller:u,startCall:d,pullCall:null,cancelCall:null,isClosed:!1},c.postMessage({sourceName:a,targetName:l,action:e,streamId:r,data:t,desiredSize:u.desiredSize},i),d.promise},pull:u=>{const d=Promise.withResolvers();return this.streamControllers[r].pullCall=d,c.postMessage({sourceName:a,targetName:l,stream:vt.PULL,streamId:r,desiredSize:u.desiredSize}),d.promise},cancel:u=>{Ee(u instanceof Error,"cancel must have a valid reason");const d=Promise.withResolvers();return this.streamControllers[r].cancelCall=d,this.streamControllers[r].isClosed=!0,c.postMessage({sourceName:a,targetName:l,stream:vt.CANCEL,streamId:r,reason:As(u)}),d.promise}},s)}destroy(){var e;(e=o(this,Su))==null||e.abort(),m(this,Su,null)}}Su=new WeakMap,jn=new WeakSet,fE=function({data:e}){if(e.targetName!==this.sourceName)return;if(e.stream){A(this,jn,mE).call(this,e);return}if(e.callback){const s=e.callbackId,i=this.callbackCapabilities[s];if(!i)throw new Error(`Cannot resolve callback ${s}`);if(delete this.callbackCapabilities[s],e.callback===km.DATA)i.resolve(e.data);else if(e.callback===km.ERROR)i.reject(As(e.reason));else throw new Error("Unexpected callback case");return}const t=this.actionHandler[e.action];if(!t)throw new Error(`Unknown action from worker: ${e.action}`);if(e.callbackId){const s=this.sourceName,i=e.sourceName,r=this.comObj;Promise.try(t,e.data).then(function(a){r.postMessage({sourceName:s,targetName:i,callback:km.DATA,callbackId:e.callbackId,data:a})},function(a){r.postMessage({sourceName:s,targetName:i,callback:km.ERROR,callbackId:e.callbackId,reason:As(a)})});return}if(e.streamId){A(this,jn,pE).call(this,e);return}t(e.data)},pE=function(e){const t=e.streamId,s=this.sourceName,i=e.sourceName,r=this.comObj,a=this,l=this.actionHandler[e.action],c={enqueue(u,d=1,h){if(this.isCancelled)return;const f=this.desiredSize;this.desiredSize-=d,f>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),r.postMessage({sourceName:s,targetName:i,stream:vt.ENQUEUE,streamId:t,chunk:u},h)},close(){this.isCancelled||(this.isCancelled=!0,r.postMessage({sourceName:s,targetName:i,stream:vt.CLOSE,streamId:t}),delete a.streamSinks[t])},error(u){Ee(u instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,r.postMessage({sourceName:s,targetName:i,stream:vt.ERROR,streamId:t,reason:As(u)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:e.desiredSize,ready:null};c.sinkCapability.resolve(),c.ready=c.sinkCapability.promise,this.streamSinks[t]=c,Promise.try(l,e.data,c).then(function(){r.postMessage({sourceName:s,targetName:i,stream:vt.START_COMPLETE,streamId:t,success:!0})},function(u){r.postMessage({sourceName:s,targetName:i,stream:vt.START_COMPLETE,streamId:t,reason:As(u)})})},mE=function(e){const t=e.streamId,s=this.sourceName,i=e.sourceName,r=this.comObj,a=this.streamControllers[t],l=this.streamSinks[t];switch(e.stream){case vt.START_COMPLETE:e.success?a.startCall.resolve():a.startCall.reject(As(e.reason));break;case vt.PULL_COMPLETE:e.success?a.pullCall.resolve():a.pullCall.reject(As(e.reason));break;case vt.PULL:if(!l){r.postMessage({sourceName:s,targetName:i,stream:vt.PULL_COMPLETE,streamId:t,success:!0});break}l.desiredSize<=0&&e.desiredSize>0&&l.sinkCapability.resolve(),l.desiredSize=e.desiredSize,Promise.try(l.onPull||z1).then(function(){r.postMessage({sourceName:s,targetName:i,stream:vt.PULL_COMPLETE,streamId:t,success:!0})},function(u){r.postMessage({sourceName:s,targetName:i,stream:vt.PULL_COMPLETE,streamId:t,reason:As(u)})});break;case vt.ENQUEUE:if(Ee(a,"enqueue should have stream controller"),a.isClosed)break;a.controller.enqueue(e.chunk);break;case vt.CLOSE:if(Ee(a,"close should have stream controller"),a.isClosed)break;a.isClosed=!0,a.controller.close(),A(this,jn,Qm).call(this,a,t);break;case vt.ERROR:Ee(a,"error should have stream controller"),a.controller.error(As(e.reason)),A(this,jn,Qm).call(this,a,t);break;case vt.CANCEL_COMPLETE:e.success?a.cancelCall.resolve():a.cancelCall.reject(As(e.reason)),A(this,jn,Qm).call(this,a,t);break;case vt.CANCEL:if(!l)break;const c=As(e.reason);Promise.try(l.onCancel||z1,c).then(function(){r.postMessage({sourceName:s,targetName:i,stream:vt.CANCEL_COMPLETE,streamId:t,success:!0})},function(u){r.postMessage({sourceName:s,targetName:i,stream:vt.CANCEL_COMPLETE,streamId:t,reason:As(u)})}),l.sinkCapability.reject(c),l.isCancelled=!0,delete this.streamSinks[t];break;default:throw new Error("Unexpected stream case")}},Qm=async function(e,t){var s,i,r;await Promise.allSettled([(s=e.startCall)==null?void 0:s.promise,(i=e.pullCall)==null?void 0:i.promise,(r=e.cancelCall)==null?void 0:r.promise]),delete this.streamControllers[t]};var Ff;class gE{constructor({enableHWA:e=!1}){x(this,Ff,!1);m(this,Ff,e)}create(e,t){if(e<=0||t<=0)throw new Error("Invalid canvas size");const s=this._createCanvas(e,t);return{canvas:s,context:s.getContext("2d",{willReadFrequently:!o(this,Ff)})}}reset(e,t,s){if(!e.canvas)throw new Error("Canvas is not specified");if(t<=0||s<=0)throw new Error("Invalid canvas size");e.canvas.width=t,e.canvas.height=s}destroy(e){if(!e.canvas)throw new Error("Canvas is not specified");e.canvas.width=0,e.canvas.height=0,e.canvas=null,e.context=null}_createCanvas(e,t){Ce("Abstract method `_createCanvas` called.")}}Ff=new WeakMap;class FN extends gE{constructor({ownerDocument:e=globalThis.document,enableHWA:t=!1}){super({enableHWA:t}),this._document=e}_createCanvas(e,t){const s=this._document.createElement("canvas");return s.width=e,s.height=t,s}}class vE{constructor({baseUrl:e=null,isCompressed:t=!0}){this.baseUrl=e,this.isCompressed=t}async fetch({name:e}){if(!this.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!e)throw new Error("CMap name must be specified.");const t=this.baseUrl+e+(this.isCompressed?".bcmap":"");return this._fetch(t).then(s=>({cMapData:s,isCompressed:this.isCompressed})).catch(s=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${t}`)})}async _fetch(e){Ce("Abstract method `_fetch` called.")}}class U1 extends vE{async _fetch(e){const t=await Qp(e,this.isCompressed?"arraybuffer":"text");return t instanceof ArrayBuffer?new Uint8Array(t):V0(t)}}class yE{addFilter(e){return"none"}addHCMFilter(e,t){return"none"}addAlphaFilter(e){return"none"}addLuminosityFilter(e){return"none"}addHighlightHCMFilter(e,t,s,i,r){return"none"}destroy(e=!1){}}var rl,Eu,pr,mr,is,ol,al,U,es,rh,gc,Jm,vc,xE,sx,yc,oh,ah,nx,lh;class jN extends yE{constructor({docId:t,ownerDocument:s=globalThis.document}){super();x(this,U);x(this,rl);x(this,Eu);x(this,pr);x(this,mr);x(this,is);x(this,ol);x(this,al,0);m(this,mr,t),m(this,is,s)}addFilter(t){if(!t)return"none";let s=o(this,U,es).get(t);if(s)return s;const[i,r,a]=A(this,U,Jm).call(this,t),l=t.length===1?i:`${i}${r}${a}`;if(s=o(this,U,es).get(l),s)return o(this,U,es).set(t,s),s;const c=`g_${o(this,mr)}_transfer_map_${At(this,al)._++}`,u=A(this,U,vc).call(this,c);o(this,U,es).set(t,u),o(this,U,es).set(l,u);const d=A(this,U,yc).call(this,c);return A(this,U,ah).call(this,i,r,a,d),u}addHCMFilter(t,s){var v;const i=`${t}-${s}`,r="base";let a=o(this,U,rh).get(r);if((a==null?void 0:a.key)===i||(a?((v=a.filter)==null||v.remove(),a.key=i,a.url="none",a.filter=null):(a={key:i,url:"none",filter:null},o(this,U,rh).set(r,a)),!t||!s))return a.url;const l=A(this,U,lh).call(this,t);t=z.makeHexColor(...l);const c=A(this,U,lh).call(this,s);if(s=z.makeHexColor(...c),o(this,U,gc).style.color="",t==="#000000"&&s==="#ffffff"||t===s)return a.url;const u=new Array(256);for(let b=0;b<=255;b++){const S=b/255;u[b]=S<=.03928?S/12.92:((S+.055)/1.055)**2.4}const d=u.join(","),h=`g_${o(this,mr)}_hcm_filter`,f=a.filter=A(this,U,yc).call(this,h);A(this,U,ah).call(this,d,d,d,f),A(this,U,sx).call(this,f);const p=(b,S)=>{const y=l[b]/255,k=c[b]/255,w=new Array(S+1);for(let E=0;E<=S;E++)w[E]=y+E/S*(k-y);return w.join(",")};return A(this,U,ah).call(this,p(0,5),p(1,5),p(2,5),f),a.url=A(this,U,vc).call(this,h),a.url}addAlphaFilter(t){let s=o(this,U,es).get(t);if(s)return s;const[i]=A(this,U,Jm).call(this,[t]),r=`alpha_${i}`;if(s=o(this,U,es).get(r),s)return o(this,U,es).set(t,s),s;const a=`g_${o(this,mr)}_alpha_map_${At(this,al)._++}`,l=A(this,U,vc).call(this,a);o(this,U,es).set(t,l),o(this,U,es).set(r,l);const c=A(this,U,yc).call(this,a);return A(this,U,nx).call(this,i,c),l}addLuminosityFilter(t){let s=o(this,U,es).get(t||"luminosity");if(s)return s;let i,r;if(t?([i]=A(this,U,Jm).call(this,[t]),r=`luminosity_${i}`):r="luminosity",s=o(this,U,es).get(r),s)return o(this,U,es).set(t,s),s;const a=`g_${o(this,mr)}_luminosity_map_${At(this,al)._++}`,l=A(this,U,vc).call(this,a);o(this,U,es).set(t,l),o(this,U,es).set(r,l);const c=A(this,U,yc).call(this,a);return A(this,U,xE).call(this,c),t&&A(this,U,nx).call(this,i,c),l}addHighlightHCMFilter(t,s,i,r,a){var k;const l=`${s}-${i}-${r}-${a}`;let c=o(this,U,rh).get(t);if((c==null?void 0:c.key)===l||(c?((k=c.filter)==null||k.remove(),c.key=l,c.url="none",c.filter=null):(c={key:l,url:"none",filter:null},o(this,U,rh).set(t,c)),!s||!i))return c.url;const[u,d]=[s,i].map(A(this,U,lh).bind(this));let h=Math.round(.2126*u[0]+.7152*u[1]+.0722*u[2]),f=Math.round(.2126*d[0]+.7152*d[1]+.0722*d[2]),[p,v]=[r,a].map(A(this,U,lh).bind(this));f<h&&([h,f,p,v]=[f,h,v,p]),o(this,U,gc).style.color="";const b=(w,E,C)=>{const T=new Array(256),_=(f-h)/C,P=w/255,D=(E-w)/(255*C);let I=0;for(let F=0;F<=C;F++){const K=Math.round(h+F*_),Z=P+F*D;for(let Q=I;Q<=K;Q++)T[Q]=Z;I=K+1}for(let F=I;F<256;F++)T[F]=T[I-1];return T.join(",")},S=`g_${o(this,mr)}_hcm_${t}_filter`,y=c.filter=A(this,U,yc).call(this,S);return A(this,U,sx).call(this,y),A(this,U,ah).call(this,b(p[0],v[0],5),b(p[1],v[1],5),b(p[2],v[2],5),y),c.url=A(this,U,vc).call(this,S),c.url}destroy(t=!1){var s,i,r,a;t&&((s=o(this,ol))!=null&&s.size)||((i=o(this,pr))==null||i.parentNode.parentNode.remove(),m(this,pr,null),(r=o(this,Eu))==null||r.clear(),m(this,Eu,null),(a=o(this,ol))==null||a.clear(),m(this,ol,null),m(this,al,0))}}rl=new WeakMap,Eu=new WeakMap,pr=new WeakMap,mr=new WeakMap,is=new WeakMap,ol=new WeakMap,al=new WeakMap,U=new WeakSet,es=function(){return o(this,Eu)||m(this,Eu,new Map)},rh=function(){return o(this,ol)||m(this,ol,new Map)},gc=function(){if(!o(this,pr)){const t=o(this,is).createElement("div"),{style:s}=t;s.visibility="hidden",s.contain="strict",s.width=s.height=0,s.position="absolute",s.top=s.left=0,s.zIndex=-1;const i=o(this,is).createElementNS(Xi,"svg");i.setAttribute("width",0),i.setAttribute("height",0),m(this,pr,o(this,is).createElementNS(Xi,"defs")),t.append(i),i.append(o(this,pr)),o(this,is).body.append(t)}return o(this,pr)},Jm=function(t){if(t.length===1){const u=t[0],d=new Array(256);for(let f=0;f<256;f++)d[f]=u[f]/255;const h=d.join(",");return[h,h,h]}const[s,i,r]=t,a=new Array(256),l=new Array(256),c=new Array(256);for(let u=0;u<256;u++)a[u]=s[u]/255,l[u]=i[u]/255,c[u]=r[u]/255;return[a.join(","),l.join(","),c.join(",")]},vc=function(t){if(o(this,rl)===void 0){m(this,rl,"");const s=o(this,is).URL;s!==o(this,is).baseURI&&(W0(s)?ne('#createUrl: ignore "data:"-URL for performance reasons.'):m(this,rl,CS(s,"")))}return`url(${o(this,rl)}#${t})`},xE=function(t){const s=o(this,is).createElementNS(Xi,"feColorMatrix");s.setAttribute("type","matrix"),s.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),t.append(s)},sx=function(t){const s=o(this,is).createElementNS(Xi,"feColorMatrix");s.setAttribute("type","matrix"),s.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),t.append(s)},yc=function(t){const s=o(this,is).createElementNS(Xi,"filter");return s.setAttribute("color-interpolation-filters","sRGB"),s.setAttribute("id",t),o(this,U,gc).append(s),s},oh=function(t,s,i){const r=o(this,is).createElementNS(Xi,s);r.setAttribute("type","discrete"),r.setAttribute("tableValues",i),t.append(r)},ah=function(t,s,i,r){const a=o(this,is).createElementNS(Xi,"feComponentTransfer");r.append(a),A(this,U,oh).call(this,a,"feFuncR",t),A(this,U,oh).call(this,a,"feFuncG",s),A(this,U,oh).call(this,a,"feFuncB",i)},nx=function(t,s){const i=o(this,is).createElementNS(Xi,"feComponentTransfer");s.append(i),A(this,U,oh).call(this,i,"feFuncA",t)},lh=function(t){return o(this,U,gc).style.color=t,Zp(getComputedStyle(o(this,U,gc)).getPropertyValue("color"))};class bE{constructor({baseUrl:e=null}){this.baseUrl=e}async fetch({filename:e}){if(!this.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!e)throw new Error("Font filename must be specified.");const t=`${this.baseUrl}${e}`;return this._fetch(t).catch(s=>{throw new Error(`Unable to load font data at: ${t}`)})}async _fetch(e){Ce("Abstract method `_fetch` called.")}}class H1 extends bE{async _fetch(e){const t=await Qp(e,"arraybuffer");return new Uint8Array(t)}}class wE{constructor({baseUrl:e=null}){this.baseUrl=e}async fetch({filename:e}){if(!this.baseUrl)throw new Error("Ensure that the `wasmUrl` API parameter is provided.");if(!e)throw new Error("Wasm filename must be specified.");const t=`${this.baseUrl}${e}`;return this._fetch(t).catch(s=>{throw new Error(`Unable to load wasm data at: ${t}`)})}async _fetch(e){Ce("Abstract method `_fetch` called.")}}class $1 extends wE{async _fetch(e){const t=await Qp(e,"arraybuffer");return new Uint8Array(t)}}ps&&ne("Please use the `legacy` build in Node.js environments.");async function iw(n){const t=await process.getBuiltinModule("fs").promises.readFile(n);return new Uint8Array(t)}class ON extends yE{}class BN extends gE{_createCanvas(e,t){return process.getBuiltinModule("module").createRequire(import.meta.url)("@napi-rs/canvas").createCanvas(e,t)}}class zN extends vE{async _fetch(e){return iw(e)}}class UN extends bE{async _fetch(e){return iw(e)}}class HN extends wE{async _fetch(e){return iw(e)}}const fc="__forcedDependency",{floor:V1,ceil:W1}=Math;function Sm(n,e,t,s,i,r){n[e*4+0]=Math.min(n[e*4+0],t),n[e*4+1]=Math.min(n[e*4+1],s),n[e*4+2]=Math.max(n[e*4+2],i),n[e*4+3]=Math.max(n[e*4+3],r)}const ix=new Uint32Array(new Uint8Array([255,255,0,0]).buffer)[0];var Cu,Io;class $N{constructor(e,t){x(this,Cu);x(this,Io);m(this,Cu,e),m(this,Io,t)}get length(){return o(this,Cu).length}isEmpty(e){return o(this,Cu)[e]===ix}minX(e){return o(this,Io)[e*4+0]/256}minY(e){return o(this,Io)[e*4+1]/256}maxX(e){return(o(this,Io)[e*4+2]+1)/256}maxY(e){return(o(this,Io)[e*4+3]+1)/256}}Cu=new WeakMap,Io=new WeakMap;const Em=(n,e)=>{if(!n)return;let t=n.get(e);return t||(t={dependencies:new Set,isRenderingOperation:!1},n.set(e,t)),t};var Es,Cs,ll,Kn,cl,gr,Me,Fe,vr,Ts,jf,Tu,ul,dl,yr,rs,_i,Of,rx;class VN{constructor(e,t,s=!1){x(this,Of);x(this,Es,{__proto__:null});x(this,Cs,{__proto__:null,transform:[],moveText:[],sameLineText:[],[fc]:[]});x(this,ll,new Map);x(this,Kn,[]);x(this,cl,[]);x(this,gr,[[1,0,0,1,0,0]]);x(this,Me,[-1/0,-1/0,1/0,1/0]);x(this,Fe,new Float64Array([1/0,1/0,-1/0,-1/0]));x(this,vr,-1);x(this,Ts,new Set);x(this,jf,new Map);x(this,Tu,new Map);x(this,ul);x(this,dl);x(this,yr);x(this,rs);x(this,_i);m(this,ul,e.width),m(this,dl,e.height),A(this,Of,rx).call(this,t),s&&m(this,_i,new Map)}growOperationsCount(e){e>=o(this,rs).length&&A(this,Of,rx).call(this,e,o(this,rs))}save(e){return m(this,Es,{__proto__:o(this,Es)}),m(this,Cs,{__proto__:o(this,Cs),transform:{__proto__:o(this,Cs).transform},moveText:{__proto__:o(this,Cs).moveText},sameLineText:{__proto__:o(this,Cs).sameLineText},[fc]:{__proto__:o(this,Cs)[fc]}}),m(this,Me,{__proto__:o(this,Me)}),o(this,Kn).push(e),this}restore(e){var i;const t=Object.getPrototypeOf(o(this,Es));if(t===null)return this;m(this,Es,t),m(this,Cs,Object.getPrototypeOf(o(this,Cs))),m(this,Me,Object.getPrototypeOf(o(this,Me)));const s=o(this,Kn).pop();return s!==void 0&&((i=Em(o(this,_i),e))==null||i.dependencies.add(s),o(this,rs)[e]=o(this,rs)[s]),this}recordOpenMarker(e){return o(this,Kn).push(e),this}getOpenMarker(){return o(this,Kn).length===0?null:o(this,Kn).at(-1)}recordCloseMarker(e){var s;const t=o(this,Kn).pop();return t!==void 0&&((s=Em(o(this,_i),e))==null||s.dependencies.add(t),o(this,rs)[e]=o(this,rs)[t]),this}beginMarkedContent(e){return o(this,cl).push(e),this}endMarkedContent(e){var s;const t=o(this,cl).pop();return t!==void 0&&((s=Em(o(this,_i),e))==null||s.dependencies.add(t),o(this,rs)[e]=o(this,rs)[t]),this}pushBaseTransform(e){return o(this,gr).push(z.multiplyByDOMMatrix(o(this,gr).at(-1),e.getTransform())),this}popBaseTransform(){return o(this,gr).length>1&&o(this,gr).pop(),this}recordSimpleData(e,t){return o(this,Es)[e]=t,this}recordIncrementalData(e,t){return o(this,Cs)[e].push(t),this}resetIncrementalData(e,t){return o(this,Cs)[e].length=0,this}recordNamedData(e,t){return o(this,ll).set(e,t),this}recordSimpleDataFromNamed(e,t,s){o(this,Es)[e]=o(this,ll).get(t)??s}recordFutureForcedDependency(e,t){return this.recordIncrementalData(fc,t),this}inheritSimpleDataAsFutureForcedDependencies(e){for(const t of e)t in o(this,Es)&&this.recordFutureForcedDependency(t,o(this,Es)[t]);return this}inheritPendingDependenciesAsFutureForcedDependencies(){for(const e of o(this,Ts))this.recordFutureForcedDependency(fc,e);return this}resetBBox(e){return o(this,vr)!==e&&(m(this,vr,e),o(this,Fe)[0]=1/0,o(this,Fe)[1]=1/0,o(this,Fe)[2]=-1/0,o(this,Fe)[3]=-1/0),this}recordClipBox(e,t,s,i,r,a){const l=z.multiplyByDOMMatrix(o(this,gr).at(-1),t.getTransform()),c=[1/0,1/0,-1/0,-1/0];z.axialAlignedBoundingBox([s,r,i,a],l,c);const u=z.intersect(o(this,Me),c);return u?(o(this,Me)[0]=u[0],o(this,Me)[1]=u[1],o(this,Me)[2]=u[2],o(this,Me)[3]=u[3]):(o(this,Me)[0]=o(this,Me)[1]=1/0,o(this,Me)[2]=o(this,Me)[3]=-1/0),this}recordBBox(e,t,s,i,r,a){const l=o(this,Me);if(l[0]===1/0)return this;const c=z.multiplyByDOMMatrix(o(this,gr).at(-1),t.getTransform());if(l[0]===-1/0)return z.axialAlignedBoundingBox([s,r,i,a],c,o(this,Fe)),this;const u=[1/0,1/0,-1/0,-1/0];return z.axialAlignedBoundingBox([s,r,i,a],c,u),o(this,Fe)[0]=Math.min(o(this,Fe)[0],Math.max(u[0],l[0])),o(this,Fe)[1]=Math.min(o(this,Fe)[1],Math.max(u[1],l[1])),o(this,Fe)[2]=Math.max(o(this,Fe)[2],Math.min(u[2],l[2])),o(this,Fe)[3]=Math.max(o(this,Fe)[3],Math.min(u[3],l[3])),this}recordCharacterBBox(e,t,s,i=1,r=0,a=0,l){const c=s.bbox;let u,d;if(c&&(u=c[2]!==c[0]&&c[3]!==c[1]&&o(this,Tu).get(s),u!==!1&&(d=[0,0,0,0],z.axialAlignedBoundingBox(c,s.fontMatrix,d),(i!==1||r!==0||a!==0)&&z.scaleMinMax([i,0,0,-i,r,a],d),u)))return this.recordBBox(e,t,d[0],d[2],d[1],d[3]);if(!l)return this.recordFullPageBBox(e);const h=l();return c&&d&&u===void 0&&(u=d[0]<=r-h.actualBoundingBoxLeft&&d[2]>=r+h.actualBoundingBoxRight&&d[1]<=a-h.actualBoundingBoxAscent&&d[3]>=a+h.actualBoundingBoxDescent,o(this,Tu).set(s,u),u)?this.recordBBox(e,t,d[0],d[2],d[1],d[3]):this.recordBBox(e,t,r-h.actualBoundingBoxLeft,r+h.actualBoundingBoxRight,a-h.actualBoundingBoxAscent,a+h.actualBoundingBoxDescent)}recordFullPageBBox(e){return o(this,Fe)[0]=Math.max(0,o(this,Me)[0]),o(this,Fe)[1]=Math.max(0,o(this,Me)[1]),o(this,Fe)[2]=Math.min(o(this,ul),o(this,Me)[2]),o(this,Fe)[3]=Math.min(o(this,dl),o(this,Me)[3]),this}getSimpleIndex(e){return o(this,Es)[e]}recordDependencies(e,t){const s=o(this,Ts),i=o(this,Es),r=o(this,Cs);for(const a of t)a in o(this,Es)?s.add(i[a]):a in r&&r[a].forEach(s.add,s);return this}recordNamedDependency(e,t){return o(this,ll).has(t)&&o(this,Ts).add(o(this,ll).get(t)),this}recordOperation(e,t=!1){if(this.recordDependencies(e,[fc]),o(this,_i)){const s=Em(o(this,_i),e),{dependencies:i}=s;o(this,Ts).forEach(i.add,i),o(this,Kn).forEach(i.add,i),o(this,cl).forEach(i.add,i),i.delete(e),s.isRenderingOperation=!0}if(o(this,vr)===e){const s=V1(o(this,Fe)[0]*256/o(this,ul)),i=V1(o(this,Fe)[1]*256/o(this,dl)),r=W1(o(this,Fe)[2]*256/o(this,ul)),a=W1(o(this,Fe)[3]*256/o(this,dl));Sm(o(this,yr),e,s,i,r,a);for(const l of o(this,Ts))l!==e&&Sm(o(this,yr),l,s,i,r,a);for(const l of o(this,Kn))l!==e&&Sm(o(this,yr),l,s,i,r,a);for(const l of o(this,cl))l!==e&&Sm(o(this,yr),l,s,i,r,a);t||(o(this,Ts).clear(),m(this,vr,-1))}return this}recordShowTextOperation(e,t=!1){const s=Array.from(o(this,Ts));this.recordOperation(e,t),this.recordIncrementalData("sameLineText",e);for(const i of s)this.recordIncrementalData("sameLineText",i);return this}bboxToClipBoxDropOperation(e,t=!1){return o(this,vr)===e&&(m(this,vr,-1),o(this,Me)[0]=Math.max(o(this,Me)[0],o(this,Fe)[0]),o(this,Me)[1]=Math.max(o(this,Me)[1],o(this,Fe)[1]),o(this,Me)[2]=Math.min(o(this,Me)[2],o(this,Fe)[2]),o(this,Me)[3]=Math.min(o(this,Me)[3],o(this,Fe)[3]),t||o(this,Ts).clear()),this}_takePendingDependencies(){const e=o(this,Ts);return m(this,Ts,new Set),e}_extractOperation(e){const t=o(this,jf).get(e);return o(this,jf).delete(e),t}_pushPendingDependencies(e){for(const t of e)o(this,Ts).add(t)}take(){return o(this,Tu).clear(),new $N(o(this,rs),o(this,yr))}takeDebugMetadata(){return o(this,_i)}}Es=new WeakMap,Cs=new WeakMap,ll=new WeakMap,Kn=new WeakMap,cl=new WeakMap,gr=new WeakMap,Me=new WeakMap,Fe=new WeakMap,vr=new WeakMap,Ts=new WeakMap,jf=new WeakMap,Tu=new WeakMap,ul=new WeakMap,dl=new WeakMap,yr=new WeakMap,rs=new WeakMap,_i=new WeakMap,Of=new WeakSet,rx=function(e,t){const s=new ArrayBuffer(e*4);m(this,yr,new Uint8ClampedArray(s)),m(this,rs,new Uint32Array(s)),t&&t.length>0?(o(this,rs).set(t),o(this,rs).fill(ix,t.length)):o(this,rs).fill(ix)};var Be,rt,Qn,_u,Nu;const hw=class hw{constructor(e,t,s){x(this,Be);x(this,rt);x(this,Qn);x(this,_u,0);x(this,Nu,0);if(e instanceof hw&&o(e,Qn)===!!s)return e;m(this,Be,e),m(this,rt,t),m(this,Qn,!!s)}growOperationsCount(){throw new Error("Unreachable")}save(e){return At(this,Nu)._++,o(this,Be).save(o(this,rt)),this}restore(e){return o(this,Nu)>0&&(o(this,Be).restore(o(this,rt)),At(this,Nu)._--),this}recordOpenMarker(e){return At(this,_u)._++,this}getOpenMarker(){return o(this,_u)>0?o(this,rt):o(this,Be).getOpenMarker()}recordCloseMarker(e){return At(this,_u)._--,this}beginMarkedContent(e){return this}endMarkedContent(e){return this}pushBaseTransform(e){return o(this,Be).pushBaseTransform(e),this}popBaseTransform(){return o(this,Be).popBaseTransform(),this}recordSimpleData(e,t){return o(this,Be).recordSimpleData(e,o(this,rt)),this}recordIncrementalData(e,t){return o(this,Be).recordIncrementalData(e,o(this,rt)),this}resetIncrementalData(e,t){return o(this,Be).resetIncrementalData(e,o(this,rt)),this}recordNamedData(e,t){return this}recordSimpleDataFromNamed(e,t,s){return o(this,Be).recordSimpleDataFromNamed(e,t,o(this,rt)),this}recordFutureForcedDependency(e,t){return o(this,Be).recordFutureForcedDependency(e,o(this,rt)),this}inheritSimpleDataAsFutureForcedDependencies(e){return o(this,Be).inheritSimpleDataAsFutureForcedDependencies(e),this}inheritPendingDependenciesAsFutureForcedDependencies(){return o(this,Be).inheritPendingDependenciesAsFutureForcedDependencies(),this}resetBBox(e){return o(this,Qn)||o(this,Be).resetBBox(o(this,rt)),this}recordClipBox(e,t,s,i,r,a){return o(this,Qn)||o(this,Be).recordClipBox(o(this,rt),t,s,i,r,a),this}recordBBox(e,t,s,i,r,a){return o(this,Qn)||o(this,Be).recordBBox(o(this,rt),t,s,i,r,a),this}recordCharacterBBox(e,t,s,i,r,a,l){return o(this,Qn)||o(this,Be).recordCharacterBBox(o(this,rt),t,s,i,r,a,l),this}recordFullPageBBox(e){return o(this,Qn)||o(this,Be).recordFullPageBBox(o(this,rt)),this}getSimpleIndex(e){return o(this,Be).getSimpleIndex(e)}recordDependencies(e,t){return o(this,Be).recordDependencies(o(this,rt),t),this}recordNamedDependency(e,t){return o(this,Be).recordNamedDependency(o(this,rt),t),this}recordOperation(e){return o(this,Be).recordOperation(o(this,rt),!0),this}recordShowTextOperation(e){return o(this,Be).recordShowTextOperation(o(this,rt),!0),this}bboxToClipBoxDropOperation(e){return o(this,Qn)||o(this,Be).bboxToClipBoxDropOperation(o(this,rt),!0),this}take(){throw new Error("Unreachable")}takeDebugMetadata(){throw new Error("Unreachable")}};Be=new WeakMap,rt=new WeakMap,Qn=new WeakMap,_u=new WeakMap,Nu=new WeakMap;let Zg=hw;const vn={stroke:["path","transform","filter","strokeColor","strokeAlpha","lineWidth","lineCap","lineJoin","miterLimit","dash"],fill:["path","transform","filter","fillColor","fillAlpha","globalCompositeOperation","SMask"],imageXObject:["transform","SMask","filter","fillAlpha","strokeAlpha","globalCompositeOperation"],rawFillPath:["filter","fillColor","fillAlpha"],showText:["transform","leading","charSpacing","wordSpacing","hScale","textRise","moveText","textMatrix","font","fontObj","filter","fillColor","textRenderingMode","SMask","fillAlpha","strokeAlpha","globalCompositeOperation","sameLineText"],transform:["transform"],transformAndFill:["transform","fillColor"]},Xt={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function ox(n,e){if(!e)return;const t=e[2]-e[0],s=e[3]-e[1],i=new Path2D;i.rect(e[0],e[1],t,s),n.clip(i)}class rw{isModifyingCurrentTransform(){return!1}getPattern(){Ce("Abstract method `getPattern` called.")}}class WN extends rw{constructor(e){super(),this._type=e[1],this._bbox=e[2],this._colorStops=e[3],this._p0=e[4],this._p1=e[5],this._r0=e[6],this._r1=e[7],this.matrix=null}isOriginBased(){return this._p0[0]===0&&this._p0[1]===0&&(!this.isRadial()||this._p1[0]===0&&this._p1[1]===0)}isRadial(){return this._type==="radial"}_createGradient(e,t=null){let s,i=this._p0,r=this._p1;if(t&&(i=i.slice(),r=r.slice(),z.applyTransform(i,t),z.applyTransform(r,t)),this._type==="axial")s=e.createLinearGradient(i[0],i[1],r[0],r[1]);else if(this._type==="radial"){let a=this._r0,l=this._r1;if(t){const c=new Float32Array(2);z.singularValueDecompose2dScale(t,c),a*=c[0],l*=c[0]}s=e.createRadialGradient(i[0],i[1],a,r[0],r[1],l)}for(const a of this._colorStops)s.addColorStop(a[0],a[1]);return s}getPattern(e,t,s,i){let r;if(i===Xt.STROKE||i===Xt.FILL){if(this.isOriginBased()){let f=z.transform(s,t.baseTransform);this.matrix&&(f=z.transform(f,this.matrix));const p=.001,v=Math.hypot(f[0],f[1]),b=Math.hypot(f[2],f[3]),S=(f[0]*f[2]+f[1]*f[3])/(v*b);if(Math.abs(S)<p)if(this.isRadial()){if(Math.abs(v-b)<p)return this._createGradient(e,f)}else return this._createGradient(e,f)}const a=t.current.getClippedPathBoundingBox(i,et(e))||[0,0,0,0],l=Math.ceil(a[2]-a[0])||1,c=Math.ceil(a[3]-a[1])||1,u=t.cachedCanvases.getCanvas("pattern",l,c),d=u.context;d.clearRect(0,0,d.canvas.width,d.canvas.height),d.beginPath(),d.rect(0,0,d.canvas.width,d.canvas.height),d.translate(-a[0],-a[1]),s=z.transform(s,[1,0,0,1,a[0],a[1]]),d.transform(...t.baseTransform),this.matrix&&d.transform(...this.matrix),ox(d,this._bbox),d.fillStyle=this._createGradient(d),d.fill(),r=e.createPattern(u.canvas,"no-repeat");const h=new DOMMatrix(s);r.setTransform(h)}else ox(e,this._bbox),r=this._createGradient(e);return r}}function Mv(n,e,t,s,i,r,a,l){const c=e.coords,u=e.colors,d=n.data,h=n.width*4;let f;c[t+1]>c[s+1]&&(f=t,t=s,s=f,f=r,r=a,a=f),c[s+1]>c[i+1]&&(f=s,s=i,i=f,f=a,a=l,l=f),c[t+1]>c[s+1]&&(f=t,t=s,s=f,f=r,r=a,a=f);const p=(c[t]+e.offsetX)*e.scaleX,v=(c[t+1]+e.offsetY)*e.scaleY,b=(c[s]+e.offsetX)*e.scaleX,S=(c[s+1]+e.offsetY)*e.scaleY,y=(c[i]+e.offsetX)*e.scaleX,k=(c[i+1]+e.offsetY)*e.scaleY;if(v>=k)return;const w=u[r],E=u[r+1],C=u[r+2],T=u[a],_=u[a+1],P=u[a+2],D=u[l],I=u[l+1],F=u[l+2],K=Math.round(v),Z=Math.round(k);let Q,se,G,$,R,X,Y,ae;for(let te=K;te<=Z;te++){if(te<S){const ke=te<v?0:(v-te)/(v-S);Q=p-(p-b)*ke,se=w-(w-T)*ke,G=E-(E-_)*ke,$=C-(C-P)*ke}else{let ke;te>k?ke=1:S===k?ke=0:ke=(S-te)/(S-k),Q=b-(b-y)*ke,se=T-(T-D)*ke,G=_-(_-I)*ke,$=P-(P-F)*ke}let he;te<v?he=0:te>k?he=1:he=(v-te)/(v-k),R=p-(p-y)*he,X=w-(w-D)*he,Y=E-(E-I)*he,ae=C-(C-F)*he;const ht=Math.round(Math.min(Q,R)),Ae=Math.round(Math.max(Q,R));let _e=h*te+ht*4;for(let ke=ht;ke<=Ae;ke++)he=(Q-ke)/(Q-R),he<0?he=0:he>1&&(he=1),d[_e++]=se-(se-X)*he|0,d[_e++]=G-(G-Y)*he|0,d[_e++]=$-($-ae)*he|0,d[_e++]=255}}function GN(n,e,t){const s=e.coords,i=e.colors;let r,a;switch(e.type){case My.LATTICE:const l=e.verticesPerRow,c=Math.floor(s.length/l)-1,u=l-1;for(r=0;r<c;r++){let d=r*l;for(let h=0;h<u;h++,d++)Mv(n,t,s[d],s[d+1],s[d+l],i[d],i[d+1],i[d+l]),Mv(n,t,s[d+l+1],s[d+1],s[d+l],i[d+l+1],i[d+1],i[d+l])}break;case My.TRIANGLES:for(r=0,a=s.length;r<a;r+=3)Mv(n,t,s[r],s[r+1],s[r+2],i[r],i[r+1],i[r+2]);break;default:throw new Error("illegal figure")}}class XN extends rw{constructor(e){super(),this._coords=e[2],this._colors=e[3],this._figures=e[4],this._bounds=e[5],this._bbox=e[6],this._background=e[7],this.matrix=null}_createMeshCanvas(e,t,s){const l=Math.floor(this._bounds[0]),c=Math.floor(this._bounds[1]),u=Math.ceil(this._bounds[2])-l,d=Math.ceil(this._bounds[3])-c,h=Math.min(Math.ceil(Math.abs(u*e[0]*1.1)),3e3),f=Math.min(Math.ceil(Math.abs(d*e[1]*1.1)),3e3),p=u/h,v=d/f,b={coords:this._coords,colors:this._colors,offsetX:-l,offsetY:-c,scaleX:1/p,scaleY:1/v},S=h+2*2,y=f+2*2,k=s.getCanvas("mesh",S,y),w=k.context,E=w.createImageData(h,f);if(t){const T=E.data;for(let _=0,P=T.length;_<P;_+=4)T[_]=t[0],T[_+1]=t[1],T[_+2]=t[2],T[_+3]=255}for(const T of this._figures)GN(E,T,b);return w.putImageData(E,2,2),{canvas:k.canvas,offsetX:l-2*p,offsetY:c-2*v,scaleX:p,scaleY:v}}isModifyingCurrentTransform(){return!0}getPattern(e,t,s,i){ox(e,this._bbox);const r=new Float32Array(2);if(i===Xt.SHADING)z.singularValueDecompose2dScale(et(e),r);else if(this.matrix){z.singularValueDecompose2dScale(this.matrix,r);const[l,c]=r;z.singularValueDecompose2dScale(t.baseTransform,r),r[0]*=l,r[1]*=c}else z.singularValueDecompose2dScale(t.baseTransform,r);const a=this._createMeshCanvas(r,i===Xt.SHADING?null:this._background,t.cachedCanvases);return i!==Xt.SHADING&&(e.setTransform(...t.baseTransform),this.matrix&&e.transform(...this.matrix)),e.translate(a.offsetX,a.offsetY),e.scale(a.scaleX,a.scaleY),e.createPattern(a.canvas,"no-repeat")}}class YN extends rw{getPattern(){return"hotpink"}}function qN(n){switch(n[0]){case"RadialAxial":return new WN(n);case"Mesh":return new XN(n);case"Dummy":return new YN}throw new Error(`Unknown IR type: ${n[0]}`)}const G1={COLORED:1,UNCOLORED:2},p0=class p0{constructor(e,t,s,i){this.color=e[1],this.operatorList=e[2],this.matrix=e[3],this.bbox=e[4],this.xstep=e[5],this.ystep=e[6],this.paintType=e[7],this.tilingType=e[8],this.ctx=t,this.canvasGraphicsFactory=s,this.baseTransform=i}createPatternCanvas(e,t){var X,Y;const{bbox:s,operatorList:i,paintType:r,tilingType:a,color:l,canvasGraphicsFactory:c}=this;let{xstep:u,ystep:d}=this;u=Math.abs(u),d=Math.abs(d),$0("TilingType: "+a);const h=s[0],f=s[1],p=s[2],v=s[3],b=p-h,S=v-f,y=new Float32Array(2);z.singularValueDecompose2dScale(this.matrix,y);const[k,w]=y;z.singularValueDecompose2dScale(this.baseTransform,y);const E=k*y[0],C=w*y[1];let T=b,_=S,P=!1,D=!1;const I=Math.ceil(u*E),F=Math.ceil(d*C),K=Math.ceil(b*E),Z=Math.ceil(S*C);I>=K?T=u:P=!0,F>=Z?_=d:D=!0;const Q=this.getSizeAndScale(T,this.ctx.canvas.width,E),se=this.getSizeAndScale(_,this.ctx.canvas.height,C),G=e.cachedCanvases.getCanvas("pattern",Q.size,se.size),$=G.context,R=c.createCanvasGraphics($,t);if(R.groupLevel=e.groupLevel,this.setFillAndStrokeStyleToContext(R,r,l),$.translate(-Q.scale*h,-se.scale*f),R.transform(0,Q.scale,0,0,se.scale,0,0),$.save(),(X=R.dependencyTracker)==null||X.save(),this.clipBbox(R,h,f,p,v),R.baseTransform=et(R.ctx),R.executeOperatorList(i),R.endDrawing(),(Y=R.dependencyTracker)==null||Y.restore(),$.restore(),P||D){const ae=G.canvas;P&&(T=u),D&&(_=d);const te=this.getSizeAndScale(T,this.ctx.canvas.width,E),he=this.getSizeAndScale(_,this.ctx.canvas.height,C),ht=te.size,Ae=he.size,_e=e.cachedCanvases.getCanvas("pattern-workaround",ht,Ae),ke=_e.context,sm=P?Math.floor(b/u):0,nm=D?Math.floor(S/d):0;for(let eo=0;eo<=sm;eo++)for(let Un=0;Un<=nm;Un++)ke.drawImage(ae,ht*eo,Ae*Un,ht,Ae,0,0,ht,Ae);return{canvas:_e.canvas,scaleX:te.scale,scaleY:he.scale,offsetX:h,offsetY:f}}return{canvas:G.canvas,scaleX:Q.scale,scaleY:se.scale,offsetX:h,offsetY:f}}getSizeAndScale(e,t,s){const i=Math.max(p0.MAX_PATTERN_SIZE,t);let r=Math.ceil(e*s);return r>=i?r=i:s=r/e,{scale:s,size:r}}clipBbox(e,t,s,i,r){const a=i-t,l=r-s;e.ctx.rect(t,s,a,l),z.axialAlignedBoundingBox([t,s,i,r],et(e.ctx),e.current.minMax),e.clip(),e.endPath()}setFillAndStrokeStyleToContext(e,t,s){const i=e.ctx,r=e.current;switch(t){case G1.COLORED:const{fillStyle:a,strokeStyle:l}=this.ctx;i.fillStyle=r.fillColor=a,i.strokeStyle=r.strokeColor=l;break;case G1.UNCOLORED:i.fillStyle=i.strokeStyle=s,r.fillColor=r.strokeColor=s;break;default:throw new aN(`Unsupported paint type: ${t}`)}}isModifyingCurrentTransform(){return!1}getPattern(e,t,s,i,r){let a=s;i!==Xt.SHADING&&(a=z.transform(a,t.baseTransform),this.matrix&&(a=z.transform(a,this.matrix)));const l=this.createPatternCanvas(t,r);let c=new DOMMatrix(a);c=c.translate(l.offsetX,l.offsetY),c=c.scale(1/l.scaleX,1/l.scaleY);const u=e.createPattern(l.canvas,"repeat");return u.setTransform(c),u}};M(p0,"MAX_PATTERN_SIZE",3e3);let ax=p0;function KN({src:n,srcPos:e=0,dest:t,width:s,height:i,nonBlackColor:r=4294967295,inverseDecode:a=!1}){const l=Nt.isLittleEndian?4278190080:255,[c,u]=a?[r,l]:[l,r],d=s>>3,h=s&7,f=n.length;t=new Uint32Array(t.buffer);let p=0;for(let v=0;v<i;v++){for(const S=e+d;e<S;e++){const y=e<f?n[e]:255;t[p++]=y&128?u:c,t[p++]=y&64?u:c,t[p++]=y&32?u:c,t[p++]=y&16?u:c,t[p++]=y&8?u:c,t[p++]=y&4?u:c,t[p++]=y&2?u:c,t[p++]=y&1?u:c}if(h===0)continue;const b=e<f?n[e++]:255;for(let S=0;S<h;S++)t[p++]=b&1<<7-S?u:c}return{srcPos:e,destPos:p}}const X1=16,Y1=100,QN=15,q1=10,Ls=16,Lv=new DOMMatrix,an=new Float32Array(2),Rc=new Float32Array([1/0,1/0,-1/0,-1/0]);function JN(n,e){if(n._removeMirroring)throw new Error("Context is already forwarding operations.");n.__originalSave=n.save,n.__originalRestore=n.restore,n.__originalRotate=n.rotate,n.__originalScale=n.scale,n.__originalTranslate=n.translate,n.__originalTransform=n.transform,n.__originalSetTransform=n.setTransform,n.__originalResetTransform=n.resetTransform,n.__originalClip=n.clip,n.__originalMoveTo=n.moveTo,n.__originalLineTo=n.lineTo,n.__originalBezierCurveTo=n.bezierCurveTo,n.__originalRect=n.rect,n.__originalClosePath=n.closePath,n.__originalBeginPath=n.beginPath,n._removeMirroring=()=>{n.save=n.__originalSave,n.restore=n.__originalRestore,n.rotate=n.__originalRotate,n.scale=n.__originalScale,n.translate=n.__originalTranslate,n.transform=n.__originalTransform,n.setTransform=n.__originalSetTransform,n.resetTransform=n.__originalResetTransform,n.clip=n.__originalClip,n.moveTo=n.__originalMoveTo,n.lineTo=n.__originalLineTo,n.bezierCurveTo=n.__originalBezierCurveTo,n.rect=n.__originalRect,n.closePath=n.__originalClosePath,n.beginPath=n.__originalBeginPath,delete n._removeMirroring},n.save=function(){e.save(),this.__originalSave()},n.restore=function(){e.restore(),this.__originalRestore()},n.translate=function(t,s){e.translate(t,s),this.__originalTranslate(t,s)},n.scale=function(t,s){e.scale(t,s),this.__originalScale(t,s)},n.transform=function(t,s,i,r,a,l){e.transform(t,s,i,r,a,l),this.__originalTransform(t,s,i,r,a,l)},n.setTransform=function(t,s,i,r,a,l){e.setTransform(t,s,i,r,a,l),this.__originalSetTransform(t,s,i,r,a,l)},n.resetTransform=function(){e.resetTransform(),this.__originalResetTransform()},n.rotate=function(t){e.rotate(t),this.__originalRotate(t)},n.clip=function(t){e.clip(t),this.__originalClip(t)},n.moveTo=function(t,s){e.moveTo(t,s),this.__originalMoveTo(t,s)},n.lineTo=function(t,s){e.lineTo(t,s),this.__originalLineTo(t,s)},n.bezierCurveTo=function(t,s,i,r,a,l){e.bezierCurveTo(t,s,i,r,a,l),this.__originalBezierCurveTo(t,s,i,r,a,l)},n.rect=function(t,s,i,r){e.rect(t,s,i,r),this.__originalRect(t,s,i,r)},n.closePath=function(){e.closePath(),this.__originalClosePath()},n.beginPath=function(){e.beginPath(),this.__originalBeginPath()}}class ZN{constructor(e){this.canvasFactory=e,this.cache=Object.create(null)}getCanvas(e,t,s){let i;return this.cache[e]!==void 0?(i=this.cache[e],this.canvasFactory.reset(i,t,s)):(i=this.canvasFactory.create(t,s),this.cache[e]=i),i}delete(e){delete this.cache[e]}clear(){for(const e in this.cache){const t=this.cache[e];this.canvasFactory.destroy(t),delete this.cache[e]}}}function Cm(n,e,t,s,i,r,a,l,c,u){const[d,h,f,p,v,b]=et(n);if(h===0&&f===0){const k=a*d+v,w=Math.round(k),E=l*p+b,C=Math.round(E),T=(a+c)*d+v,_=Math.abs(Math.round(T)-w)||1,P=(l+u)*p+b,D=Math.abs(Math.round(P)-C)||1;return n.setTransform(Math.sign(d),0,0,Math.sign(p),w,C),n.drawImage(e,t,s,i,r,0,0,_,D),n.setTransform(d,h,f,p,v,b),[_,D]}if(d===0&&p===0){const k=l*f+v,w=Math.round(k),E=a*h+b,C=Math.round(E),T=(l+u)*f+v,_=Math.abs(Math.round(T)-w)||1,P=(a+c)*h+b,D=Math.abs(Math.round(P)-C)||1;return n.setTransform(0,Math.sign(h),Math.sign(f),0,w,C),n.drawImage(e,t,s,i,r,0,0,D,_),n.setTransform(d,h,f,p,v,b),[D,_]}n.drawImage(e,t,s,i,r,a,l,c,u);const S=Math.hypot(d,h),y=Math.hypot(f,p);return[S*c,y*u]}class K1{constructor(e,t,s){M(this,"alphaIsShape",!1);M(this,"fontSize",0);M(this,"fontSizeScale",1);M(this,"textMatrix",null);M(this,"textMatrixScale",1);M(this,"fontMatrix",Py);M(this,"leading",0);M(this,"x",0);M(this,"y",0);M(this,"lineX",0);M(this,"lineY",0);M(this,"charSpacing",0);M(this,"wordSpacing",0);M(this,"textHScale",1);M(this,"textRenderingMode",kt.FILL);M(this,"textRise",0);M(this,"fillColor","#000000");M(this,"strokeColor","#000000");M(this,"patternFill",!1);M(this,"patternStroke",!1);M(this,"fillAlpha",1);M(this,"strokeAlpha",1);M(this,"lineWidth",1);M(this,"activeSMask",null);M(this,"transferMaps","none");s==null||s(this),this.clipBox=new Float32Array([0,0,e,t]),this.minMax=Rc.slice()}clone(){const e=Object.create(this);return e.clipBox=this.clipBox.slice(),e.minMax=this.minMax.slice(),e}getPathBoundingBox(e=Xt.FILL,t=null){const s=this.minMax.slice();if(e===Xt.STROKE){t||Ce("Stroke bounding box must include transform."),z.singularValueDecompose2dScale(t,an);const i=an[0]*this.lineWidth/2,r=an[1]*this.lineWidth/2;s[0]-=i,s[1]-=r,s[2]+=i,s[3]+=r}return s}updateClipFromPath(){const e=z.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(e||[0,0,0,0])}isEmptyClip(){return this.minMax[0]===1/0}startNewPathAndClipBox(e){this.clipBox.set(e,0),this.minMax.set(Rc,0)}getClippedPathBoundingBox(e=Xt.FILL,t=null){return z.intersect(this.clipBox,this.getPathBoundingBox(e,t))}}function Q1(n,e){if(e instanceof ImageData){n.putImageData(e,0,0);return}const t=e.height,s=e.width,i=t%Ls,r=(t-i)/Ls,a=i===0?r:r+1,l=n.createImageData(s,Ls);let c=0,u;const d=e.data,h=l.data;let f,p,v,b;if(e.kind===Hm.GRAYSCALE_1BPP){const S=d.byteLength,y=new Uint32Array(h.buffer,0,h.byteLength>>2),k=y.length,w=s+7>>3,E=4294967295,C=Nt.isLittleEndian?4278190080:255;for(f=0;f<a;f++){for(v=f<r?Ls:i,u=0,p=0;p<v;p++){const T=S-c;let _=0;const P=T>w?s:T*8-7,D=P&-8;let I=0,F=0;for(;_<D;_+=8)F=d[c++],y[u++]=F&128?E:C,y[u++]=F&64?E:C,y[u++]=F&32?E:C,y[u++]=F&16?E:C,y[u++]=F&8?E:C,y[u++]=F&4?E:C,y[u++]=F&2?E:C,y[u++]=F&1?E:C;for(;_<P;_++)I===0&&(F=d[c++],I=128),y[u++]=F&I?E:C,I>>=1}for(;u<k;)y[u++]=0;n.putImageData(l,0,f*Ls)}}else if(e.kind===Hm.RGBA_32BPP){for(p=0,b=s*Ls*4,f=0;f<r;f++)h.set(d.subarray(c,c+b)),c+=b,n.putImageData(l,0,p),p+=Ls;f<a&&(b=s*i*4,h.set(d.subarray(c,c+b)),n.putImageData(l,0,p))}else if(e.kind===Hm.RGB_24BPP)for(v=Ls,b=s*v,f=0;f<a;f++){for(f>=r&&(v=i,b=s*v),u=0,p=b;p--;)h[u++]=d[c++],h[u++]=d[c++],h[u++]=d[c++],h[u++]=255;n.putImageData(l,0,f*Ls)}else throw new Error(`bad image kind: ${e.kind}`)}function J1(n,e){if(e.bitmap){n.drawImage(e.bitmap,0,0);return}const t=e.height,s=e.width,i=t%Ls,r=(t-i)/Ls,a=i===0?r:r+1,l=n.createImageData(s,Ls);let c=0;const u=e.data,d=l.data;for(let h=0;h<a;h++){const f=h<r?Ls:i;({srcPos:c}=KN({src:u,srcPos:c,dest:d,width:s,height:f,nonBlackColor:0})),n.putImageData(l,0,h*Ls)}}function Hd(n,e){const t=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const s of t)n[s]!==void 0&&(e[s]=n[s]);n.setLineDash!==void 0&&(e.setLineDash(n.getLineDash()),e.lineDashOffset=n.lineDashOffset)}function Tm(n){n.strokeStyle=n.fillStyle="#000000",n.fillRule="nonzero",n.globalAlpha=1,n.lineWidth=1,n.lineCap="butt",n.lineJoin="miter",n.miterLimit=10,n.globalCompositeOperation="source-over",n.font="10px sans-serif",n.setLineDash!==void 0&&(n.setLineDash([]),n.lineDashOffset=0);const{filter:e}=n;e!=="none"&&e!==""&&(n.filter="none")}function Z1(n,e){if(e)return!0;z.singularValueDecompose2dScale(n,an);const t=Math.fround($i.pixelRatio*ya.PDF_TO_CSS_UNITS);return an[0]<=t&&an[1]<=t}const eP=["butt","round","square"],tP=["miter","round","bevel"],sP={},eA={};var di,lx,cx,ux;const fw=class fw{constructor(e,t,s,i,r,{optionalContentConfig:a,markedContentStack:l=null},c,u,d){x(this,di);this.ctx=e,this.current=new K1(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=t,this.objs=s,this.canvasFactory=i,this.filterFactory=r,this.groupStack=[],this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=l||[],this.optionalContentConfig=a,this.cachedCanvases=new ZN(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=c,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=u,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map,this.dependencyTracker=d??null}getObject(e,t,s=null){var i;return typeof t=="string"?((i=this.dependencyTracker)==null||i.recordNamedDependency(e,t),t.startsWith("g_")?this.commonObjs.get(t):this.objs.get(t)):s}beginDrawing({transform:e,viewport:t,transparency:s=!1,background:i=null}){const r=this.ctx.canvas.width,a=this.ctx.canvas.height,l=this.ctx.fillStyle;if(this.ctx.fillStyle=i||"#ffffff",this.ctx.fillRect(0,0,r,a),this.ctx.fillStyle=l,s){const c=this.cachedCanvases.getCanvas("transparent",r,a);this.compositeCtx=this.ctx,this.transparentCanvas=c.canvas,this.ctx=c.context,this.ctx.save(),this.ctx.transform(...et(this.compositeCtx))}this.ctx.save(),Tm(this.ctx),e&&(this.ctx.transform(...e),this.outputScaleX=e[0],this.outputScaleY=e[0]),this.ctx.transform(...t.transform),this.viewportScale=t.scale,this.baseTransform=et(this.ctx)}executeOperatorList(e,t,s,i,r){var y;const a=e.argsArray,l=e.fnArray;let c=t||0;const u=a.length;if(u===c)return c;const d=u-c>q1&&typeof s=="function",h=d?Date.now()+QN:0;let f=0;const p=this.commonObjs,v=this.objs;let b,S;for(;;){if(i!==void 0&&c===i.nextBreakPoint)return i.breakIt(c,s),c;if(!r||r(c))if(b=l[c],S=a[c]??null,b!==Wh.dependency)S===null?this[b](c):this[b](c,...S);else for(const k of S){(y=this.dependencyTracker)==null||y.recordNamedData(k,c);const w=k.startsWith("g_")?p:v;if(!w.has(k))return w.get(k,s),c}if(c++,c===u)return c;if(d&&++f>q1){if(Date.now()>h)return s(),c;f=0}}}endDrawing(){A(this,di,lx).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const e of this._cachedBitmapsMap.values()){for(const t of e.values())typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement&&(t.width=t.height=0);e.clear()}this._cachedBitmapsMap.clear(),A(this,di,cx).call(this)}_scaleImage(e,t){const s=e.width??e.displayWidth,i=e.height??e.displayHeight;let r=Math.max(Math.hypot(t[0],t[1]),1),a=Math.max(Math.hypot(t[2],t[3]),1),l=s,c=i,u="prescale1",d,h;for(;r>2&&l>1||a>2&&c>1;){let f=l,p=c;r>2&&l>1&&(f=l>=16384?Math.floor(l/2)-1||1:Math.ceil(l/2),r/=l/f),a>2&&c>1&&(p=c>=16384?Math.floor(c/2)-1||1:Math.ceil(c)/2,a/=c/p),d=this.cachedCanvases.getCanvas(u,f,p),h=d.context,h.clearRect(0,0,f,p),h.drawImage(e,0,0,l,c,0,0,f,p),e=d.canvas,l=f,c=p,u=u==="prescale1"?"prescale2":"prescale1"}return{img:e,paintWidth:l,paintHeight:c}}_createMaskCanvas(e,t){var I,F;const s=this.ctx,{width:i,height:r}=t,a=this.current.fillColor,l=this.current.patternFill,c=et(s);let u,d,h,f;if((t.bitmap||t.data)&&t.count>1){const K=t.bitmap||t.data.buffer;d=JSON.stringify(l?c:[c.slice(0,4),a]),u=this._cachedBitmapsMap.get(K),u||(u=new Map,this._cachedBitmapsMap.set(K,u));const Z=u.get(d);if(Z&&!l){const Q=Math.round(Math.min(c[0],c[2])+c[4]),se=Math.round(Math.min(c[1],c[3])+c[5]);return(I=this.dependencyTracker)==null||I.recordDependencies(e,vn.transformAndFill),{canvas:Z,offsetX:Q,offsetY:se}}h=Z}h||(f=this.cachedCanvases.getCanvas("maskCanvas",i,r),J1(f.context,t));let p=z.transform(c,[1/i,0,0,-1/r,0,0]);p=z.transform(p,[1,0,0,1,0,-r]);const v=Rc.slice();z.axialAlignedBoundingBox([0,0,i,r],p,v);const[b,S,y,k]=v,w=Math.round(y-b)||1,E=Math.round(k-S)||1,C=this.cachedCanvases.getCanvas("fillCanvas",w,E),T=C.context,_=b,P=S;T.translate(-_,-P),T.transform(...p),h||(h=this._scaleImage(f.canvas,fi(T)),h=h.img,u&&l&&u.set(d,h)),T.imageSmoothingEnabled=Z1(et(T),t.interpolate),Cm(T,h,0,0,h.width,h.height,0,0,i,r),T.globalCompositeOperation="source-in";const D=z.transform(fi(T),[1,0,0,1,-_,-P]);return T.fillStyle=l?a.getPattern(s,this,D,Xt.FILL,e):a,T.fillRect(0,0,i,r),u&&!l&&(this.cachedCanvases.delete("fillCanvas"),u.set(d,C.canvas)),(F=this.dependencyTracker)==null||F.recordDependencies(e,vn.transformAndFill),{canvas:C.canvas,offsetX:Math.round(_),offsetY:Math.round(P)}}setLineWidth(e,t){var s;(s=this.dependencyTracker)==null||s.recordSimpleData("lineWidth",e),t!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=t,this.ctx.lineWidth=t}setLineCap(e,t){var s;(s=this.dependencyTracker)==null||s.recordSimpleData("lineCap",e),this.ctx.lineCap=eP[t]}setLineJoin(e,t){var s;(s=this.dependencyTracker)==null||s.recordSimpleData("lineJoin",e),this.ctx.lineJoin=tP[t]}setMiterLimit(e,t){var s;(s=this.dependencyTracker)==null||s.recordSimpleData("miterLimit",e),this.ctx.miterLimit=t}setDash(e,t,s){var r;(r=this.dependencyTracker)==null||r.recordSimpleData("dash",e);const i=this.ctx;i.setLineDash!==void 0&&(i.setLineDash(t),i.lineDashOffset=s)}setRenderingIntent(e,t){}setFlatness(e,t){}setGState(e,t){var s,i,r,a,l;for(const[c,u]of t)switch(c){case"LW":this.setLineWidth(e,u);break;case"LC":this.setLineCap(e,u);break;case"LJ":this.setLineJoin(e,u);break;case"ML":this.setMiterLimit(e,u);break;case"D":this.setDash(e,u[0],u[1]);break;case"RI":this.setRenderingIntent(e,u);break;case"FL":this.setFlatness(e,u);break;case"Font":this.setFont(e,u[0],u[1]);break;case"CA":(s=this.dependencyTracker)==null||s.recordSimpleData("strokeAlpha",e),this.current.strokeAlpha=u;break;case"ca":(i=this.dependencyTracker)==null||i.recordSimpleData("fillAlpha",e),this.ctx.globalAlpha=this.current.fillAlpha=u;break;case"BM":(r=this.dependencyTracker)==null||r.recordSimpleData("globalCompositeOperation",e),this.ctx.globalCompositeOperation=u;break;case"SMask":(a=this.dependencyTracker)==null||a.recordSimpleData("SMask",e),this.current.activeSMask=u?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":(l=this.dependencyTracker)==null||l.recordSimpleData("filter",e),this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(u);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const e=this.inSMaskMode;this.current.activeSMask&&!e?this.beginSMaskMode():!this.current.activeSMask&&e&&this.endSMaskMode()}beginSMaskMode(e){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const t=this.ctx.canvas.width,s=this.ctx.canvas.height,i="smaskGroupAt"+this.groupLevel,r=this.cachedCanvases.getCanvas(i,t,s);this.suspendedCtx=this.ctx;const a=this.ctx=r.context;a.setTransform(this.suspendedCtx.getTransform()),Hd(this.suspendedCtx,a),JN(a,this.suspendedCtx),this.setGState(e,[["BM","source-over"]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),Hd(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(e){if(!this.current.activeSMask)return;e?(e[0]=Math.floor(e[0]),e[1]=Math.floor(e[1]),e[2]=Math.ceil(e[2]),e[3]=Math.ceil(e[3])):e=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const t=this.current.activeSMask,s=this.suspendedCtx;this.composeSMask(s,t,this.ctx,e),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(e,t,s,i){const r=i[0],a=i[1],l=i[2]-r,c=i[3]-a;l===0||c===0||(this.genericComposeSMask(t.context,s,l,c,t.subtype,t.backdrop,t.transferMap,r,a,t.offsetX,t.offsetY),e.save(),e.globalAlpha=1,e.globalCompositeOperation="source-over",e.setTransform(1,0,0,1,0,0),e.drawImage(s.canvas,0,0),e.restore())}genericComposeSMask(e,t,s,i,r,a,l,c,u,d,h){let f=e.canvas,p=c-d,v=u-h;if(a)if(p<0||v<0||p+s>f.width||v+i>f.height){const S=this.cachedCanvases.getCanvas("maskExtension",s,i),y=S.context;y.drawImage(f,-p,-v),y.globalCompositeOperation="destination-atop",y.fillStyle=a,y.fillRect(0,0,s,i),y.globalCompositeOperation="source-over",f=S.canvas,p=v=0}else{e.save(),e.globalAlpha=1,e.setTransform(1,0,0,1,0,0);const S=new Path2D;S.rect(p,v,s,i),e.clip(S),e.globalCompositeOperation="destination-atop",e.fillStyle=a,e.fillRect(p,v,s,i),e.restore()}t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0),r==="Alpha"&&l?t.filter=this.filterFactory.addAlphaFilter(l):r==="Luminosity"&&(t.filter=this.filterFactory.addLuminosityFilter(l));const b=new Path2D;b.rect(c,u,s,i),t.clip(b),t.globalCompositeOperation="destination-in",t.drawImage(f,p,v,s,i,c,u,s,i),t.restore()}save(e){var s;this.inSMaskMode&&Hd(this.ctx,this.suspendedCtx),this.ctx.save();const t=this.current;this.stateStack.push(t),this.current=t.clone(),(s=this.dependencyTracker)==null||s.save(e)}restore(e){var t;if((t=this.dependencyTracker)==null||t.restore(e),this.stateStack.length===0){this.inSMaskMode&&this.endSMaskMode();return}this.current=this.stateStack.pop(),this.ctx.restore(),this.inSMaskMode&&Hd(this.suspendedCtx,this.ctx),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}transform(e,t,s,i,r,a,l){var c;(c=this.dependencyTracker)==null||c.recordIncrementalData("transform",e),this.ctx.transform(t,s,i,r,a,l),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(e,t,s,i){let[r]=s;if(!i){r||(r=s[0]=new Path2D),this[t](e,r);return}if(this.dependencyTracker!==null){const a=t===Wh.stroke?this.current.lineWidth/2:0;this.dependencyTracker.resetBBox(e).recordBBox(e,this.ctx,i[0]-a,i[2]+a,i[1]-a,i[3]+a).recordDependencies(e,["transform"])}r instanceof Path2D||(r=s[0]=PS(r)),z.axialAlignedBoundingBox(i,et(this.ctx),this.current.minMax),this[t](e,r),this._pathStartIdx=e}closePath(e){this.ctx.closePath()}stroke(e,t,s=!0){var a;const i=this.ctx,r=this.current.strokeColor;if(i.globalAlpha=this.current.strokeAlpha,this.contentVisible)if(typeof r=="object"&&(r!=null&&r.getPattern)){const l=r.isModifyingCurrentTransform()?i.getTransform():null;if(i.save(),i.strokeStyle=r.getPattern(i,this,fi(i),Xt.STROKE,e),l){const c=new Path2D;c.addPath(t,i.getTransform().invertSelf().multiplySelf(l)),t=c}this.rescaleAndStroke(t,!1),i.restore()}else this.rescaleAndStroke(t,!0);(a=this.dependencyTracker)==null||a.recordDependencies(e,vn.stroke),s&&this.consumePath(e,t,this.current.getClippedPathBoundingBox(Xt.STROKE,et(this.ctx))),i.globalAlpha=this.current.fillAlpha}closeStroke(e,t){this.stroke(e,t)}fill(e,t,s=!0){var u,d,h;const i=this.ctx,r=this.current.fillColor,a=this.current.patternFill;let l=!1;if(a){const f=r.isModifyingCurrentTransform()?i.getTransform():null;if((u=this.dependencyTracker)==null||u.save(e),i.save(),i.fillStyle=r.getPattern(i,this,fi(i),Xt.FILL,e),f){const p=new Path2D;p.addPath(t,i.getTransform().invertSelf().multiplySelf(f)),t=p}l=!0}const c=this.current.getClippedPathBoundingBox();this.contentVisible&&c!==null&&(this.pendingEOFill?(i.fill(t,"evenodd"),this.pendingEOFill=!1):i.fill(t)),(d=this.dependencyTracker)==null||d.recordDependencies(e,vn.fill),l&&(i.restore(),(h=this.dependencyTracker)==null||h.restore(e)),s&&this.consumePath(e,t,c)}eoFill(e,t){this.pendingEOFill=!0,this.fill(e,t)}fillStroke(e,t){this.fill(e,t,!1),this.stroke(e,t,!1),this.consumePath(e,t)}eoFillStroke(e,t){this.pendingEOFill=!0,this.fillStroke(e,t)}closeFillStroke(e,t){this.fillStroke(e,t)}closeEOFillStroke(e,t){this.pendingEOFill=!0,this.fillStroke(e,t)}endPath(e,t){this.consumePath(e,t)}rawFillPath(e,t){var s;this.ctx.fill(t),(s=this.dependencyTracker)==null||s.recordDependencies(e,vn.rawFillPath).recordOperation(e)}clip(e){var t;(t=this.dependencyTracker)==null||t.recordFutureForcedDependency("clipMode",e),this.pendingClip=sP}eoClip(e){var t;(t=this.dependencyTracker)==null||t.recordFutureForcedDependency("clipMode",e),this.pendingClip=eA}beginText(e){var t;this.current.textMatrix=null,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0,(t=this.dependencyTracker)==null||t.recordOpenMarker(e).resetIncrementalData("sameLineText").resetIncrementalData("moveText",e)}endText(e){const t=this.pendingTextPaths,s=this.ctx;if(this.dependencyTracker){const{dependencyTracker:i}=this;t!==void 0&&i.recordFutureForcedDependency("textClip",i.getOpenMarker()).recordFutureForcedDependency("textClip",e),i.recordCloseMarker(e)}if(t!==void 0){const i=new Path2D,r=s.getTransform().invertSelf();for(const{transform:a,x:l,y:c,fontSize:u,path:d}of t)d&&i.addPath(d,new DOMMatrix(a).preMultiplySelf(r).translate(l,c).scale(u,-u));s.clip(i)}delete this.pendingTextPaths}setCharSpacing(e,t){var s;(s=this.dependencyTracker)==null||s.recordSimpleData("charSpacing",e),this.current.charSpacing=t}setWordSpacing(e,t){var s;(s=this.dependencyTracker)==null||s.recordSimpleData("wordSpacing",e),this.current.wordSpacing=t}setHScale(e,t){var s;(s=this.dependencyTracker)==null||s.recordSimpleData("hScale",e),this.current.textHScale=t/100}setLeading(e,t){var s;(s=this.dependencyTracker)==null||s.recordSimpleData("leading",e),this.current.leading=-t}setFont(e,t,s){var h,f;(h=this.dependencyTracker)==null||h.recordSimpleData("font",e).recordSimpleDataFromNamed("fontObj",t,e);const i=this.commonObjs.get(t),r=this.current;if(!i)throw new Error(`Can't find font for ${t}`);if(r.fontMatrix=i.fontMatrix||Py,(r.fontMatrix[0]===0||r.fontMatrix[3]===0)&&ne("Invalid font matrix for font "+t),s<0?(s=-s,r.fontDirection=-1):r.fontDirection=1,this.current.font=i,this.current.fontSize=s,i.isType3Font)return;const a=i.loadedName||"sans-serif",l=((f=i.systemFontInfo)==null?void 0:f.css)||`"${a}", ${i.fallbackName}`;let c="normal";i.black?c="900":i.bold&&(c="bold");const u=i.italic?"italic":"normal";let d=s;s<X1?d=X1:s>Y1&&(d=Y1),this.current.fontSizeScale=s/d,this.ctx.font=`${u} ${c} ${d}px ${l}`}setTextRenderingMode(e,t){var s;(s=this.dependencyTracker)==null||s.recordSimpleData("textRenderingMode",e),this.current.textRenderingMode=t}setTextRise(e,t){var s;(s=this.dependencyTracker)==null||s.recordSimpleData("textRise",e),this.current.textRise=t}moveText(e,t,s){var i;(i=this.dependencyTracker)==null||i.resetIncrementalData("sameLineText").recordIncrementalData("moveText",e),this.current.x=this.current.lineX+=t,this.current.y=this.current.lineY+=s}setLeadingMoveText(e,t,s){this.setLeading(e,-s),this.moveText(e,t,s)}setTextMatrix(e,t){var i;(i=this.dependencyTracker)==null||i.resetIncrementalData("sameLineText").recordSimpleData("textMatrix",e);const{current:s}=this;s.textMatrix=t,s.textMatrixScale=Math.hypot(t[0],t[1]),s.x=s.lineX=0,s.y=s.lineY=0}nextLine(e){var t;this.moveText(e,0,this.current.leading),(t=this.dependencyTracker)==null||t.recordIncrementalData("moveText",this.dependencyTracker.getSimpleIndex("leading")??e)}paintChar(e,t,s,i,r,a){var y,k,w,E;const l=this.ctx,c=this.current,u=c.font,d=c.textRenderingMode,h=c.fontSize/c.fontSizeScale,f=d&kt.FILL_STROKE_MASK,p=!!(d&kt.ADD_TO_PATH_FLAG),v=c.patternFill&&!u.missingFile,b=c.patternStroke&&!u.missingFile;let S;if((u.disableFontFace||p||v||b)&&!u.missingFile&&(S=u.getPathGenerator(this.commonObjs,t)),S&&(u.disableFontFace||v||b)){l.save(),l.translate(s,i),l.scale(h,-h),(y=this.dependencyTracker)==null||y.recordCharacterBBox(e,l,u);let C;if(f===kt.FILL||f===kt.FILL_STROKE)if(r){C=l.getTransform(),l.setTransform(...r);const T=A(this,di,ux).call(this,S,C,r);l.fill(T)}else l.fill(S);if(f===kt.STROKE||f===kt.FILL_STROKE)if(a){C||(C=l.getTransform()),l.setTransform(...a);const{a:T,b:_,c:P,d:D}=C,I=z.inverseTransform(a),F=z.transform([T,_,P,D,0,0],I);z.singularValueDecompose2dScale(F,an),l.lineWidth*=Math.max(an[0],an[1])/h,l.stroke(A(this,di,ux).call(this,S,C,a))}else l.lineWidth/=h,l.stroke(S);l.restore()}else(f===kt.FILL||f===kt.FILL_STROKE)&&(l.fillText(t,s,i),(k=this.dependencyTracker)==null||k.recordCharacterBBox(e,l,u,h,s,i,()=>l.measureText(t))),(f===kt.STROKE||f===kt.FILL_STROKE)&&(this.dependencyTracker&&((w=this.dependencyTracker)==null||w.recordCharacterBBox(e,l,u,h,s,i,()=>l.measureText(t)).recordDependencies(e,vn.stroke)),l.strokeText(t,s,i));p&&((this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:et(l),x:s,y:i,fontSize:h,path:S}),(E=this.dependencyTracker)==null||E.recordCharacterBBox(e,l,u,h,s,i))}get isFontSubpixelAAEnabled(){const{context:e}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);e.scale(1.5,1),e.fillText("I",0,10);const t=e.getImageData(0,0,10,10).data;let s=!1;for(let i=3;i<t.length;i+=4)if(t[i]>0&&t[i]<255){s=!0;break}return ie(this,"isFontSubpixelAAEnabled",s)}showText(e,t){var F,K,Z,Q;this.dependencyTracker&&(this.dependencyTracker.recordDependencies(e,vn.showText).resetBBox(e),this.current.textRenderingMode&kt.ADD_TO_PATH_FLAG&&this.dependencyTracker.recordFutureForcedDependency("textClip",e).inheritPendingDependenciesAsFutureForcedDependencies());const s=this.current,i=s.font;if(i.isType3Font){this.showType3Text(e,t),(F=this.dependencyTracker)==null||F.recordShowTextOperation(e);return}const r=s.fontSize;if(r===0){(K=this.dependencyTracker)==null||K.recordOperation(e);return}const a=this.ctx,l=s.fontSizeScale,c=s.charSpacing,u=s.wordSpacing,d=s.fontDirection,h=s.textHScale*d,f=t.length,p=i.vertical,v=p?1:-1,b=i.defaultVMetrics,S=r*s.fontMatrix[0],y=s.textRenderingMode===kt.FILL&&!i.disableFontFace&&!s.patternFill;a.save(),s.textMatrix&&a.transform(...s.textMatrix),a.translate(s.x,s.y+s.textRise),d>0?a.scale(h,-1):a.scale(h,1);let k,w;const E=s.textRenderingMode&kt.FILL_STROKE_MASK,C=E===kt.FILL||E===kt.FILL_STROKE,T=E===kt.STROKE||E===kt.FILL_STROKE;if(C&&s.patternFill){a.save();const se=s.fillColor.getPattern(a,this,fi(a),Xt.FILL,e);k=et(a),a.restore(),a.fillStyle=se}if(T&&s.patternStroke){a.save();const se=s.strokeColor.getPattern(a,this,fi(a),Xt.STROKE,e);w=et(a),a.restore(),a.strokeStyle=se}let _=s.lineWidth;const P=s.textMatrixScale;if(P===0||_===0?T&&(_=this.getSinglePixelWidth()):_/=P,l!==1&&(a.scale(l,l),_/=l),a.lineWidth=_,i.isInvalidPDFjsFont){const se=[];let G=0;for(const R of t)se.push(R.unicode),G+=R.width;const $=se.join("");if(a.fillText($,0,0),this.dependencyTracker!==null){const R=a.measureText($);this.dependencyTracker.recordBBox(e,this.ctx,-R.actualBoundingBoxLeft,R.actualBoundingBoxRight,-R.actualBoundingBoxAscent,R.actualBoundingBoxDescent).recordShowTextOperation(e)}s.x+=G*S*h,a.restore(),this.compose();return}let D=0,I;for(I=0;I<f;++I){const se=t[I];if(typeof se=="number"){D+=v*se*r/1e3;continue}let G=!1;const $=(se.isSpace?u:0)+c,R=se.fontChar,X=se.accent;let Y,ae,te=se.width;if(p){const Ae=se.vmetric||b,_e=-(se.vmetric?Ae[1]:te*.5)*S,ke=Ae[2]*S;te=Ae?-Ae[0]:te,Y=_e/l,ae=(D+ke)/l}else Y=D/l,ae=0;let he;if(i.remeasure&&te>0){he=a.measureText(R);const Ae=he.width*1e3/r*l;if(te<Ae&&this.isFontSubpixelAAEnabled){const _e=te/Ae;G=!0,a.save(),a.scale(_e,1),Y/=_e}else te!==Ae&&(Y+=(te-Ae)/2e3*r/l)}if(this.contentVisible&&(se.isInFont||i.missingFile)){if(y&&!X)a.fillText(R,Y,ae),(Z=this.dependencyTracker)==null||Z.recordCharacterBBox(e,a,he?{bbox:null}:i,r/l,Y,ae,()=>he??a.measureText(R));else if(this.paintChar(e,R,Y,ae,k,w),X){const Ae=Y+r*X.offset.x/l,_e=ae-r*X.offset.y/l;this.paintChar(e,X.fontChar,Ae,_e,k,w)}}const ht=p?te*S-$*d:te*S+$*d;D+=ht,G&&a.restore()}p?s.y-=D:s.x+=D*h,a.restore(),this.compose(),(Q=this.dependencyTracker)==null||Q.recordShowTextOperation(e)}showType3Text(e,t){const s=this.ctx,i=this.current,r=i.font,a=i.fontSize,l=i.fontDirection,c=r.vertical?1:-1,u=i.charSpacing,d=i.wordSpacing,h=i.textHScale*l,f=i.fontMatrix||Py,p=t.length,v=i.textRenderingMode===kt.INVISIBLE;let b,S,y,k;if(v||a===0)return;this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,s.save(),i.textMatrix&&s.transform(...i.textMatrix),s.translate(i.x,i.y+i.textRise),s.scale(h,l);const w=this.dependencyTracker;for(this.dependencyTracker=w?new Zg(w,e):null,b=0;b<p;++b){if(S=t[b],typeof S=="number"){k=c*S*a/1e3,this.ctx.translate(k,0),i.x+=k*h;continue}const E=(S.isSpace?d:0)+u,C=r.charProcOperatorList[S.operatorListId];C?this.contentVisible&&(this.save(),s.scale(a,a),s.transform(...f),this.executeOperatorList(C),this.restore()):ne(`Type3 character "${S.operatorListId}" is not available.`);const T=[S.width,0];z.applyTransform(T,f),y=T[0]*a+E,s.translate(y,0),i.x+=y*h}s.restore(),w&&(this.dependencyTracker=w)}setCharWidth(e,t,s){}setCharWidthAndBounds(e,t,s,i,r,a,l){var u;const c=new Path2D;c.rect(i,r,a-i,l-r),this.ctx.clip(c),(u=this.dependencyTracker)==null||u.recordBBox(e,this.ctx,i,a,r,l).recordClipBox(e,this.ctx,i,a,r,l),this.endPath(e)}getColorN_Pattern(e,t){let s;if(t[0]==="TilingPattern"){const i=this.baseTransform||et(this.ctx),r={createCanvasGraphics:(a,l)=>new fw(a,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack},void 0,void 0,this.dependencyTracker?new Zg(this.dependencyTracker,l,!0):null)};s=new ax(t,this.ctx,r,i)}else s=this._getPattern(e,t[1],t[2]);return s}setStrokeColorN(e,...t){var s;(s=this.dependencyTracker)==null||s.recordSimpleData("strokeColor",e),this.current.strokeColor=this.getColorN_Pattern(e,t),this.current.patternStroke=!0}setFillColorN(e,...t){var s;(s=this.dependencyTracker)==null||s.recordSimpleData("fillColor",e),this.current.fillColor=this.getColorN_Pattern(e,t),this.current.patternFill=!0}setStrokeRGBColor(e,t){var s;(s=this.dependencyTracker)==null||s.recordSimpleData("strokeColor",e),this.ctx.strokeStyle=this.current.strokeColor=t,this.current.patternStroke=!1}setStrokeTransparent(e){var t;(t=this.dependencyTracker)==null||t.recordSimpleData("strokeColor",e),this.ctx.strokeStyle=this.current.strokeColor="transparent",this.current.patternStroke=!1}setFillRGBColor(e,t){var s;(s=this.dependencyTracker)==null||s.recordSimpleData("fillColor",e),this.ctx.fillStyle=this.current.fillColor=t,this.current.patternFill=!1}setFillTransparent(e){var t;(t=this.dependencyTracker)==null||t.recordSimpleData("fillColor",e),this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(e,t,s=null){let i;return this.cachedPatterns.has(t)?i=this.cachedPatterns.get(t):(i=qN(this.getObject(e,t)),this.cachedPatterns.set(t,i)),s&&(i.matrix=s),i}shadingFill(e,t){var a;if(!this.contentVisible)return;const s=this.ctx;this.save(e);const i=this._getPattern(e,t);s.fillStyle=i.getPattern(s,this,fi(s),Xt.SHADING,e);const r=fi(s);if(r){const{width:l,height:c}=s.canvas,u=Rc.slice();z.axialAlignedBoundingBox([0,0,l,c],r,u);const[d,h,f,p]=u;this.ctx.fillRect(d,h,f-d,p-h)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);(a=this.dependencyTracker)==null||a.resetBBox(e).recordFullPageBBox(e).recordDependencies(e,vn.transform).recordDependencies(e,vn.fill).recordOperation(e),this.compose(this.current.getClippedPathBoundingBox()),this.restore(e)}beginInlineImage(){Ce("Should not call beginInlineImage")}beginImageData(){Ce("Should not call beginImageData")}paintFormXObjectBegin(e,t,s){var i;if(this.contentVisible&&(this.save(e),this.baseTransformStack.push(this.baseTransform),t&&this.transform(e,...t),this.baseTransform=et(this.ctx),s)){z.axialAlignedBoundingBox(s,this.baseTransform,this.current.minMax);const[r,a,l,c]=s,u=new Path2D;u.rect(r,a,l-r,c-a),this.ctx.clip(u),(i=this.dependencyTracker)==null||i.recordClipBox(e,this.ctx,r,l,a,c),this.endPath(e)}}paintFormXObjectEnd(e){this.contentVisible&&(this.restore(e),this.baseTransform=this.baseTransformStack.pop())}beginGroup(e,t){var w;if(!this.contentVisible)return;this.save(e),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const s=this.ctx;t.isolated||$0("TODO: Support non-isolated groups."),t.knockout&&ne("Knockout groups not supported.");const i=et(s);if(t.matrix&&s.transform(...t.matrix),!t.bbox)throw new Error("Bounding box is required.");let r=Rc.slice();z.axialAlignedBoundingBox(t.bbox,et(s),r);const a=[0,0,s.canvas.width,s.canvas.height];r=z.intersect(r,a)||[0,0,0,0];const l=Math.floor(r[0]),c=Math.floor(r[1]),u=Math.max(Math.ceil(r[2])-l,1),d=Math.max(Math.ceil(r[3])-c,1);this.current.startNewPathAndClipBox([0,0,u,d]);let h="groupAt"+this.groupLevel;t.smask&&(h+="_smask_"+this.smaskCounter++%2);const f=this.cachedCanvases.getCanvas(h,u,d),p=f.context;p.translate(-l,-c),p.transform(...i);let v=new Path2D;const[b,S,y,k]=t.bbox;if(v.rect(b,S,y-b,k-S),t.matrix){const E=new Path2D;E.addPath(v,new DOMMatrix(t.matrix)),v=E}p.clip(v),t.smask&&this.smaskStack.push({canvas:f.canvas,context:p,offsetX:l,offsetY:c,subtype:t.smask.subtype,backdrop:t.smask.backdrop,transferMap:t.smask.transferMap||null,startTransformInverse:null}),(!t.smask||this.dependencyTracker)&&(s.setTransform(1,0,0,1,0,0),s.translate(l,c),s.save()),Hd(s,p),this.ctx=p,(w=this.dependencyTracker)==null||w.inheritSimpleDataAsFutureForcedDependencies(["fillAlpha","strokeAlpha","globalCompositeOperation"]).pushBaseTransform(s),this.setGState(e,[["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(s),this.groupLevel++}endGroup(e,t){var r;if(!this.contentVisible)return;this.groupLevel--;const s=this.ctx,i=this.groupStack.pop();if(this.ctx=i,this.ctx.imageSmoothingEnabled=!1,(r=this.dependencyTracker)==null||r.popBaseTransform(),t.smask)this.tempSMask=this.smaskStack.pop(),this.restore(e),this.dependencyTracker&&this.ctx.restore();else{this.ctx.restore();const a=et(this.ctx);this.restore(e),this.ctx.save(),this.ctx.setTransform(...a);const l=Rc.slice();z.axialAlignedBoundingBox([0,0,s.canvas.width,s.canvas.height],a,l),this.ctx.drawImage(s.canvas,0,0),this.ctx.restore(),this.compose(l)}}beginAnnotation(e,t,s,i,r,a){if(A(this,di,lx).call(this),Tm(this.ctx),this.ctx.save(),this.save(e),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),s){const l=s[2]-s[0],c=s[3]-s[1];if(a&&this.annotationCanvasMap){i=i.slice(),i[4]-=s[0],i[5]-=s[1],s=s.slice(),s[0]=s[1]=0,s[2]=l,s[3]=c,z.singularValueDecompose2dScale(et(this.ctx),an);const{viewportScale:u}=this,d=Math.ceil(l*this.outputScaleX*u),h=Math.ceil(c*this.outputScaleY*u);this.annotationCanvas=this.canvasFactory.create(d,h);const{canvas:f,context:p}=this.annotationCanvas;this.annotationCanvasMap.set(t,f),this.annotationCanvas.savedCtx=this.ctx,this.ctx=p,this.ctx.save(),this.ctx.setTransform(an[0],0,0,-an[1],0,c*an[1]),Tm(this.ctx)}else{Tm(this.ctx),this.endPath(e);const u=new Path2D;u.rect(s[0],s[1],l,c),this.ctx.clip(u)}}this.current=new K1(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(e,...i),this.transform(e,...r)}endAnnotation(e){this.annotationCanvas&&(this.ctx.restore(),A(this,di,cx).call(this),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(e,t){var l;if(!this.contentVisible)return;const s=t.count;t=this.getObject(e,t.data,t),t.count=s;const i=this.ctx,r=this._createMaskCanvas(e,t),a=r.canvas;i.save(),i.setTransform(1,0,0,1,0,0),i.drawImage(a,r.offsetX,r.offsetY),(l=this.dependencyTracker)==null||l.resetBBox(e).recordBBox(e,this.ctx,r.offsetX,r.offsetX+a.width,r.offsetY,r.offsetY+a.height).recordOperation(e),i.restore(),this.compose()}paintImageMaskXObjectRepeat(e,t,s,i=0,r=0,a,l){var h,f,p;if(!this.contentVisible)return;t=this.getObject(e,t.data,t);const c=this.ctx;c.save();const u=et(c);c.transform(s,i,r,a,0,0);const d=this._createMaskCanvas(e,t);c.setTransform(1,0,0,1,d.offsetX-u[4],d.offsetY-u[5]),(h=this.dependencyTracker)==null||h.resetBBox(e);for(let v=0,b=l.length;v<b;v+=2){const S=z.transform(u,[s,i,r,a,l[v],l[v+1]]);c.drawImage(d.canvas,S[4],S[5]),(f=this.dependencyTracker)==null||f.recordBBox(e,this.ctx,S[4],S[4]+d.canvas.width,S[5],S[5]+d.canvas.height)}c.restore(),this.compose(),(p=this.dependencyTracker)==null||p.recordOperation(e)}paintImageMaskXObjectGroup(e,t){var a,l,c;if(!this.contentVisible)return;const s=this.ctx,i=this.current.fillColor,r=this.current.patternFill;(a=this.dependencyTracker)==null||a.resetBBox(e).recordDependencies(e,vn.transformAndFill);for(const u of t){const{data:d,width:h,height:f,transform:p}=u,v=this.cachedCanvases.getCanvas("maskCanvas",h,f),b=v.context;b.save();const S=this.getObject(e,d,u);J1(b,S),b.globalCompositeOperation="source-in",b.fillStyle=r?i.getPattern(b,this,fi(s),Xt.FILL,e):i,b.fillRect(0,0,h,f),b.restore(),s.save(),s.transform(...p),s.scale(1,-1),Cm(s,v.canvas,0,0,h,f,0,-1,1,1),(l=this.dependencyTracker)==null||l.recordBBox(e,s,0,h,0,f),s.restore()}this.compose(),(c=this.dependencyTracker)==null||c.recordOperation(e)}paintImageXObject(e,t){if(!this.contentVisible)return;const s=this.getObject(e,t);if(!s){ne("Dependent image isn't ready yet");return}this.paintInlineImageXObject(e,s)}paintImageXObjectRepeat(e,t,s,i,r){if(!this.contentVisible)return;const a=this.getObject(e,t);if(!a){ne("Dependent image isn't ready yet");return}const l=a.width,c=a.height,u=[];for(let d=0,h=r.length;d<h;d+=2)u.push({transform:[s,0,0,i,r[d],r[d+1]],x:0,y:0,w:l,h:c});this.paintInlineImageXObjectGroup(e,a,u)}applyTransferMapsToCanvas(e){return this.current.transferMaps!=="none"&&(e.filter=this.current.transferMaps,e.drawImage(e.canvas,0,0),e.filter="none"),e.canvas}applyTransferMapsToBitmap(e){if(this.current.transferMaps==="none")return e.bitmap;const{bitmap:t,width:s,height:i}=e,r=this.cachedCanvases.getCanvas("inlineImage",s,i),a=r.context;return a.filter=this.current.transferMaps,a.drawImage(t,0,0),a.filter="none",r.canvas}paintInlineImageXObject(e,t){var u;if(!this.contentVisible)return;const s=t.width,i=t.height,r=this.ctx;this.save(e);const{filter:a}=r;a!=="none"&&a!==""&&(r.filter="none"),r.scale(1/s,-1/i);let l;if(t.bitmap)l=this.applyTransferMapsToBitmap(t);else if(typeof HTMLElement=="function"&&t instanceof HTMLElement||!t.data)l=t;else{const h=this.cachedCanvases.getCanvas("inlineImage",s,i).context;Q1(h,t),l=this.applyTransferMapsToCanvas(h)}const c=this._scaleImage(l,fi(r));r.imageSmoothingEnabled=Z1(et(r),t.interpolate),(u=this.dependencyTracker)==null||u.resetBBox(e).recordBBox(e,r,0,s,-i,0).recordDependencies(e,vn.imageXObject).recordOperation(e),Cm(r,c.img,0,0,c.paintWidth,c.paintHeight,0,-i,s,i),this.compose(),this.restore(e)}paintInlineImageXObjectGroup(e,t,s){var a,l,c;if(!this.contentVisible)return;const i=this.ctx;let r;if(t.bitmap)r=t.bitmap;else{const u=t.width,d=t.height,f=this.cachedCanvases.getCanvas("inlineImage",u,d).context;Q1(f,t),r=this.applyTransferMapsToCanvas(f)}(a=this.dependencyTracker)==null||a.resetBBox(e);for(const u of s)i.save(),i.transform(...u.transform),i.scale(1,-1),Cm(i,r,u.x,u.y,u.w,u.h,0,-1,1,1),(l=this.dependencyTracker)==null||l.recordBBox(e,i,0,1,-1,0),i.restore();(c=this.dependencyTracker)==null||c.recordOperation(e),this.compose()}paintSolidColorImageMask(e){var t;this.contentVisible&&((t=this.dependencyTracker)==null||t.resetBBox(e).recordBBox(e,this.ctx,0,1,0,1).recordDependencies(e,vn.fill).recordOperation(e),this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(e,t){}markPointProps(e,t,s){}beginMarkedContent(e,t){var s;(s=this.dependencyTracker)==null||s.beginMarkedContent(e),this.markedContentStack.push({visible:!0})}beginMarkedContentProps(e,t,s){var i;(i=this.dependencyTracker)==null||i.beginMarkedContent(e),t==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(s)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(e){var t;(t=this.dependencyTracker)==null||t.endMarkedContent(e),this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(e){}endCompat(e){}consumePath(e,t,s){var a,l;const i=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(s);const r=this.ctx;this.pendingClip?(i||(this.pendingClip===eA?r.clip(t,"evenodd"):r.clip(t)),this.pendingClip=null,(a=this.dependencyTracker)==null||a.bboxToClipBoxDropOperation(e).recordFutureForcedDependency("clipPath",e)):(l=this.dependencyTracker)==null||l.recordOperation(e),this.current.startNewPathAndClipBox(this.current.clipBox)}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const e=et(this.ctx);if(e[1]===0&&e[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(e[0]),Math.abs(e[3]));else{const t=Math.abs(e[0]*e[3]-e[2]*e[1]),s=Math.hypot(e[0],e[2]),i=Math.hypot(e[1],e[3]);this._cachedGetSinglePixelWidth=Math.max(s,i)/t}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:e}=this.current,{a:t,b:s,c:i,d:r}=this.ctx.getTransform();let a,l;if(s===0&&i===0){const c=Math.abs(t),u=Math.abs(r);if(c===u)if(e===0)a=l=1/c;else{const d=c*e;a=l=d<1?1/d:1}else if(e===0)a=1/c,l=1/u;else{const d=c*e,h=u*e;a=d<1?1/d:1,l=h<1?1/h:1}}else{const c=Math.abs(t*r-s*i),u=Math.hypot(t,s),d=Math.hypot(i,r);if(e===0)a=d/c,l=u/c;else{const h=e*c;a=d>h?d/h:1,l=u>h?u/h:1}}this._cachedScaleForStroking[0]=a,this._cachedScaleForStroking[1]=l}return this._cachedScaleForStroking}rescaleAndStroke(e,t){const{ctx:s,current:{lineWidth:i}}=this,[r,a]=this.getScaleForStroking();if(r===a){s.lineWidth=(i||1)*r,s.stroke(e);return}const l=s.getLineDash();t&&s.save(),s.scale(r,a),Lv.a=1/r,Lv.d=1/a;const c=new Path2D;if(c.addPath(e,Lv),l.length>0){const u=Math.max(r,a);s.setLineDash(l.map(d=>d/u)),s.lineDashOffset/=u}s.lineWidth=i||1,s.stroke(c),t&&s.restore()}isContentVisible(){for(let e=this.markedContentStack.length-1;e>=0;e--)if(!this.markedContentStack[e].visible)return!1;return!0}};di=new WeakSet,lx=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},cx=function(){if(this.pageColors){const e=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(e!=="none"){const t=this.ctx.filter;this.ctx.filter=e,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=t}}},ux=function(e,t,s){const i=new Path2D;return i.addPath(e,new DOMMatrix(s).invertSelf().multiplySelf(t)),i};let Gc=fw;for(const n in Wh)Gc.prototype[n]!==void 0&&(Gc.prototype[Wh[n]]=Gc.prototype[n]);var Bf,zf;class zi{static get workerPort(){return o(this,Bf)}static set workerPort(e){if(!(typeof Worker<"u"&&e instanceof Worker)&&e!==null)throw new Error("Invalid `workerPort` type.");m(this,Bf,e)}static get workerSrc(){return o(this,zf)}static set workerSrc(e){if(typeof e!="string")throw new Error("Invalid `workerSrc` type.");m(this,zf,e)}}Bf=new WeakMap,zf=new WeakMap,x(zi,Bf,null),x(zi,zf,"");var Pu,Uf;class nP{constructor({parsedData:e,rawData:t}){x(this,Pu);x(this,Uf);m(this,Pu,e),m(this,Uf,t)}getRaw(){return o(this,Uf)}get(e){return o(this,Pu).get(e)??null}[Symbol.iterator](){return o(this,Pu).entries()}}Pu=new WeakMap,Uf=new WeakMap;const xc=Symbol("INTERNAL");var Hf,$f,Vf,Mu;class iP{constructor(e,{name:t,intent:s,usage:i,rbGroups:r}){x(this,Hf,!1);x(this,$f,!1);x(this,Vf,!1);x(this,Mu,!0);m(this,Hf,!!(e&rn.DISPLAY)),m(this,$f,!!(e&rn.PRINT)),this.name=t,this.intent=s,this.usage=i,this.rbGroups=r}get visible(){if(o(this,Vf))return o(this,Mu);if(!o(this,Mu))return!1;const{print:e,view:t}=this.usage;return o(this,Hf)?(t==null?void 0:t.viewState)!=="OFF":o(this,$f)?(e==null?void 0:e.printState)!=="OFF":!0}_setVisible(e,t,s=!1){e!==xc&&Ce("Internal method `_setVisible` called."),m(this,Vf,s),m(this,Mu,t)}}Hf=new WeakMap,$f=new WeakMap,Vf=new WeakMap,Mu=new WeakMap;var Ro,je,Lu,Du,Wf,dx;class rP{constructor(e,t=rn.DISPLAY){x(this,Wf);x(this,Ro,null);x(this,je,new Map);x(this,Lu,null);x(this,Du,null);if(this.renderingIntent=t,this.name=null,this.creator=null,e!==null){this.name=e.name,this.creator=e.creator,m(this,Du,e.order);for(const s of e.groups)o(this,je).set(s.id,new iP(t,s));if(e.baseState==="OFF")for(const s of o(this,je).values())s._setVisible(xc,!1);for(const s of e.on)o(this,je).get(s)._setVisible(xc,!0);for(const s of e.off)o(this,je).get(s)._setVisible(xc,!1);m(this,Lu,this.getHash())}}isVisible(e){if(o(this,je).size===0)return!0;if(!e)return $0("Optional content group not defined."),!0;if(e.type==="OCG")return o(this,je).has(e.id)?o(this,je).get(e.id).visible:(ne(`Optional content group not found: ${e.id}`),!0);if(e.type==="OCMD"){if(e.expression)return A(this,Wf,dx).call(this,e.expression);if(!e.policy||e.policy==="AnyOn"){for(const t of e.ids){if(!o(this,je).has(t))return ne(`Optional content group not found: ${t}`),!0;if(o(this,je).get(t).visible)return!0}return!1}else if(e.policy==="AllOn"){for(const t of e.ids){if(!o(this,je).has(t))return ne(`Optional content group not found: ${t}`),!0;if(!o(this,je).get(t).visible)return!1}return!0}else if(e.policy==="AnyOff"){for(const t of e.ids){if(!o(this,je).has(t))return ne(`Optional content group not found: ${t}`),!0;if(!o(this,je).get(t).visible)return!0}return!1}else if(e.policy==="AllOff"){for(const t of e.ids){if(!o(this,je).has(t))return ne(`Optional content group not found: ${t}`),!0;if(o(this,je).get(t).visible)return!1}return!0}return ne(`Unknown optional content policy ${e.policy}.`),!0}return ne(`Unknown group type ${e.type}.`),!0}setVisibility(e,t=!0,s=!0){var r;const i=o(this,je).get(e);if(!i){ne(`Optional content group not found: ${e}`);return}if(s&&t&&i.rbGroups.length)for(const a of i.rbGroups)for(const l of a)l!==e&&((r=o(this,je).get(l))==null||r._setVisible(xc,!1,!0));i._setVisible(xc,!!t,!0),m(this,Ro,null)}setOCGState({state:e,preserveRB:t}){let s;for(const i of e){switch(i){case"ON":case"OFF":case"Toggle":s=i;continue}const r=o(this,je).get(i);if(r)switch(s){case"ON":this.setVisibility(i,!0,t);break;case"OFF":this.setVisibility(i,!1,t);break;case"Toggle":this.setVisibility(i,!r.visible,t);break}}m(this,Ro,null)}get hasInitialVisibility(){return o(this,Lu)===null||this.getHash()===o(this,Lu)}getOrder(){return o(this,je).size?o(this,Du)?o(this,Du).slice():[...o(this,je).keys()]:null}getGroup(e){return o(this,je).get(e)||null}getHash(){if(o(this,Ro)!==null)return o(this,Ro);const e=new uE;for(const[t,s]of o(this,je))e.update(`${t}:${s.visible}`);return m(this,Ro,e.hexdigest())}[Symbol.iterator](){return o(this,je).entries()}}Ro=new WeakMap,je=new WeakMap,Lu=new WeakMap,Du=new WeakMap,Wf=new WeakSet,dx=function(e){const t=e.length;if(t<2)return!0;const s=e[0];for(let i=1;i<t;i++){const r=e[i];let a;if(Array.isArray(r))a=A(this,Wf,dx).call(this,r);else if(o(this,je).has(r))a=o(this,je).get(r).visible;else return ne(`Optional content group not found: ${r}`),!0;switch(s){case"And":if(!a)return!1;break;case"Or":if(a)return!0;break;case"Not":return!a;default:return!0}}return s==="And"};var Gf,Xf;class G0{constructor(e,t,s){x(this,Gf,null);x(this,Xf,null);M(this,"_fullReader",null);M(this,"_rangeReaders",new Set);M(this,"_source",null);this._source=e,m(this,Gf,t),m(this,Xf,s)}get _progressiveDataLength(){var e;return((e=this._fullReader)==null?void 0:e._loaded)??0}getFullReader(){return Ee(!this._fullReader,"BasePDFStream.getFullReader can only be called once."),this._fullReader=new(o(this,Gf))(this)}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const s=new(o(this,Xf))(this,e,t);return this._rangeReaders.add(s),s}cancelAllRequests(e){var t;(t=this._fullReader)==null||t.cancel(e);for(const s of new Set(this._rangeReaders))s.cancel(e)}}Gf=new WeakMap,Xf=new WeakMap;class X0{constructor(e){M(this,"onProgress",null);M(this,"_contentLength",0);M(this,"_filename",null);M(this,"_headersCapability",Promise.withResolvers());M(this,"_isRangeSupported",!1);M(this,"_isStreamingSupported",!1);M(this,"_loaded",0);M(this,"_stream",null);this._stream=e}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){Ce("Abstract method `read` called")}cancel(e){Ce("Abstract method `cancel` called")}}class Y0{constructor(e,t,s){M(this,"_stream",null);this._stream=e}async read(){Ce("Abstract method `read` called")}cancel(e){Ce("Abstract method `cancel` called")}}function tA(n){return n instanceof Uint8Array&&n.byteLength===n.buffer.byteLength?n.buffer:new Uint8Array(n).buffer}var Yf,hx;class oP extends G0{constructor(t){super(t,aP,lP);x(this,Yf);M(this,"_progressiveDone",!1);M(this,"_queuedChunks",[]);const{pdfDataRangeTransport:s}=t,{initialData:i,progressiveDone:r}=s;if((i==null?void 0:i.length)>0){const a=tA(i);this._queuedChunks.push(a)}this._progressiveDone=r,s.addRangeListener((a,l)=>{A(this,Yf,hx).call(this,a,l)}),s.addProgressListener((a,l)=>{var c,u;l!==void 0&&((u=(c=this._fullReader)==null?void 0:c.onProgress)==null||u.call(c,{loaded:a,total:l}))}),s.addProgressiveReadListener(a=>{A(this,Yf,hx).call(this,void 0,a)}),s.addProgressiveDoneListener(()=>{var a;(a=this._fullReader)==null||a.progressiveDone(),this._progressiveDone=!0}),s.transportReady()}getFullReader(){const t=super.getFullReader();return this._queuedChunks=null,t}getRangeReader(t,s){const i=super.getRangeReader(t,s);return i&&(i.onDone=()=>this._rangeReaders.delete(i),this._source.pdfDataRangeTransport.requestDataRange(t,s)),i}cancelAllRequests(t){super.cancelAllRequests(t),this._source.pdfDataRangeTransport.abort()}}Yf=new WeakSet,hx=function(t,s){const i=tA(s);if(t===void 0)this._fullReader?this._fullReader._enqueue(i):this._queuedChunks.push(i);else{const r=this._rangeReaders.keys().find(a=>a._begin===t);Ee(r,"#onReceiveData - no `PDFDataTransportStreamRangeReader` instance found."),r._enqueue(i)}};class aP extends X0{constructor(t){super(t);M(this,"_done",!1);M(this,"_queuedChunks",null);M(this,"_requests",[]);const{pdfDataRangeTransport:s,disableRange:i,disableStream:r}=t._source,{length:a,contentDispositionFilename:l}=s;this._queuedChunks=t._queuedChunks||[];for(const c of this._queuedChunks)this._loaded+=c.byteLength;this._done=t._progressiveDone,this._contentLength=a,this._isStreamingSupported=!r,this._isRangeSupported=!i,sw(l)&&(this._filename=l),this._headersCapability.resolve()}_enqueue(t){this._done||(this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunks.push(t),this._loaded+=t.byteLength)}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const s of this._requests)s.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class lP extends Y0{constructor(t,s,i){super(t,s,i);M(this,"onDone",null);M(this,"_begin",-1);M(this,"_done",!1);M(this,"_queuedChunk",null);M(this,"_requests",[]);this._begin=s}_enqueue(t){var s;if(!this._done){if(this._requests.length===0)this._queuedChunk=t;else{this._requests.shift().resolve({value:t,done:!1});for(const r of this._requests)r.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,(s=this.onDone)==null||s.call(this)}}async read(){if(this._queuedChunk){const s=this._queuedChunk;return this._queuedChunk=null,{value:s,done:!1}}if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){var s;this._done=!0;for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0,(s=this.onDone)==null||s.call(this)}}function cP(n){let e=!0,t=s("filename\\*","i").exec(n);if(t){t=t[1];let d=l(t);return d=unescape(d),d=c(d),d=u(d),r(d)}if(t=a(n),t){const d=u(t);return r(d)}if(t=s("filename","i").exec(n),t){t=t[1];let d=l(t);return d=u(d),r(d)}function s(d,h){return new RegExp("(?:^|;)\\s*"+d+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',h)}function i(d,h){if(d){if(!/^[\x00-\xFF]+$/.test(h))return h;try{const f=new TextDecoder(d,{fatal:!0}),p=V0(h);h=f.decode(p),e=!1}catch{}}return h}function r(d){return e&&/[\x80-\xff]/.test(d)&&(d=i("utf-8",d),e&&(d=i("iso-8859-1",d))),d}function a(d){const h=[];let f;const p=s("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(f=p.exec(d))!==null;){let[,b,S,y]=f;if(b=parseInt(b,10),b in h){if(b===0)break;continue}h[b]=[S,y]}const v=[];for(let b=0;b<h.length&&b in h;++b){let[S,y]=h[b];y=l(y),S&&(y=unescape(y),b===0&&(y=c(y))),v.push(y)}return v.join("")}function l(d){if(d.startsWith('"')){const h=d.slice(1).split('\\"');for(let f=0;f<h.length;++f){const p=h[f].indexOf('"');p!==-1&&(h[f]=h[f].slice(0,p),h.length=f+1),h[f]=h[f].replaceAll(/\\(.)/g,"$1")}d=h.join('"')}return d}function c(d){const h=d.indexOf("'");if(h===-1)return d;const f=d.slice(0,h),v=d.slice(h+1).replace(/^[^']*'/,"");return i(f,v)}function u(d){return!d.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(d)?d:d.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(h,f,p,v){if(p==="q"||p==="Q")return v=v.replaceAll("_"," "),v=v.replaceAll(/=([0-9a-fA-F]{2})/g,function(b,S){return String.fromCharCode(parseInt(S,16))}),i(f,v);try{v=atob(v)}catch{}return i(f,v)})}return""}function AE(n,e){const t=new Headers;if(!n||!e||typeof e!="object")return t;for(const s in e){const i=e[s];i!==void 0&&t.append(s,i)}return t}function q0(n){var e;return((e=URL.parse(n))==null?void 0:e.origin)??null}function kE({responseHeaders:n,isHttp:e,rangeChunkSize:t,disableRange:s}){const i={allowRangeRequests:!1,suggestedLength:void 0},r=parseInt(n.get("Content-Length"),10);return!Number.isInteger(r)||(i.suggestedLength=r,r<=2*t)||s||!e||n.get("Accept-Ranges")!=="bytes"||(n.get("Content-Encoding")||"identity")!=="identity"||(i.allowRangeRequests=!0),i}function SE(n){const e=n.get("Content-Disposition");if(e){let t=cP(e);if(t.includes("%"))try{t=decodeURIComponent(t)}catch{}if(sw(t))return t}return null}function K0(n,e){return new Xg(`Unexpected server response (${n}) while retrieving PDF "${e}".`,n,n===404||n===0&&e.startsWith("file:"))}function EE(n,e){if(n!==e)throw new Error(`Expected range response-origin "${n}" to match "${e}".`)}function CE(n,e,t,s){return fetch(n,{method:"GET",headers:e,signal:s.signal,mode:"cors",credentials:t?"include":"same-origin",redirect:"follow"})}function TE(n,e){if(n!==200&&n!==206)throw K0(n,e)}function _E(n){return n instanceof Uint8Array?n.buffer:n instanceof ArrayBuffer?n:(ne(`getArrayBuffer - unexpected data format: ${n}`),new Uint8Array(n).buffer)}class uP extends G0{constructor(t){super(t,dP,hP);M(this,"_responseOrigin",null);this.isHttp=/^https?:/i.test(t.url),this.headers=AE(this.isHttp,t.httpHeaders)}}class dP extends X0{constructor(t){super(t);M(this,"_abortController",new AbortController);M(this,"_reader",null);const{disableRange:s,disableStream:i,length:r,rangeChunkSize:a,url:l,withCredentials:c}=t._source;this._contentLength=r,this._isStreamingSupported=!i,this._isRangeSupported=!s;const u=new Headers(t.headers);CE(l,u,c,this._abortController).then(d=>{t._responseOrigin=q0(d.url),TE(d.status,l),this._reader=d.body.getReader();const h=d.headers,{allowRangeRequests:f,suggestedLength:p}=kE({responseHeaders:h,isHttp:t.isHttp,rangeChunkSize:a,disableRange:s});this._isRangeSupported=f,this._contentLength=p||this._contentLength,this._filename=SE(h),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new va("Streaming is disabled.")),this._headersCapability.resolve()}).catch(this._headersCapability.reject)}async read(){var i;await this._headersCapability.promise;const{value:t,done:s}=await this._reader.read();return s?{value:t,done:s}:(this._loaded+=t.byteLength,(i=this.onProgress)==null||i.call(this,{loaded:this._loaded,total:this._contentLength}),{value:_E(t),done:!1})}cancel(t){var s;(s=this._reader)==null||s.cancel(t),this._abortController.abort()}}class hP extends Y0{constructor(t,s,i){super(t,s,i);M(this,"_abortController",new AbortController);M(this,"_readCapability",Promise.withResolvers());M(this,"_reader",null);const{url:r,withCredentials:a}=t._source,l=new Headers(t.headers);l.append("Range",`bytes=${s}-${i-1}`),CE(r,l,a,this._abortController).then(c=>{const u=q0(c.url);EE(u,t._responseOrigin),TE(c.status,r),this._reader=c.body.getReader(),this._readCapability.resolve()}).catch(this._readCapability.reject)}async read(){await this._readCapability.promise;const{value:t,done:s}=await this._reader.read();return s?{value:t,done:s}:{value:_E(t),done:!1}}cancel(t){var s;(s=this._reader)==null||s.cancel(t),this._abortController.abort()}}const Dv=200,sA=206;function fP(n){return typeof n!="string"?n:V0(n).buffer}var Ni,Td,NE,PE;class pP extends G0{constructor(t){super(t,mP,gP);x(this,Td);x(this,Ni,new WeakMap);M(this,"_responseOrigin",null);this.url=t.url,this.isHttp=/^https?:/i.test(this.url),this.headers=AE(this.isHttp,t.httpHeaders)}_request(t){const s=new XMLHttpRequest,i={validateStatus:null,onHeadersReceived:t.onHeadersReceived,onDone:t.onDone,onError:t.onError,onProgress:t.onProgress};o(this,Ni).set(s,i),s.open("GET",this.url),s.withCredentials=this._source.withCredentials;for(const[r,a]of this.headers)s.setRequestHeader(r,a);return this.isHttp&&"begin"in t&&"end"in t?(s.setRequestHeader("Range",`bytes=${t.begin}-${t.end-1}`),i.validateStatus=r=>r===sA||r===Dv):i.validateStatus=r=>r===Dv,s.responseType="arraybuffer",Ee(t.onError,"Expected `onError` callback to be provided."),s.onerror=()=>t.onError(s.status),s.onreadystatechange=A(this,Td,PE).bind(this,s),s.onprogress=A(this,Td,NE).bind(this,s),s.send(null),s}_abortRequest(t){o(this,Ni).has(t)&&(o(this,Ni).delete(t),t.abort())}getRangeReader(t,s){const i=super.getRangeReader(t,s);return i&&(i.onClosed=()=>this._rangeReaders.delete(i)),i}}Ni=new WeakMap,Td=new WeakSet,NE=function(t,s){var r;const i=o(this,Ni).get(t);(r=i==null?void 0:i.onProgress)==null||r.call(i,s)},PE=function(t,s){const i=o(this,Ni).get(t);if(!i||(t.readyState>=2&&i.onHeadersReceived&&(i.onHeadersReceived(),delete i.onHeadersReceived),t.readyState!==4)||!o(this,Ni).has(t))return;if(o(this,Ni).delete(t),t.status===0&&this.isHttp){i.onError(t.status);return}const r=t.status||Dv;if(!i.validateStatus(r)){i.onError(t.status);return}const a=fP(t.response);if(r===sA){const l=t.getResponseHeader("Content-Range");/bytes (\d+)-(\d+)\/(\d+)/.test(l)?i.onDone(a):(ne('Missing or invalid "Content-Range" header.'),i.onError(0))}else a?i.onDone(a):i.onError(t.status)};var Vi,ME,LE,DE,IE;class mP extends X0{constructor(t){super(t);x(this,Vi);M(this,"_cachedChunks",[]);M(this,"_done",!1);M(this,"_requests",[]);M(this,"_storedError",null);const{length:s}=t._source;this._contentLength=s,this._fullRequestXhr=t._request({onHeadersReceived:A(this,Vi,ME).bind(this),onDone:A(this,Vi,LE).bind(this),onError:A(this,Vi,DE).bind(this),onProgress:A(this,Vi,IE).bind(this)})}async read(){if(await this._headersCapability.promise,this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0,this._headersCapability.reject(t);for(const s of this._requests)s.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._abortRequest(this._fullRequestXhr),this._fullRequestXhr=null}}Vi=new WeakSet,ME=function(){const t=this._stream,{disableRange:s,rangeChunkSize:i}=t._source,r=this._fullRequestXhr;t._responseOrigin=q0(r.responseURL);const a=r.getAllResponseHeaders(),l=new Headers(a?a.trimStart().replace(/[^\S ]+$/,"").split(/[\r\n]+/).map(d=>{const[h,...f]=d.split(": ");return[h,f.join(": ")]}):[]),{allowRangeRequests:c,suggestedLength:u}=kE({responseHeaders:l,isHttp:t.isHttp,rangeChunkSize:i,disableRange:s});c&&(this._isRangeSupported=!0),this._contentLength=u||this._contentLength,this._filename=SE(l),this._isRangeSupported&&t._abortRequest(r),this._headersCapability.resolve()},LE=function(t){if(this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._cachedChunks.push(t),this._done=!0,!(this._cachedChunks.length>0)){for(const s of this._requests)s.resolve({value:void 0,done:!0});this._requests.length=0}},DE=function(t){this._storedError=K0(t,this._stream.url),this._headersCapability.reject(this._storedError);for(const s of this._requests)s.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0},IE=function(t){var s;(s=this.onProgress)==null||s.call(this,{loaded:t.loaded,total:t.lengthComputable?t.total:this._contentLength})};var Qr,RE,FE,fx;class gP extends Y0{constructor(t,s,i){super(t,s,i);x(this,Qr);M(this,"onClosed",null);M(this,"_done",!1);M(this,"_queuedChunk",null);M(this,"_requests",[]);M(this,"_storedError",null);this._requestXhr=t._request({begin:s,end:i,onHeadersReceived:A(this,Qr,RE).bind(this),onDone:A(this,Qr,FE).bind(this),onError:A(this,Qr,fx).bind(this),onProgress:null})}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const s=this._queuedChunk;return this._queuedChunk=null,{value:s,done:!1}}if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){var s;this._done=!0;for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._abortRequest(this._requestXhr),(s=this.onClosed)==null||s.call(this)}}Qr=new WeakSet,RE=function(){var s;const t=q0((s=this._requestXhr)==null?void 0:s.responseURL);try{EE(t,this._stream._responseOrigin)}catch(i){this._storedError=i,A(this,Qr,fx).call(this,0)}},FE=function(t){var s;this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunk=t,this._done=!0;for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0,(s=this.onClosed)==null||s.call(this)},fx=function(t){this._storedError??(this._storedError=K0(t,this._stream.url));for(const s of this._requests)s.reject(this._storedError);this._requests.length=0,this._queuedChunk=null};const vP=/^[a-z][a-z0-9\-+.]+:/i;function yP(n){if(vP.test(n))return new URL(n);const e=process.getBuiltinModule("url");return new URL(e.pathToFileURL(n))}function jE(n){const{Readable:e}=process.getBuiltinModule("stream");return typeof e.toWeb=="function"?e.toWeb(n):process.getBuiltinModule("module").createRequire(import.meta.url)("node-readable-to-web-readable-stream").makeDefaultReadableStreamFromNodeReadable(n)}function OE(n){return n instanceof Uint8Array?n.buffer:n instanceof ArrayBuffer?n:(ne(`getArrayBuffer - unexpected data format: ${n}`),new Uint8Array(n).buffer)}class xP extends G0{constructor(e){super(e,bP,wP),this.url=yP(e.url),Ee(this.url.protocol==="file:","PDFNodeStream only supports file:// URLs.")}}class bP extends X0{constructor(t){super(t);M(this,"_reader",null);const{disableRange:s,disableStream:i,length:r,rangeChunkSize:a}=t._source;this._contentLength=r,this._isStreamingSupported=!i,this._isRangeSupported=!s;const l=t.url,c=process.getBuiltinModule("fs");c.promises.lstat(l).then(u=>{const d=c.createReadStream(l),h=jE(d);this._reader=h.getReader();const{size:f}=u;f<=2*a&&(this._isRangeSupported=!1),this._contentLength=f,!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new va("Streaming is disabled.")),this._headersCapability.resolve()}).catch(u=>{u.code==="ENOENT"&&(u=K0(0,l.href)),this._headersCapability.reject(u)})}async read(){var i;await this._headersCapability.promise;const{value:t,done:s}=await this._reader.read();return s?{value:t,done:s}:(this._loaded+=t.length,(i=this.onProgress)==null||i.call(this,{loaded:this._loaded,total:this._contentLength}),{value:OE(t),done:!1})}cancel(t){var s;(s=this._reader)==null||s.cancel(t)}}class wP extends Y0{constructor(t,s,i){super(t,s,i);M(this,"_readCapability",Promise.withResolvers());M(this,"_reader",null);const r=t.url,a=process.getBuiltinModule("fs");try{const l=a.createReadStream(r,{start:s,end:i-1}),c=jE(l);this._reader=c.getReader(),this._readCapability.resolve()}catch(l){this._readCapability.reject(l)}}async read(){await this._readCapability.promise;const{value:t,done:s}=await this._reader.read();return s?{value:t,done:s}:{value:OE(t),done:!1}}cancel(t){var s;(s=this._reader)==null||s.cancel(t)}}const $d=Symbol("INITIAL_DATA");var $s,qf,px;class BE{constructor(){x(this,qf);x(this,$s,Object.create(null))}get(e,t=null){if(t){const i=A(this,qf,px).call(this,e);return i.promise.then(()=>t(i.data)),null}const s=o(this,$s)[e];if(!s||s.data===$d)throw new Error(`Requesting object that isn't resolved yet ${e}.`);return s.data}has(e){const t=o(this,$s)[e];return!!t&&t.data!==$d}delete(e){const t=o(this,$s)[e];return!t||t.data===$d?!1:(delete o(this,$s)[e],!0)}resolve(e,t=null){const s=A(this,qf,px).call(this,e);s.data=t,s.resolve()}clear(){var e;for(const t in o(this,$s)){const{data:s}=o(this,$s)[t];(e=s==null?void 0:s.bitmap)==null||e.close()}m(this,$s,Object.create(null))}*[Symbol.iterator](){for(const e in o(this,$s)){const{data:t}=o(this,$s)[e];t!==$d&&(yield[e,t])}}}$s=new WeakMap,qf=new WeakSet,px=function(e){var t;return(t=o(this,$s))[e]||(t[e]={...Promise.withResolvers(),data:$d})};const AP=1e5,nA=30;var hA,Fo,_s,Kf,Qf,hl,xr,Jf,Zf,fl,ep,Iu,jo,Ru,tp,Fu,pl,sp,np,ju,ml,ip,Ou,Bu,Jr,zE,UE,mx,hn,Zm,gx,HE,$E;const Bt=class Bt{constructor({textContentSource:e,container:t,viewport:s}){x(this,Jr);x(this,Fo,Promise.withResolvers());x(this,_s,null);x(this,Kf,!1);x(this,Qf,!!((hA=globalThis.FontInspector)!=null&&hA.enabled));x(this,hl,null);x(this,xr,null);x(this,Jf,0);x(this,Zf,0);x(this,fl,null);x(this,ep,null);x(this,Iu,0);x(this,jo,0);x(this,Ru,Object.create(null));x(this,tp,[]);x(this,Fu,null);x(this,pl,[]);x(this,sp,new WeakMap);x(this,np,null);var c;if(e instanceof ReadableStream)m(this,Fu,e);else if(typeof e=="object")m(this,Fu,new ReadableStream({start(u){u.enqueue(e),u.close()}}));else throw new Error('No "textContentSource" parameter specified.');m(this,_s,m(this,ep,t)),m(this,jo,s.scale*$i.pixelRatio),m(this,Iu,s.rotation),m(this,xr,{div:null,properties:null,ctx:null});const{pageWidth:i,pageHeight:r,pageX:a,pageY:l}=s.rawDims;m(this,np,[1,0,0,-1,-a,l+r]),m(this,Zf,i),m(this,Jf,r),A(c=Bt,hn,HE).call(c),t.style.setProperty("--min-font-size",o(Bt,Ou)),sc(t,s),o(this,Fo).promise.finally(()=>{o(Bt,Bu).delete(this),m(this,xr,null),m(this,Ru,null)}).catch(()=>{})}static get fontFamilyMap(){const{isWindows:e,isFirefox:t}=Nt.platform;return ie(this,"fontFamilyMap",new Map([["sans-serif",`${e&&t?"Calibri, ":""}sans-serif`],["monospace",`${e&&t?"Lucida Console, ":""}monospace`]]))}render(){const e=()=>{o(this,fl).read().then(({value:t,done:s})=>{if(s){o(this,Fo).resolve();return}o(this,hl)??m(this,hl,t.lang),Object.assign(o(this,Ru),t.styles),A(this,Jr,zE).call(this,t.items),e()},o(this,Fo).reject)};return m(this,fl,o(this,Fu).getReader()),o(Bt,Bu).add(this),e(),o(this,Fo).promise}update({viewport:e,onBefore:t=null}){var r;const s=e.scale*$i.pixelRatio,i=e.rotation;if(i!==o(this,Iu)&&(t==null||t(),m(this,Iu,i),sc(o(this,ep),{rotation:i})),s!==o(this,jo)){t==null||t(),m(this,jo,s);const a={div:null,properties:null,ctx:A(r=Bt,hn,Zm).call(r,o(this,hl))};for(const l of o(this,pl))a.properties=o(this,sp).get(l),a.div=l,A(this,Jr,mx).call(this,a)}}cancel(){var t;const e=new va("TextLayer task cancelled.");(t=o(this,fl))==null||t.cancel(e).catch(()=>{}),m(this,fl,null),o(this,Fo).reject(e)}get textDivs(){return o(this,pl)}get textContentItemsStr(){return o(this,tp)}static cleanup(){if(!(o(this,Bu).size>0)){o(this,ju).clear();for(const{canvas:e}of o(this,ml).values())e.remove();o(this,ml).clear()}}};Fo=new WeakMap,_s=new WeakMap,Kf=new WeakMap,Qf=new WeakMap,hl=new WeakMap,xr=new WeakMap,Jf=new WeakMap,Zf=new WeakMap,fl=new WeakMap,ep=new WeakMap,Iu=new WeakMap,jo=new WeakMap,Ru=new WeakMap,tp=new WeakMap,Fu=new WeakMap,pl=new WeakMap,sp=new WeakMap,np=new WeakMap,ju=new WeakMap,ml=new WeakMap,ip=new WeakMap,Ou=new WeakMap,Bu=new WeakMap,Jr=new WeakSet,zE=function(e){var i,r;if(o(this,Kf))return;(r=o(this,xr)).ctx??(r.ctx=A(i=Bt,hn,Zm).call(i,o(this,hl)));const t=o(this,pl),s=o(this,tp);for(const a of e){if(t.length>AP){ne("Ignoring additional textDivs for performance reasons."),m(this,Kf,!0);return}if(a.str===void 0){if(a.type==="beginMarkedContentProps"||a.type==="beginMarkedContent"){const l=o(this,_s);m(this,_s,document.createElement("span")),o(this,_s).classList.add("markedContent"),a.id&&o(this,_s).setAttribute("id",`${a.id}`),a.tag==="Artifact"&&(o(this,_s).ariaHidden=!0),l.append(o(this,_s))}else a.type==="endMarkedContent"&&m(this,_s,o(this,_s).parentNode);continue}s.push(a.str),A(this,Jr,UE).call(this,a)}},UE=function(e){var v;const t=document.createElement("span"),s={angle:0,canvasWidth:0,hasText:e.str!=="",hasEOL:e.hasEOL,fontSize:0};o(this,pl).push(t);const i=z.transform(o(this,np),e.transform);let r=Math.atan2(i[1],i[0]);const a=o(this,Ru)[e.fontName];a.vertical&&(r+=Math.PI/2);let l=o(this,Qf)&&a.fontSubstitution||a.fontFamily;l=Bt.fontFamilyMap.get(l)||l;const c=Math.hypot(i[2],i[3]),u=c*A(v=Bt,hn,$E).call(v,l,a,o(this,hl));let d,h;r===0?(d=i[4],h=i[5]-u):(d=i[4]+u*Math.sin(r),h=i[5]-u*Math.cos(r));const f=t.style;f.left=`${(100*d/o(this,Zf)).toFixed(2)}%`,f.top=`${(100*h/o(this,Jf)).toFixed(2)}%`,f.setProperty("--font-height",`${c.toFixed(2)}px`),f.fontFamily=l,s.fontSize=c,t.setAttribute("role","presentation"),t.textContent=e.str,t.dir=e.dir,o(this,Qf)&&(t.dataset.fontName=a.fontSubstitutionLoadedName||e.fontName),r!==0&&(s.angle=r*(180/Math.PI));let p=!1;if(e.str.length>1)p=!0;else if(e.str!==" "&&e.transform[0]!==e.transform[3]){const b=Math.abs(e.transform[0]),S=Math.abs(e.transform[3]);b!==S&&Math.max(b,S)/Math.min(b,S)>1.5&&(p=!0)}if(p&&(s.canvasWidth=a.vertical?e.height:e.width),o(this,sp).set(t,s),o(this,xr).div=t,o(this,xr).properties=s,A(this,Jr,mx).call(this,o(this,xr)),s.hasText&&o(this,_s).append(t),s.hasEOL){const b=document.createElement("br");b.setAttribute("role","presentation"),o(this,_s).append(b)}},mx=function(e){var a;const{div:t,properties:s,ctx:i}=e,{style:r}=t;if(s.canvasWidth!==0&&s.hasText){const{fontFamily:l}=r,{canvasWidth:c,fontSize:u}=s;A(a=Bt,hn,gx).call(a,i,u*o(this,jo),l);const{width:d}=i.measureText(t.textContent);d>0&&r.setProperty("--scale-x",c*o(this,jo)/d)}s.angle!==0&&r.setProperty("--rotate",`${s.angle}deg`)},hn=new WeakSet,Zm=function(e=null){let t=o(this,ml).get(e||(e=""));if(!t){const s=document.createElement("canvas");s.className="hiddenCanvasElement",s.lang=e,document.body.append(s),t=s.getContext("2d",{alpha:!1,willReadFrequently:!0}),o(this,ml).set(e,t),o(this,ip).set(t,{size:0,family:""})}return t},gx=function(e,t,s){const i=o(this,ip).get(e);t===i.size&&s===i.family||(e.font=`${t}px ${s}`,i.size=t,i.family=s)},HE=function(){if(o(this,Ou)!==null)return;const e=document.createElement("div");e.style.opacity=0,e.style.lineHeight=1,e.style.fontSize="1px",e.style.position="absolute",e.textContent="X",document.body.append(e),m(this,Ou,e.getBoundingClientRect().height),e.remove()},$E=function(e,t,s){const i=o(this,ju).get(e);if(i)return i;const r=A(this,hn,Zm).call(this,s);r.canvas.width=r.canvas.height=nA,A(this,hn,gx).call(this,r,nA,e);const a=r.measureText(""),l=a.fontBoundingBoxAscent,c=Math.abs(a.fontBoundingBoxDescent);r.canvas.width=r.canvas.height=0;let u=.8;return l?u=l/(l+c):(Nt.platform.isFirefox&&ne("Enable the `dom.textMetrics.fontBoundingBox.enabled` preference in `about:config` to improve TextLayer rendering."),t.ascent?u=t.ascent:t.descent&&(u=1+t.descent)),o(this,ju).set(e,u),u},x(Bt,hn),x(Bt,ju,new Map),x(Bt,ml,new Map),x(Bt,ip,new WeakMap),x(Bt,Ou,null),x(Bt,Bu,new Set);let Yh=Bt;const kP=100;function VE(n={}){typeof n=="string"||n instanceof URL?n={url:n}:(n instanceof ArrayBuffer||ArrayBuffer.isView(n))&&(n={data:n});const e=new vx,{docId:t}=e,s=n.url?MN(n.url):null,i=n.data?LN(n.data):null,r=n.httpHeaders||null,a=n.withCredentials===!0,l=n.password??null,c=n.range instanceof WE?n.range:null,u=Number.isInteger(n.rangeChunkSize)&&n.rangeChunkSize>0?n.rangeChunkSize:2**16;let d=n.worker instanceof qh?n.worker:null;const h=n.verbosity,f=typeof n.docBaseUrl=="string"&&!W0(n.docBaseUrl)?n.docBaseUrl:null,p=Am(n.cMapUrl),v=n.cMapPacked!==!1,b=n.CMapReaderFactory||(ps?zN:U1),S=Am(n.iccUrl),y=Am(n.standardFontDataUrl),k=n.StandardFontDataFactory||(ps?UN:H1),w=Am(n.wasmUrl),E=n.WasmFactory||(ps?HN:$1),C=n.stopAtErrors!==!0,T=Number.isInteger(n.maxImageSize)&&n.maxImageSize>-1?n.maxImageSize:-1,_=n.isEvalSupported!==!1,P=typeof n.isOffscreenCanvasSupported=="boolean"?n.isOffscreenCanvasSupported:!ps,D=typeof n.isImageDecoderSupported=="boolean"?n.isImageDecoderSupported:!ps&&(Nt.platform.isFirefox||!globalThis.chrome),I=Number.isInteger(n.canvasMaxAreaInBytes)?n.canvasMaxAreaInBytes:-1,F=typeof n.disableFontFace=="boolean"?n.disableFontFace:ps,K=n.fontExtraProperties===!0,Z=n.enableXfa===!0,Q=n.ownerDocument||globalThis.document,se=n.disableRange===!0,G=n.disableStream===!0,$=n.disableAutoFetch===!0,R=n.pdfBug===!0,X=n.CanvasFactory||(ps?BN:FN),Y=n.FilterFactory||(ps?ON:jN),ae=n.enableHWA===!0,te=n.useWasm!==!1,he=c?c.length:n.length??NaN,ht=typeof n.useSystemFonts=="boolean"?n.useSystemFonts:!ps&&!F,Ae=typeof n.useWorkerFetch=="boolean"?n.useWorkerFetch:!!(b===U1&&k===H1&&E===$1&&p&&y&&w&&Kd(p,document.baseURI)&&Kd(y,document.baseURI)&&Kd(w,document.baseURI)),_e=null;iN(h);const ke={canvasFactory:new X({ownerDocument:Q,enableHWA:ae}),filterFactory:new Y({docId:t,ownerDocument:Q}),cMapReaderFactory:Ae?null:new b({baseUrl:p,isCompressed:v}),standardFontDataFactory:Ae?null:new k({baseUrl:y}),wasmFactory:Ae?null:new E({baseUrl:w})};d||(d=qh.create({verbosity:h,port:zi.workerPort}),e._worker=d);const sm={docId:t,apiVersion:"5.4.624",data:i,password:l,disableAutoFetch:$,rangeChunkSize:u,length:he,docBaseUrl:f,enableXfa:Z,evaluatorOptions:{maxImageSize:T,disableFontFace:F,ignoreErrors:C,isEvalSupported:_,isOffscreenCanvasSupported:P,isImageDecoderSupported:D,canvasMaxAreaInBytes:I,fontExtraProperties:K,useSystemFonts:ht,useWasm:te,useWorkerFetch:Ae,cMapUrl:p,iccUrl:S,standardFontDataUrl:y,wasmUrl:w}},nm={ownerDocument:Q,pdfBug:R,styleElement:_e,enableHWA:ae,loadingParams:{disableAutoFetch:$,enableXfa:Z}};return d.promise.then(function(){if(e.destroyed)throw new Error("Loading aborted");if(d.destroyed)throw new Error("Worker was destroyed");const eo=d.messageHandler.sendWithPromise("GetDocRequest",sm,i?[i.buffer]:null);let Un;if(c)Un=new oP({pdfDataRangeTransport:c,disableRange:se,disableStream:G});else if(!i){if(!s)throw new Error("getDocument - no `url` parameter provided.");const ka=Kd(s)?uP:ps?xP:pP;Un=new ka({url:s,length:he,httpHeaders:r,withCredentials:a,rangeChunkSize:u,disableRange:se,disableStream:G})}return eo.then(ka=>{if(e.destroyed)throw new Error("Loading aborted");if(d.destroyed)throw new Error("Worker was destroyed");const cc=new ih(t,ka,d.port),Md=new CP(cc,e,Un,nm,ke);e._transport=Md,cc.send("Ready",null)})}).catch(e._capability.reject),e}var m0;const g0=class g0{constructor(){M(this,"_capability",Promise.withResolvers());M(this,"_transport",null);M(this,"_worker",null);M(this,"docId",`d${At(g0,m0)._++}`);M(this,"destroyed",!1);M(this,"onPassword",null);M(this,"onProgress",null)}get promise(){return this._capability.promise}async destroy(){var e,t,s,i;this.destroyed=!0;try{(e=this._worker)!=null&&e.port&&(this._worker._pendingDestroy=!0),await((t=this._transport)==null?void 0:t.destroy())}catch(r){throw(s=this._worker)!=null&&s.port&&delete this._worker._pendingDestroy,r}this._transport=null,(i=this._worker)==null||i.destroy(),this._worker=null}async getData(){return this._transport.getData()}};m0=new WeakMap,x(g0,m0,0);let vx=g0;var gl,rp,op,ap,lp;class WE{constructor(e,t,s=!1,i=null){x(this,gl,Promise.withResolvers());x(this,rp,[]);x(this,op,[]);x(this,ap,[]);x(this,lp,[]);this.length=e,this.initialData=t,this.progressiveDone=s,this.contentDispositionFilename=i}addRangeListener(e){o(this,lp).push(e)}addProgressListener(e){o(this,ap).push(e)}addProgressiveReadListener(e){o(this,op).push(e)}addProgressiveDoneListener(e){o(this,rp).push(e)}onDataRange(e,t){for(const s of o(this,lp))s(e,t)}onDataProgress(e,t){o(this,gl).promise.then(()=>{for(const s of o(this,ap))s(e,t)})}onDataProgressiveRead(e){o(this,gl).promise.then(()=>{for(const t of o(this,op))t(e)})}onDataProgressiveDone(){o(this,gl).promise.then(()=>{for(const e of o(this,rp))e()})}transportReady(){o(this,gl).resolve()}requestDataRange(e,t){Ce("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}gl=new WeakMap,rp=new WeakMap,op=new WeakMap,ap=new WeakMap,lp=new WeakMap;class SP{constructor(e,t){this._pdfInfo=e,this._transport=t}get annotationStorage(){return this._transport.annotationStorage}get canvasFactory(){return this._transport.canvasFactory}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return ie(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(e){return this._transport.getPage(e)}getPageIndex(e){return this._transport.getPageIndex(e)}getDestinations(){return this._transport.getDestinations()}getDestination(e){return this._transport.getDestination(e)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getAnnotationsByType(e,t){return this._transport.getAnnotationsByType(e,t)}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getOptionalContentConfig(t)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}extractPages(e){return this._transport.extractPages(e)}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(e=!1){return this._transport.startCleanup(e||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(e){return this._transport.cachedPageNumber(e)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}var br,cp,vl,ch;class EP{constructor(e,t,s,i=!1){x(this,vl);x(this,br,!1);x(this,cp,Xh.instance);this._pageIndex=e,this._pageInfo=t,this._transport=s,this._stats=i?new I1:null,this._pdfBug=i,this.commonObjs=s.commonObjs,this.objs=new BE,this._intentStates=new Map,this.destroyed=!1,this.recordedBBoxes=null}get pageNumber(){return this._pageIndex+1}set pageNumber(e){this._pageIndex=e-1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:e,rotation:t=this.rotate,offsetX:s=0,offsetY:i=0,dontFlip:r=!1}={}){return new Jp({viewBox:this.view,userUnit:this.userUnit,scale:e,rotation:t,offsetX:s,offsetY:i,dontFlip:r})}getAnnotations({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getAnnotations(this._pageIndex,t)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return ie(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){var e;return((e=this._transport._htmlForXfa)==null?void 0:e.children[this._pageIndex])||null}render({canvasContext:e,canvas:t=e.canvas,viewport:s,intent:i="display",annotationMode:r=ao.ENABLE,transform:a=null,background:l=null,optionalContentConfigPromise:c=null,annotationCanvasMap:u=null,pageColors:d=null,printAnnotationStorage:h=null,isEditing:f=!1,recordOperations:p=!1,operationsFilter:v=null}){var D,I,F;(D=this._stats)==null||D.time("Overall");const b=this._transport.getRenderingIntent(i,r,h,f),{renderingIntent:S,cacheKey:y}=b;m(this,br,!1),c||(c=this._transport.getOptionalContentConfig(S));let k=this._intentStates.get(y);k||(k=Object.create(null),this._intentStates.set(y,k)),k.streamReaderCancelTimeout&&(clearTimeout(k.streamReaderCancelTimeout),k.streamReaderCancelTimeout=null);const w=!!(S&rn.PRINT);k.displayReadyCapability||(k.displayReadyCapability=Promise.withResolvers(),k.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(I=this._stats)==null||I.time("Page Request"),this._pumpOperatorList(b));const E=!!(this._pdfBug&&((F=globalThis.StepperManager)!=null&&F.enabled)),C=!this.recordedBBoxes&&(p||E),T=K=>{var Z,Q;if(k.renderTasks.delete(_),C){const se=(Z=_.gfx)==null?void 0:Z.dependencyTracker.take();se&&(_.stepper&&_.stepper.setOperatorBBoxes(se,_.gfx.dependencyTracker.takeDebugMetadata()),p&&(this.recordedBBoxes=se))}w&&m(this,br,!0),A(this,vl,ch).call(this),K?(_.capability.reject(K),this._abortOperatorList({intentState:k,reason:K instanceof Error?K:new Error(K)})):_.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),(Q=globalThis.Stats)!=null&&Q.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},_=new yx({callback:T,params:{canvas:t,canvasContext:e,dependencyTracker:C?new VN(t,k.operatorList.length,E):null,viewport:s,transform:a,background:l},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:u,operatorList:k.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!w,pdfBug:this._pdfBug,pageColors:d,enableHWA:this._transport.enableHWA,operationsFilter:v});(k.renderTasks||(k.renderTasks=new Set)).add(_);const P=_.task;return Promise.all([k.displayReadyCapability.promise,c]).then(([K,Z])=>{var Q;if(this.destroyed){T();return}if((Q=this._stats)==null||Q.time("Rendering"),!(Z.renderingIntent&S))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");_.initializeGraphics({transparency:K,optionalContentConfig:Z}),_.operatorListChanged()}).catch(T),P}getOperatorList({intent:e="display",annotationMode:t=ao.ENABLE,printAnnotationStorage:s=null,isEditing:i=!1}={}){var u;function r(){l.operatorList.lastChunk&&(l.opListReadCapability.resolve(l.operatorList),l.renderTasks.delete(c))}const a=this._transport.getRenderingIntent(e,t,s,i,!0);let l=this._intentStates.get(a.cacheKey);l||(l=Object.create(null),this._intentStates.set(a.cacheKey,l));let c;return l.opListReadCapability||(c=Object.create(null),c.operatorListChanged=r,l.opListReadCapability=Promise.withResolvers(),(l.renderTasks||(l.renderTasks=new Set)).add(c),l.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(u=this._stats)==null||u.time("Page Request"),this._pumpOperatorList(a)),l.opListReadCapability.promise}streamTextContent({includeMarkedContent:e=!1,disableNormalization:t=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageId:o(this,cp).getPageId(this._pageIndex+1)-1,pageIndex:this._pageIndex,includeMarkedContent:e===!0,disableNormalization:t===!0},{highWaterMark:100,size(i){return i.items.length}})}getTextContent(e={}){if(this._transport._htmlForXfa)return this.getXfa().then(s=>Gh.textContent(s));const t=this.streamTextContent(e);return new Promise(function(s,i){function r(){a.read().then(function({value:c,done:u}){if(u){s(l);return}l.lang??(l.lang=c.lang),Object.assign(l.styles,c.styles),l.items.push(...c.items),r()},i)}const a=t.getReader(),l={items:[],styles:Object.create(null),lang:null};r()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const e=[];for(const t of this._intentStates.values())if(this._abortOperatorList({intentState:t,reason:new Error("Page was destroyed."),force:!0}),!t.opListReadCapability)for(const s of t.renderTasks)e.push(s.completed),s.cancel();return this.objs.clear(),m(this,br,!1),Promise.all(e)}cleanup(e=!1){m(this,br,!0);const t=A(this,vl,ch).call(this);return e&&t&&this._stats&&(this._stats=new I1),t}_startRenderPage(e,t){var i,r;const s=this._intentStates.get(t);s&&((i=this._stats)==null||i.timeEnd("Page Request"),(r=s.displayReadyCapability)==null||r.resolve(e))}_renderPageChunk(e,t){for(let s=0,i=e.length;s<i;s++)t.operatorList.fnArray.push(e.fnArray[s]),t.operatorList.argsArray.push(e.argsArray[s]);t.operatorList.lastChunk=e.lastChunk,t.operatorList.separateAnnots=e.separateAnnots;for(const s of t.renderTasks)s.operatorListChanged();e.lastChunk&&A(this,vl,ch).call(this)}_pumpOperatorList({renderingIntent:e,cacheKey:t,annotationStorageSerializable:s,modifiedIds:i}){const{map:r,transfer:a}=s,c=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageId:o(this,cp).getPageId(this._pageIndex+1)-1,pageIndex:this._pageIndex,intent:e,cacheKey:t,annotationStorage:r,modifiedIds:i},a).getReader(),u=this._intentStates.get(t);u.streamReader=c;const d=()=>{c.read().then(({value:h,done:f})=>{if(f){u.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(h,u),d())},h=>{if(u.streamReader=null,!this._transport.destroyed){if(u.operatorList){u.operatorList.lastChunk=!0;for(const f of u.renderTasks)f.operatorListChanged();A(this,vl,ch).call(this)}if(u.displayReadyCapability)u.displayReadyCapability.reject(h);else if(u.opListReadCapability)u.opListReadCapability.reject(h);else throw h}})};d()}_abortOperatorList({intentState:e,reason:t,force:s=!1}){if(e.streamReader){if(e.streamReaderCancelTimeout&&(clearTimeout(e.streamReaderCancelTimeout),e.streamReaderCancelTimeout=null),!s){if(e.renderTasks.size>0)return;if(t instanceof tw){let i=kP;t.extraDelay>0&&t.extraDelay<1e3&&(i+=t.extraDelay),e.streamReaderCancelTimeout=setTimeout(()=>{e.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:e,reason:t,force:!0})},i);return}}if(e.streamReader.cancel(new va(t.message)).catch(()=>{}),e.streamReader=null,!this._transport.destroyed){for(const[i,r]of this._intentStates)if(r===e){this._intentStates.delete(i);break}this.cleanup()}}}get stats(){return this._stats}}br=new WeakMap,cp=new WeakMap,vl=new WeakSet,ch=function(){if(!o(this,br)||this.destroyed)return!1;for(const{renderTasks:e,operatorList:t}of this._intentStates.values())if(e.size>0||!t.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),m(this,br,!1),!0};var Oo,Jn,wr,yl,v0,xl,bl,gs,eg,GE,XE,uh,zu,tg;const Ye=class Ye{constructor({name:e=null,port:t=null,verbosity:s=rN()}={}){x(this,gs);x(this,Oo,Promise.withResolvers());x(this,Jn,null);x(this,wr,null);x(this,yl,null);if(this.name=e,this.destroyed=!1,this.verbosity=s,t){if(o(Ye,bl).has(t))throw new Error("Cannot use more than one PDFWorker per port.");o(Ye,bl).set(t,this),A(this,gs,GE).call(this,t)}else A(this,gs,XE).call(this)}get promise(){return o(this,Oo).promise}get port(){return o(this,wr)}get messageHandler(){return o(this,Jn)}destroy(){var e,t;this.destroyed=!0,(e=o(this,yl))==null||e.terminate(),m(this,yl,null),o(Ye,bl).delete(o(this,wr)),m(this,wr,null),(t=o(this,Jn))==null||t.destroy(),m(this,Jn,null)}static create(e){const t=o(this,bl).get(e==null?void 0:e.port);if(t){if(t._pendingDestroy)throw new Error("PDFWorker.create - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return t}return new Ye(e)}static get workerSrc(){if(zi.workerSrc)return zi.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _setupFakeWorkerGlobal(){return ie(this,"_setupFakeWorkerGlobal",(async()=>o(this,zu,tg)?o(this,zu,tg):(await import(this.workerSrc)).WorkerMessageHandler)())}};Oo=new WeakMap,Jn=new WeakMap,wr=new WeakMap,yl=new WeakMap,v0=new WeakMap,xl=new WeakMap,bl=new WeakMap,gs=new WeakSet,eg=function(){o(this,Oo).resolve(),o(this,Jn).send("configure",{verbosity:this.verbosity})},GE=function(e){m(this,wr,e),m(this,Jn,new ih("main","worker",e)),o(this,Jn).on("ready",()=>{}),A(this,gs,eg).call(this)},XE=function(){if(o(Ye,xl)||o(Ye,zu,tg)){A(this,gs,uh).call(this);return}let{workerSrc:e}=Ye;try{Ye._isSameOrigin(window.location,e)||(e=Ye._createCDNWrapper(new URL(e,window.location).href));const t=new Worker(e,{type:"module"}),s=new ih("main","worker",t),i=()=>{r.abort(),s.destroy(),t.terminate(),this.destroyed?o(this,Oo).reject(new Error("Worker was destroyed")):A(this,gs,uh).call(this)},r=new AbortController;t.addEventListener("error",()=>{o(this,yl)||i()},{signal:r.signal}),s.on("test",l=>{if(r.abort(),this.destroyed||!l){i();return}m(this,Jn,s),m(this,wr,t),m(this,yl,t),A(this,gs,eg).call(this)}),s.on("ready",l=>{if(r.abort(),this.destroyed){i();return}try{a()}catch{A(this,gs,uh).call(this)}});const a=()=>{const l=new Uint8Array;s.send("test",l,[l.buffer])};a();return}catch{$0("The worker has been disabled.")}A(this,gs,uh).call(this)},uh=function(){o(Ye,xl)||(ne("Setting up fake worker."),m(Ye,xl,!0)),Ye._setupFakeWorkerGlobal.then(e=>{if(this.destroyed){o(this,Oo).reject(new Error("Worker was destroyed"));return}const t=new RN;m(this,wr,t);const s=`fake${At(Ye,v0)._++}`,i=new ih(s+"_worker",s,t);e.setup(i,t),m(this,Jn,new ih(s,s+"_worker",t)),A(this,gs,eg).call(this)}).catch(e=>{o(this,Oo).reject(new Error(`Setting up fake worker failed: "${e.message}".`))})},zu=new WeakSet,tg=function(){var e;try{return((e=globalThis.pdfjsWorker)==null?void 0:e.WorkerMessageHandler)||null}catch{return null}},x(Ye,zu),x(Ye,v0,0),x(Ye,xl,!1),x(Ye,bl,new WeakMap),ps&&(m(Ye,xl,!0),zi.workerSrc||(zi.workerSrc="./pdf.worker.mjs")),Ye._isSameOrigin=(e,t)=>{const s=URL.parse(e);if(!(s!=null&&s.origin)||s.origin==="null")return!1;const i=new URL(t,s);return s.origin===i.origin},Ye._createCDNWrapper=e=>{const t=`await import("${e}");`;return URL.createObjectURL(new Blob([t],{type:"text/javascript"}))},Ye.fromPort=e=>{if(vN("`PDFWorker.fromPort` - please use `PDFWorker.create` instead."),!(e!=null&&e.port))throw new Error("PDFWorker.fromPort - invalid method signature.");return Ye.create(e)};let qh=Ye;var Vs,Ar,kr,_n,Bo,Uu,Sr,Ns,un,YE,dh,sg;class CP{constructor(e,t,s,i,r){x(this,un);M(this,"downloadInfoCapability",Promise.withResolvers());x(this,Vs,null);x(this,Ar,new Map);x(this,kr,null);x(this,_n,new Map);x(this,Bo,new Map);x(this,Uu,new Map);x(this,Sr,null);x(this,Ns,Xh.instance);this.messageHandler=e,this.loadingTask=t,m(this,kr,s),this.commonObjs=new BE,this.fontLoader=new _N({ownerDocument:i.ownerDocument,styleElement:i.styleElement}),this.enableHWA=i.enableHWA,this.loadingParams=i.loadingParams,this._params=i,this.canvasFactory=r.canvasFactory,this.filterFactory=r.filterFactory,this.cMapReaderFactory=r.cMapReaderFactory,this.standardFontDataFactory=r.standardFontDataFactory,this.wasmFactory=r.wasmFactory,this.destroyed=!1,this.destroyCapability=null,this.setupMessageHandler(),o(this,Ns).addListener(A(this,un,YE).bind(this))}get annotationStorage(){return ie(this,"annotationStorage",new nw)}getRenderingIntent(e,t=ao.ENABLE,s=null,i=!1,r=!1){let a=rn.DISPLAY,l=Jy;switch(e){case"any":a=rn.ANY;break;case"display":break;case"print":a=rn.PRINT;break;default:ne(`getRenderingIntent - invalid intent: ${e}`)}const c=a&rn.PRINT&&s instanceof hE?s:this.annotationStorage;switch(t){case ao.DISABLE:a+=rn.ANNOTATIONS_DISABLE;break;case ao.ENABLE:break;case ao.ENABLE_FORMS:a+=rn.ANNOTATIONS_FORMS;break;case ao.ENABLE_STORAGE:a+=rn.ANNOTATIONS_STORAGE,l=c.serializable;break;default:ne(`getRenderingIntent - invalid annotationMode: ${t}`)}i&&(a+=rn.IS_EDITING),r&&(a+=rn.OPLIST);const{ids:u,hash:d}=c.modifiedIds,h=[a,l.hash,d];return{renderingIntent:a,cacheKey:h.join("_"),annotationStorageSerializable:l,modifiedIds:u}}destroy(){var s;if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),(s=o(this,Sr))==null||s.reject(new Error("Worker was destroyed during onPassword callback"));const e=[];for(const i of o(this,_n).values())e.push(i._destroy());o(this,_n).clear(),o(this,Bo).clear(),o(this,Uu).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const t=this.messageHandler.sendWithPromise("Terminate",null);return e.push(t),Promise.all(e).then(()=>{var i,r;this.commonObjs.clear(),this.fontLoader.clear(),o(this,Ar).clear(),this.filterFactory.destroy(),Yh.cleanup(),(i=o(this,kr))==null||i.cancelAllRequests(new va("Worker was terminated.")),(r=this.messageHandler)==null||r.destroy(),this.messageHandler=null,this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:e,loadingTask:t}=this;e.on("GetReader",(s,i)=>{Ee(o(this,kr),"GetReader - no `BasePDFStream` instance available."),m(this,Vs,o(this,kr).getFullReader()),o(this,Vs).onProgress=r=>A(this,un,sg).call(this,r),i.onPull=()=>{o(this,Vs).read().then(function({value:r,done:a}){if(a){i.close();return}Ee(r instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),i.enqueue(new Uint8Array(r),1,[r])}).catch(r=>{i.error(r)})},i.onCancel=r=>{o(this,Vs).cancel(r),i.ready.catch(a=>{if(!this.destroyed)throw a})}}),e.on("ReaderHeadersReady",async s=>{await o(this,Vs).headersReady;const{isStreamingSupported:i,isRangeSupported:r,contentLength:a}=o(this,Vs);return i&&r&&(o(this,Vs).onProgress=null),{isStreamingSupported:i,isRangeSupported:r,contentLength:a}}),e.on("GetRangeReader",(s,i)=>{Ee(o(this,kr),"GetRangeReader - no `BasePDFStream` instance available.");const r=o(this,kr).getRangeReader(s.begin,s.end);if(!r){i.close();return}i.onPull=()=>{r.read().then(function({value:a,done:l}){if(l){i.close();return}Ee(a instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),i.enqueue(new Uint8Array(a),1,[a])}).catch(a=>{i.error(a)})},i.onCancel=a=>{r.cancel(a),i.ready.catch(l=>{if(!this.destroyed)throw l})}}),e.on("GetDoc",({pdfInfo:s})=>{o(this,Ns).pagesNumber=s.numPages,this._numPages=s.numPages,this._htmlForXfa=s.htmlForXfa,delete s.htmlForXfa,t._capability.resolve(new SP(s,this))}),e.on("DocException",s=>{t._capability.reject(As(s))}),e.on("PasswordRequest",s=>{m(this,Sr,Promise.withResolvers());try{if(!t.onPassword)throw As(s);const i=r=>{r instanceof Error?o(this,Sr).reject(r):o(this,Sr).resolve({password:r})};t.onPassword(i,s.code)}catch(i){o(this,Sr).reject(i)}return o(this,Sr).promise}),e.on("DataLoaded",s=>{A(this,un,sg).call(this,{loaded:s.length,total:s.length}),this.downloadInfoCapability.resolve(s)}),e.on("StartRenderPage",s=>{if(this.destroyed)return;o(this,_n).get(s.pageIndex)._startRenderPage(s.transparency,s.cacheKey)}),e.on("commonobj",([s,i,r])=>{var a;if(this.destroyed||this.commonObjs.has(s))return null;switch(i){case"Font":if("error"in r){const f=r.error;ne(`Error during font loading: ${f}`),this.commonObjs.resolve(s,f);break}const l=new Zy(r),c=this._params.pdfBug&&((a=globalThis.FontInspector)!=null&&a.enabled)?(f,p)=>globalThis.FontInspector.fontAdded(f,p):null,u=new NN(l,c,r.extra,r.charProcOperatorList);this.fontLoader.bind(u).catch(()=>e.sendWithPromise("FontFallback",{id:s})).finally(()=>{!u.fontExtraProperties&&u.data&&u.clearData(),this.commonObjs.resolve(s,u)});break;case"CopyLocalImage":const{imageRef:d}=r;Ee(d,"The imageRef must be defined.");for(const f of o(this,_n).values())for(const[,p]of f.objs)if((p==null?void 0:p.ref)===d)return p.dataLen?(this.commonObjs.resolve(s,structuredClone(p)),p.dataLen):null;break;case"FontPath":this.commonObjs.resolve(s,new PN(r));break;case"Image":this.commonObjs.resolve(s,r);break;case"Pattern":const h=new ex(r);this.commonObjs.resolve(s,h.getIR());break;default:throw new Error(`Got unknown common object type ${i}`)}return null}),e.on("obj",([s,i,r,a])=>{var c;if(this.destroyed)return;const l=o(this,_n).get(i);if(!l.objs.has(s)){if(l._intentStates.size===0){(c=a==null?void 0:a.bitmap)==null||c.close();return}switch(r){case"Image":case"Pattern":l.objs.resolve(s,a);break;default:throw new Error(`Got unknown object type ${r}`)}}}),e.on("DocProgress",s=>{this.destroyed||A(this,un,sg).call(this,s)}),e.on("FetchBinaryData",async s=>{if(this.destroyed)throw new Error("Worker was destroyed.");const i=this[s.type];if(!i)throw new Error(`${s.type} not initialized, see the \`useWorkerFetch\` parameter.`);return i.fetch(s)})}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){var s;this.annotationStorage.size<=0&&ne("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:e,transfer:t}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:e,filename:((s=o(this,Vs))==null?void 0:s.filename)??null},t).finally(()=>{this.annotationStorage.resetModified()})}extractPages(e){return this.messageHandler.sendWithPromise("ExtractPages",{pageInfos:e})}getPage(e){if(!Number.isInteger(e)||e<=0||e>o(this,Ns).pagesNumber)return Promise.reject(new Error("Invalid page request."));const t=e-1,s=o(this,Ns).getPageId(e)-1,i=o(this,Bo).get(t);if(i)return i;const r=this.messageHandler.sendWithPromise("GetPage",{pageIndex:s}).then(a=>{if(this.destroyed)throw new Error("Transport destroyed");a.refStr&&o(this,Uu).set(a.refStr,s);const l=new EP(t,a,this,this._params.pdfBug);return o(this,_n).set(t,l),l});return o(this,Bo).set(t,r),r}async getPageIndex(e){if(!tx(e))throw new Error("Invalid pageIndex request.");const t=await this.messageHandler.sendWithPromise("GetPageIndex",{num:e.num,gen:e.gen});return o(this,Ns).getPageNumber(t+1)-1}getAnnotations(e,t){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:o(this,Ns).getPageId(e+1)-1,intent:t})}getFieldObjects(){return A(this,un,dh).call(this,"GetFieldObjects")}hasJSActions(){return A(this,un,dh).call(this,"HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(e){return typeof e!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:e})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getAnnotationsByType(e,t){return this.messageHandler.sendWithPromise("GetAnnotationsByType",{types:e,pageIndexesToSkip:t})}getDocJSActions(){return A(this,un,dh).call(this,"GetDocJSActions")}getPageJSActions(e){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:o(this,Ns).getPageId(e+1)-1})}getStructTree(e){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:o(this,Ns).getPageId(e+1)-1})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(e){return A(this,un,dh).call(this,"GetOptionalContentConfig").then(t=>new rP(t,e))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const e="GetMetadata",t=o(this,Ar).get(e);if(t)return t;const s=this.messageHandler.sendWithPromise(e,null).then(i=>{var r,a;return{info:i[0],metadata:i[1]?new nP(i[1]):null,contentDispositionFilename:((r=o(this,Vs))==null?void 0:r.filename)??null,contentLength:((a=o(this,Vs))==null?void 0:a.contentLength)??null,hasStructTree:i[2]}});return o(this,Ar).set(e,s),s}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(e=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const t of o(this,_n).values())if(!t.cleanup())throw new Error(`startCleanup: Page ${t.pageNumber} is currently rendering.`);this.commonObjs.clear(),e||this.fontLoader.clear(),o(this,Ar).clear(),this.filterFactory.destroy(!0),Yh.cleanup()}}cachedPageNumber(e){if(!tx(e))return null;const t=e.gen===0?`${e.num}R`:`${e.num}R${e.gen}`,s=o(this,Uu).get(t);return s>=0?o(this,Ns).getPageNumber(s+1):null}}Vs=new WeakMap,Ar=new WeakMap,kr=new WeakMap,_n=new WeakMap,Bo=new WeakMap,Uu=new WeakMap,Sr=new WeakMap,Ns=new WeakMap,un=new WeakSet,YE=function(){const e=new Map,t=new Map;for(let s=0,i=o(this,Ns).pagesNumber;s<i;s++){const r=o(this,Ns).getPrevPageNumber(s+1)-1,a=o(this,_n).get(r);a&&e.set(s,a);const l=o(this,Bo).get(r);l&&t.set(s,l)}m(this,_n,e),m(this,Bo,t)},dh=function(e,t=null){const s=o(this,Ar).get(e);if(s)return s;const i=this.messageHandler.sendWithPromise(e,t);return o(this,Ar).set(e,i),i},sg=function({loaded:e,total:t}){var s,i;(i=(s=this.loadingTask).onProgress)==null||i.call(s,{loaded:e,total:t,percent:Gt(Math.round(e/t*100),0,100)})};class TP{constructor(e){M(this,"_internalRenderTask",null);M(this,"onContinue",null);M(this,"onError",null);this._internalRenderTask=e}get promise(){return this._internalRenderTask.capability.promise}cancel(e=0){this._internalRenderTask.cancel(null,e)}get separateAnnots(){const{separateAnnots:e}=this._internalRenderTask.operatorList;if(!e)return!1;const{annotationCanvasMap:t}=this._internalRenderTask;return e.form||e.canvas&&(t==null?void 0:t.size)>0}}var zo,wl;const La=class La{constructor({callback:e,params:t,objs:s,commonObjs:i,annotationCanvasMap:r,operatorList:a,pageIndex:l,canvasFactory:c,filterFactory:u,useRequestAnimationFrame:d=!1,pdfBug:h=!1,pageColors:f=null,enableHWA:p=!1,operationsFilter:v=null}){x(this,zo,null);this.callback=e,this.params=t,this.objs=s,this.commonObjs=i,this.annotationCanvasMap=r,this.operatorListIdx=null,this.operatorList=a,this._pageIndex=l,this.canvasFactory=c,this.filterFactory=u,this._pdfBug=h,this.pageColors=f,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=d===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new TP(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=t.canvas,this._canvasContext=t.canvas?null:t.canvasContext,this._enableHWA=p,this._dependencyTracker=t.dependencyTracker,this._operationsFilter=v}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:e=!1,optionalContentConfig:t}){var c,u;if(this.cancelled)return;if(this._canvas){if(o(La,wl).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");o(La,wl).add(this._canvas)}this._pdfBug&&((c=globalThis.StepperManager)!=null&&c.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{viewport:s,transform:i,background:r,dependencyTracker:a}=this.params,l=this._canvasContext||this._canvas.getContext("2d",{alpha:!1,willReadFrequently:!this._enableHWA});this.gfx=new Gc(l,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:t},this.annotationCanvasMap,this.pageColors,a),this.gfx.beginDrawing({transform:i,viewport:s,transparency:e,background:r}),this.operatorListIdx=0,this.graphicsReady=!0,(u=this.graphicsReadyCallback)==null||u.call(this)}cancel(e=null,t=0){var s,i,r;this.running=!1,this.cancelled=!0,(s=this.gfx)==null||s.endDrawing(),o(this,zo)&&(window.cancelAnimationFrame(o(this,zo)),m(this,zo,null)),o(La,wl).delete(this._canvas),e||(e=new tw(`Rendering cancelled, page ${this._pageIndex+1}`,t)),this.callback(e),(r=(i=this.task).onError)==null||r.call(i,e)}operatorListChanged(){var e,t;if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}(e=this.gfx.dependencyTracker)==null||e.growOperationsCount(this.operatorList.fnArray.length),(t=this.stepper)==null||t.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?m(this,zo,window.requestAnimationFrame(()=>{m(this,zo,null),this._nextBound().catch(this._cancelBound)})):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper,this._operationsFilter),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),o(La,wl).delete(this._canvas),this.callback())))}};zo=new WeakMap,wl=new WeakMap,x(La,wl,new WeakSet);let yx=La;const qE="5.4.624",_P="384c6208b";var Ws,Al,Hu,Et,up,$u,Er,dp,Uo,Zn,hp,Oe,xx,bx,wx,_a,KE,so;const ks=class ks{constructor({editor:e=null,uiManager:t=null}){x(this,Oe);x(this,Ws,null);x(this,Al,null);x(this,Hu);x(this,Et,null);x(this,up,!1);x(this,$u,!1);x(this,Er,null);x(this,dp);x(this,Uo,null);x(this,Zn,null);var s,i;e?(m(this,$u,!1),m(this,Er,e)):m(this,$u,!0),m(this,Zn,(e==null?void 0:e._uiManager)||t),m(this,dp,o(this,Zn)._eventBus),m(this,Hu,((s=e==null?void 0:e.color)==null?void 0:s.toUpperCase())||((i=o(this,Zn))==null?void 0:i.highlightColors.values().next().value)||"#FFFF98"),o(ks,hp)||m(ks,hp,Object.freeze({blue:"pdfjs-editor-colorpicker-blue",green:"pdfjs-editor-colorpicker-green",pink:"pdfjs-editor-colorpicker-pink",red:"pdfjs-editor-colorpicker-red",yellow:"pdfjs-editor-colorpicker-yellow"}))}static get _keyboardManager(){return ie(this,"_keyboardManager",new em([[["Escape","mac+Escape"],ks.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],ks.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],ks.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],ks.prototype._moveToPrevious],[["Home","mac+Home"],ks.prototype._moveToBeginning],[["End","mac+End"],ks.prototype._moveToEnd]]))}renderButton(){const e=m(this,Ws,document.createElement("button"));e.className="colorPicker",e.tabIndex="0",e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),e.ariaHasPopup="true",o(this,Er)&&(e.ariaControls=`${o(this,Er).id}_colorpicker_dropdown`);const t=o(this,Zn)._signal;e.addEventListener("click",A(this,Oe,_a).bind(this),{signal:t}),e.addEventListener("keydown",A(this,Oe,wx).bind(this),{signal:t});const s=m(this,Al,document.createElement("span"));return s.className="swatch",s.ariaHidden="true",s.style.backgroundColor=o(this,Hu),e.append(s),e}renderMainDropdown(){const e=m(this,Et,A(this,Oe,xx).call(this));return e.ariaOrientation="horizontal",e.ariaLabelledBy="highlightColorPickerLabel",e}_colorSelectFromKeyboard(e){if(e.target===o(this,Ws)){A(this,Oe,_a).call(this,e);return}const t=e.target.getAttribute("data-color");t&&A(this,Oe,bx).call(this,t,e)}_moveToNext(e){var t,s;if(!o(this,Oe,so)){A(this,Oe,_a).call(this,e);return}if(e.target===o(this,Ws)){(t=o(this,Et).firstElementChild)==null||t.focus();return}(s=e.target.nextSibling)==null||s.focus()}_moveToPrevious(e){var t,s;if(e.target===((t=o(this,Et))==null?void 0:t.firstElementChild)||e.target===o(this,Ws)){o(this,Oe,so)&&this._hideDropdownFromKeyboard();return}o(this,Oe,so)||A(this,Oe,_a).call(this,e),(s=e.target.previousSibling)==null||s.focus()}_moveToBeginning(e){var t;if(!o(this,Oe,so)){A(this,Oe,_a).call(this,e);return}(t=o(this,Et).firstElementChild)==null||t.focus()}_moveToEnd(e){var t;if(!o(this,Oe,so)){A(this,Oe,_a).call(this,e);return}(t=o(this,Et).lastElementChild)==null||t.focus()}hideDropdown(){var e,t;(e=o(this,Et))==null||e.classList.add("hidden"),o(this,Ws).ariaExpanded="false",(t=o(this,Uo))==null||t.abort(),m(this,Uo,null)}_hideDropdownFromKeyboard(){var e;if(!o(this,$u)){if(!o(this,Oe,so)){(e=o(this,Er))==null||e.unselect();return}this.hideDropdown(),o(this,Ws).focus({preventScroll:!0,focusVisible:o(this,up)})}}updateColor(e){if(o(this,Al)&&(o(this,Al).style.backgroundColor=e),!o(this,Et))return;const t=o(this,Zn).highlightColors.values();for(const s of o(this,Et).children)s.ariaSelected=t.next().value===e.toUpperCase()}destroy(){var e,t;(e=o(this,Ws))==null||e.remove(),m(this,Ws,null),m(this,Al,null),(t=o(this,Et))==null||t.remove(),m(this,Et,null)}};Ws=new WeakMap,Al=new WeakMap,Hu=new WeakMap,Et=new WeakMap,up=new WeakMap,$u=new WeakMap,Er=new WeakMap,dp=new WeakMap,Uo=new WeakMap,Zn=new WeakMap,hp=new WeakMap,Oe=new WeakSet,xx=function(){const e=document.createElement("div"),t=o(this,Zn)._signal;e.addEventListener("contextmenu",zn,{signal:t}),e.className="dropdown",e.role="listbox",e.ariaMultiSelectable="false",e.ariaOrientation="vertical",e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown"),o(this,Er)&&(e.id=`${o(this,Er).id}_colorpicker_dropdown`);for(const[s,i]of o(this,Zn).highlightColors){const r=document.createElement("button");r.tabIndex="0",r.role="option",r.setAttribute("data-color",i),r.title=s,r.setAttribute("data-l10n-id",o(ks,hp)[s]);const a=document.createElement("span");r.append(a),a.className="swatch",a.style.backgroundColor=i,r.ariaSelected=i===o(this,Hu),r.addEventListener("click",A(this,Oe,bx).bind(this,i),{signal:t}),e.append(r)}return e.addEventListener("keydown",A(this,Oe,wx).bind(this),{signal:t}),e},bx=function(e,t){t.stopPropagation(),o(this,dp).dispatch("switchannotationeditorparams",{source:this,type:ve.HIGHLIGHT_COLOR,value:e}),this.updateColor(e)},wx=function(e){ks._keyboardManager.exec(this,e)},_a=function(e){if(o(this,Oe,so)){this.hideDropdown();return}if(m(this,up,e.detail===0),o(this,Uo)||(m(this,Uo,new AbortController),window.addEventListener("pointerdown",A(this,Oe,KE).bind(this),{signal:o(this,Zn).combinedSignal(o(this,Uo))})),o(this,Ws).ariaExpanded="true",o(this,Et)){o(this,Et).classList.remove("hidden");return}const t=m(this,Et,A(this,Oe,xx).call(this));o(this,Ws).append(t)},KE=function(e){var t;(t=o(this,Et))!=null&&t.contains(e.target)||this.hideDropdown()},so=function(){return o(this,Et)&&!o(this,Et).classList.contains("hidden")},x(ks,hp,null);let e0=ks;var Pi,fp,Vu,pp;const Da=class Da{constructor(e){x(this,Pi,null);x(this,fp,null);x(this,Vu,null);m(this,fp,e),m(this,Vu,e._uiManager),o(Da,pp)||m(Da,pp,Object.freeze({freetext:"pdfjs-editor-color-picker-free-text-input",ink:"pdfjs-editor-color-picker-ink-input"}))}renderButton(){if(o(this,Pi))return o(this,Pi);const{editorType:e,colorType:t,color:s}=o(this,fp),i=m(this,Pi,document.createElement("input"));return i.type="color",i.value=s||"#000000",i.className="basicColorPicker",i.tabIndex=0,i.setAttribute("data-l10n-id",o(Da,pp)[e]),i.addEventListener("input",()=>{o(this,Vu).updateParams(t,i.value)},{signal:o(this,Vu)._signal}),i}update(e){o(this,Pi)&&(o(this,Pi).value=e)}destroy(){var e;(e=o(this,Pi))==null||e.remove(),m(this,Pi,null)}hideDropdown(){}};Pi=new WeakMap,fp=new WeakMap,Vu=new WeakMap,pp=new WeakMap,x(Da,pp,null);let t0=Da;function iA(n){return Math.floor(Math.max(0,Math.min(1,n))*255).toString(16).padStart(2,"0")}function Vd(n){return Math.max(0,Math.min(255,255*n))}class rA{static CMYK_G([e,t,s,i]){return["G",1-Math.min(1,.3*e+.59*s+.11*t+i)]}static G_CMYK([e]){return["CMYK",0,0,0,1-e]}static G_RGB([e]){return["RGB",e,e,e]}static G_rgb([e]){return e=Vd(e),[e,e,e]}static G_HTML([e]){const t=iA(e);return`#${t}${t}${t}`}static RGB_G([e,t,s]){return["G",.3*e+.59*t+.11*s]}static RGB_rgb(e){return e.map(Vd)}static RGB_HTML(e){return`#${e.map(iA).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([e,t,s,i]){return["RGB",1-Math.min(1,e+i),1-Math.min(1,s+i),1-Math.min(1,t+i)]}static CMYK_rgb([e,t,s,i]){return[Vd(1-Math.min(1,e+i)),Vd(1-Math.min(1,s+i)),Vd(1-Math.min(1,t+i))]}static CMYK_HTML(e){const t=this.CMYK_RGB(e).slice(1);return this.RGB_HTML(t)}static RGB_CMYK([e,t,s]){const i=1-e,r=1-t,a=1-s,l=Math.min(i,r,a);return["CMYK",i,r,a,l]}}class NP{create(e,t,s=!1){if(e<=0||t<=0)throw new Error("Invalid SVG dimensions");const i=this._createSVG("svg:svg");return i.setAttribute("version","1.1"),s||(i.setAttribute("width",`${e}px`),i.setAttribute("height",`${t}px`)),i.setAttribute("preserveAspectRatio","none"),i.setAttribute("viewBox",`0 0 ${e} ${t}`),i}createElement(e){if(typeof e!="string")throw new Error("Invalid SVG element type");return this._createSVG(e)}_createSVG(e){Ce("Abstract method `_createSVG` called.")}}class s0 extends NP{_createSVG(e){return document.createElementNS(Xi,e)}}const PP=9,ic=new WeakSet,MP=new Date().getTimezoneOffset()*60*1e3;class Iv{static create(e){switch(e.data.annotationType){case yt.LINK:return new ow(e);case yt.TEXT:return new DP(e);case yt.WIDGET:switch(e.data.fieldType){case"Tx":return new IP(e);case"Btn":return e.data.radioButton?new ZE(e):e.data.checkBox?new FP(e):new jP(e);case"Ch":return new OP(e);case"Sig":return new RP(e)}return new lc(e);case yt.POPUP:return new kx(e);case yt.FREETEXT:return new iC(e);case yt.LINE:return new zP(e);case yt.SQUARE:return new UP(e);case yt.CIRCLE:return new HP(e);case yt.POLYLINE:return new rC(e);case yt.CARET:return new VP(e);case yt.INK:return new aw(e);case yt.POLYGON:return new $P(e);case yt.HIGHLIGHT:return new oC(e);case yt.UNDERLINE:return new WP(e);case yt.SQUIGGLY:return new GP(e);case yt.STRIKEOUT:return new XP(e);case yt.STAMP:return new aC(e);case yt.FILEATTACHMENT:return new YP(e);default:return new nt(e)}}}var kl,Wu,Nn,mp,Ax;const pw=class pw{constructor(e,{isRenderable:t=!1,ignoreBorder:s=!1,createQuadrilaterals:i=!1}={}){x(this,mp);x(this,kl,null);x(this,Wu,!1);x(this,Nn,null);this.isRenderable=t,this.data=e.data,this.layer=e.layer,this.linkService=e.linkService,this.downloadManager=e.downloadManager,this.imageResourcesPath=e.imageResourcesPath,this.renderForms=e.renderForms,this.svgFactory=e.svgFactory,this.annotationStorage=e.annotationStorage,this.enableComment=e.enableComment,this.enableScripting=e.enableScripting,this.hasJSActions=e.hasJSActions,this._fieldObjects=e.fieldObjects,this.parent=e.parent,this.hasOwnCommentButton=!1,t&&(this.contentElement=this.container=this._createContainer(s)),i&&this._createQuadrilaterals()}static _hasPopupData({contentsObj:e,richText:t}){return!!(e!=null&&e.str||t!=null&&t.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return pw._hasPopupData(this.data)||this.enableComment&&!!this.commentText}get commentData(){var s;const{data:e}=this,t=(s=this.annotationStorage)==null?void 0:s.getEditor(e.id);return t?t.getData():e}get hasCommentButton(){return this.enableComment&&this.hasPopupElement}get commentButtonPosition(){var l;const e=(l=this.annotationStorage)==null?void 0:l.getEditor(this.data.id);if(e)return e.commentButtonPositionInPage;const{quadPoints:t,inkLists:s,rect:i}=this.data;let r=-1/0,a=-1/0;if((t==null?void 0:t.length)>=8){for(let c=0;c<t.length;c+=8)t[c+1]>a?(a=t[c+1],r=t[c+2]):t[c+1]===a&&(r=Math.max(r,t[c+2]));return[r,a]}if((s==null?void 0:s.length)>=1){for(const c of s)for(let u=0,d=c.length;u<d;u+=2)c[u+1]>a?(a=c[u+1],r=c[u]):c[u+1]===a&&(r=Math.max(r,c[u]));if(r!==1/0)return[r,a]}return i?[i[2],i[3]]:null}_normalizePoint(e){const{page:{view:t},viewport:{rawDims:{pageWidth:s,pageHeight:i,pageX:r,pageY:a}}}=this.parent;return e[1]=t[3]-e[1]+t[1],e[0]=100*(e[0]-r)/s,e[1]=100*(e[1]-a)/i,e}get commentText(){var t,s,i;const{data:e}=this;return((s=(t=this.annotationStorage.getRawValue(`${Vh}${e.id}`))==null?void 0:t.popup)==null?void 0:s.contents)||((i=e.contentsObj)==null?void 0:i.str)||""}set commentText(e){const{data:t}=this,s={deleted:!e,contents:e||""};this.annotationStorage.updateEditor(t.id,{popup:s})||this.annotationStorage.setValue(`${Vh}${t.id}`,{id:t.id,annotationType:t.annotationType,page:this.parent.page,popup:s,popupRef:t.popupRef,modificationDate:new Date}),e||this.removePopup()}removePopup(){var e,t;(t=((e=o(this,Nn))==null?void 0:e.popup)||this.popup)==null||t.remove(),m(this,Nn,this.popup=null)}updateEdited(e){var r;if(!this.container)return;e.rect&&(o(this,kl)||m(this,kl,{rect:this.data.rect.slice(0)}));const{rect:t,popup:s}=e;t&&A(this,mp,Ax).call(this,t);let i=((r=o(this,Nn))==null?void 0:r.popup)||this.popup;!i&&(s!=null&&s.text)&&(this._createPopup(s),i=o(this,Nn).popup),i&&(i.updateEdited(e),s!=null&&s.deleted&&(i.remove(),m(this,Nn,null),this.popup=null))}resetEdited(){var e;o(this,kl)&&(A(this,mp,Ax).call(this,o(this,kl).rect),(e=o(this,Nn))==null||e.popup.resetEdited(),m(this,kl,null))}_createContainer(e){const{data:t,parent:{page:s,viewport:i}}=this,r=document.createElement("section");r.setAttribute("data-annotation-id",t.id),!(this instanceof lc)&&!(this instanceof ow)&&(r.tabIndex=0);const{style:a}=r;if(a.zIndex=this.parent.zIndex,this.parent.zIndex+=2,t.alternativeText&&(r.title=t.alternativeText),t.noRotate&&r.classList.add("norotate"),!t.rect||this instanceof kx){const{rotation:b}=t;return!t.hasOwnCanvas&&b!==0&&this.setRotation(b,r),r}const{width:l,height:c}=this;if(!e&&t.borderStyle.width>0){a.borderWidth=`${t.borderStyle.width}px`;const b=t.borderStyle.horizontalCornerRadius,S=t.borderStyle.verticalCornerRadius;if(b>0||S>0){const k=`calc(${b}px * var(--total-scale-factor)) / calc(${S}px * var(--total-scale-factor))`;a.borderRadius=k}else if(this instanceof ZE){const k=`calc(${l}px * var(--total-scale-factor)) / calc(${c}px * var(--total-scale-factor))`;a.borderRadius=k}switch(t.borderStyle.style){case pc.SOLID:a.borderStyle="solid";break;case pc.DASHED:a.borderStyle="dashed";break;case pc.BEVELED:ne("Unimplemented border style: beveled");break;case pc.INSET:ne("Unimplemented border style: inset");break;case pc.UNDERLINE:a.borderBottomStyle="solid";break}const y=t.borderColor||null;y?(m(this,Wu,!0),a.borderColor=z.makeHexColor(y[0]|0,y[1]|0,y[2]|0)):a.borderWidth=0}const u=z.normalizeRect([t.rect[0],s.view[3]-t.rect[1]+s.view[1],t.rect[2],s.view[3]-t.rect[3]+s.view[1]]),{pageWidth:d,pageHeight:h,pageX:f,pageY:p}=i.rawDims;a.left=`${100*(u[0]-f)/d}%`,a.top=`${100*(u[1]-p)/h}%`;const{rotation:v}=t;return t.hasOwnCanvas||v===0?(a.width=`${100*l/d}%`,a.height=`${100*c/h}%`):this.setRotation(v,r),r}setRotation(e,t=this.container){if(!this.data.rect)return;const{pageWidth:s,pageHeight:i}=this.parent.viewport.rawDims;let{width:r,height:a}=this;e%180!==0&&([r,a]=[a,r]),t.style.width=`${100*r/s}%`,t.style.height=`${100*a/i}%`,t.setAttribute("data-main-rotation",(360-e)%360)}get _commonActions(){const e=(t,s,i)=>{const r=i.detail[t],a=r[0],l=r.slice(1);i.target.style[s]=rA[`${a}_HTML`](l),this.annotationStorage.setValue(this.data.id,{[s]:rA[`${a}_rgb`](l)})};return ie(this,"_commonActions",{display:t=>{const{display:s}=t.detail,i=s%2===1;this.container.style.visibility=i?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:i,noPrint:s===1||s===2})},print:t=>{this.annotationStorage.setValue(this.data.id,{noPrint:!t.detail.print})},hidden:t=>{const{hidden:s}=t.detail;this.container.style.visibility=s?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:s,noView:s})},focus:t=>{setTimeout(()=>t.target.focus({preventScroll:!1}),0)},userName:t=>{t.target.title=t.detail.userName},readonly:t=>{t.target.disabled=t.detail.readonly},required:t=>{this._setRequired(t.target,t.detail.required)},bgColor:t=>{e("bgColor","backgroundColor",t)},fillColor:t=>{e("fillColor","backgroundColor",t)},fgColor:t=>{e("fgColor","color",t)},textColor:t=>{e("textColor","color",t)},borderColor:t=>{e("borderColor","borderColor",t)},strokeColor:t=>{e("strokeColor","borderColor",t)},rotation:t=>{const s=t.detail.rotation;this.setRotation(s),this.annotationStorage.setValue(this.data.id,{rotation:s})}})}_dispatchEventFromSandbox(e,t){const s=this._commonActions;for(const i of Object.keys(t.detail)){const r=e[i]||s[i];r==null||r(t)}}_setDefaultPropertiesFromJS(e){if(!this.enableScripting)return;const t=this.annotationStorage.getRawValue(this.data.id);if(!t)return;const s=this._commonActions;for(const[i,r]of Object.entries(t)){const a=s[i];if(a){const l={detail:{[i]:r},target:e};a(l),delete t[i]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:e}=this.data;if(!e)return;const[t,s,i,r]=this.data.rect.map(b=>Math.fround(b));if(e.length===8){const[b,S,y,k]=e.subarray(2,6);if(i===b&&r===S&&t===y&&s===k)return}const{style:a}=this.container;let l;if(o(this,Wu)){const{borderColor:b,borderWidth:S}=a;a.borderWidth=0,l=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${b}" stroke-width="${S}">`],this.container.classList.add("hasBorder")}const c=i-t,u=r-s,{svgFactory:d}=this,h=d.createElement("svg");h.classList.add("quadrilateralsContainer"),h.setAttribute("width",0),h.setAttribute("height",0),h.role="none";const f=d.createElement("defs");h.append(f);const p=d.createElement("clipPath"),v=`clippath_${this.data.id}`;p.setAttribute("id",v),p.setAttribute("clipPathUnits","objectBoundingBox"),f.append(p);for(let b=2,S=e.length;b<S;b+=8){const y=e[b],k=e[b+1],w=e[b+2],E=e[b+3],C=d.createElement("rect"),T=(w-t)/c,_=(r-k)/u,P=(y-w)/c,D=(k-E)/u;C.setAttribute("x",T),C.setAttribute("y",_),C.setAttribute("width",P),C.setAttribute("height",D),p.append(C),l==null||l.push(`<rect vector-effect="non-scaling-stroke" x="${T}" y="${_}" width="${P}" height="${D}"/>`)}o(this,Wu)&&(l.push("</g></svg>')"),a.backgroundImage=l.join("")),this.container.append(h),this.container.style.clipPath=`url(#${v})`}_createPopup(e=null){const{data:t}=this;let s,i;e?(s={str:e.text},i=e.date):(s=t.contentsObj,i=t.modificationDate),m(this,Nn,new kx({data:{color:t.color,titleObj:t.titleObj,modificationDate:i,contentsObj:s,richText:t.richText,parentRect:t.rect,borderStyle:0,id:`popup_${t.id}`,rotation:t.rotation,noRotate:!0},linkService:this.linkService,parent:this.parent,elements:[this]}))}get hasPopupElement(){return!!(o(this,Nn)||this.popup||this.data.popupRef)}get extraPopupElement(){return o(this,Nn)}render(){Ce("Abstract method `AnnotationElement.render` called")}_getElementsByName(e,t=null){const s=[];if(this._fieldObjects){const i=this._fieldObjects[e];if(i)for(const{page:r,id:a,exportValues:l}of i){if(r===-1||a===t)continue;const c=typeof l=="string"?l:null,u=document.querySelector(`[data-element-id="${a}"]`);if(u&&!ic.has(u)){ne(`_getElementsByName - element not allowed: ${a}`);continue}s.push({id:a,exportValue:c,domElement:u})}return s}for(const i of document.getElementsByName(e)){const{exportValue:r}=i,a=i.getAttribute("data-element-id");a!==t&&ic.has(i)&&s.push({id:a,exportValue:r,domElement:i})}return s}show(){var e;this.container&&(this.container.hidden=!1),(e=this.popup)==null||e.maybeShow()}hide(){var e;this.container&&(this.container.hidden=!0),(e=this.popup)==null||e.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const e=this.getElementsToTriggerPopup();if(Array.isArray(e))for(const t of e)t.classList.add("highlightArea");else e.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:e,data:{id:t}}=this;this.container.addEventListener("dblclick",()=>{var s;(s=this.linkService.eventBus)==null||s.dispatch("switchannotationeditormode",{source:this,mode:e,editId:t,mustEnterInEditMode:!0})})}get width(){return this.data.rect[2]-this.data.rect[0]}get height(){return this.data.rect[3]-this.data.rect[1]}};kl=new WeakMap,Wu=new WeakMap,Nn=new WeakMap,mp=new WeakSet,Ax=function(e){const{container:{style:t},data:{rect:s,rotation:i},parent:{viewport:{rawDims:{pageWidth:r,pageHeight:a,pageX:l,pageY:c}}}}=this;s==null||s.splice(0,4,...e),t.left=`${100*(e[0]-l)/r}%`,t.top=`${100*(a-e[3]+c)/a}%`,i===0?(t.width=`${100*(e[2]-e[0])/r}%`,t.height=`${100*(e[3]-e[1])/a}%`):this.setRotation(i)};let nt=pw;class LP extends nt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.editor=e.editor}render(){return this.container.className="editorAnnotation",this.container}createOrUpdatePopup(){const{editor:e}=this;e.hasComment&&this._createPopup(e.comment)}get hasCommentButton(){return this.enableComment&&this.editor.hasComment}get commentButtonPosition(){return this.editor.commentButtonPositionInPage}get commentText(){return this.editor.comment.text}set commentText(e){this.editor.comment=e,e||this.removePopup()}get commentData(){return this.editor.getData()}remove(){this.parent.removeAnnotation(this.data.id),this.container.remove(),this.container=null,this.removePopup()}}var ln,Na,QE,JE;class ow extends nt{constructor(t,s=null){super(t,{isRenderable:!0,ignoreBorder:!!(s!=null&&s.ignoreBorder),createQuadrilaterals:!0});x(this,ln);this.isTooltipOnly=t.data.isTooltipOnly}render(){const{data:t,linkService:s}=this,i=document.createElement("a");i.setAttribute("data-element-id",t.id);let r=!1;return t.url?(s.addLinkAttributes(i,t.url,t.newWindow),r=!0):t.action?(this._bindNamedAction(i,t.action,t.overlaidText),r=!0):t.attachment?(A(this,ln,QE).call(this,i,t.attachment,t.overlaidText,t.attachmentDest),r=!0):t.setOCGState?(A(this,ln,JE).call(this,i,t.setOCGState,t.overlaidText),r=!0):t.dest?(this._bindLink(i,t.dest,t.overlaidText),r=!0):(t.actions&&(t.actions.Action||t.actions["Mouse Up"]||t.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(i,t),r=!0),t.resetForm?(this._bindResetFormAction(i,t.resetForm),r=!0):this.isTooltipOnly&&!r&&(this._bindLink(i,""),r=!0)),this.container.classList.add("linkAnnotation"),r&&(this.contentElement=i,this.container.append(i)),this.container}_bindLink(t,s,i=""){t.href=this.linkService.getDestinationHash(s),t.onclick=()=>(s&&this.linkService.goToDestination(s),!1),(s||s==="")&&A(this,ln,Na).call(this),i&&(t.title=i)}_bindNamedAction(t,s,i=""){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeNamedAction(s),!1),i&&(t.title=i),A(this,ln,Na).call(this)}_bindJSAction(t,s){t.href=this.linkService.getAnchorUrl("");const i=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const r of Object.keys(s.actions)){const a=i.get(r);a&&(t[a]=()=>{var l;return(l=this.linkService.eventBus)==null||l.dispatch("dispatcheventinsandbox",{source:this,detail:{id:s.id,name:r}}),!1})}s.overlaidText&&(t.title=s.overlaidText),t.onclick||(t.onclick=()=>!1),A(this,ln,Na).call(this)}_bindResetFormAction(t,s){const i=t.onclick;if(i||(t.href=this.linkService.getAnchorUrl("")),A(this,ln,Na).call(this),!this._fieldObjects){ne('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),i||(t.onclick=()=>!1);return}t.onclick=()=>{var h;i==null||i();const{fields:r,refs:a,include:l}=s,c=[];if(r.length!==0||a.length!==0){const f=new Set(a);for(const p of r){const v=this._fieldObjects[p]||[];for(const{id:b}of v)f.add(b)}for(const p of Object.values(this._fieldObjects))for(const v of p)f.has(v.id)===l&&c.push(v)}else for(const f of Object.values(this._fieldObjects))c.push(...f);const u=this.annotationStorage,d=[];for(const f of c){const{id:p}=f;switch(d.push(p),f.type){case"text":{const b=f.defaultValue||"";u.setValue(p,{value:b});break}case"checkbox":case"radiobutton":{const b=f.defaultValue===f.exportValues;u.setValue(p,{value:b});break}case"combobox":case"listbox":{const b=f.defaultValue||"";u.setValue(p,{value:b});break}default:continue}const v=document.querySelector(`[data-element-id="${p}"]`);if(v){if(!ic.has(v)){ne(`_bindResetFormAction - element not allowed: ${p}`);continue}}else continue;v.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((h=this.linkService.eventBus)==null||h.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:d,name:"ResetForm"}})),!1}}}ln=new WeakSet,Na=function(){this.container.setAttribute("data-internal-link","")},QE=function(t,s,i="",r=null){t.href=this.linkService.getAnchorUrl(""),s.description?t.title=s.description:i&&(t.title=i),t.onclick=()=>{var a;return(a=this.downloadManager)==null||a.openOrDownloadData(s.content,s.filename,r),!1},A(this,ln,Na).call(this)},JE=function(t,s,i=""){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeSetOCGState(s),!1),i&&(t.title=i),A(this,ln,Na).call(this)};class DP extends nt{constructor(e){super(e,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const e=document.createElement("img");return e.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",e.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),e.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.append(e),this.container}}class lc extends nt{render(){return this.container}showElementAndHideCanvas(e){var t;this.data.hasOwnCanvas&&(((t=e.previousSibling)==null?void 0:t.nodeName)==="CANVAS"&&(e.previousSibling.hidden=!0),e.hidden=!1)}_getKeyModifier(e){return Nt.platform.isMac?e.metaKey:e.ctrlKey}_setEventListener(e,t,s,i,r){s.includes("mouse")?e.addEventListener(s,a=>{var l;(l=this.linkService.eventBus)==null||l.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:i,value:r(a),shift:a.shiftKey,modifier:this._getKeyModifier(a)}})}):e.addEventListener(s,a=>{var l;if(s==="blur"){if(!t.focused||!a.relatedTarget)return;t.focused=!1}else if(s==="focus"){if(t.focused)return;t.focused=!0}r&&((l=this.linkService.eventBus)==null||l.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:i,value:r(a)}}))})}_setEventListeners(e,t,s,i){var r,a,l;for(const[c,u]of s)(u==="Action"||(r=this.data.actions)!=null&&r[u])&&((u==="Focus"||u==="Blur")&&(t||(t={focused:!1})),this._setEventListener(e,t,c,u,i),u==="Focus"&&!((a=this.data.actions)!=null&&a.Blur)?this._setEventListener(e,t,"blur","Blur",null):u==="Blur"&&!((l=this.data.actions)!=null&&l.Focus)&&this._setEventListener(e,t,"focus","Focus",null))}_setBackgroundColor(e){const t=this.data.backgroundColor||null;e.style.backgroundColor=t===null?"transparent":z.makeHexColor(t[0],t[1],t[2])}_setTextStyle(e){const t=["left","center","right"],{fontColor:s}=this.data.defaultAppearanceData,i=this.data.defaultAppearanceData.fontSize||PP,r=e.style;let a;const l=2,c=u=>Math.round(10*u)/10;if(this.data.multiLine){const u=Math.abs(this.data.rect[3]-this.data.rect[1]-l),d=Math.round(u/(Tv*i))||1,h=u/d;a=Math.min(i,c(h/Tv))}else{const u=Math.abs(this.data.rect[3]-this.data.rect[1]-l);a=Math.min(i,c(u/Tv))}r.fontSize=`calc(${a}px * var(--total-scale-factor))`,r.color=z.makeHexColor(s[0],s[1],s[2]),this.data.textAlignment!==null&&(r.textAlign=t[this.data.textAlignment])}_setRequired(e,t){t?e.setAttribute("required",!0):e.removeAttribute("required"),e.setAttribute("aria-required",t)}}class IP extends lc{constructor(e){const t=e.renderForms||e.data.hasOwnCanvas||!e.data.hasAppearance&&!!e.data.fieldValue;super(e,{isRenderable:t})}setPropertyOnSiblings(e,t,s,i){const r=this.annotationStorage;for(const a of this._getElementsByName(e.name,e.id))a.domElement&&(a.domElement[t]=s),r.setValue(a.id,{[i]:s})}render(){var i,r;const e=this.annotationStorage,t=this.data.id;this.container.classList.add("textWidgetAnnotation");let s=null;if(this.renderForms){const a=e.getValue(t,{value:this.data.fieldValue});let l=a.value||"";const c=e.getValue(t,{charLimit:this.data.maxLen}).charLimit;c&&l.length>c&&(l=l.slice(0,c));let u=a.formattedValue||((i=this.data.textContent)==null?void 0:i.join(`
`))||null;u&&this.data.comb&&(u=u.replaceAll(/\s+/g,""));const d={userValue:l,formattedValue:u,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(s=document.createElement("textarea"),s.textContent=u??l,this.data.doNotScroll&&(s.style.overflowY="hidden")):(s=document.createElement("input"),s.type=this.data.password?"password":"text",s.setAttribute("value",u??l),this.data.doNotScroll&&(s.style.overflowX="hidden")),this.data.hasOwnCanvas&&(s.hidden=!0),ic.add(s),this.contentElement=s,s.setAttribute("data-element-id",t),s.disabled=this.data.readOnly,s.name=this.data.fieldName,s.tabIndex=0;const{datetimeFormat:h,datetimeType:f,timeStep:p}=this.data,v=!!f&&this.enableScripting;h&&(s.title=h),this._setRequired(s,this.data.required),c&&(s.maxLength=c),s.addEventListener("input",S=>{e.setValue(t,{value:S.target.value}),this.setPropertyOnSiblings(s,"value",S.target.value,"value"),d.formattedValue=null}),s.addEventListener("resetform",S=>{const y=this.data.defaultFieldValue??"";s.value=d.userValue=y,d.formattedValue=null});let b=S=>{const{formattedValue:y}=d;y!=null&&(S.target.value=y),S.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){s.addEventListener("focus",y=>{var w;if(d.focused)return;const{target:k}=y;if(v&&(k.type=f,p&&(k.step=p)),d.userValue){const E=d.userValue;if(v)if(f==="time"){const C=new Date(E),T=[C.getHours(),C.getMinutes(),C.getSeconds()];k.value=T.map(_=>_.toString().padStart(2,"0")).join(":")}else k.value=new Date(E-MP).toISOString().split(f==="date"?"T":".",1)[0];else k.value=E}d.lastCommittedValue=k.value,d.commitKey=1,(w=this.data.actions)!=null&&w.Focus||(d.focused=!0)}),s.addEventListener("updatefromsandbox",y=>{this.showElementAndHideCanvas(y.target);const k={value(w){d.userValue=w.detail.value??"",v||e.setValue(t,{value:d.userValue.toString()}),w.target.value=d.userValue},formattedValue(w){const{formattedValue:E}=w.detail;d.formattedValue=E,E!=null&&w.target!==document.activeElement&&(w.target.value=E);const C={formattedValue:E};v&&(C.value=E),e.setValue(t,C)},selRange(w){w.target.setSelectionRange(...w.detail.selRange)},charLimit:w=>{var _;const{charLimit:E}=w.detail,{target:C}=w;if(E===0){C.removeAttribute("maxLength");return}C.setAttribute("maxLength",E);let T=d.userValue;!T||T.length<=E||(T=T.slice(0,E),C.value=d.userValue=T,e.setValue(t,{value:T}),(_=this.linkService.eventBus)==null||_.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:T,willCommit:!0,commitKey:1,selStart:C.selectionStart,selEnd:C.selectionEnd}}))}};this._dispatchEventFromSandbox(k,y)}),s.addEventListener("keydown",y=>{var E;d.commitKey=1;let k=-1;if(y.key==="Escape"?k=0:y.key==="Enter"&&!this.data.multiLine?k=2:y.key==="Tab"&&(d.commitKey=3),k===-1)return;const{value:w}=y.target;d.lastCommittedValue!==w&&(d.lastCommittedValue=w,d.userValue=w,(E=this.linkService.eventBus)==null||E.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:w,willCommit:!0,commitKey:k,selStart:y.target.selectionStart,selEnd:y.target.selectionEnd}}))});const S=b;b=null,s.addEventListener("blur",y=>{var E,C;if(!d.focused||!y.relatedTarget)return;(E=this.data.actions)!=null&&E.Blur||(d.focused=!1);const{target:k}=y;let{value:w}=k;if(v){if(w&&f==="time"){const T=w.split(":").map(_=>parseInt(_,10));w=new Date(2e3,0,1,T[0],T[1],T[2]||0).valueOf(),k.step=""}else w.includes("T")||(w=`${w}T00:00`),w=new Date(w).valueOf();k.type="text"}d.userValue=w,d.lastCommittedValue!==w&&((C=this.linkService.eventBus)==null||C.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:w,willCommit:!0,commitKey:d.commitKey,selStart:y.target.selectionStart,selEnd:y.target.selectionEnd}})),S(y)}),(r=this.data.actions)!=null&&r.Keystroke&&s.addEventListener("beforeinput",y=>{var D;d.lastCommittedValue=null;const{data:k,target:w}=y,{value:E,selectionStart:C,selectionEnd:T}=w;let _=C,P=T;switch(y.inputType){case"deleteWordBackward":{const I=E.substring(0,C).match(/\w*[^\w]*$/);I&&(_-=I[0].length);break}case"deleteWordForward":{const I=E.substring(C).match(/^[^\w]*\w*/);I&&(P+=I[0].length);break}case"deleteContentBackward":C===T&&(_-=1);break;case"deleteContentForward":C===T&&(P+=1);break}y.preventDefault(),(D=this.linkService.eventBus)==null||D.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:E,change:k||"",willCommit:!1,selStart:_,selEnd:P}})}),this._setEventListeners(s,d,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],y=>y.target.value)}if(b&&s.addEventListener("blur",b),this.data.comb){const y=(this.data.rect[2]-this.data.rect[0])/c;s.classList.add("comb"),s.style.letterSpacing=`calc(${y}px * var(--total-scale-factor) - 1ch)`}}else s=document.createElement("div"),s.textContent=this.data.fieldValue,s.style.verticalAlign="middle",s.style.display="table-cell",this.data.hasOwnCanvas&&(s.hidden=!0);return this._setTextStyle(s),this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}}class RP extends lc{constructor(e){super(e,{isRenderable:!!e.data.hasOwnCanvas})}}class FP extends lc{constructor(e){super(e,{isRenderable:e.renderForms})}render(){const e=this.annotationStorage,t=this.data,s=t.id;let i=e.getValue(s,{value:t.exportValue===t.fieldValue}).value;typeof i=="string"&&(i=i!=="Off",e.setValue(s,{value:i})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const r=document.createElement("input");return ic.add(r),r.setAttribute("data-element-id",s),r.disabled=t.readOnly,this._setRequired(r,this.data.required),r.type="checkbox",r.name=t.fieldName,i&&r.setAttribute("checked",!0),r.setAttribute("exportValue",t.exportValue),r.tabIndex=0,r.addEventListener("change",a=>{const{name:l,checked:c}=a.target;for(const u of this._getElementsByName(l,s)){const d=c&&u.exportValue===t.exportValue;u.domElement&&(u.domElement.checked=d),e.setValue(u.id,{value:d})}e.setValue(s,{value:c})}),r.addEventListener("resetform",a=>{const l=t.defaultFieldValue||"Off";a.target.checked=l===t.exportValue}),this.enableScripting&&this.hasJSActions&&(r.addEventListener("updatefromsandbox",a=>{const l={value(c){c.target.checked=c.detail.value!=="Off",e.setValue(s,{value:c.target.checked})}};this._dispatchEventFromSandbox(l,a)}),this._setEventListeners(r,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],a=>a.target.checked)),this._setBackgroundColor(r),this._setDefaultPropertiesFromJS(r),this.container.append(r),this.container}}class ZE extends lc{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const e=this.annotationStorage,t=this.data,s=t.id;let i=e.getValue(s,{value:t.fieldValue===t.buttonValue}).value;if(typeof i=="string"&&(i=i!==t.buttonValue,e.setValue(s,{value:i})),i)for(const a of this._getElementsByName(t.fieldName,s))e.setValue(a.id,{value:!1});const r=document.createElement("input");if(ic.add(r),r.setAttribute("data-element-id",s),r.disabled=t.readOnly,this._setRequired(r,this.data.required),r.type="radio",r.name=t.fieldName,i&&r.setAttribute("checked",!0),r.tabIndex=0,r.addEventListener("change",a=>{const{name:l,checked:c}=a.target;for(const u of this._getElementsByName(l,s))e.setValue(u.id,{value:!1});e.setValue(s,{value:c})}),r.addEventListener("resetform",a=>{const l=t.defaultFieldValue;a.target.checked=l!=null&&l===t.buttonValue}),this.enableScripting&&this.hasJSActions){const a=t.buttonValue;r.addEventListener("updatefromsandbox",l=>{const c={value:u=>{const d=a===u.detail.value;for(const h of this._getElementsByName(u.target.name)){const f=d&&h.id===s;h.domElement&&(h.domElement.checked=f),e.setValue(h.id,{value:f})}}};this._dispatchEventFromSandbox(c,l)}),this._setEventListeners(r,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],l=>l.target.checked)}return this._setBackgroundColor(r),this._setDefaultPropertiesFromJS(r),this.container.append(r),this.container}}class jP extends ow{constructor(e){super(e,{ignoreBorder:e.data.hasAppearance})}render(){const e=super.render();e.classList.add("buttonWidgetAnnotation","pushButton");const t=e.lastChild;return this.enableScripting&&this.hasJSActions&&t&&(this._setDefaultPropertiesFromJS(t),t.addEventListener("updatefromsandbox",s=>{this._dispatchEventFromSandbox({},s)})),e}}class OP extends lc{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const e=this.annotationStorage,t=this.data.id,s=e.getValue(t,{value:this.data.fieldValue}),i=document.createElement("select");ic.add(i),i.setAttribute("data-element-id",t),i.disabled=this.data.readOnly,this._setRequired(i,this.data.required),i.name=this.data.fieldName,i.tabIndex=0;let r=this.data.combo&&this.data.options.length>0;this.data.combo||(i.size=this.data.options.length,this.data.multiSelect&&(i.multiple=!0)),i.addEventListener("resetform",d=>{const h=this.data.defaultFieldValue;for(const f of i.options)f.selected=f.value===h});for(const d of this.data.options){const h=document.createElement("option");h.textContent=d.displayValue,h.value=d.exportValue,s.value.includes(d.exportValue)&&(h.setAttribute("selected",!0),r=!1),i.append(h)}let a=null;if(r){const d=document.createElement("option");d.value=" ",d.setAttribute("hidden",!0),d.setAttribute("selected",!0),i.prepend(d),a=()=>{d.remove(),i.removeEventListener("input",a),a=null},i.addEventListener("input",a)}const l=d=>{const h=d?"value":"textContent",{options:f,multiple:p}=i;return p?Array.prototype.filter.call(f,v=>v.selected).map(v=>v[h]):f.selectedIndex===-1?null:f[f.selectedIndex][h]};let c=l(!1);const u=d=>{const h=d.target.options;return Array.prototype.map.call(h,f=>({displayValue:f.textContent,exportValue:f.value}))};return this.enableScripting&&this.hasJSActions?(i.addEventListener("updatefromsandbox",d=>{const h={value(f){a==null||a();const p=f.detail.value,v=new Set(Array.isArray(p)?p:[p]);for(const b of i.options)b.selected=v.has(b.value);e.setValue(t,{value:l(!0)}),c=l(!1)},multipleSelection(f){i.multiple=!0},remove(f){const p=i.options,v=f.detail.remove;p[v].selected=!1,i.remove(v),p.length>0&&Array.prototype.findIndex.call(p,S=>S.selected)===-1&&(p[0].selected=!0),e.setValue(t,{value:l(!0),items:u(f)}),c=l(!1)},clear(f){for(;i.length!==0;)i.remove(0);e.setValue(t,{value:null,items:[]}),c=l(!1)},insert(f){const{index:p,displayValue:v,exportValue:b}=f.detail.insert,S=i.children[p],y=document.createElement("option");y.textContent=v,y.value=b,S?S.before(y):i.append(y),e.setValue(t,{value:l(!0),items:u(f)}),c=l(!1)},items(f){const{items:p}=f.detail;for(;i.length!==0;)i.remove(0);for(const v of p){const{displayValue:b,exportValue:S}=v,y=document.createElement("option");y.textContent=b,y.value=S,i.append(y)}i.options.length>0&&(i.options[0].selected=!0),e.setValue(t,{value:l(!0),items:u(f)}),c=l(!1)},indices(f){const p=new Set(f.detail.indices);for(const v of f.target.options)v.selected=p.has(v.index);e.setValue(t,{value:l(!0)}),c=l(!1)},editable(f){f.target.disabled=!f.detail.editable}};this._dispatchEventFromSandbox(h,d)}),i.addEventListener("input",d=>{var p;const h=l(!0),f=l(!1);e.setValue(t,{value:h}),d.preventDefault(),(p=this.linkService.eventBus)==null||p.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:c,change:f,changeEx:h,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(i,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],d=>d.target.value)):i.addEventListener("input",function(d){e.setValue(t,{value:l(!0)})}),this.data.combo&&this._setTextStyle(i),this._setBackgroundColor(i),this._setDefaultPropertiesFromJS(i),this.container.append(i),this.container}}var gp,Sx;class kx extends nt{constructor(t){const{data:s,elements:i,parent:r}=t,a=!!r._commentManager;super(t,{isRenderable:!a&&nt._hasPopupData(s)});x(this,gp);if(this.elements=i,a&&nt._hasPopupData(s)){const l=this.popup=A(this,gp,Sx).call(this);for(const c of i)c.popup=l}else this.popup=null}render(){const{container:t}=this;t.classList.add("popupAnnotation"),t.role="comment";const s=this.popup=A(this,gp,Sx).call(this),i=[];for(const r of this.elements)r.popup=s,r.container.ariaHasPopup="dialog",i.push(r.data.id),r.addHighlightArea();return this.container.setAttribute("aria-controls",i.map(r=>`${Ic}${r}`).join(",")),this.container}}gp=new WeakSet,Sx=function(){return new BP({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate||this.data.creationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open,commentManager:this.parent._commentManager})};var Gs,Ho,y0,x0,Gu,Xu,ot,Mi,$o,Sl,Yu,qu,Li,Xs,Cr,Tr,at,_r,Vo,vp,Nr,Ku,El,Wo,Mt,Go,ue,ng,Ex,Cx,Tx,ig,_x,eC,tC,sC,nC,rg,og,Nx;class BP{constructor({container:e,color:t,elements:s,titleObj:i,modificationDate:r,contentsObj:a,richText:l,parent:c,rect:u,parentRect:d,open:h,commentManager:f=null}){x(this,ue);x(this,Gs,null);x(this,Ho,A(this,ue,sC).bind(this));x(this,y0,A(this,ue,Nx).bind(this));x(this,x0,A(this,ue,og).bind(this));x(this,Gu,A(this,ue,rg).bind(this));x(this,Xu,null);x(this,ot,null);x(this,Mi,null);x(this,$o,null);x(this,Sl,null);x(this,Yu,null);x(this,qu,null);x(this,Li,!1);x(this,Xs,null);x(this,Cr,null);x(this,Tr,null);x(this,at,null);x(this,_r,null);x(this,Vo,null);x(this,vp,null);x(this,Nr,null);x(this,Ku,null);x(this,El,null);x(this,Wo,!1);x(this,Mt,null);x(this,Go,null);m(this,ot,e),m(this,Ku,i),m(this,Mi,a),m(this,Nr,l),m(this,Yu,c),m(this,Xu,t),m(this,vp,u),m(this,qu,d),m(this,Sl,s),m(this,Gs,f),m(this,Mt,s[0]),m(this,$o,Yg.toDateObject(r)),this.trigger=s.flatMap(p=>p.getElementsToTriggerPopup()),f||(A(this,ue,ng).call(this),o(this,ot).hidden=!0,h&&A(this,ue,rg).call(this))}renderCommentButton(){if(o(this,at)){o(this,at).parentNode||o(this,Mt).container.after(o(this,at));return}if(o(this,_r)||A(this,ue,Ex).call(this),!o(this,_r))return;const{signal:e}=m(this,Cr,new AbortController),t=o(this,Mt).hasOwnCommentButton,s=()=>{o(this,Gs).toggleCommentPopup(this,!0,void 0,!t)},i=()=>{o(this,Gs).toggleCommentPopup(this,!1,!0,!t)},r=()=>{o(this,Gs).toggleCommentPopup(this,!1,!1)};if(t){m(this,at,o(this,Mt).container);for(const a of this.trigger)a.ariaHasPopup="dialog",a.ariaControls="commentPopup",a.addEventListener("keydown",o(this,Ho),{signal:e}),a.addEventListener("click",s,{signal:e}),a.addEventListener("pointerenter",i,{signal:e}),a.addEventListener("pointerleave",r,{signal:e}),a.classList.add("popupTriggerArea")}else{const a=m(this,at,document.createElement("button"));a.className="annotationCommentButton";const l=o(this,Mt).container;a.style.zIndex=l.style.zIndex+1,a.tabIndex=0,a.ariaHasPopup="dialog",a.ariaControls="commentPopup",a.setAttribute("data-l10n-id","pdfjs-show-comment-button"),A(this,ue,Tx).call(this),A(this,ue,Cx).call(this),a.addEventListener("keydown",o(this,Ho),{signal:e}),a.addEventListener("click",s,{signal:e}),a.addEventListener("pointerenter",i,{signal:e}),a.addEventListener("pointerleave",r,{signal:e}),l.after(a)}}get commentButtonColor(){const{color:e,opacity:t}=o(this,Mt).commentData;return e?o(this,Yu)._commentManager.makeCommentColor(e,t):null}focusCommentButton(){setTimeout(()=>{var e;(e=o(this,at))==null||e.focus()},0)}getData(){const{richText:e,color:t,opacity:s,creationDate:i,modificationDate:r}=o(this,Mt).commentData;return{contentsObj:{str:this.comment},richText:e,color:t,opacity:s,creationDate:i,modificationDate:r}}get elementBeforePopup(){return o(this,at)}get comment(){return o(this,Go)||m(this,Go,o(this,Mt).commentText),o(this,Go)}set comment(e){e!==this.comment&&(o(this,Mt).commentText=m(this,Go,e))}focus(){var e;(e=o(this,Mt).container)==null||e.focus()}get parentBoundingClientRect(){return o(this,Mt).layer.getBoundingClientRect()}setCommentButtonStates({selected:e,hasPopup:t}){o(this,at)&&(o(this,at).classList.toggle("selected",e),o(this,at).ariaExpanded=t)}setSelectedCommentButton(e){o(this,at).classList.toggle("selected",e)}get commentPopupPosition(){if(o(this,Vo))return o(this,Vo);const{x:e,y:t,height:s}=o(this,at).getBoundingClientRect(),{x:i,y:r,width:a,height:l}=o(this,Mt).layer.getBoundingClientRect();return[(e-i)/a,(t+s-r)/l]}set commentPopupPosition(e){m(this,Vo,e)}hasDefaultPopupPosition(){return o(this,Vo)===null}get commentButtonPosition(){return o(this,_r)}get commentButtonWidth(){return o(this,at).getBoundingClientRect().width/this.parentBoundingClientRect.width}editComment(e){const[t,s]=o(this,Vo)||this.commentButtonPosition.map(u=>u/100),i=this.parentBoundingClientRect,{x:r,y:a,width:l,height:c}=i;o(this,Gs).showDialog(null,this,r+t*l,a+s*c,{...e,parentDimensions:i})}render(){var s,i;if(o(this,Xs))return;const e=m(this,Xs,document.createElement("div"));if(e.className="popup",o(this,Xu)){const r=e.style.outlineColor=z.makeHexColor(...o(this,Xu));e.style.backgroundColor=`color-mix(in srgb, ${r} 30%, white)`}const t=document.createElement("span");if(t.className="header",(s=o(this,Ku))!=null&&s.str){const r=document.createElement("span");r.className="title",t.append(r),{dir:r.dir,str:r.textContent}=o(this,Ku)}if(e.append(t),o(this,$o)){const r=document.createElement("time");r.className="popupDate",r.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),r.setAttribute("data-l10n-args",JSON.stringify({dateObj:o(this,$o).valueOf()})),r.dateTime=o(this,$o).toISOString(),t.append(r)}NS({html:o(this,ue,ig)||o(this,Mi).str,dir:(i=o(this,Mi))==null?void 0:i.dir,className:"popupContent"},e),o(this,ot).append(e)}updateEdited({rect:e,popup:t,deleted:s}){var i;if(o(this,Gs)){s?(this.remove(),m(this,Go,null)):t&&(t.deleted?this.remove():(A(this,ue,Tx).call(this),m(this,Go,t.text))),e&&(m(this,_r,null),A(this,ue,Ex).call(this),A(this,ue,Cx).call(this));return}if(s||t!=null&&t.deleted){this.remove();return}A(this,ue,ng).call(this),o(this,El)||m(this,El,{contentsObj:o(this,Mi),richText:o(this,Nr)}),e&&m(this,Tr,null),t&&t.text&&(m(this,Nr,A(this,ue,tC).call(this,t.text)),m(this,$o,Yg.toDateObject(t.date)),m(this,Mi,null)),(i=o(this,Xs))==null||i.remove(),m(this,Xs,null)}resetEdited(){var e;o(this,El)&&({contentsObj:At(this,Mi)._,richText:At(this,Nr)._}=o(this,El),m(this,El,null),(e=o(this,Xs))==null||e.remove(),m(this,Xs,null),m(this,Tr,null))}remove(){var e,t,s;if((e=o(this,Cr))==null||e.abort(),m(this,Cr,null),(t=o(this,Xs))==null||t.remove(),m(this,Xs,null),m(this,Wo,!1),m(this,Li,!1),(s=o(this,at))==null||s.remove(),m(this,at,null),this.trigger)for(const i of this.trigger)i.classList.remove("popupTriggerArea")}forceHide(){m(this,Wo,this.isVisible),o(this,Wo)&&(o(this,ot).hidden=!0)}maybeShow(){o(this,Gs)||(A(this,ue,ng).call(this),o(this,Wo)&&(o(this,Xs)||A(this,ue,og).call(this),m(this,Wo,!1),o(this,ot).hidden=!1))}get isVisible(){return o(this,Gs)?!1:o(this,ot).hidden===!1}}Gs=new WeakMap,Ho=new WeakMap,y0=new WeakMap,x0=new WeakMap,Gu=new WeakMap,Xu=new WeakMap,ot=new WeakMap,Mi=new WeakMap,$o=new WeakMap,Sl=new WeakMap,Yu=new WeakMap,qu=new WeakMap,Li=new WeakMap,Xs=new WeakMap,Cr=new WeakMap,Tr=new WeakMap,at=new WeakMap,_r=new WeakMap,Vo=new WeakMap,vp=new WeakMap,Nr=new WeakMap,Ku=new WeakMap,El=new WeakMap,Wo=new WeakMap,Mt=new WeakMap,Go=new WeakMap,ue=new WeakSet,ng=function(){var t;if(o(this,Cr))return;m(this,Cr,new AbortController);const{signal:e}=o(this,Cr);for(const s of this.trigger)s.addEventListener("click",o(this,Gu),{signal:e}),s.addEventListener("pointerenter",o(this,x0),{signal:e}),s.addEventListener("pointerleave",o(this,y0),{signal:e}),s.classList.add("popupTriggerArea");for(const s of o(this,Sl))(t=s.container)==null||t.addEventListener("keydown",o(this,Ho),{signal:e})},Ex=function(){const e=o(this,Sl).find(t=>t.hasCommentButton);e&&m(this,_r,e._normalizePoint(e.commentButtonPosition))},Cx=function(){if(o(this,Mt).extraPopupElement&&!o(this,Mt).editor)return;o(this,at)||this.renderCommentButton();const[e,t]=o(this,_r),{style:s}=o(this,at);s.left=`calc(${e}%)`,s.top=`calc(${t}% - var(--comment-button-dim))`},Tx=function(){o(this,Mt).extraPopupElement||(o(this,at)||this.renderCommentButton(),o(this,at).style.backgroundColor=this.commentButtonColor||"")},ig=function(){const e=o(this,Nr),t=o(this,Mi);return e!=null&&e.str&&(!(t!=null&&t.str)||t.str===e.str)&&o(this,Nr).html||null},_x=function(){var e,t,s;return((s=(t=(e=o(this,ue,ig))==null?void 0:e.attributes)==null?void 0:t.style)==null?void 0:s.fontSize)||0},eC=function(){var e,t,s;return((s=(t=(e=o(this,ue,ig))==null?void 0:e.attributes)==null?void 0:t.style)==null?void 0:s.color)||null},tC=function(e){const t=[],s={str:e,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:t}]}},i={style:{color:o(this,ue,eC),fontSize:o(this,ue,_x)?`calc(${o(this,ue,_x)}px * var(--total-scale-factor))`:""}};for(const r of e.split(`
`))t.push({name:"span",value:r,attributes:i});return s},sC=function(e){e.altKey||e.shiftKey||e.ctrlKey||e.metaKey||(e.key==="Enter"||e.key==="Escape"&&o(this,Li))&&A(this,ue,rg).call(this)},nC=function(){if(o(this,Tr)!==null)return;const{page:{view:e},viewport:{rawDims:{pageWidth:t,pageHeight:s,pageX:i,pageY:r}}}=o(this,Yu);let a=!!o(this,qu),l=a?o(this,qu):o(this,vp);for(const v of o(this,Sl))if(!l||z.intersect(v.data.rect,l)!==null){l=v.data.rect,a=!0;break}const c=z.normalizeRect([l[0],e[3]-l[1]+e[1],l[2],e[3]-l[3]+e[1]]),d=a?l[2]-l[0]+5:0,h=c[0]+d,f=c[1];m(this,Tr,[100*(h-i)/t,100*(f-r)/s]);const{style:p}=o(this,ot);p.left=`${o(this,Tr)[0]}%`,p.top=`${o(this,Tr)[1]}%`},rg=function(){if(o(this,Gs)){o(this,Gs).toggleCommentPopup(this,!1);return}m(this,Li,!o(this,Li)),o(this,Li)?(A(this,ue,og).call(this),o(this,ot).addEventListener("click",o(this,Gu)),o(this,ot).addEventListener("keydown",o(this,Ho))):(A(this,ue,Nx).call(this),o(this,ot).removeEventListener("click",o(this,Gu)),o(this,ot).removeEventListener("keydown",o(this,Ho)))},og=function(){o(this,Xs)||this.render(),this.isVisible?o(this,Li)&&o(this,ot).classList.add("focused"):(A(this,ue,nC).call(this),o(this,ot).hidden=!1,o(this,ot).style.zIndex=parseInt(o(this,ot).style.zIndex)+1e3)},Nx=function(){o(this,ot).classList.remove("focused"),!(o(this,Li)||!this.isVisible)&&(o(this,ot).hidden=!0,o(this,ot).style.zIndex=parseInt(o(this,ot).style.zIndex)-1e3)};class iC extends nt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.textContent=e.data.textContent,this.textPosition=e.data.textPosition,this.annotationEditorType=oe.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const e=this.contentElement=document.createElement("div");e.classList.add("annotationTextContent"),e.setAttribute("role","comment");for(const t of this.textContent){const s=document.createElement("span");s.textContent=t,e.append(s)}this.container.append(e)}return!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this._editOnDoubleClick(),this.container}}var yp;class zP extends nt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});x(this,yp,null)}render(){this.container.classList.add("lineAnnotation");const{data:t,width:s,height:i}=this,r=this.svgFactory.create(s,i,!0),a=m(this,yp,this.svgFactory.createElement("svg:line"));return a.setAttribute("x1",t.rect[2]-t.lineCoordinates[0]),a.setAttribute("y1",t.rect[3]-t.lineCoordinates[1]),a.setAttribute("x2",t.rect[2]-t.lineCoordinates[2]),a.setAttribute("y2",t.rect[3]-t.lineCoordinates[3]),a.setAttribute("stroke-width",t.borderStyle.width||1),a.setAttribute("stroke","transparent"),a.setAttribute("fill","transparent"),r.append(a),this.container.append(r),!t.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return o(this,yp)}addHighlightArea(){this.container.classList.add("highlightArea")}}yp=new WeakMap;var xp;class UP extends nt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});x(this,xp,null)}render(){this.container.classList.add("squareAnnotation");const{data:t,width:s,height:i}=this,r=this.svgFactory.create(s,i,!0),a=t.borderStyle.width,l=m(this,xp,this.svgFactory.createElement("svg:rect"));return l.setAttribute("x",a/2),l.setAttribute("y",a/2),l.setAttribute("width",s-a),l.setAttribute("height",i-a),l.setAttribute("stroke-width",a||1),l.setAttribute("stroke","transparent"),l.setAttribute("fill","transparent"),r.append(l),this.container.append(r),!t.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return o(this,xp)}addHighlightArea(){this.container.classList.add("highlightArea")}}xp=new WeakMap;var bp;class HP extends nt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});x(this,bp,null)}render(){this.container.classList.add("circleAnnotation");const{data:t,width:s,height:i}=this,r=this.svgFactory.create(s,i,!0),a=t.borderStyle.width,l=m(this,bp,this.svgFactory.createElement("svg:ellipse"));return l.setAttribute("cx",s/2),l.setAttribute("cy",i/2),l.setAttribute("rx",s/2-a/2),l.setAttribute("ry",i/2-a/2),l.setAttribute("stroke-width",a||1),l.setAttribute("stroke","transparent"),l.setAttribute("fill","transparent"),r.append(l),this.container.append(r),!t.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return o(this,bp)}addHighlightArea(){this.container.classList.add("highlightArea")}}bp=new WeakMap;var wp;class rC extends nt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});x(this,wp,null);this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,vertices:s,borderStyle:i,popupRef:r},width:a,height:l}=this;if(!s)return this.container;const c=this.svgFactory.create(a,l,!0);let u=[];for(let h=0,f=s.length;h<f;h+=2){const p=s[h]-t[0],v=t[3]-s[h+1];u.push(`${p},${v}`)}u=u.join(" ");const d=m(this,wp,this.svgFactory.createElement(this.svgElementName));return d.setAttribute("points",u),d.setAttribute("stroke-width",i.width||1),d.setAttribute("stroke","transparent"),d.setAttribute("fill","transparent"),c.append(d),this.container.append(c),!r&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return o(this,wp)}addHighlightArea(){this.container.classList.add("highlightArea")}}wp=new WeakMap;class $P extends rC{constructor(e){super(e),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class VP extends nt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}}var Ap,Cl,kp,Px;class aw extends nt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});x(this,kp);x(this,Ap,null);x(this,Cl,[]);this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=this.data.it==="InkHighlight"?oe.HIGHLIGHT:oe.INK}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,rotation:s,inkLists:i,borderStyle:r,popupRef:a}}=this,{transform:l,width:c,height:u}=A(this,kp,Px).call(this,s,t),d=this.svgFactory.create(c,u,!0),h=m(this,Ap,this.svgFactory.createElement("svg:g"));d.append(h),h.setAttribute("stroke-width",r.width||1),h.setAttribute("stroke-linecap","round"),h.setAttribute("stroke-linejoin","round"),h.setAttribute("stroke-miterlimit",10),h.setAttribute("stroke","transparent"),h.setAttribute("fill","transparent"),h.setAttribute("transform",l);for(let f=0,p=i.length;f<p;f++){const v=this.svgFactory.createElement(this.svgElementName);o(this,Cl).push(v),v.setAttribute("points",i[f].join(",")),h.append(v)}return!a&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.append(d),this._editOnDoubleClick(),this.container}updateEdited(t){super.updateEdited(t);const{thickness:s,points:i,rect:r}=t,a=o(this,Ap);if(s>=0&&a.setAttribute("stroke-width",s||1),i)for(let l=0,c=o(this,Cl).length;l<c;l++)o(this,Cl)[l].setAttribute("points",i[l].join(","));if(r){const{transform:l,width:c,height:u}=A(this,kp,Px).call(this,this.data.rotation,r);a.parentElement.setAttribute("viewBox",`0 0 ${c} ${u}`),a.setAttribute("transform",l)}}getElementsToTriggerPopup(){return o(this,Cl)}addHighlightArea(){this.container.classList.add("highlightArea")}}Ap=new WeakMap,Cl=new WeakMap,kp=new WeakSet,Px=function(t,s){switch(t){case 90:return{transform:`rotate(90) translate(${-s[0]},${s[1]}) scale(1,-1)`,width:s[3]-s[1],height:s[2]-s[0]};case 180:return{transform:`rotate(180) translate(${-s[2]},${s[1]}) scale(1,-1)`,width:s[2]-s[0],height:s[3]-s[1]};case 270:return{transform:`rotate(270) translate(${-s[2]},${s[3]}) scale(1,-1)`,width:s[3]-s[1],height:s[2]-s[0]};default:return{transform:`translate(${-s[0]},${s[3]}) scale(1,-1)`,width:s[2]-s[0],height:s[3]-s[1]}}};class oC extends nt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}),this.annotationEditorType=oe.HIGHLIGHT}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("highlightAnnotation"),this._editOnDoubleClick(),e){const s=document.createElement("mark");s.classList.add("overlaidText"),s.textContent=e,this.container.append(s)}return this.container}}class WP extends nt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("underlineAnnotation"),e){const s=document.createElement("u");s.classList.add("overlaidText"),s.textContent=e,this.container.append(s)}return this.container}}class GP extends nt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("squigglyAnnotation"),e){const s=document.createElement("u");s.classList.add("overlaidText"),s.textContent=e,this.container.append(s)}return this.container}}class XP extends nt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("strikeoutAnnotation"),e){const s=document.createElement("s");s.classList.add("overlaidText"),s.textContent=e,this.container.append(s)}return this.container}}class aC extends nt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.annotationEditorType=oe.STAMP}render(){return this.container.classList.add("stampAnnotation"),this.container.setAttribute("role","img"),!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this._editOnDoubleClick(),this.container}}var Sp,Ep,Mx;class YP extends nt{constructor(t){var i;super(t,{isRenderable:!0});x(this,Ep);x(this,Sp,null);const{file:s}=this.data;this.filename=s.filename,this.content=s.content,(i=this.linkService.eventBus)==null||i.dispatch("fileattachmentannotation",{source:this,...s})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:t,data:s}=this;let i;s.hasAppearance||s.fillAlpha===0?i=document.createElement("div"):(i=document.createElement("img"),i.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(s.name)?"paperclip":"pushpin"}.svg`,s.fillAlpha&&s.fillAlpha<1&&(i.style=`filter: opacity(${Math.round(s.fillAlpha*100)}%);`)),i.addEventListener("dblclick",A(this,Ep,Mx).bind(this)),m(this,Sp,i);const{isMac:r}=Nt.platform;return t.addEventListener("keydown",a=>{a.key==="Enter"&&(r?a.metaKey:a.ctrlKey)&&A(this,Ep,Mx).call(this)}),!s.popupRef&&this.hasPopupData?(this.hasOwnCommentButton=!0,this._createPopup()):i.classList.add("popupTriggerArea"),t.append(i),t}getElementsToTriggerPopup(){return o(this,Sp)}addHighlightArea(){this.container.classList.add("highlightArea")}}Sp=new WeakMap,Ep=new WeakSet,Mx=function(){var t;(t=this.downloadManager)==null||t.openOrDownloadData(this.content,this.filename)};var Tl,_l,Qu,Xo,Cp,Nl,Ys,Tp,Vr,ag,Dx;const mw=class mw{constructor({div:e,accessibilityManager:t,annotationCanvasMap:s,annotationEditorUIManager:i,page:r,viewport:a,structTreeLayer:l,commentManager:c,linkService:u,annotationStorage:d}){x(this,Vr);x(this,Tl,null);x(this,_l,null);x(this,Qu,null);x(this,Xo,new Map);x(this,Cp,null);x(this,Nl,null);x(this,Ys,[]);x(this,Tp,!1);this.div=e,m(this,Tl,t),m(this,_l,s),m(this,Cp,l||null),m(this,Nl,u||null),m(this,Qu,d||new nw),this.page=r,this.viewport=a,this.zIndex=0,this._annotationEditorUIManager=i,this._commentManager=c||null}hasEditableAnnotations(){return o(this,Xo).size>0}async render(e){var l;const{annotations:t}=e,s=this.div;sc(s,this.viewport);const i=new Map,r=[],a={data:null,layer:s,linkService:o(this,Nl),downloadManager:e.downloadManager,imageResourcesPath:e.imageResourcesPath||"",renderForms:e.renderForms!==!1,svgFactory:new s0,annotationStorage:o(this,Qu),enableComment:e.enableComment===!0,enableScripting:e.enableScripting===!0,hasJSActions:e.hasJSActions,fieldObjects:e.fieldObjects,parent:this,elements:null};for(const c of t){if(c.noHTML)continue;const u=c.annotationType===yt.POPUP;if(u){const f=i.get(c.id);if(!f)continue;if(!this._commentManager){r.push(c);continue}a.elements=f}else if(c.rect[2]===c.rect[0]||c.rect[3]===c.rect[1])continue;a.data=c;const d=Iv.create(a);if(!d.isRenderable)continue;if(!u&&(o(this,Ys).push(d),c.popupRef)){const f=i.get(c.popupRef);f?f.push(d):i.set(c.popupRef,[d])}const h=d.render();c.hidden&&(h.style.visibility="hidden"),d._isEditable&&(o(this,Xo).set(d.data.id,d),(l=this._annotationEditorUIManager)==null||l.renderAnnotationElement(d))}await A(this,Vr,ag).call(this);for(const c of r){const u=a.elements=i.get(c.id);a.data=c;const d=Iv.create(a);if(!d.isRenderable)continue;const h=d.render();d.contentElement.id=`${Ic}${c.id}`,c.hidden&&(h.style.visibility="hidden"),u.at(-1).container.after(h)}A(this,Vr,Dx).call(this)}async addLinkAnnotations(e){const t={data:null,layer:this.div,linkService:o(this,Nl),svgFactory:new s0,parent:this};for(const s of e){s.borderStyle||(s.borderStyle=mw._defaultBorderStyle),t.data=s;const i=Iv.create(t);i.isRenderable&&(i.render(),i.contentElement.id=`${Ic}${s.id}`,o(this,Ys).push(i))}await A(this,Vr,ag).call(this)}update({viewport:e}){const t=this.div;this.viewport=e,sc(t,{rotation:e.rotation}),A(this,Vr,Dx).call(this),t.hidden=!1}getEditableAnnotations(){return Array.from(o(this,Xo).values())}getEditableAnnotation(e){return o(this,Xo).get(e)}addFakeAnnotation(e){const{div:t}=this,{id:s,rotation:i}=e,r=new LP({data:{id:s,rect:e.getPDFRect(),rotation:i},editor:e,layer:t,parent:this,enableComment:!!this._commentManager,linkService:o(this,Nl),annotationStorage:o(this,Qu)});return r.render(),r.contentElement.id=`${Ic}${s}`,r.createOrUpdatePopup(),o(this,Ys).push(r),r}removeAnnotation(e){var i;const t=o(this,Ys).findIndex(r=>r.data.id===e);if(t<0)return;const[s]=o(this,Ys).splice(t,1);(i=o(this,Tl))==null||i.removePointerInTextLayer(s.contentElement)}updateFakeAnnotations(e){if(e.length!==0){for(const t of e)t.updateFakeAnnotationElement(this);A(this,Vr,ag).call(this)}}togglePointerEvents(e=!1){this.div.classList.toggle("disabled",!e)}static get _defaultBorderStyle(){return ie(this,"_defaultBorderStyle",Object.freeze({width:1,rawWidth:1,style:pc.SOLID,dashArray:[3],horizontalCornerRadius:0,verticalCornerRadius:0}))}};Tl=new WeakMap,_l=new WeakMap,Qu=new WeakMap,Xo=new WeakMap,Cp=new WeakMap,Nl=new WeakMap,Ys=new WeakMap,Tp=new WeakMap,Vr=new WeakSet,ag=async function(){var s,i,r;if(o(this,Ys).length===0)return;this.div.replaceChildren();const e=[];if(!o(this,Tp)){m(this,Tp,!0);for(const{contentElement:a,data:{id:l}}of o(this,Ys)){const c=a.id=`${Ic}${l}`;e.push((s=o(this,Cp))==null?void 0:s.getAriaAttributes(c).then(u=>{if(u)for(const[d,h]of u)a.setAttribute(d,h)}))}}o(this,Ys).sort(({data:{rect:[a,l,c,u]}},{data:{rect:[d,h,f,p]}})=>{if(a===c&&l===u)return 1;if(d===f&&h===p)return-1;const v=u,b=l,S=(l+u)/2,y=p,k=h,w=(h+p)/2;if(S>=y&&w<=b)return-1;if(w>=v&&S<=k)return 1;const E=(a+c)/2,C=(d+f)/2;return E-C});const t=document.createDocumentFragment();for(const a of o(this,Ys))t.append(a.container),this._commentManager?(r=((i=a.extraPopupElement)==null?void 0:i.popup)||a.popup)==null||r.renderCommentButton():a.extraPopupElement&&t.append(a.extraPopupElement.render());if(this.div.append(t),await Promise.all(e),o(this,Tl))for(const a of o(this,Ys))o(this,Tl).addPointerInTextLayer(a.contentElement,!1)},Dx=function(){var t;if(!o(this,_l))return;const e=this.div;for(const[s,i]of o(this,_l)){const r=e.querySelector(`[data-annotation-id="${s}"]`);if(!r)continue;i.className="annotationContent";const{firstChild:a}=r;a?a.nodeName==="CANVAS"?a.replaceWith(i):a.classList.contains("annotationContent")?a.after(i):a.before(i):r.append(i);const l=o(this,Xo).get(s);l&&(l._hasNoCanvas?((t=this._annotationEditorUIManager)==null||t.setMissingCanvas(s,r.id,i),l._hasNoCanvas=!1):l.canvas=i)}o(this,_l).clear()};let Lx=mw;const _m=/\r\n?|\n/g;var qs,_p,Pl,Ks,wt,lC,cC,uC,lg,Wr,cg,ug,dC,Rx,hC;const Ge=class Ge extends Ve{constructor(t){super({...t,name:"freeTextEditor"});x(this,wt);x(this,qs,"");x(this,_p,`${this.id}-editor`);x(this,Pl,null);x(this,Ks);M(this,"_colorPicker",null);this.color=t.color||Ge._defaultColor||Ve._defaultLineColor,m(this,Ks,t.fontSize||Ge._defaultFontSize),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-freetext-added-alert"),this.canAddComment=!1}static get _keyboardManager(){const t=Ge.prototype,s=a=>a.isEmpty(),i=nc.TRANSLATE_SMALL,r=nc.TRANSLATE_BIG;return ie(this,"_keyboardManager",new em([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],t.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],t.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],t._translateEmpty,{args:[-i,0],checker:s}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t._translateEmpty,{args:[-r,0],checker:s}],[["ArrowRight","mac+ArrowRight"],t._translateEmpty,{args:[i,0],checker:s}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t._translateEmpty,{args:[r,0],checker:s}],[["ArrowUp","mac+ArrowUp"],t._translateEmpty,{args:[0,-i],checker:s}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t._translateEmpty,{args:[0,-r],checker:s}],[["ArrowDown","mac+ArrowDown"],t._translateEmpty,{args:[0,i],checker:s}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t._translateEmpty,{args:[0,r],checker:s}]]))}static initialize(t,s){Ve.initialize(t,s);const i=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(i.getPropertyValue("--freetext-padding"))}static updateDefaultParams(t,s){switch(t){case ve.FREETEXT_SIZE:Ge._defaultFontSize=s;break;case ve.FREETEXT_COLOR:Ge._defaultColor=s;break}}updateParams(t,s){switch(t){case ve.FREETEXT_SIZE:A(this,wt,lC).call(this,s);break;case ve.FREETEXT_COLOR:A(this,wt,cC).call(this,s);break}}static get defaultPropertiesToUpdate(){return[[ve.FREETEXT_SIZE,Ge._defaultFontSize],[ve.FREETEXT_COLOR,Ge._defaultColor||Ve._defaultLineColor]]}get propertiesToUpdate(){return[[ve.FREETEXT_SIZE,o(this,Ks)],[ve.FREETEXT_COLOR,this.color]]}get toolbarButtons(){return this._colorPicker||(this._colorPicker=new t0(this)),[["colorPicker",this._colorPicker]]}get colorType(){return ve.FREETEXT_COLOR}onUpdatedColor(){var t;this.editorDiv.style.color=this.color,(t=this._colorPicker)==null||t.update(this.color),super.onUpdatedColor()}_translateEmpty(t,s){this._uiManager.translateSelectedEditors(t,s,!0)}getInitialTranslation(){const t=this.parentScale;return[-Ge._internalPadding*t,-(Ge._internalPadding+o(this,Ks))*t]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(!super.enableEditMode())return!1;this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),m(this,Pl,new AbortController);const t=this._uiManager.combinedSignal(o(this,Pl));return this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:t}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:t}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:t}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:t}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:t}),!0}disableEditMode(){var t;return super.disableEditMode()?(this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",o(this,_p)),this._isDraggable=!0,(t=o(this,Pl))==null||t.abort(),m(this,Pl,null),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"),!0):!1}focusin(t){this._focusEventsAllowed&&(super.focusin(t),t.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(t){var s;this.width||(this.enableEditMode(),t&&this.editorDiv.focus(),(s=this._initialOptions)!=null&&s.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const t=o(this,qs),s=m(this,qs,A(this,wt,uC).call(this).trimEnd());if(t===s)return;const i=r=>{if(m(this,qs,r),!r){this.remove();return}A(this,wt,ug).call(this),this._uiManager.rebuild(this),A(this,wt,lg).call(this)};this.addCommands({cmd:()=>{i(s)},undo:()=>{i(t)},mustExec:!1}),A(this,wt,lg).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}keydown(t){t.target===this.div&&t.key==="Enter"&&(this.enterInEditMode(),t.preventDefault())}editorDivKeydown(t){Ge._keyboardManager.exec(this,t)}editorDivFocus(t){this.isEditing=!0}editorDivBlur(t){this.isEditing=!1}editorDivInput(t){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}get canChangeContent(){return!0}render(){if(this.div)return this.div;let t,s;(this._isCopy||this.annotationElementId)&&(t=this.x,s=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",o(this,_p)),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text2"),this.editorDiv.setAttribute("data-l10n-attrs","default-content"),this.enableEditing(),this.editorDiv.contentEditable=!0;const{style:i}=this.editorDiv;if(i.fontSize=`calc(${o(this,Ks)}px * var(--total-scale-factor))`,i.color=this.color,this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),this._isCopy||this.annotationElementId){const[r,a]=this.parentDimensions;if(this.annotationElementId){const{position:l}=this._initialData;let[c,u]=this.getInitialTranslation();[c,u]=this.pageTranslationToScreen(c,u);const[d,h]=this.pageDimensions,[f,p]=this.pageTranslation;let v,b;switch(this.rotation){case 0:v=t+(l[0]-f)/d,b=s+this.height-(l[1]-p)/h;break;case 90:v=t+(l[0]-f)/d,b=s-(l[1]-p)/h,[c,u]=[u,-c];break;case 180:v=t-this.width+(l[0]-f)/d,b=s-(l[1]-p)/h,[c,u]=[-c,-u];break;case 270:v=t+(l[0]-f-this.height*h)/d,b=s+(l[1]-p-this.width*d)/h,[c,u]=[-u,c];break}this.setAt(v*r,b*a,c,u)}else this._moveAfterPaste(t,s);A(this,wt,ug).call(this),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}editorDivPaste(t){var v,b,S;const s=t.clipboardData||window.clipboardData,{types:i}=s;if(i.length===1&&i[0]==="text/plain")return;t.preventDefault();const r=A(v=Ge,Wr,Rx).call(v,s.getData("text")||"").replaceAll(_m,`
`);if(!r)return;const a=window.getSelection();if(!a.rangeCount)return;this.editorDiv.normalize(),a.deleteFromDocument();const l=a.getRangeAt(0);if(!r.includes(`
`)){l.insertNode(document.createTextNode(r)),this.editorDiv.normalize(),a.collapseToStart();return}const{startContainer:c,startOffset:u}=l,d=[],h=[];if(c.nodeType===Node.TEXT_NODE){const y=c.parentElement;if(h.push(c.nodeValue.slice(u).replaceAll(_m,"")),y!==this.editorDiv){let k=d;for(const w of this.editorDiv.childNodes){if(w===y){k=h;continue}k.push(A(b=Ge,Wr,cg).call(b,w))}}d.push(c.nodeValue.slice(0,u).replaceAll(_m,""))}else if(c===this.editorDiv){let y=d,k=0;for(const w of this.editorDiv.childNodes)k++===u&&(y=h),y.push(A(S=Ge,Wr,cg).call(S,w))}m(this,qs,`${d.join(`
`)}${r}${h.join(`
`)}`),A(this,wt,ug).call(this);const f=new Range;let p=Math.sumPrecise(d.map(y=>y.length));for(const{firstChild:y}of this.editorDiv.childNodes)if(y.nodeType===Node.TEXT_NODE){const k=y.nodeValue.length;if(p<=k){f.setStart(y,p),f.setEnd(y,p);break}p-=k}a.removeAllRanges(),a.addRange(f)}get contentDiv(){return this.editorDiv}getPDFRect(){const t=Ge._internalPadding*this.parentScale;return this.getRect(t,t)}static async deserialize(t,s,i){var l;let r=null;if(t instanceof iC){const{data:{defaultAppearanceData:{fontSize:c,fontColor:u},rect:d,rotation:h,id:f,popupRef:p,richText:v,contentsObj:b,creationDate:S,modificationDate:y},textContent:k,textPosition:w,parent:{page:{pageNumber:E}}}=t;if(!k||k.length===0)return null;r=t={annotationType:oe.FREETEXT,color:Array.from(u),fontSize:c,value:k.join(`
`),position:w,pageIndex:E-1,rect:d.slice(0),rotation:h,annotationElementId:f,id:f,deleted:!1,popupRef:p,comment:(b==null?void 0:b.str)||null,richText:v,creationDate:S,modificationDate:y}}const a=await super.deserialize(t,s,i);return m(a,Ks,t.fontSize),a.color=z.makeHexColor(...t.color),m(a,qs,A(l=Ge,Wr,Rx).call(l,t.value)),a._initialData=r,t.comment&&a.setCommentData(t),a}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const s=Ve._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:this.color),i=Object.assign(super.serialize(t),{color:s,fontSize:o(this,Ks),value:A(this,wt,dC).call(this)});return this.addComment(i),t?(i.isCopy=!0,i):this.annotationElementId&&!A(this,wt,hC).call(this,i)?null:(i.id=this.annotationElementId,i)}renderAnnotationElement(t){const s=super.renderAnnotationElement(t);if(!s)return null;const{style:i}=s;i.fontSize=`calc(${o(this,Ks)}px * var(--total-scale-factor))`,i.color=this.color,s.replaceChildren();for(const r of o(this,qs).split(`
`)){const a=document.createElement("div");a.append(r?document.createTextNode(r):document.createElement("br")),s.append(a)}return t.updateEdited({rect:this.getPDFRect(),popup:this._uiManager.hasCommentManager()||this.hasEditedComment?this.comment:{text:o(this,qs)}}),s}resetAnnotationElement(t){super.resetAnnotationElement(t),t.resetEdited()}};qs=new WeakMap,_p=new WeakMap,Pl=new WeakMap,Ks=new WeakMap,wt=new WeakSet,lC=function(t){const s=r=>{this.editorDiv.style.fontSize=`calc(${r}px * var(--total-scale-factor))`,this.translate(0,-(r-o(this,Ks))*this.parentScale),m(this,Ks,r),A(this,wt,lg).call(this)},i=o(this,Ks);this.addCommands({cmd:s.bind(this,t),undo:s.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:ve.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},cC=function(t){const s=r=>{this.color=r,this.onUpdatedColor()},i=this.color;this.addCommands({cmd:s.bind(this,t),undo:s.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:ve.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},uC=function(){var i;const t=[];this.editorDiv.normalize();let s=null;for(const r of this.editorDiv.childNodes)(s==null?void 0:s.nodeType)===Node.TEXT_NODE&&r.nodeName==="BR"||(t.push(A(i=Ge,Wr,cg).call(i,r)),s=r);return t.join(`
`)},lg=function(){const[t,s]=this.parentDimensions;let i;if(this.isAttachedToDOM)i=this.div.getBoundingClientRect();else{const{currentLayer:r,div:a}=this,l=a.style.display,c=a.classList.contains("hidden");a.classList.remove("hidden"),a.style.display="hidden",r.div.append(this.div),i=a.getBoundingClientRect(),a.remove(),a.style.display=l,a.classList.toggle("hidden",c)}this.rotation%180===this.parentRotation%180?(this.width=i.width/t,this.height=i.height/s):(this.width=i.height/t,this.height=i.width/s),this.fixAndSetPosition()},Wr=new WeakSet,cg=function(t){return(t.nodeType===Node.TEXT_NODE?t.nodeValue:t.innerText).replaceAll(_m,"")},ug=function(){if(this.editorDiv.replaceChildren(),!!o(this,qs))for(const t of o(this,qs).split(`
`)){const s=document.createElement("div");s.append(t?document.createTextNode(t):document.createElement("br")),this.editorDiv.append(s)}},dC=function(){return o(this,qs).replaceAll(""," ")},Rx=function(t){return t.replaceAll(" ","")},hC=function(t){const{value:s,fontSize:i,color:r,pageIndex:a}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||t.value!==s||t.fontSize!==i||t.color.some((l,c)=>l!==r[c])||t.pageIndex!==a},x(Ge,Wr),M(Ge,"_freeTextDefaultContent",""),M(Ge,"_internalPadding",0),M(Ge,"_defaultColor",null),M(Ge,"_defaultFontSize",10),M(Ge,"_type","freetext"),M(Ge,"_editorType",oe.FREETEXT);let Ix=Ge;class H{toSVGPath(){Ce("Abstract method `toSVGPath` must be implemented.")}get box(){Ce("Abstract getter `box` must be implemented.")}serialize(e,t){Ce("Abstract method `serialize` must be implemented.")}static _rescale(e,t,s,i,r,a){a||(a=new Float32Array(e.length));for(let l=0,c=e.length;l<c;l+=2)a[l]=t+e[l]*i,a[l+1]=s+e[l+1]*r;return a}static _rescaleAndSwap(e,t,s,i,r,a){a||(a=new Float32Array(e.length));for(let l=0,c=e.length;l<c;l+=2)a[l]=t+e[l+1]*i,a[l+1]=s+e[l]*r;return a}static _translate(e,t,s,i){i||(i=new Float32Array(e.length));for(let r=0,a=e.length;r<a;r+=2)i[r]=t+e[r],i[r+1]=s+e[r+1];return i}static svgRound(e){return Math.round(e*1e4)}static _normalizePoint(e,t,s,i,r){switch(r){case 90:return[1-t/s,e/i];case 180:return[1-e/s,1-t/i];case 270:return[t/s,1-e/i];default:return[e/s,t/i]}}static _normalizePagePoint(e,t,s){switch(s){case 90:return[1-t,e];case 180:return[1-e,1-t];case 270:return[t,1-e];default:return[e,t]}}static createBezierPoints(e,t,s,i,r,a){return[(e+5*s)/6,(t+5*i)/6,(5*s+r)/6,(5*i+a)/6,(s+r)/2,(i+a)/2]}}M(H,"PRECISION",1e-4);var Qs,ei,Ju,Zu,Di,de,Ml,Ll,Np,Pp,ed,td,Yo,Mp,b0,w0,_t,hh,fC,pC,mC,gC,vC,yC;const Ji=class Ji{constructor({x:e,y:t},s,i,r,a,l=0){x(this,_t);x(this,Qs);x(this,ei,[]);x(this,Ju);x(this,Zu);x(this,Di,[]);x(this,de,new Float32Array(18));x(this,Ml);x(this,Ll);x(this,Np);x(this,Pp);x(this,ed);x(this,td);x(this,Yo,[]);m(this,Qs,s),m(this,td,r*i),m(this,Zu,a),o(this,de).set([NaN,NaN,NaN,NaN,e,t],6),m(this,Ju,l),m(this,Pp,o(Ji,Mp)*i),m(this,Np,o(Ji,w0)*i),m(this,ed,i),o(this,Yo).push(e,t)}isEmpty(){return isNaN(o(this,de)[8])}add({x:e,y:t}){var D;m(this,Ml,e),m(this,Ll,t);const[s,i,r,a]=o(this,Qs);let[l,c,u,d]=o(this,de).subarray(8,12);const h=e-u,f=t-d,p=Math.hypot(h,f);if(p<o(this,Np))return!1;const v=p-o(this,Pp),b=v/p,S=b*h,y=b*f;let k=l,w=c;l=u,c=d,u+=S,d+=y,(D=o(this,Yo))==null||D.push(e,t);const E=-y/v,C=S/v,T=E*o(this,td),_=C*o(this,td);return o(this,de).set(o(this,de).subarray(2,8),0),o(this,de).set([u+T,d+_],4),o(this,de).set(o(this,de).subarray(14,18),12),o(this,de).set([u-T,d-_],16),isNaN(o(this,de)[6])?(o(this,Di).length===0&&(o(this,de).set([l+T,c+_],2),o(this,Di).push(NaN,NaN,NaN,NaN,(l+T-s)/r,(c+_-i)/a),o(this,de).set([l-T,c-_],14),o(this,ei).push(NaN,NaN,NaN,NaN,(l-T-s)/r,(c-_-i)/a)),o(this,de).set([k,w,l,c,u,d],6),!this.isEmpty()):(o(this,de).set([k,w,l,c,u,d],6),Math.abs(Math.atan2(w-c,k-l)-Math.atan2(y,S))<Math.PI/2?([l,c,u,d]=o(this,de).subarray(2,6),o(this,Di).push(NaN,NaN,NaN,NaN,((l+u)/2-s)/r,((c+d)/2-i)/a),[l,c,k,w]=o(this,de).subarray(14,18),o(this,ei).push(NaN,NaN,NaN,NaN,((k+l)/2-s)/r,((w+c)/2-i)/a),!0):([k,w,l,c,u,d]=o(this,de).subarray(0,6),o(this,Di).push(((k+5*l)/6-s)/r,((w+5*c)/6-i)/a,((5*l+u)/6-s)/r,((5*c+d)/6-i)/a,((l+u)/2-s)/r,((c+d)/2-i)/a),[u,d,l,c,k,w]=o(this,de).subarray(12,18),o(this,ei).push(((k+5*l)/6-s)/r,((w+5*c)/6-i)/a,((5*l+u)/6-s)/r,((5*c+d)/6-i)/a,((l+u)/2-s)/r,((c+d)/2-i)/a),!0))}toSVGPath(){if(this.isEmpty())return"";const e=o(this,Di),t=o(this,ei);if(isNaN(o(this,de)[6])&&!this.isEmpty())return A(this,_t,fC).call(this);const s=[];s.push(`M${e[4]} ${e[5]}`);for(let i=6;i<e.length;i+=6)isNaN(e[i])?s.push(`L${e[i+4]} ${e[i+5]}`):s.push(`C${e[i]} ${e[i+1]} ${e[i+2]} ${e[i+3]} ${e[i+4]} ${e[i+5]}`);A(this,_t,mC).call(this,s);for(let i=t.length-6;i>=6;i-=6)isNaN(t[i])?s.push(`L${t[i+4]} ${t[i+5]}`):s.push(`C${t[i]} ${t[i+1]} ${t[i+2]} ${t[i+3]} ${t[i+4]} ${t[i+5]}`);return A(this,_t,pC).call(this,s),s.join(" ")}newFreeDrawOutline(e,t,s,i,r,a){return new xC(e,t,s,i,r,a)}getOutlines(){var h;const e=o(this,Di),t=o(this,ei),s=o(this,de),[i,r,a,l]=o(this,Qs),c=new Float32Array((((h=o(this,Yo))==null?void 0:h.length)??0)+2);for(let f=0,p=c.length-2;f<p;f+=2)c[f]=(o(this,Yo)[f]-i)/a,c[f+1]=(o(this,Yo)[f+1]-r)/l;if(c[c.length-2]=(o(this,Ml)-i)/a,c[c.length-1]=(o(this,Ll)-r)/l,isNaN(s[6])&&!this.isEmpty())return A(this,_t,gC).call(this,c);const u=new Float32Array(o(this,Di).length+24+o(this,ei).length);let d=e.length;for(let f=0;f<d;f+=2){if(isNaN(e[f])){u[f]=u[f+1]=NaN;continue}u[f]=e[f],u[f+1]=e[f+1]}d=A(this,_t,yC).call(this,u,d);for(let f=t.length-6;f>=6;f-=6)for(let p=0;p<6;p+=2){if(isNaN(t[f+p])){u[d]=u[d+1]=NaN,d+=2;continue}u[d]=t[f+p],u[d+1]=t[f+p+1],d+=2}return A(this,_t,vC).call(this,u,d),this.newFreeDrawOutline(u,c,o(this,Qs),o(this,ed),o(this,Ju),o(this,Zu))}};Qs=new WeakMap,ei=new WeakMap,Ju=new WeakMap,Zu=new WeakMap,Di=new WeakMap,de=new WeakMap,Ml=new WeakMap,Ll=new WeakMap,Np=new WeakMap,Pp=new WeakMap,ed=new WeakMap,td=new WeakMap,Yo=new WeakMap,Mp=new WeakMap,b0=new WeakMap,w0=new WeakMap,_t=new WeakSet,hh=function(){const e=o(this,de).subarray(4,6),t=o(this,de).subarray(16,18),[s,i,r,a]=o(this,Qs);return[(o(this,Ml)+(e[0]-t[0])/2-s)/r,(o(this,Ll)+(e[1]-t[1])/2-i)/a,(o(this,Ml)+(t[0]-e[0])/2-s)/r,(o(this,Ll)+(t[1]-e[1])/2-i)/a]},fC=function(){const[e,t,s,i]=o(this,Qs),[r,a,l,c]=A(this,_t,hh).call(this);return`M${(o(this,de)[2]-e)/s} ${(o(this,de)[3]-t)/i} L${(o(this,de)[4]-e)/s} ${(o(this,de)[5]-t)/i} L${r} ${a} L${l} ${c} L${(o(this,de)[16]-e)/s} ${(o(this,de)[17]-t)/i} L${(o(this,de)[14]-e)/s} ${(o(this,de)[15]-t)/i} Z`},pC=function(e){const t=o(this,ei);e.push(`L${t[4]} ${t[5]} Z`)},mC=function(e){const[t,s,i,r]=o(this,Qs),a=o(this,de).subarray(4,6),l=o(this,de).subarray(16,18),[c,u,d,h]=A(this,_t,hh).call(this);e.push(`L${(a[0]-t)/i} ${(a[1]-s)/r} L${c} ${u} L${d} ${h} L${(l[0]-t)/i} ${(l[1]-s)/r}`)},gC=function(e){const t=o(this,de),[s,i,r,a]=o(this,Qs),[l,c,u,d]=A(this,_t,hh).call(this),h=new Float32Array(36);return h.set([NaN,NaN,NaN,NaN,(t[2]-s)/r,(t[3]-i)/a,NaN,NaN,NaN,NaN,(t[4]-s)/r,(t[5]-i)/a,NaN,NaN,NaN,NaN,l,c,NaN,NaN,NaN,NaN,u,d,NaN,NaN,NaN,NaN,(t[16]-s)/r,(t[17]-i)/a,NaN,NaN,NaN,NaN,(t[14]-s)/r,(t[15]-i)/a],0),this.newFreeDrawOutline(h,e,o(this,Qs),o(this,ed),o(this,Ju),o(this,Zu))},vC=function(e,t){const s=o(this,ei);return e.set([NaN,NaN,NaN,NaN,s[4],s[5]],t),t+=6},yC=function(e,t){const s=o(this,de).subarray(4,6),i=o(this,de).subarray(16,18),[r,a,l,c]=o(this,Qs),[u,d,h,f]=A(this,_t,hh).call(this);return e.set([NaN,NaN,NaN,NaN,(s[0]-r)/l,(s[1]-a)/c,NaN,NaN,NaN,NaN,u,d,NaN,NaN,NaN,NaN,h,f,NaN,NaN,NaN,NaN,(i[0]-r)/l,(i[1]-a)/c],t),t+=24},x(Ji,Mp,8),x(Ji,b0,2),x(Ji,w0,o(Ji,Mp)+o(Ji,b0));let n0=Ji;var sd,Dl,Pr,Lp,Js,Dp,mt,A0,bC;class xC extends H{constructor(t,s,i,r,a,l){super();x(this,A0);x(this,sd);x(this,Dl,new Float32Array(4));x(this,Pr);x(this,Lp);x(this,Js);x(this,Dp);x(this,mt);m(this,mt,t),m(this,Js,s),m(this,sd,i),m(this,Dp,r),m(this,Pr,a),m(this,Lp,l),this.firstPoint=[NaN,NaN],this.lastPoint=[NaN,NaN],A(this,A0,bC).call(this,l);const[c,u,d,h]=o(this,Dl);for(let f=0,p=t.length;f<p;f+=2)t[f]=(t[f]-c)/d,t[f+1]=(t[f+1]-u)/h;for(let f=0,p=s.length;f<p;f+=2)s[f]=(s[f]-c)/d,s[f+1]=(s[f+1]-u)/h}toSVGPath(){const t=[`M${o(this,mt)[4]} ${o(this,mt)[5]}`];for(let s=6,i=o(this,mt).length;s<i;s+=6){if(isNaN(o(this,mt)[s])){t.push(`L${o(this,mt)[s+4]} ${o(this,mt)[s+5]}`);continue}t.push(`C${o(this,mt)[s]} ${o(this,mt)[s+1]} ${o(this,mt)[s+2]} ${o(this,mt)[s+3]} ${o(this,mt)[s+4]} ${o(this,mt)[s+5]}`)}return t.push("Z"),t.join(" ")}serialize([t,s,i,r],a){const l=i-t,c=r-s;let u,d;switch(a){case 0:u=H._rescale(o(this,mt),t,r,l,-c),d=H._rescale(o(this,Js),t,r,l,-c);break;case 90:u=H._rescaleAndSwap(o(this,mt),t,s,l,c),d=H._rescaleAndSwap(o(this,Js),t,s,l,c);break;case 180:u=H._rescale(o(this,mt),i,s,-l,c),d=H._rescale(o(this,Js),i,s,-l,c);break;case 270:u=H._rescaleAndSwap(o(this,mt),i,r,-l,-c),d=H._rescaleAndSwap(o(this,Js),i,r,-l,-c);break}return{outline:Array.from(u),points:[Array.from(d)]}}get box(){return o(this,Dl)}newOutliner(t,s,i,r,a,l=0){return new n0(t,s,i,r,a,l)}getNewOutline(t,s){const[i,r,a,l]=o(this,Dl),[c,u,d,h]=o(this,sd),f=a*d,p=l*h,v=i*d+c,b=r*h+u,S=this.newOutliner({x:o(this,Js)[0]*f+v,y:o(this,Js)[1]*p+b},o(this,sd),o(this,Dp),t,o(this,Lp),s??o(this,Pr));for(let y=2;y<o(this,Js).length;y+=2)S.add({x:o(this,Js)[y]*f+v,y:o(this,Js)[y+1]*p+b});return S.getOutlines()}}sd=new WeakMap,Dl=new WeakMap,Pr=new WeakMap,Lp=new WeakMap,Js=new WeakMap,Dp=new WeakMap,mt=new WeakMap,A0=new WeakSet,bC=function(t){const s=o(this,mt);let i=s[4],r=s[5];const a=[i,r,i,r];let l=i,c=r,u=i,d=r;const h=t?Math.max:Math.min,f=new Float32Array(4);for(let v=6,b=s.length;v<b;v+=6){const S=s[v+4],y=s[v+5];isNaN(s[v])?(z.pointBoundingBox(S,y,a),c>y?(l=S,c=y):c===y&&(l=h(l,S)),d<y?(u=S,d=y):d===y&&(u=h(u,S))):(f[0]=f[1]=1/0,f[2]=f[3]=-1/0,z.bezierBoundingBox(i,r,...s.slice(v,v+6),f),z.rectBoundingBox(f[0],f[1],f[2],f[3],a),c>f[1]?(l=f[0],c=f[1]):c===f[1]&&(l=h(l,f[0])),d<f[3]?(u=f[2],d=f[3]):d===f[3]&&(u=h(u,f[2]))),i=S,r=y}const p=o(this,Dl);p[0]=a[0]-o(this,Pr),p[1]=a[1]-o(this,Pr),p[2]=a[2]-a[0]+2*o(this,Pr),p[3]=a[3]-a[1]+2*o(this,Pr),this.firstPoint=[l,c],this.lastPoint=[u,d]};var Ip,Rp,Fp,qo,ti,ys,wC,dg,AC,kC,jx;class Fx{constructor(e,t=0,s=0,i=!0){x(this,ys);x(this,Ip);x(this,Rp);x(this,Fp);x(this,qo,[]);x(this,ti,[]);const r=[1/0,1/0,-1/0,-1/0],a=10**-4;for(const{x:b,y:S,width:y,height:k}of e){const w=Math.floor((b-t)/a)*a,E=Math.ceil((b+y+t)/a)*a,C=Math.floor((S-t)/a)*a,T=Math.ceil((S+k+t)/a)*a,_=[w,C,T,!0],P=[E,C,T,!1];o(this,qo).push(_,P),z.rectBoundingBox(w,C,E,T,r)}const l=r[2]-r[0]+2*s,c=r[3]-r[1]+2*s,u=r[0]-s,d=r[1]-s;let h=i?-1/0:1/0,f=1/0;const p=o(this,qo).at(i?-1:-2),v=[p[0],p[2]];for(const b of o(this,qo)){const[S,y,k,w]=b;!w&&i?y<f?(f=y,h=S):y===f&&(h=Math.max(h,S)):w&&!i&&(y<f?(f=y,h=S):y===f&&(h=Math.min(h,S))),b[0]=(S-u)/l,b[1]=(y-d)/c,b[2]=(k-d)/c}m(this,Ip,new Float32Array([u,d,l,c])),m(this,Rp,[h,f]),m(this,Fp,v)}getOutlines(){o(this,qo).sort((t,s)=>t[0]-s[0]||t[1]-s[1]||t[2]-s[2]);const e=[];for(const t of o(this,qo))t[3]?(e.push(...A(this,ys,jx).call(this,t)),A(this,ys,AC).call(this,t)):(A(this,ys,kC).call(this,t),e.push(...A(this,ys,jx).call(this,t)));return A(this,ys,wC).call(this,e)}}Ip=new WeakMap,Rp=new WeakMap,Fp=new WeakMap,qo=new WeakMap,ti=new WeakMap,ys=new WeakSet,wC=function(e){const t=[],s=new Set;for(const a of e){const[l,c,u]=a;t.push([l,c,a],[l,u,a])}t.sort((a,l)=>a[1]-l[1]||a[0]-l[0]);for(let a=0,l=t.length;a<l;a+=2){const c=t[a][2],u=t[a+1][2];c.push(u),u.push(c),s.add(c),s.add(u)}const i=[];let r;for(;s.size>0;){const a=s.values().next().value;let[l,c,u,d,h]=a;s.delete(a);let f=l,p=c;for(r=[l,u],i.push(r);;){let v;if(s.has(d))v=d;else if(s.has(h))v=h;else break;s.delete(v),[l,c,u,d,h]=v,f!==l&&(r.push(f,p,l,p===c?c:u),f=l),p=p===c?u:c}r.push(f,p)}return new qP(i,o(this,Ip),o(this,Rp),o(this,Fp))},dg=function(e){const t=o(this,ti);let s=0,i=t.length-1;for(;s<=i;){const r=s+i>>1,a=t[r][0];if(a===e)return r;a<e?s=r+1:i=r-1}return i+1},AC=function([,e,t]){const s=A(this,ys,dg).call(this,e);o(this,ti).splice(s,0,[e,t])},kC=function([,e,t]){const s=A(this,ys,dg).call(this,e);for(let i=s;i<o(this,ti).length;i++){const[r,a]=o(this,ti)[i];if(r!==e)break;if(r===e&&a===t){o(this,ti).splice(i,1);return}}for(let i=s-1;i>=0;i--){const[r,a]=o(this,ti)[i];if(r!==e)break;if(r===e&&a===t){o(this,ti).splice(i,1);return}}},jx=function(e){const[t,s,i]=e,r=[[t,s,i]],a=A(this,ys,dg).call(this,i);for(let l=0;l<a;l++){const[c,u]=o(this,ti)[l];for(let d=0,h=r.length;d<h;d++){const[,f,p]=r[d];if(!(u<=f||p<=c)){if(f>=c){if(p>u)r[d][1]=u;else{if(h===1)return[];r.splice(d,1),d--,h--}continue}r[d][2]=c,p>u&&r.push([t,u,p])}}}return r};var jp,nd;class qP extends H{constructor(t,s,i,r){super();x(this,jp);x(this,nd);m(this,nd,t),m(this,jp,s),this.firstPoint=i,this.lastPoint=r}toSVGPath(){const t=[];for(const s of o(this,nd)){let[i,r]=s;t.push(`M${i} ${r}`);for(let a=2;a<s.length;a+=2){const l=s[a],c=s[a+1];l===i?(t.push(`V${c}`),r=c):c===r&&(t.push(`H${l}`),i=l)}t.push("Z")}return t.join(" ")}serialize([t,s,i,r],a){const l=[],c=i-t,u=r-s;for(const d of o(this,nd)){const h=new Array(d.length);for(let f=0;f<d.length;f+=2)h[f]=t+d[f]*c,h[f+1]=r-d[f+1]*u;l.push(h)}return l}get box(){return o(this,jp)}get classNamesForOutlining(){return["highlightOutline"]}}jp=new WeakMap,nd=new WeakMap;class Ox extends n0{newFreeDrawOutline(e,t,s,i,r,a){return new KP(e,t,s,i,r,a)}}class KP extends xC{newOutliner(e,t,s,i,r,a=0){return new Ox(e,t,s,i,r,a)}}var id,Op,Mr,Il,Bp,Ps,zp,Up,Rl,Zs,en,$t,rd,od,os,ad,Pn,Hp,ce,Bx,hg,SC,EC,CC,zx,Pa,In,bc,TC,fg,pg,_C,NC,PC,MC,LC;const Se=class Se extends Ve{constructor(t){super({...t,name:"highlightEditor"});x(this,ce);x(this,id,null);x(this,Op,0);x(this,Mr);x(this,Il,null);x(this,Bp,null);x(this,Ps,null);x(this,zp,null);x(this,Up,0);x(this,Rl,null);x(this,Zs,null);x(this,en,null);x(this,$t,!1);x(this,rd,null);x(this,od,null);x(this,os,null);x(this,ad,"");x(this,Pn);x(this,Hp,"");this.color=t.color||Se._defaultColor,m(this,Pn,t.thickness||Se._defaultThickness),this.opacity=t.opacity||Se._defaultOpacity,m(this,Mr,t.boxes||null),m(this,Hp,t.methodOfCreation||""),m(this,ad,t.text||""),this._isDraggable=!1,this.defaultL10nId="pdfjs-editor-highlight-editor",t.highlightId>-1?(m(this,$t,!0),A(this,ce,hg).call(this,t),A(this,ce,Pa).call(this)):o(this,Mr)&&(m(this,id,t.anchorNode),m(this,Op,t.anchorOffset),m(this,zp,t.focusNode),m(this,Up,t.focusOffset),A(this,ce,Bx).call(this),A(this,ce,Pa).call(this),this.rotate(this.rotation)),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-highlight-added-alert")}static get _keyboardManager(){const t=Se.prototype;return ie(this,"_keyboardManager",new em([[["ArrowLeft","mac+ArrowLeft"],t._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],t._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],t._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],t._moveCaret,{args:[3]}]]))}get telemetryInitialData(){return{action:"added",type:o(this,$t)?"free_highlight":"highlight",color:this._uiManager.getNonHCMColorName(this.color),thickness:o(this,Pn),methodOfCreation:o(this,Hp)}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.getNonHCMColorName(this.color)}}static computeTelemetryFinalData(t){return{numberOfColors:t.get("color").size}}static initialize(t,s){var i;Ve.initialize(t,s),Se._defaultColor||(Se._defaultColor=((i=s.highlightColors)==null?void 0:i.values().next().value)||"#fff066")}static updateDefaultParams(t,s){switch(t){case ve.HIGHLIGHT_COLOR:Se._defaultColor=s;break;case ve.HIGHLIGHT_THICKNESS:Se._defaultThickness=s;break}}translateInPage(t,s){}get toolbarPosition(){return o(this,od)}get commentButtonPosition(){return o(this,rd)}updateParams(t,s){switch(t){case ve.HIGHLIGHT_COLOR:A(this,ce,SC).call(this,s);break;case ve.HIGHLIGHT_THICKNESS:A(this,ce,EC).call(this,s);break}}static get defaultPropertiesToUpdate(){return[[ve.HIGHLIGHT_COLOR,Se._defaultColor],[ve.HIGHLIGHT_THICKNESS,Se._defaultThickness]]}get propertiesToUpdate(){return[[ve.HIGHLIGHT_COLOR,this.color||Se._defaultColor],[ve.HIGHLIGHT_THICKNESS,o(this,Pn)||Se._defaultThickness],[ve.HIGHLIGHT_FREE,o(this,$t)]]}onUpdatedColor(){var t,s;(t=this.parent)==null||t.drawLayer.updateProperties(o(this,en),{root:{fill:this.color,"fill-opacity":this.opacity}}),(s=o(this,Bp))==null||s.updateColor(this.color),super.onUpdatedColor()}get toolbarButtons(){return this._uiManager.highlightColors?[["colorPicker",m(this,Bp,new e0({editor:this}))]]:super.toolbarButtons}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(A(this,ce,pg).call(this))}getBaseTranslation(){return[0,0]}getRect(t,s){return super.getRect(t,s,A(this,ce,pg).call(this))}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),t&&this.div.focus()}remove(){A(this,ce,zx).call(this),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(A(this,ce,Pa).call(this),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){var i;let s=!1;this.parent&&!t?A(this,ce,zx).call(this):t&&(A(this,ce,Pa).call(this,t),s=!this.parent&&((i=this.div)==null?void 0:i.classList.contains("selectedEditor"))),super.setParent(t),this.show(this._isVisible),s&&this.select()}rotate(t){var r,a,l;const{drawLayer:s}=this.parent;let i;o(this,$t)?(t=(t-this.rotation+360)%360,i=A(r=Se,In,bc).call(r,o(this,Zs).box,t)):i=A(a=Se,In,bc).call(a,[this.x,this.y,this.width,this.height],t),s.updateProperties(o(this,en),{bbox:i,root:{"data-main-rotation":t}}),s.updateProperties(o(this,os),{bbox:A(l=Se,In,bc).call(l,o(this,Ps).box,t),root:{"data-main-rotation":t}})}render(){if(this.div)return this.div;const t=super.render();o(this,ad)&&(t.setAttribute("aria-label",o(this,ad)),t.setAttribute("role","mark")),o(this,$t)?t.classList.add("free"):this.div.addEventListener("keydown",A(this,ce,TC).bind(this),{signal:this._uiManager._signal});const s=m(this,Rl,document.createElement("div"));return t.append(s),s.setAttribute("aria-hidden","true"),s.className="internal",s.style.clipPath=o(this,Il),this.setDims(),OS(this,o(this,Rl),["pointerover","pointerleave"]),this.enableEditing(),t}pointerover(){var t;this.isSelected||(t=this.parent)==null||t.drawLayer.updateProperties(o(this,os),{rootClass:{hovered:!0}})}pointerleave(){var t;this.isSelected||(t=this.parent)==null||t.drawLayer.updateProperties(o(this,os),{rootClass:{hovered:!1}})}_moveCaret(t){switch(this.parent.unselect(this),t){case 0:case 2:A(this,ce,fg).call(this,!0);break;case 1:case 3:A(this,ce,fg).call(this,!1);break}}select(){var t;super.select(),o(this,os)&&((t=this.parent)==null||t.drawLayer.updateProperties(o(this,os),{rootClass:{hovered:!1,selected:!0}}))}unselect(){var t;super.unselect(),o(this,os)&&((t=this.parent)==null||t.drawLayer.updateProperties(o(this,os),{rootClass:{selected:!1}}),o(this,$t)||A(this,ce,fg).call(this,!1))}get _mustFixPosition(){return!o(this,$t)}show(t=this._isVisible){super.show(t),this.parent&&(this.parent.drawLayer.updateProperties(o(this,en),{rootClass:{hidden:!t}}),this.parent.drawLayer.updateProperties(o(this,os),{rootClass:{hidden:!t}}))}static startHighlighting(t,s,{target:i,x:r,y:a}){const{x:l,y:c,width:u,height:d}=i.getBoundingClientRect(),h=new AbortController,f=t.combinedSignal(h),p=v=>{h.abort(),A(this,In,MC).call(this,t,v)};window.addEventListener("blur",p,{signal:f}),window.addEventListener("pointerup",p,{signal:f}),window.addEventListener("pointerdown",ut,{capture:!0,passive:!1,signal:f}),window.addEventListener("contextmenu",zn,{signal:f}),i.addEventListener("pointermove",A(this,In,PC).bind(this,t),{signal:f}),this._freeHighlight=new Ox({x:r,y:a},[l,c,u,d],t.scale,this._defaultThickness/2,s,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=t.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:this._defaultColor,"fill-opacity":this._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:this._freeHighlight.toSVGPath()}},!0,!0)}static async deserialize(t,s,i){var b,S,y,k;let r=null;if(t instanceof oC){const{data:{quadPoints:w,rect:E,rotation:C,id:T,color:_,opacity:P,popupRef:D,richText:I,contentsObj:F,creationDate:K,modificationDate:Z},parent:{page:{pageNumber:Q}}}=t;r=t={annotationType:oe.HIGHLIGHT,color:Array.from(_),opacity:P,quadPoints:w,boxes:null,pageIndex:Q-1,rect:E.slice(0),rotation:C,annotationElementId:T,id:T,deleted:!1,popupRef:D,richText:I,comment:(F==null?void 0:F.str)||null,creationDate:K,modificationDate:Z}}else if(t instanceof aw){const{data:{inkLists:w,rect:E,rotation:C,id:T,color:_,borderStyle:{rawWidth:P},popupRef:D,richText:I,contentsObj:F,creationDate:K,modificationDate:Z},parent:{page:{pageNumber:Q}}}=t;r=t={annotationType:oe.HIGHLIGHT,color:Array.from(_),thickness:P,inkLists:w,boxes:null,pageIndex:Q-1,rect:E.slice(0),rotation:C,annotationElementId:T,id:T,deleted:!1,popupRef:D,richText:I,comment:(F==null?void 0:F.str)||null,creationDate:K,modificationDate:Z}}const{color:a,quadPoints:l,inkLists:c,opacity:u}=t,d=await super.deserialize(t,s,i);d.color=z.makeHexColor(...a),d.opacity=u||1,c&&m(d,Pn,t.thickness),d._initialData=r,t.comment&&d.setCommentData(t);const[h,f]=d.pageDimensions,[p,v]=d.pageTranslation;if(l){const w=m(d,Mr,[]);for(let E=0;E<l.length;E+=8)w.push({x:(l[E]-p)/h,y:1-(l[E+1]-v)/f,width:(l[E+2]-l[E])/h,height:(l[E+1]-l[E+5])/f});A(b=d,ce,Bx).call(b),A(S=d,ce,Pa).call(S),d.rotate(d.rotation)}else if(c){m(d,$t,!0);const w=c[0],E={x:w[0]-p,y:f-(w[1]-v)},C=new Ox(E,[0,0,h,f],1,o(d,Pn)/2,!0,.001);for(let P=0,D=w.length;P<D;P+=2)E.x=w[P]-p,E.y=f-(w[P+1]-v),C.add(E);const{id:T,clipPathId:_}=s.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:d.color,"fill-opacity":d._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:C.toSVGPath()}},!0,!0);A(y=d,ce,hg).call(y,{highlightOutlines:C.getOutlines(),highlightId:T,clipPathId:_}),A(k=d,ce,Pa).call(k),d.rotate(d.parentRotation)}return d}serialize(t=!1){if(this.isEmpty()||t)return null;if(this.deleted)return this.serializeDeleted();const s=Ve._colorManager.convert(this._uiManager.getNonHCMColor(this.color)),i=super.serialize(t);return Object.assign(i,{color:s,opacity:this.opacity,thickness:o(this,Pn),quadPoints:A(this,ce,_C).call(this),outlines:A(this,ce,NC).call(this,i.rect)}),this.addComment(i),this.annotationElementId&&!A(this,ce,LC).call(this,i)?null:(i.id=this.annotationElementId,i)}renderAnnotationElement(t){return this.deleted?(t.hide(),null):(t.updateEdited({rect:this.getPDFRect(),popup:this.comment}),null)}static canCreateNewEmptyEditor(){return!1}};id=new WeakMap,Op=new WeakMap,Mr=new WeakMap,Il=new WeakMap,Bp=new WeakMap,Ps=new WeakMap,zp=new WeakMap,Up=new WeakMap,Rl=new WeakMap,Zs=new WeakMap,en=new WeakMap,$t=new WeakMap,rd=new WeakMap,od=new WeakMap,os=new WeakMap,ad=new WeakMap,Pn=new WeakMap,Hp=new WeakMap,ce=new WeakSet,Bx=function(){const t=new Fx(o(this,Mr),.001);m(this,Zs,t.getOutlines()),[this.x,this.y,this.width,this.height]=o(this,Zs).box;const s=new Fx(o(this,Mr),.0025,.001,this._uiManager.direction==="ltr");m(this,Ps,s.getOutlines());const{firstPoint:i}=o(this,Zs);m(this,rd,[(i[0]-this.x)/this.width,(i[1]-this.y)/this.height]);const{lastPoint:r}=o(this,Ps);m(this,od,[(r[0]-this.x)/this.width,(r[1]-this.y)/this.height])},hg=function({highlightOutlines:t,highlightId:s,clipPathId:i}){var f,p;if(m(this,Zs,t),m(this,Ps,t.getNewOutline(o(this,Pn)/2+1.5,.0025)),s>=0)m(this,en,s),m(this,Il,i),this.parent.drawLayer.finalizeDraw(s,{bbox:t.box,path:{d:t.toSVGPath()}}),m(this,os,this.parent.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:!0},bbox:o(this,Ps).box,path:{d:o(this,Ps).toSVGPath()}},!0));else if(this.parent){const v=this.parent.viewport.rotation;this.parent.drawLayer.updateProperties(o(this,en),{bbox:A(f=Se,In,bc).call(f,o(this,Zs).box,(v-this.rotation+360)%360),path:{d:t.toSVGPath()}}),this.parent.drawLayer.updateProperties(o(this,os),{bbox:A(p=Se,In,bc).call(p,o(this,Ps).box,v),path:{d:o(this,Ps).toSVGPath()}})}const[a,l,c,u]=t.box;switch(this.rotation){case 0:this.x=a,this.y=l,this.width=c,this.height=u;break;case 90:{const[v,b]=this.parentDimensions;this.x=l,this.y=1-a,this.width=c*b/v,this.height=u*v/b;break}case 180:this.x=1-a,this.y=1-l,this.width=c,this.height=u;break;case 270:{const[v,b]=this.parentDimensions;this.x=1-l,this.y=a,this.width=c*b/v,this.height=u*v/b;break}}const{firstPoint:d}=t;m(this,rd,[(d[0]-a)/c,(d[1]-l)/u]);const{lastPoint:h}=o(this,Ps);m(this,od,[(h[0]-a)/c,(h[1]-l)/u])},SC=function(t){const s=(a,l)=>{this.color=a,this.opacity=l,this.onUpdatedColor()},i=this.color,r=this.opacity;this.addCommands({cmd:s.bind(this,t,Se._defaultOpacity),undo:s.bind(this,i,r),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:ve.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.getNonHCMColorName(t)},!0)},EC=function(t){const s=o(this,Pn),i=r=>{m(this,Pn,r),A(this,ce,CC).call(this,r)};this.addCommands({cmd:i.bind(this,t),undo:i.bind(this,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:ve.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:t},!0)},CC=function(t){o(this,$t)&&(A(this,ce,hg).call(this,{highlightOutlines:o(this,Zs).getNewOutline(t/2)}),this.fixAndSetPosition(),this.setDims())},zx=function(){o(this,en)===null||!this.parent||(this.parent.drawLayer.remove(o(this,en)),m(this,en,null),this.parent.drawLayer.remove(o(this,os)),m(this,os,null))},Pa=function(t=this.parent){o(this,en)===null&&({id:At(this,en)._,clipPathId:At(this,Il)._}=t.drawLayer.draw({bbox:o(this,Zs).box,root:{viewBox:"0 0 1 1",fill:this.color,"fill-opacity":this.opacity},rootClass:{highlight:!0,free:o(this,$t)},path:{d:o(this,Zs).toSVGPath()}},!1,!0),m(this,os,t.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:o(this,$t)},bbox:o(this,Ps).box,path:{d:o(this,Ps).toSVGPath()}},o(this,$t))),o(this,Rl)&&(o(this,Rl).style.clipPath=o(this,Il)))},In=new WeakSet,bc=function([t,s,i,r],a){switch(a){case 90:return[1-s-r,t,r,i];case 180:return[1-t-i,1-s-r,i,r];case 270:return[s,1-t-i,r,i]}return[t,s,i,r]},TC=function(t){Se._keyboardManager.exec(this,t)},fg=function(t){if(!o(this,id))return;const s=window.getSelection();t?s.setPosition(o(this,id),o(this,Op)):s.setPosition(o(this,zp),o(this,Up))},pg=function(){return o(this,$t)?this.rotation:0},_C=function(){if(o(this,$t))return null;const[t,s]=this.pageDimensions,[i,r]=this.pageTranslation,a=o(this,Mr),l=new Float32Array(a.length*8);let c=0;for(const{x:u,y:d,width:h,height:f}of a){const p=u*t+i,v=(1-d)*s+r;l[c]=l[c+4]=p,l[c+1]=l[c+3]=v,l[c+2]=l[c+6]=p+h*t,l[c+5]=l[c+7]=v-f*s,c+=8}return l},NC=function(t){return o(this,Zs).serialize(t,A(this,ce,pg).call(this))},PC=function(t,s){this._freeHighlight.add(s)&&t.drawLayer.updateProperties(this._freeHighlightId,{path:{d:this._freeHighlight.toSVGPath()}})},MC=function(t,s){this._freeHighlight.isEmpty()?t.drawLayer.remove(this._freeHighlightId):t.createAndAddNewEditor(s,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""},LC=function(t){const{color:s}=this._initialData;return this.hasEditedComment||t.color.some((i,r)=>i!==s[r])},x(Se,In),M(Se,"_defaultColor",null),M(Se,"_defaultOpacity",1),M(Se,"_defaultThickness",12),M(Se,"_type","highlight"),M(Se,"_editorType",oe.HIGHLIGHT),M(Se,"_freeHighlightId",-1),M(Se,"_freeHighlight",null),M(Se,"_freeHighlightClipId","");let i0=Se;var Fl;class DC{constructor(){x(this,Fl,Object.create(null))}updateProperty(e,t){this[e]=t,this.updateSVGProperty(e,t)}updateProperties(e){if(e)for(const[t,s]of Object.entries(e))t.startsWith("_")||this.updateProperty(t,s)}updateSVGProperty(e,t){o(this,Fl)[e]=t}toSVGProperties(){const e=o(this,Fl);return m(this,Fl,Object.create(null)),{root:e}}reset(){m(this,Fl,Object.create(null))}updateAll(e=this){this.updateProperties(e)}clone(){Ce("Not implemented")}}Fl=new WeakMap;var tn,ld,Lt,jl,Ol,be,Ux,Hx,$x,fh,IC,mg,ph,wc;const ge=class ge extends Ve{constructor(t){super(t);x(this,be);x(this,tn,null);x(this,ld);M(this,"_colorPicker",null);M(this,"_drawId",null);m(this,ld,t.mustBeCommitted||!1),this._addOutlines(t)}onUpdatedColor(){var t;(t=this._colorPicker)==null||t.update(this.color),super.onUpdatedColor()}_addOutlines(t){t.drawOutlines&&(A(this,be,Ux).call(this,t),A(this,be,fh).call(this))}static _mergeSVGProperties(t,s){const i=new Set(Object.keys(t));for(const[r,a]of Object.entries(s))i.has(r)?Object.assign(t[r],a):t[r]=a;return t}static getDefaultDrawingOptions(t){Ce("Not implemented")}static get typesMap(){Ce("Not implemented")}static get isDrawer(){return!0}static get supportMultipleDrawings(){return!1}static updateDefaultParams(t,s){const i=this.typesMap.get(t);i&&this._defaultDrawingOptions.updateProperty(i,s),this._currentParent&&(o(ge,Lt).updateProperty(i,s),this._currentParent.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}updateParams(t,s){const i=this.constructor.typesMap.get(t);i&&this._updateProperty(t,i,s)}static get defaultPropertiesToUpdate(){const t=[],s=this._defaultDrawingOptions;for(const[i,r]of this.typesMap)t.push([i,s[r]]);return t}get propertiesToUpdate(){const t=[],{_drawingOptions:s}=this;for(const[i,r]of this.constructor.typesMap)t.push([i,s[r]]);return t}_updateProperty(t,s,i){const r=this._drawingOptions,a=r[s],l=c=>{var d;r.updateProperty(s,c);const u=o(this,tn).updateProperty(s,c);u&&A(this,be,ph).call(this,u),(d=this.parent)==null||d.drawLayer.updateProperties(this._drawId,r.toSVGProperties()),t===this.colorType&&this.onUpdatedColor()};this.addCommands({cmd:l.bind(this,i),undo:l.bind(this,a),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:t,overwriteIfSameType:!0,keepUndo:!0})}_onResizing(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,ge._mergeSVGProperties(o(this,tn).getPathResizingSVGProperties(A(this,be,mg).call(this)),{bbox:A(this,be,wc).call(this)}))}_onResized(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,ge._mergeSVGProperties(o(this,tn).getPathResizedSVGProperties(A(this,be,mg).call(this)),{bbox:A(this,be,wc).call(this)}))}_onTranslating(t,s){var i;(i=this.parent)==null||i.drawLayer.updateProperties(this._drawId,{bbox:A(this,be,wc).call(this)})}_onTranslated(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,ge._mergeSVGProperties(o(this,tn).getPathTranslatedSVGProperties(A(this,be,mg).call(this),this.parentDimensions),{bbox:A(this,be,wc).call(this)}))}_onStartDragging(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!0}})}_onStopDragging(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!1}})}commit(){super.commit(),this.disableEditMode(),this.disableEditing()}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}getBaseTranslation(){return[0,0]}get isResizable(){return!0}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),this._isDraggable=!0,o(this,ld)&&(m(this,ld,!1),this.commit(),this.parent.setSelected(this),t&&this.isOnScreen&&this.div.focus())}remove(){A(this,be,$x).call(this),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(A(this,be,fh).call(this),A(this,be,ph).call(this,o(this,tn).box),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){var i;let s=!1;this.parent&&!t?(this._uiManager.removeShouldRescale(this),A(this,be,$x).call(this)):t&&(this._uiManager.addShouldRescale(this),A(this,be,fh).call(this,t),s=!this.parent&&((i=this.div)==null?void 0:i.classList.contains("selectedEditor"))),super.setParent(t),s&&this.select()}rotate(){this.parent&&this.parent.drawLayer.updateProperties(this._drawId,ge._mergeSVGProperties({bbox:A(this,be,wc).call(this)},o(this,tn).updateRotation((this.parentRotation-this.rotation+360)%360)))}onScaleChanging(){this.parent&&A(this,be,ph).call(this,o(this,tn).updateParentDimensions(this.parentDimensions,this.parent.scale))}static onScaleChangingWhenDrawing(){}render(){if(this.div)return this.div;let t,s;this._isCopy&&(t=this.x,s=this.y);const i=super.render();i.classList.add("draw");const r=document.createElement("div");return i.append(r),r.setAttribute("aria-hidden","true"),r.className="internal",this.setDims(),this._uiManager.addShouldRescale(this),this.disableEditing(),this._isCopy&&this._moveAfterPaste(t,s),i}static createDrawerInstance(t,s,i,r,a){Ce("Not implemented")}static startDrawing(t,s,i,r){var S;const{target:a,offsetX:l,offsetY:c,pointerId:u,pointerType:d}=r;if(ts.isInitializedAndDifferentPointerType(d))return;const{viewport:{rotation:h}}=t,{width:f,height:p}=a.getBoundingClientRect(),v=m(ge,jl,new AbortController),b=t.combinedSignal(v);if(ts.setPointer(d,u),window.addEventListener("pointerup",y=>{ts.isSamePointerIdOrRemove(y.pointerId)&&this._endDraw(y)},{signal:b}),window.addEventListener("pointercancel",y=>{ts.isSamePointerIdOrRemove(y.pointerId)&&this._currentParent.endDrawingSession()},{signal:b}),window.addEventListener("pointerdown",y=>{ts.isSamePointerType(y.pointerType)&&(ts.initializeAndAddPointerId(y.pointerId),o(ge,Lt).isCancellable()&&(o(ge,Lt).removeLastElement(),o(ge,Lt).isEmpty()?this._currentParent.endDrawingSession(!0):this._endDraw(null)))},{capture:!0,passive:!1,signal:b}),window.addEventListener("contextmenu",zn,{signal:b}),a.addEventListener("pointermove",this._drawMove.bind(this),{signal:b}),a.addEventListener("touchmove",y=>{ts.isSameTimeStamp(y.timeStamp)&&ut(y)},{signal:b}),t.toggleDrawing(),(S=s._editorUndoBar)==null||S.hide(),o(ge,Lt)){t.drawLayer.updateProperties(this._currentDrawId,o(ge,Lt).startNew(l,c,f,p,h));return}s.updateUIForDefaultProperties(this),m(ge,Lt,this.createDrawerInstance(l,c,f,p,h)),m(ge,Ol,this.getDefaultDrawingOptions()),this._currentParent=t,{id:this._currentDrawId}=t.drawLayer.draw(this._mergeSVGProperties(o(ge,Ol).toSVGProperties(),o(ge,Lt).defaultSVGProperties),!0,!1)}static _drawMove(t){if(ts.isSameTimeStamp(t.timeStamp),!o(ge,Lt))return;const{offsetX:s,offsetY:i,pointerId:r}=t;if(ts.isSamePointerId(r)){if(ts.isUsingMultiplePointers()){this._endDraw(t);return}this._currentParent.drawLayer.updateProperties(this._currentDrawId,o(ge,Lt).add(s,i)),ts.setTimeStamp(t.timeStamp),ut(t)}}static _cleanup(t){t&&(this._currentDrawId=-1,this._currentParent=null,m(ge,Lt,null),m(ge,Ol,null),ts.clearTimeStamp()),o(ge,jl)&&(o(ge,jl).abort(),m(ge,jl,null),ts.clearPointerIds())}static _endDraw(t){const s=this._currentParent;if(s){if(s.toggleDrawing(!0),this._cleanup(!1),(t==null?void 0:t.target)===s.div&&s.drawLayer.updateProperties(this._currentDrawId,o(ge,Lt).end(t.offsetX,t.offsetY)),this.supportMultipleDrawings){const i=o(ge,Lt),r=this._currentDrawId,a=i.getLastElement();s.addCommands({cmd:()=>{s.drawLayer.updateProperties(r,i.setLastElement(a))},undo:()=>{s.drawLayer.updateProperties(r,i.removeLastElement())},mustExec:!1,type:ve.DRAW_STEP});return}this.endDrawing(!1)}}static endDrawing(t){const s=this._currentParent;if(!s)return null;if(s.toggleDrawing(!0),s.cleanUndoStack(ve.DRAW_STEP),!o(ge,Lt).isEmpty()){const{pageDimensions:[i,r],scale:a}=s,l=s.createAndAddNewEditor({offsetX:0,offsetY:0},!1,{drawId:this._currentDrawId,drawOutlines:o(ge,Lt).getOutlines(i*a,r*a,a,this._INNER_MARGIN),drawingOptions:o(ge,Ol),mustBeCommitted:!t});return this._cleanup(!0),l}return s.drawLayer.remove(this._currentDrawId),this._cleanup(!0),null}createDrawingOptions(t){}static deserializeDraw(t,s,i,r,a,l){Ce("Not implemented")}static async deserialize(t,s,i){var h,f;const{rawDims:{pageWidth:r,pageHeight:a,pageX:l,pageY:c}}=s.viewport,u=this.deserializeDraw(l,c,r,a,this._INNER_MARGIN,t),d=await super.deserialize(t,s,i);return d.createDrawingOptions(t),A(h=d,be,Ux).call(h,{drawOutlines:u}),A(f=d,be,fh).call(f),d.onScaleChanging(),d.rotate(),d}serializeDraw(t){const[s,i]=this.pageTranslation,[r,a]=this.pageDimensions;return o(this,tn).serialize([s,i,r,a],t)}renderAnnotationElement(t){return t.updateEdited({rect:this.getPDFRect()}),null}static canCreateNewEmptyEditor(){return!1}};tn=new WeakMap,ld=new WeakMap,Lt=new WeakMap,jl=new WeakMap,Ol=new WeakMap,be=new WeakSet,Ux=function({drawOutlines:t,drawId:s,drawingOptions:i}){m(this,tn,t),this._drawingOptions||(this._drawingOptions=i),this.annotationElementId||this._uiManager.a11yAlert(`pdfjs-editor-${this.editorType}-added-alert`),s>=0?(this._drawId=s,this.parent.drawLayer.finalizeDraw(s,t.defaultProperties)):this._drawId=A(this,be,Hx).call(this,t,this.parent),A(this,be,ph).call(this,t.box)},Hx=function(t,s){const{id:i}=s.drawLayer.draw(ge._mergeSVGProperties(this._drawingOptions.toSVGProperties(),t.defaultSVGProperties),!1,!1);return i},$x=function(){this._drawId===null||!this.parent||(this.parent.drawLayer.remove(this._drawId),this._drawId=null,this._drawingOptions.reset())},fh=function(t=this.parent){if(!(this._drawId!==null&&this.parent===t)){if(this._drawId!==null){this.parent.drawLayer.updateParent(this._drawId,t.drawLayer);return}this._drawingOptions.updateAll(),this._drawId=A(this,be,Hx).call(this,o(this,tn),t)}},IC=function([t,s,i,r]){const{parentDimensions:[a,l],rotation:c}=this;switch(c){case 90:return[s,1-t,i*(l/a),r*(a/l)];case 180:return[1-t,1-s,i,r];case 270:return[1-s,t,i*(l/a),r*(a/l)];default:return[t,s,i,r]}},mg=function(){const{x:t,y:s,width:i,height:r,parentDimensions:[a,l],rotation:c}=this;switch(c){case 90:return[1-s,t,i*(a/l),r*(l/a)];case 180:return[1-t,1-s,i,r];case 270:return[s,1-t,i*(a/l),r*(l/a)];default:return[t,s,i,r]}},ph=function(t){[this.x,this.y,this.width,this.height]=A(this,be,IC).call(this,t),this.div&&(this.fixAndSetPosition(),this.setDims()),this._onResized()},wc=function(){const{x:t,y:s,width:i,height:r,rotation:a,parentRotation:l,parentDimensions:[c,u]}=this;switch((a*4+l)/90){case 1:return[1-s-r,t,r,i];case 2:return[1-t-i,1-s-r,i,r];case 3:return[s,1-t-i,r,i];case 4:return[t,s-i*(c/u),r*(u/c),i*(c/u)];case 5:return[1-s,t,i*(c/u),r*(u/c)];case 6:return[1-t-r*(u/c),1-s,r*(u/c),i*(c/u)];case 7:return[s-i*(c/u),1-t-r*(u/c),i*(c/u),r*(u/c)];case 8:return[t-i,s-r,i,r];case 9:return[1-s,t-i,r,i];case 10:return[1-t,1-s,i,r];case 11:return[s-r,1-t,r,i];case 12:return[t-r*(u/c),s,r*(u/c),i*(c/u)];case 13:return[1-s-i*(c/u),t-r*(u/c),i*(c/u),r*(u/c)];case 14:return[1-t,1-s-i*(c/u),r*(u/c),i*(c/u)];case 15:return[s,1-t,i*(c/u),r*(u/c)];default:return[t,s,i,r]}},M(ge,"_currentDrawId",-1),M(ge,"_currentParent",null),x(ge,Lt,null),x(ge,jl,null),x(ge,Ol,null),M(ge,"_INNER_MARGIN",3);let r0=ge;var Ii,Dt,It,Bl,cd,ds,Vt,Mn,zl,Ul,Hl,ud,gg;class QP{constructor(e,t,s,i,r,a){x(this,ud);x(this,Ii,new Float64Array(6));x(this,Dt);x(this,It);x(this,Bl);x(this,cd);x(this,ds);x(this,Vt,"");x(this,Mn,0);x(this,zl,new tm);x(this,Ul);x(this,Hl);m(this,Ul,s),m(this,Hl,i),m(this,Bl,r),m(this,cd,a),[e,t]=A(this,ud,gg).call(this,e,t);const l=m(this,Dt,[NaN,NaN,NaN,NaN,e,t]);m(this,ds,[e,t]),m(this,It,[{line:l,points:o(this,ds)}]),o(this,Ii).set(l,0)}updateProperty(e,t){e==="stroke-width"&&m(this,cd,t)}isEmpty(){return!o(this,It)||o(this,It).length===0}isCancellable(){return o(this,ds).length<=10}add(e,t){[e,t]=A(this,ud,gg).call(this,e,t);const[s,i,r,a]=o(this,Ii).subarray(2,6),l=e-r,c=t-a;return Math.hypot(o(this,Ul)*l,o(this,Hl)*c)<=2?null:(o(this,ds).push(e,t),isNaN(s)?(o(this,Ii).set([r,a,e,t],2),o(this,Dt).push(NaN,NaN,NaN,NaN,e,t),{path:{d:this.toSVGPath()}}):(isNaN(o(this,Ii)[0])&&o(this,Dt).splice(6,6),o(this,Ii).set([s,i,r,a,e,t],0),o(this,Dt).push(...H.createBezierPoints(s,i,r,a,e,t)),{path:{d:this.toSVGPath()}}))}end(e,t){const s=this.add(e,t);return s||(o(this,ds).length===2?{path:{d:this.toSVGPath()}}:null)}startNew(e,t,s,i,r){m(this,Ul,s),m(this,Hl,i),m(this,Bl,r),[e,t]=A(this,ud,gg).call(this,e,t);const a=m(this,Dt,[NaN,NaN,NaN,NaN,e,t]);m(this,ds,[e,t]);const l=o(this,It).at(-1);return l&&(l.line=new Float32Array(l.line),l.points=new Float32Array(l.points)),o(this,It).push({line:a,points:o(this,ds)}),o(this,Ii).set(a,0),m(this,Mn,0),this.toSVGPath(),null}getLastElement(){return o(this,It).at(-1)}setLastElement(e){return o(this,It)?(o(this,It).push(e),m(this,Dt,e.line),m(this,ds,e.points),m(this,Mn,0),{path:{d:this.toSVGPath()}}):o(this,zl).setLastElement(e)}removeLastElement(){if(!o(this,It))return o(this,zl).removeLastElement();o(this,It).pop(),m(this,Vt,"");for(let e=0,t=o(this,It).length;e<t;e++){const{line:s,points:i}=o(this,It)[e];m(this,Dt,s),m(this,ds,i),m(this,Mn,0),this.toSVGPath()}return{path:{d:o(this,Vt)}}}toSVGPath(){const e=H.svgRound(o(this,Dt)[4]),t=H.svgRound(o(this,Dt)[5]);if(o(this,ds).length===2)return m(this,Vt,`${o(this,Vt)} M ${e} ${t} Z`),o(this,Vt);if(o(this,ds).length<=6){const i=o(this,Vt).lastIndexOf("M");m(this,Vt,`${o(this,Vt).slice(0,i)} M ${e} ${t}`),m(this,Mn,6)}if(o(this,ds).length===4){const i=H.svgRound(o(this,Dt)[10]),r=H.svgRound(o(this,Dt)[11]);return m(this,Vt,`${o(this,Vt)} L ${i} ${r}`),m(this,Mn,12),o(this,Vt)}const s=[];o(this,Mn)===0&&(s.push(`M ${e} ${t}`),m(this,Mn,6));for(let i=o(this,Mn),r=o(this,Dt).length;i<r;i+=6){const[a,l,c,u,d,h]=o(this,Dt).slice(i,i+6).map(H.svgRound);s.push(`C${a} ${l} ${c} ${u} ${d} ${h}`)}return m(this,Vt,o(this,Vt)+s.join(" ")),m(this,Mn,o(this,Dt).length),o(this,Vt)}getOutlines(e,t,s,i){const r=o(this,It).at(-1);return r.line=new Float32Array(r.line),r.points=new Float32Array(r.points),o(this,zl).build(o(this,It),e,t,s,o(this,Bl),o(this,cd),i),m(this,Ii,null),m(this,Dt,null),m(this,It,null),m(this,Vt,null),o(this,zl)}get defaultSVGProperties(){return{root:{viewBox:"0 0 10000 10000"},rootClass:{draw:!0},bbox:[0,0,1,1]}}}Ii=new WeakMap,Dt=new WeakMap,It=new WeakMap,Bl=new WeakMap,cd=new WeakMap,ds=new WeakMap,Vt=new WeakMap,Mn=new WeakMap,zl=new WeakMap,Ul=new WeakMap,Hl=new WeakMap,ud=new WeakSet,gg=function(e,t){return H._normalizePoint(e,t,o(this,Ul),o(this,Hl),o(this,Bl))};var hs,$p,Vp,sn,Ri,Fi,dd,hd,$l,Yt,qi,RC,FC,jC;class tm extends H{constructor(){super(...arguments);x(this,Yt);x(this,hs);x(this,$p,0);x(this,Vp);x(this,sn);x(this,Ri);x(this,Fi);x(this,dd);x(this,hd);x(this,$l)}build(t,s,i,r,a,l,c){m(this,Ri,s),m(this,Fi,i),m(this,dd,r),m(this,hd,a),m(this,$l,l),m(this,Vp,c??0),m(this,sn,t),A(this,Yt,FC).call(this)}get thickness(){return o(this,$l)}setLastElement(t){return o(this,sn).push(t),{path:{d:this.toSVGPath()}}}removeLastElement(){return o(this,sn).pop(),{path:{d:this.toSVGPath()}}}toSVGPath(){const t=[];for(const{line:s}of o(this,sn)){if(t.push(`M${H.svgRound(s[4])} ${H.svgRound(s[5])}`),s.length===6){t.push("Z");continue}if(s.length===12&&isNaN(s[6])){t.push(`L${H.svgRound(s[10])} ${H.svgRound(s[11])}`);continue}for(let i=6,r=s.length;i<r;i+=6){const[a,l,c,u,d,h]=s.subarray(i,i+6).map(H.svgRound);t.push(`C${a} ${l} ${c} ${u} ${d} ${h}`)}}return t.join("")}serialize([t,s,i,r],a){const l=[],c=[],[u,d,h,f]=A(this,Yt,RC).call(this);let p,v,b,S,y,k,w,E,C;switch(o(this,hd)){case 0:C=H._rescale,p=t,v=s+r,b=i,S=-r,y=t+u*i,k=s+(1-d-f)*r,w=t+(u+h)*i,E=s+(1-d)*r;break;case 90:C=H._rescaleAndSwap,p=t,v=s,b=i,S=r,y=t+d*i,k=s+u*r,w=t+(d+f)*i,E=s+(u+h)*r;break;case 180:C=H._rescale,p=t+i,v=s,b=-i,S=r,y=t+(1-u-h)*i,k=s+d*r,w=t+(1-u)*i,E=s+(d+f)*r;break;case 270:C=H._rescaleAndSwap,p=t+i,v=s+r,b=-i,S=-r,y=t+(1-d-f)*i,k=s+(1-u-h)*r,w=t+(1-d)*i,E=s+(1-u)*r;break}for(const{line:T,points:_}of o(this,sn))l.push(C(T,p,v,b,S,a?new Array(T.length):null)),c.push(C(_,p,v,b,S,a?new Array(_.length):null));return{lines:l,points:c,rect:[y,k,w,E]}}static deserialize(t,s,i,r,a,{paths:{lines:l,points:c},rotation:u,thickness:d}){const h=[];let f,p,v,b,S;switch(u){case 0:S=H._rescale,f=-t/i,p=s/r+1,v=1/i,b=-1/r;break;case 90:S=H._rescaleAndSwap,f=-s/r,p=-t/i,v=1/r,b=1/i;break;case 180:S=H._rescale,f=t/i+1,p=-s/r,v=-1/i,b=1/r;break;case 270:S=H._rescaleAndSwap,f=s/r+1,p=t/i+1,v=-1/r,b=-1/i;break}if(!l){l=[];for(const k of c){const w=k.length;if(w===2){l.push(new Float32Array([NaN,NaN,NaN,NaN,k[0],k[1]]));continue}if(w===4){l.push(new Float32Array([NaN,NaN,NaN,NaN,k[0],k[1],NaN,NaN,NaN,NaN,k[2],k[3]]));continue}const E=new Float32Array(3*(w-2));l.push(E);let[C,T,_,P]=k.subarray(0,4);E.set([NaN,NaN,NaN,NaN,C,T],0);for(let D=4;D<w;D+=2){const I=k[D],F=k[D+1];E.set(H.createBezierPoints(C,T,_,P,I,F),(D-2)*3),[C,T,_,P]=[_,P,I,F]}}}for(let k=0,w=l.length;k<w;k++)h.push({line:S(l[k].map(E=>E??NaN),f,p,v,b),points:S(c[k].map(E=>E??NaN),f,p,v,b)});const y=new this.prototype.constructor;return y.build(h,i,r,1,u,d,a),y}get box(){return o(this,hs)}updateProperty(t,s){return t==="stroke-width"?A(this,Yt,jC).call(this,s):null}updateParentDimensions([t,s],i){const[r,a]=A(this,Yt,qi).call(this);m(this,Ri,t),m(this,Fi,s),m(this,dd,i);const[l,c]=A(this,Yt,qi).call(this),u=l-r,d=c-a,h=o(this,hs);return h[0]-=u,h[1]-=d,h[2]+=2*u,h[3]+=2*d,h}updateRotation(t){return m(this,$p,t),{path:{transform:this.rotationTransform}}}get viewBox(){return o(this,hs).map(H.svgRound).join(" ")}get defaultProperties(){const[t,s]=o(this,hs);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${H.svgRound(t)} ${H.svgRound(s)}`}}}get rotationTransform(){const[,,t,s]=o(this,hs);let i=0,r=0,a=0,l=0,c=0,u=0;switch(o(this,$p)){case 90:r=s/t,a=-t/s,c=t;break;case 180:i=-1,l=-1,c=t,u=s;break;case 270:r=-s/t,a=t/s,u=s;break;default:return""}return`matrix(${i} ${r} ${a} ${l} ${H.svgRound(c)} ${H.svgRound(u)})`}getPathResizingSVGProperties([t,s,i,r]){const[a,l]=A(this,Yt,qi).call(this),[c,u,d,h]=o(this,hs);if(Math.abs(d-a)<=H.PRECISION||Math.abs(h-l)<=H.PRECISION){const S=t+i/2-(c+d/2),y=s+r/2-(u+h/2);return{path:{"transform-origin":`${H.svgRound(t)} ${H.svgRound(s)}`,transform:`${this.rotationTransform} translate(${S} ${y})`}}}const f=(i-2*a)/(d-2*a),p=(r-2*l)/(h-2*l),v=d/i,b=h/r;return{path:{"transform-origin":`${H.svgRound(c)} ${H.svgRound(u)}`,transform:`${this.rotationTransform} scale(${v} ${b}) translate(${H.svgRound(a)} ${H.svgRound(l)}) scale(${f} ${p}) translate(${H.svgRound(-a)} ${H.svgRound(-l)})`}}}getPathResizedSVGProperties([t,s,i,r]){const[a,l]=A(this,Yt,qi).call(this),c=o(this,hs),[u,d,h,f]=c;if(c[0]=t,c[1]=s,c[2]=i,c[3]=r,Math.abs(h-a)<=H.PRECISION||Math.abs(f-l)<=H.PRECISION){const y=t+i/2-(u+h/2),k=s+r/2-(d+f/2);for(const{line:w,points:E}of o(this,sn))H._translate(w,y,k,w),H._translate(E,y,k,E);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${H.svgRound(t)} ${H.svgRound(s)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}const p=(i-2*a)/(h-2*a),v=(r-2*l)/(f-2*l),b=-p*(u+a)+t+a,S=-v*(d+l)+s+l;if(p!==1||v!==1||b!==0||S!==0)for(const{line:y,points:k}of o(this,sn))H._rescale(y,b,S,p,v,y),H._rescale(k,b,S,p,v,k);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${H.svgRound(t)} ${H.svgRound(s)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}getPathTranslatedSVGProperties([t,s],i){const[r,a]=i,l=o(this,hs),c=t-l[0],u=s-l[1];if(o(this,Ri)===r&&o(this,Fi)===a)for(const{line:d,points:h}of o(this,sn))H._translate(d,c,u,d),H._translate(h,c,u,h);else{const d=o(this,Ri)/r,h=o(this,Fi)/a;m(this,Ri,r),m(this,Fi,a);for(const{line:f,points:p}of o(this,sn))H._rescale(f,c,u,d,h,f),H._rescale(p,c,u,d,h,p);l[2]*=d,l[3]*=h}return l[0]=t,l[1]=s,{root:{viewBox:this.viewBox},path:{d:this.toSVGPath(),"transform-origin":`${H.svgRound(t)} ${H.svgRound(s)}`}}}get defaultSVGProperties(){const t=o(this,hs);return{root:{viewBox:this.viewBox},rootClass:{draw:!0},path:{d:this.toSVGPath(),"transform-origin":`${H.svgRound(t[0])} ${H.svgRound(t[1])}`,transform:this.rotationTransform||null},bbox:t}}}hs=new WeakMap,$p=new WeakMap,Vp=new WeakMap,sn=new WeakMap,Ri=new WeakMap,Fi=new WeakMap,dd=new WeakMap,hd=new WeakMap,$l=new WeakMap,Yt=new WeakSet,qi=function(t=o(this,$l)){const s=o(this,Vp)+t/2*o(this,dd);return o(this,hd)%180===0?[s/o(this,Ri),s/o(this,Fi)]:[s/o(this,Fi),s/o(this,Ri)]},RC=function(){const[t,s,i,r]=o(this,hs),[a,l]=A(this,Yt,qi).call(this,0);return[t+a,s+l,i-2*a,r-2*l]},FC=function(){const t=m(this,hs,new Float32Array([1/0,1/0,-1/0,-1/0]));for(const{line:r}of o(this,sn)){if(r.length<=12){for(let c=4,u=r.length;c<u;c+=6)z.pointBoundingBox(r[c],r[c+1],t);continue}let a=r[4],l=r[5];for(let c=6,u=r.length;c<u;c+=6){const[d,h,f,p,v,b]=r.subarray(c,c+6);z.bezierBoundingBox(a,l,d,h,f,p,v,b,t),a=v,l=b}}const[s,i]=A(this,Yt,qi).call(this);t[0]=Gt(t[0]-s,0,1),t[1]=Gt(t[1]-i,0,1),t[2]=Gt(t[2]+s,0,1),t[3]=Gt(t[3]+i,0,1),t[2]-=t[0],t[3]-=t[1]},jC=function(t){const[s,i]=A(this,Yt,qi).call(this);m(this,$l,t);const[r,a]=A(this,Yt,qi).call(this),[l,c]=[r-s,a-i],u=o(this,hs);return u[0]-=l,u[1]-=c,u[2]+=2*l,u[3]+=2*c,u};class Q0 extends DC{constructor(e){super(),this._viewParameters=e,super.updateProperties({fill:"none",stroke:Ve._defaultLineColor,"stroke-opacity":1,"stroke-width":1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-miterlimit":10})}updateSVGProperty(e,t){e==="stroke-width"&&(t??(t=this["stroke-width"]),t*=this._viewParameters.realScale),super.updateSVGProperty(e,t)}clone(){const e=new Q0(this._viewParameters);return e.updateAll(this),e}}var k0,OC;const Bc=class Bc extends r0{constructor(t){super({...t,name:"inkEditor"});x(this,k0);this._willKeepAspectRatio=!0,this.defaultL10nId="pdfjs-editor-ink-editor"}static initialize(t,s){Ve.initialize(t,s),this._defaultDrawingOptions=new Q0(s.viewParameters)}static getDefaultDrawingOptions(t){const s=this._defaultDrawingOptions.clone();return s.updateProperties(t),s}static get supportMultipleDrawings(){return!0}static get typesMap(){return ie(this,"typesMap",new Map([[ve.INK_THICKNESS,"stroke-width"],[ve.INK_COLOR,"stroke"],[ve.INK_OPACITY,"stroke-opacity"]]))}static createDrawerInstance(t,s,i,r,a){return new QP(t,s,i,r,a,this._defaultDrawingOptions["stroke-width"])}static deserializeDraw(t,s,i,r,a,l){return tm.deserialize(t,s,i,r,a,l)}static async deserialize(t,s,i){let r=null;if(t instanceof aw){const{data:{inkLists:l,rect:c,rotation:u,id:d,color:h,opacity:f,borderStyle:{rawWidth:p},popupRef:v,richText:b,contentsObj:S,creationDate:y,modificationDate:k},parent:{page:{pageNumber:w}}}=t;r=t={annotationType:oe.INK,color:Array.from(h),thickness:p,opacity:f,paths:{points:l},boxes:null,pageIndex:w-1,rect:c.slice(0),rotation:u,annotationElementId:d,id:d,deleted:!1,popupRef:v,richText:b,comment:(S==null?void 0:S.str)||null,creationDate:y,modificationDate:k}}const a=await super.deserialize(t,s,i);return a._initialData=r,t.comment&&a.setCommentData(t),a}get toolbarButtons(){return this._colorPicker||(this._colorPicker=new t0(this)),[["colorPicker",this._colorPicker]]}get colorType(){return ve.INK_COLOR}get color(){return this._drawingOptions.stroke}get opacity(){return this._drawingOptions["stroke-opacity"]}onScaleChanging(){if(!this.parent)return;super.onScaleChanging();const{_drawId:t,_drawingOptions:s,parent:i}=this;s.updateSVGProperty("stroke-width"),i.drawLayer.updateProperties(t,s.toSVGProperties())}static onScaleChangingWhenDrawing(){const t=this._currentParent;t&&(super.onScaleChangingWhenDrawing(),this._defaultDrawingOptions.updateSVGProperty("stroke-width"),t.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}createDrawingOptions({color:t,thickness:s,opacity:i}){this._drawingOptions=Bc.getDefaultDrawingOptions({stroke:z.makeHexColor(...t),"stroke-width":s,"stroke-opacity":i})}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const{lines:s,points:i}=this.serializeDraw(t),{_drawingOptions:{stroke:r,"stroke-opacity":a,"stroke-width":l}}=this,c=Object.assign(super.serialize(t),{color:Ve._colorManager.convert(r),opacity:a,thickness:l,paths:{lines:s,points:i}});return this.addComment(c),t?(c.isCopy=!0,c):this.annotationElementId&&!A(this,k0,OC).call(this,c)?null:(c.id=this.annotationElementId,c)}renderAnnotationElement(t){if(this.deleted)return t.hide(),null;const{points:s,rect:i}=this.serializeDraw(!1);return t.updateEdited({rect:i,thickness:this._drawingOptions["stroke-width"],points:s,popup:this.comment}),null}};k0=new WeakSet,OC=function(t){const{color:s,thickness:i,opacity:r,pageIndex:a}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||this._hasBeenResized||t.color.some((l,c)=>l!==s[c])||t.thickness!==i||t.opacity!==r||t.pageIndex!==a},M(Bc,"_type","ink"),M(Bc,"_editorType",oe.INK),M(Bc,"_defaultDrawingOptions",null);let Vx=Bc;class Wx extends tm{toSVGPath(){let e=super.toSVGPath();return e.endsWith("Z")||(e+="Z"),e}}const Nm=8,Wd=3;var Vl,Te,Gx,si,BC,zC,Xx,vg,UC,HC,$C,Yx,qx,VC;class jr{static extractContoursFromText(e,{fontFamily:t,fontStyle:s,fontWeight:i},r,a,l,c){let u=new OffscreenCanvas(1,1),d=u.getContext("2d",{alpha:!1});const h=200,f=d.font=`${s} ${i} ${h}px ${t}`,{actualBoundingBoxLeft:p,actualBoundingBoxRight:v,actualBoundingBoxAscent:b,actualBoundingBoxDescent:S,fontBoundingBoxAscent:y,fontBoundingBoxDescent:k,width:w}=d.measureText(e),E=1.5,C=Math.ceil(Math.max(Math.abs(p)+Math.abs(v)||0,w)*E),T=Math.ceil(Math.max(Math.abs(b)+Math.abs(S)||h,Math.abs(y)+Math.abs(k)||h)*E);u=new OffscreenCanvas(C,T),d=u.getContext("2d",{alpha:!0,willReadFrequently:!0}),d.font=f,d.filter="grayscale(1)",d.fillStyle="white",d.fillRect(0,0,C,T),d.fillStyle="black",d.fillText(e,C*(E-1)/2,T*(3-E)/2);const _=A(this,Te,Yx).call(this,d.getImageData(0,0,C,T).data),P=A(this,Te,$C).call(this,_),D=A(this,Te,qx).call(this,P),I=A(this,Te,Xx).call(this,_,C,T,D);return this.processDrawnLines({lines:{curves:I,width:C,height:T},pageWidth:r,pageHeight:a,rotation:l,innerMargin:c,mustSmooth:!0,areContours:!0})}static process(e,t,s,i,r){const[a,l,c]=A(this,Te,VC).call(this,e),[u,d]=A(this,Te,HC).call(this,a,l,c,Math.hypot(l,c)*o(this,Vl).sigmaSFactor,o(this,Vl).sigmaR,o(this,Vl).kernelSize),h=A(this,Te,qx).call(this,d),f=A(this,Te,Xx).call(this,u,l,c,h);return this.processDrawnLines({lines:{curves:f,width:l,height:c},pageWidth:t,pageHeight:s,rotation:i,innerMargin:r,mustSmooth:!0,areContours:!0})}static processDrawnLines({lines:e,pageWidth:t,pageHeight:s,rotation:i,innerMargin:r,mustSmooth:a,areContours:l}){i%180!==0&&([t,s]=[s,t]);const{curves:c,width:u,height:d}=e,h=e.thickness??0,f=[],p=Math.min(t/u,s/d),v=p/t,b=p/s,S=[];for(const{points:k}of c){const w=a?A(this,Te,UC).call(this,k):k;if(!w)continue;S.push(w);const E=w.length,C=new Float32Array(E),T=new Float32Array(3*(E===2?2:E-2));if(f.push({line:T,points:C}),E===2){C[0]=w[0]*v,C[1]=w[1]*b,T.set([NaN,NaN,NaN,NaN,C[0],C[1]],0);continue}let[_,P,D,I]=w;_*=v,P*=b,D*=v,I*=b,C.set([_,P,D,I],0),T.set([NaN,NaN,NaN,NaN,_,P],0);for(let F=4;F<E;F+=2){const K=C[F]=w[F]*v,Z=C[F+1]=w[F+1]*b;T.set(H.createBezierPoints(_,P,D,I,K,Z),(F-2)*3),[_,P,D,I]=[D,I,K,Z]}}if(f.length===0)return null;const y=l?new Wx:new tm;return y.build(f,t,s,1,i,l?0:h,r),{outline:y,newCurves:S,areContours:l,thickness:h,width:u,height:d}}static async compressSignature({outlines:e,areContours:t,thickness:s,width:i,height:r}){let a=1/0,l=-1/0,c=0;for(const w of e){c+=w.length;for(let E=2,C=w.length;E<C;E++){const T=w[E]-w[E-2];a=Math.min(a,T),l=Math.max(l,T)}}let u;a>=-128&&l<=127?u=Int8Array:a>=-32768&&l<=32767?u=Int16Array:u=Int32Array;const d=e.length,h=Nm+Wd*d,f=new Uint32Array(h);let p=0;f[p++]=h*Uint32Array.BYTES_PER_ELEMENT+(c-2*d)*u.BYTES_PER_ELEMENT,f[p++]=0,f[p++]=i,f[p++]=r,f[p++]=t?0:1,f[p++]=Math.max(0,Math.floor(s??0)),f[p++]=d,f[p++]=u.BYTES_PER_ELEMENT;for(const w of e)f[p++]=w.length-2,f[p++]=w[0],f[p++]=w[1];const v=new CompressionStream("deflate-raw"),b=v.writable.getWriter();await b.ready,b.write(f);const S=u.prototype.constructor;for(const w of e){const E=new S(w.length-2);for(let C=2,T=w.length;C<T;C++)E[C-2]=w[C]-w[C-2];b.write(E)}b.close();const y=await new Response(v.readable).arrayBuffer();return new Uint8Array(y).toBase64()}static async decompressSignature(e){try{const t=Uint8Array.fromBase64(e),{readable:s,writable:i}=new DecompressionStream("deflate-raw"),r=i.getWriter();await r.ready,r.write(t).then(async()=>{await r.ready,await r.close()}).catch(()=>{});let a=null,l=0;for await(const w of s)a||(a=new Uint8Array(new Uint32Array(w.buffer,0,4)[0])),a.set(w,l),l+=w.length;const c=new Uint32Array(a.buffer,0,a.length>>2),u=c[1];if(u!==0)throw new Error(`Invalid version: ${u}`);const d=c[2],h=c[3],f=c[4]===0,p=c[5],v=c[6],b=c[7],S=[],y=(Nm+Wd*v)*Uint32Array.BYTES_PER_ELEMENT;let k;switch(b){case Int8Array.BYTES_PER_ELEMENT:k=new Int8Array(a.buffer,y);break;case Int16Array.BYTES_PER_ELEMENT:k=new Int16Array(a.buffer,y);break;case Int32Array.BYTES_PER_ELEMENT:k=new Int32Array(a.buffer,y);break}l=0;for(let w=0;w<v;w++){const E=c[Wd*w+Nm],C=new Float32Array(E+2);S.push(C);for(let T=0;T<Wd-1;T++)C[T]=c[Wd*w+Nm+T+1];for(let T=0;T<E;T++)C[T+2]=C[T]+k[l++]}return{areContours:f,thickness:p,outlines:S,width:d,height:h}}catch(t){return ne(`decompressSignature: ${t}`),null}}}Vl=new WeakMap,Te=new WeakSet,Gx=function(e,t,s,i){return s-=e,i-=t,s===0?i>0?0:4:s===1?i+6:2-i},si=new WeakMap,BC=function(e,t,s,i,r,a,l){const c=A(this,Te,Gx).call(this,s,i,r,a);for(let u=0;u<8;u++){const d=(-u+c-l+16)%8,h=o(this,si)[2*d],f=o(this,si)[2*d+1];if(e[(s+h)*t+(i+f)]!==0)return d}return-1},zC=function(e,t,s,i,r,a,l){const c=A(this,Te,Gx).call(this,s,i,r,a);for(let u=0;u<8;u++){const d=(u+c+l+16)%8,h=o(this,si)[2*d],f=o(this,si)[2*d+1];if(e[(s+h)*t+(i+f)]!==0)return d}return-1},Xx=function(e,t,s,i){const r=e.length,a=new Int32Array(r);for(let d=0;d<r;d++)a[d]=e[d]<=i?1:0;for(let d=1;d<s-1;d++)a[d*t]=a[d*t+t-1]=0;for(let d=0;d<t;d++)a[d]=a[t*s-1-d]=0;let l=1,c;const u=[];for(let d=1;d<s-1;d++){c=1;for(let h=1;h<t-1;h++){const f=d*t+h,p=a[f];if(p===0)continue;let v=d,b=h;if(p===1&&a[f-1]===0)l+=1,b-=1;else if(p>=1&&a[f+1]===0)l+=1,b+=1,p>1&&(c=p);else{p!==1&&(c=Math.abs(p));continue}const S=[h,d],y=b===h+1,k={isHole:y,points:S,id:l,parent:0};u.push(k);let w;for(const F of u)if(F.id===c){w=F;break}w?w.isHole?k.parent=y?w.parent:c:k.parent=y?c:w.parent:k.parent=y?c:0;const E=A(this,Te,BC).call(this,a,t,d,h,v,b,0);if(E===-1){a[f]=-l,a[f]!==1&&(c=Math.abs(a[f]));continue}let C=o(this,si)[2*E],T=o(this,si)[2*E+1];const _=d+C,P=h+T;v=_,b=P;let D=d,I=h;for(;;){const F=A(this,Te,zC).call(this,a,t,D,I,v,b,1);C=o(this,si)[2*F],T=o(this,si)[2*F+1];const K=D+C,Z=I+T;S.push(Z,K);const Q=D*t+I;if(a[Q+1]===0?a[Q]=-l:a[Q]===1&&(a[Q]=l),K===d&&Z===h&&D===_&&I===P){a[f]!==1&&(c=Math.abs(a[f]));break}else v=D,b=I,D=K,I=Z}}}return u},vg=function(e,t,s,i){if(s-t<=4){for(let _=t;_<s-2;_+=2)i.push(e[_],e[_+1]);return}const r=e[t],a=e[t+1],l=e[s-4]-r,c=e[s-3]-a,u=Math.hypot(l,c),d=l/u,h=c/u,f=d*a-h*r,p=c/l,v=1/u,b=Math.atan(p),S=Math.cos(b),y=Math.sin(b),k=v*(Math.abs(S)+Math.abs(y)),w=v*(1-k+k**2),E=Math.max(Math.atan(Math.abs(y+S)*w),Math.atan(Math.abs(y-S)*w));let C=0,T=t;for(let _=t+2;_<s-2;_+=2){const P=Math.abs(f-d*e[_+1]+h*e[_]);P>C&&(T=_,C=P)}C>(u*E)**2?(A(this,Te,vg).call(this,e,t,T+2,i),A(this,Te,vg).call(this,e,T,s,i)):i.push(r,a)},UC=function(e){const t=[],s=e.length;return A(this,Te,vg).call(this,e,0,s,t),t.push(e[s-2],e[s-1]),t.length<=4?null:t},HC=function(e,t,s,i,r,a){const l=new Float32Array(a**2),c=-2*i**2,u=a>>1;for(let b=0;b<a;b++){const S=(b-u)**2;for(let y=0;y<a;y++)l[b*a+y]=Math.exp((S+(y-u)**2)/c)}const d=new Float32Array(256),h=-2*r**2;for(let b=0;b<256;b++)d[b]=Math.exp(b**2/h);const f=e.length,p=new Uint8Array(f),v=new Uint32Array(256);for(let b=0;b<s;b++)for(let S=0;S<t;S++){const y=b*t+S,k=e[y];let w=0,E=0;for(let T=0;T<a;T++){const _=b+T-u;if(!(_<0||_>=s))for(let P=0;P<a;P++){const D=S+P-u;if(D<0||D>=t)continue;const I=e[_*t+D],F=l[T*a+P]*d[Math.abs(I-k)];w+=I*F,E+=F}}const C=p[y]=Math.round(w/E);v[C]++}return[p,v]},$C=function(e){const t=new Uint32Array(256);for(const s of e)t[s]++;return t},Yx=function(e){const t=e.length,s=new Uint8ClampedArray(t>>2);let i=-1/0,r=1/0;for(let l=0,c=s.length;l<c;l++){const u=s[l]=e[l<<2];i=Math.max(i,u),r=Math.min(r,u)}const a=255/(i-r);for(let l=0,c=s.length;l<c;l++)s[l]=(s[l]-r)*a;return s},qx=function(e){let t,s=-1/0,i=-1/0;const r=e.findIndex(c=>c!==0);let a=r,l=r;for(t=r;t<256;t++){const c=e[t];c>s&&(t-a>i&&(i=t-a,l=t-1),s=c,a=t)}for(t=l-1;t>=0&&!(e[t]>e[t+1]);t--);return t},VC=function(e){const t=e,{width:s,height:i}=e,{maxDim:r}=o(this,Vl);let a=s,l=i;if(s>r||i>r){let f=s,p=i,v=Math.log2(Math.max(s,i)/r);const b=Math.floor(v);v=v===b?b-1:b;for(let y=0;y<v;y++){a=Math.ceil(f/2),l=Math.ceil(p/2);const k=new OffscreenCanvas(a,l);k.getContext("2d").drawImage(e,0,0,f,p,0,0,a,l),f=a,p=l,e!==t&&e.close(),e=k.transferToImageBitmap()}const S=Math.min(r/a,r/l);a=Math.round(a*S),l=Math.round(l*S)}const u=new OffscreenCanvas(a,l).getContext("2d",{willReadFrequently:!0});u.fillStyle="white",u.fillRect(0,0,a,l),u.filter="grayscale(1)",u.drawImage(e,0,0,e.width,e.height,0,0,a,l);const d=u.getImageData(0,0,a,l).data;return[A(this,Te,Yx).call(this,d),a,l]},x(jr,Te),x(jr,Vl,{maxDim:512,sigmaSFactor:.02,sigmaR:25,kernelSize:16}),x(jr,si,new Int32Array([0,1,-1,1,-1,0,-1,-1,0,-1,1,-1,1,0,1,1]));class lw extends DC{constructor(){super(),super.updateProperties({fill:Ve._defaultLineColor,"stroke-width":0})}clone(){const e=new lw;return e.updateAll(this),e}}class cw extends Q0{constructor(e){super(e),super.updateProperties({stroke:Ve._defaultLineColor,"stroke-width":1})}clone(){const e=new cw(this._viewParameters);return e.updateAll(this),e}}var Ko,ji,Qo,Wl;const Os=class Os extends r0{constructor(t){super({...t,mustBeCommitted:!0,name:"signatureEditor"});x(this,Ko,!1);x(this,ji,null);x(this,Qo,null);x(this,Wl,null);this._willKeepAspectRatio=!0,m(this,Qo,t.signatureData||null),m(this,ji,null),this.defaultL10nId="pdfjs-editor-signature-editor1"}static initialize(t,s){Ve.initialize(t,s),this._defaultDrawingOptions=new lw,this._defaultDrawnSignatureOptions=new cw(s.viewParameters)}static getDefaultDrawingOptions(t){const s=this._defaultDrawingOptions.clone();return s.updateProperties(t),s}static get supportMultipleDrawings(){return!1}static get typesMap(){return ie(this,"typesMap",new Map)}static get isDrawer(){return!1}get telemetryFinalData(){return{type:"signature",hasDescription:!!o(this,ji)}}static computeTelemetryFinalData(t){const s=t.get("hasDescription");return{hasAltText:s.get(!0)??0,hasNoAltText:s.get(!1)??0}}get isResizable(){return!0}onScaleChanging(){this._drawId!==null&&super.onScaleChanging()}render(){if(this.div)return this.div;let t,s;const{_isCopy:i}=this;if(i&&(this._isCopy=!1,t=this.x,s=this.y),super.render(),this._drawId===null)if(o(this,Qo)){const{lines:r,mustSmooth:a,areContours:l,description:c,uuid:u,heightInPage:d}=o(this,Qo),{rawDims:{pageWidth:h,pageHeight:f},rotation:p}=this.parent.viewport,v=jr.processDrawnLines({lines:r,pageWidth:h,pageHeight:f,rotation:p,innerMargin:Os._INNER_MARGIN,mustSmooth:a,areContours:l});this.addSignature(v,d,c,u)}else this.div.setAttribute("data-l10n-args",JSON.stringify({description:""})),this.div.hidden=!0,this._uiManager.getSignature(this);else this.div.setAttribute("data-l10n-args",JSON.stringify({description:o(this,ji)||""}));return i&&(this._isCopy=!0,this._moveAfterPaste(t,s)),this.div}setUuid(t){m(this,Wl,t),this.addEditToolbar()}getUuid(){return o(this,Wl)}get description(){return o(this,ji)}set description(t){m(this,ji,t),this.div&&(this.div.setAttribute("data-l10n-args",JSON.stringify({description:t})),super.addEditToolbar().then(s=>{s==null||s.updateEditSignatureButton(t)}))}getSignaturePreview(){const{newCurves:t,areContours:s,thickness:i,width:r,height:a}=o(this,Qo),l=Math.max(r,a),c=jr.processDrawnLines({lines:{curves:t.map(u=>({points:u})),thickness:i,width:r,height:a},pageWidth:l,pageHeight:l,rotation:0,innerMargin:0,mustSmooth:!1,areContours:s});return{areContours:s,outline:c.outline}}get toolbarButtons(){return this._uiManager.signatureManager?[["editSignature",this._uiManager.signatureManager]]:super.toolbarButtons}addSignature(t,s,i,r){const{x:a,y:l}=this,{outline:c}=m(this,Qo,t);m(this,Ko,c instanceof Wx),this.description=i;let u;o(this,Ko)?u=Os.getDefaultDrawingOptions():(u=Os._defaultDrawnSignatureOptions.clone(),u.updateProperties({"stroke-width":c.thickness})),this._addOutlines({drawOutlines:c,drawingOptions:u});const[,d]=this.pageDimensions;let h=s/d;h=h>=1?.5:h,this.width*=h/this.height,this.width>=1&&(h*=.9/this.width,this.width=.9),this.height=h,this.setDims(),this.x=a,this.y=l,this.center(),this._onResized(),this.onScaleChanging(),this.rotate(),this._uiManager.addToAnnotationStorage(this),this.setUuid(r),this._reportTelemetry({action:"pdfjs.signature.inserted",data:{hasBeenSaved:!!r,hasDescription:!!i}}),this.div.hidden=!1}getFromImage(t){const{rawDims:{pageWidth:s,pageHeight:i},rotation:r}=this.parent.viewport;return jr.process(t,s,i,r,Os._INNER_MARGIN)}getFromText(t,s){const{rawDims:{pageWidth:i,pageHeight:r},rotation:a}=this.parent.viewport;return jr.extractContoursFromText(t,s,i,r,a,Os._INNER_MARGIN)}getDrawnSignature(t){const{rawDims:{pageWidth:s,pageHeight:i},rotation:r}=this.parent.viewport;return jr.processDrawnLines({lines:t,pageWidth:s,pageHeight:i,rotation:r,innerMargin:Os._INNER_MARGIN,mustSmooth:!1,areContours:!1})}createDrawingOptions({areContours:t,thickness:s}){t?this._drawingOptions=Os.getDefaultDrawingOptions():(this._drawingOptions=Os._defaultDrawnSignatureOptions.clone(),this._drawingOptions.updateProperties({"stroke-width":s}))}serialize(t=!1){if(this.isEmpty())return null;const{lines:s,points:i}=this.serializeDraw(t),{_drawingOptions:{"stroke-width":r}}=this,a=Object.assign(super.serialize(t),{isSignature:!0,areContours:o(this,Ko),color:[0,0,0],thickness:o(this,Ko)?0:r});return this.addComment(a),t?(a.paths={lines:s,points:i},a.uuid=o(this,Wl),a.isCopy=!0):a.lines=s,o(this,ji)&&(a.accessibilityData={type:"Figure",alt:o(this,ji)}),a}static deserializeDraw(t,s,i,r,a,l){return l.areContours?Wx.deserialize(t,s,i,r,a,l):tm.deserialize(t,s,i,r,a,l)}static async deserialize(t,s,i){var a;const r=await super.deserialize(t,s,i);return m(r,Ko,t.areContours),r.description=((a=t.accessibilityData)==null?void 0:a.alt)||"",m(r,Wl,t.uuid),r}};Ko=new WeakMap,ji=new WeakMap,Qo=new WeakMap,Wl=new WeakMap,M(Os,"_type","signature"),M(Os,"_editorType",oe.SIGNATURE),M(Os,"_defaultDrawingOptions",null);let Kx=Os;var Ke,Rt,Jo,Lr,Zo,fd,Dr,Gl,Oi,nn,pd,we,mh,gh,yg,xg,bg,Jx,wg,WC;class Qx extends Ve{constructor(t){super({...t,name:"stampEditor"});x(this,we);x(this,Ke,null);x(this,Rt,null);x(this,Jo,null);x(this,Lr,null);x(this,Zo,null);x(this,fd,"");x(this,Dr,null);x(this,Gl,!1);x(this,Oi,null);x(this,nn,!1);x(this,pd,!1);m(this,Lr,t.bitmapUrl),m(this,Zo,t.bitmapFile),this.defaultL10nId="pdfjs-editor-stamp-editor"}static initialize(t,s){Ve.initialize(t,s)}static isHandlingMimeForPasting(t){return Iy.includes(t)}static paste(t,s){s.pasteEditor({mode:oe.STAMP},{bitmapFile:t.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){var t;return{type:"stamp",hasAltText:!!((t=this.altTextData)!=null&&t.altText)}}static computeTelemetryFinalData(t){const s=t.get("hasAltText");return{hasAltText:s.get(!0)??0,hasNoAltText:s.get(!1)??0}}async mlGuessAltText(t=null,s=!0){if(this.hasAltTextData())return null;const{mlManager:i}=this._uiManager;if(!i)throw new Error("No ML.");if(!await i.isEnabledFor("altText"))throw new Error("ML isn't enabled for alt text.");const{data:r,width:a,height:l}=t||this.copyCanvas(null,null,!0).imageData,c=await i.guess({name:"altText",request:{data:r,width:a,height:l,channels:r.length/(a*l)}});if(!c)throw new Error("No response from the AI service.");if(c.error)throw new Error("Error from the AI service.");if(c.cancel)return null;if(!c.output)throw new Error("No valid response from the AI service.");const u=c.output;return await this.setGuessedAltText(u),s&&!this.hasAltTextData()&&(this.altTextData={alt:u,decorative:!1}),u}remove(){var t;o(this,Rt)&&(m(this,Ke,null),this._uiManager.imageManager.deleteId(o(this,Rt)),(t=o(this,Dr))==null||t.remove(),m(this,Dr,null),o(this,Oi)&&(clearTimeout(o(this,Oi)),m(this,Oi,null))),super.remove()}rebuild(){if(!this.parent){o(this,Rt)&&A(this,we,yg).call(this);return}super.rebuild(),this.div!==null&&(o(this,Rt)&&o(this,Dr)===null&&A(this,we,yg).call(this),this.isAttachedToDOM||this.parent.add(this))}onceAdded(t){this._isDraggable=!0,t&&this.div.focus()}isEmpty(){return!(o(this,Jo)||o(this,Ke)||o(this,Lr)||o(this,Zo)||o(this,Rt)||o(this,Gl))}get toolbarButtons(){return[["altText",this.createAltText()]]}get isResizable(){return!0}render(){if(this.div)return this.div;let t,s;return this._isCopy&&(t=this.x,s=this.y),super.render(),this.div.hidden=!0,this.createAltText(),o(this,Gl)||(o(this,Ke)?A(this,we,xg).call(this):A(this,we,yg).call(this)),this._isCopy&&this._moveAfterPaste(t,s),this._uiManager.addShouldRescale(this),this.div}setCanvas(t,s){const{id:i,bitmap:r}=this._uiManager.imageManager.getFromCanvas(t,s);s.remove(),i&&this._uiManager.imageManager.isValidId(i)&&(m(this,Rt,i),r&&m(this,Ke,r),m(this,Gl,!1),A(this,we,xg).call(this))}_onResized(){this.onScaleChanging()}onScaleChanging(){if(!this.parent)return;o(this,Oi)!==null&&clearTimeout(o(this,Oi)),m(this,Oi,setTimeout(()=>{m(this,Oi,null),A(this,we,Jx).call(this)},200))}copyCanvas(t,s,i=!1){t||(t=224);const{width:r,height:a}=o(this,Ke),l=new $i;let c=o(this,Ke),u=r,d=a,h=null;if(s){if(r>s||a>s){const _=Math.min(s/r,s/a);u=Math.floor(r*_),d=Math.floor(a*_)}h=document.createElement("canvas");const p=h.width=Math.ceil(u*l.sx),v=h.height=Math.ceil(d*l.sy);o(this,nn)||(c=A(this,we,bg).call(this,p,v));const b=h.getContext("2d");b.filter=this._uiManager.hcmFilter;let S="white",y="#cfcfd8";this._uiManager.hcmFilter!=="none"?y="black":bN.isDarkMode&&(S="#8f8f9d",y="#42414d");const k=15,w=k*l.sx,E=k*l.sy,C=new OffscreenCanvas(w*2,E*2),T=C.getContext("2d");T.fillStyle=S,T.fillRect(0,0,w*2,E*2),T.fillStyle=y,T.fillRect(0,0,w,E),T.fillRect(w,E,w,E),b.fillStyle=b.createPattern(C,"repeat"),b.fillRect(0,0,p,v),b.drawImage(c,0,0,c.width,c.height,0,0,p,v)}let f=null;if(i){let p,v;if(l.symmetric&&c.width<t&&c.height<t)p=c.width,v=c.height;else if(c=o(this,Ke),r>t||a>t){const y=Math.min(t/r,t/a);p=Math.floor(r*y),v=Math.floor(a*y),o(this,nn)||(c=A(this,we,bg).call(this,p,v))}const S=new OffscreenCanvas(p,v).getContext("2d",{willReadFrequently:!0});S.drawImage(c,0,0,c.width,c.height,0,0,p,v),f={width:p,height:v,data:S.getImageData(0,0,p,v).data}}return{canvas:h,width:u,height:d,imageData:f}}static async deserialize(t,s,i){var S;let r=null,a=!1;if(t instanceof aC){const{data:{rect:y,rotation:k,id:w,structParent:E,popupRef:C,richText:T,contentsObj:_,creationDate:P,modificationDate:D},container:I,parent:{page:{pageNumber:F}},canvas:K}=t;let Z,Q;K?(delete t.canvas,{id:Z,bitmap:Q}=i.imageManager.getFromCanvas(I.id,K),K.remove()):(a=!0,t._hasNoCanvas=!0);const se=((S=await s._structTree.getAriaAttributes(`${Ic}${w}`))==null?void 0:S.get("aria-label"))||"";r=t={annotationType:oe.STAMP,bitmapId:Z,bitmap:Q,pageIndex:F-1,rect:y.slice(0),rotation:k,annotationElementId:w,id:w,deleted:!1,accessibilityData:{decorative:!1,altText:se},isSvg:!1,structParent:E,popupRef:C,richText:T,comment:(_==null?void 0:_.str)||null,creationDate:P,modificationDate:D}}const l=await super.deserialize(t,s,i),{rect:c,bitmap:u,bitmapUrl:d,bitmapId:h,isSvg:f,accessibilityData:p}=t;a?(i.addMissingCanvas(t.id,l),m(l,Gl,!0)):h&&i.imageManager.isValidId(h)?(m(l,Rt,h),u&&m(l,Ke,u)):m(l,Lr,d),m(l,nn,f);const[v,b]=l.pageDimensions;return l.width=(c[2]-c[0])/v,l.height=(c[3]-c[1])/b,p&&(l.altTextData=p),l._initialData=r,t.comment&&l.setCommentData(t),m(l,pd,!!r),l}serialize(t=!1,s=null){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const i=Object.assign(super.serialize(t),{bitmapId:o(this,Rt),isSvg:o(this,nn)});if(this.addComment(i),t)return i.bitmapUrl=A(this,we,wg).call(this,!0),i.accessibilityData=this.serializeAltText(!0),i.isCopy=!0,i;const{decorative:r,altText:a}=this.serializeAltText(!1);if(!r&&a&&(i.accessibilityData={type:"Figure",alt:a}),this.annotationElementId){const c=A(this,we,WC).call(this,i);return c.isSame?null:(c.isSameAltText?delete i.accessibilityData:i.accessibilityData.structParent=this._initialData.structParent??-1,i.id=this.annotationElementId,delete i.bitmapId,i)}if(s===null)return i;s.stamps||(s.stamps=new Map);const l=o(this,nn)?(i.rect[2]-i.rect[0])*(i.rect[3]-i.rect[1]):null;if(!s.stamps.has(o(this,Rt)))s.stamps.set(o(this,Rt),{area:l,serialized:i}),i.bitmap=A(this,we,wg).call(this,!1);else if(o(this,nn)){const c=s.stamps.get(o(this,Rt));l>c.area&&(c.area=l,c.serialized.bitmap.close(),c.serialized.bitmap=A(this,we,wg).call(this,!1))}return i}renderAnnotationElement(t){return this.deleted?(t.hide(),null):(t.updateEdited({rect:this.getPDFRect(),popup:this.comment}),null)}}Ke=new WeakMap,Rt=new WeakMap,Jo=new WeakMap,Lr=new WeakMap,Zo=new WeakMap,fd=new WeakMap,Dr=new WeakMap,Gl=new WeakMap,Oi=new WeakMap,nn=new WeakMap,pd=new WeakMap,we=new WeakSet,mh=function(t,s=!1){if(!t){this.remove();return}m(this,Ke,t.bitmap),s||(m(this,Rt,t.id),m(this,nn,t.isSvg)),t.file&&m(this,fd,t.file.name),A(this,we,xg).call(this)},gh=function(){if(m(this,Jo,null),this._uiManager.enableWaiting(!1),!!o(this,Dr)){if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&o(this,Ke)){this.addEditToolbar().then(()=>{this._editToolbar.hide(),this._uiManager.editAltText(this,!0)});return}if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&o(this,Ke)){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch{}}this.div.focus()}},yg=function(){if(o(this,Rt)){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(o(this,Rt)).then(i=>A(this,we,mh).call(this,i,!0)).finally(()=>A(this,we,gh).call(this));return}if(o(this,Lr)){const i=o(this,Lr);m(this,Lr,null),this._uiManager.enableWaiting(!0),m(this,Jo,this._uiManager.imageManager.getFromUrl(i).then(r=>A(this,we,mh).call(this,r)).finally(()=>A(this,we,gh).call(this)));return}if(o(this,Zo)){const i=o(this,Zo);m(this,Zo,null),this._uiManager.enableWaiting(!0),m(this,Jo,this._uiManager.imageManager.getFromFile(i).then(r=>A(this,we,mh).call(this,r)).finally(()=>A(this,we,gh).call(this)));return}const t=document.createElement("input");t.type="file",t.accept=Iy.join(",");const s=this._uiManager._signal;m(this,Jo,new Promise(i=>{t.addEventListener("change",async()=>{if(!t.files||t.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const r=await this._uiManager.imageManager.getFromFile(t.files[0]);this._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),A(this,we,mh).call(this,r)}i()},{signal:s}),t.addEventListener("cancel",()=>{this.remove(),i()},{signal:s})}).finally(()=>A(this,we,gh).call(this))),t.click()},xg=function(){var u;const{div:t}=this;let{width:s,height:i}=o(this,Ke);const[r,a]=this.pageDimensions,l=.75;if(this.width)s=this.width*r,i=this.height*a;else if(s>l*r||i>l*a){const d=Math.min(l*r/s,l*a/i);s*=d,i*=d}this._uiManager.enableWaiting(!1);const c=m(this,Dr,document.createElement("canvas"));c.setAttribute("role","img"),this.addContainer(c),this.width=s/r,this.height=i/a,this.setDims(),(u=this._initialOptions)!=null&&u.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,(!this._uiManager.useNewAltTextWhenAddingImage||!this._uiManager.useNewAltTextFlow||this.annotationElementId)&&(t.hidden=!1),A(this,we,Jx).call(this),o(this,pd)||(this.parent.addUndoableEditor(this),m(this,pd,!0)),this._reportTelemetry({action:"inserted_image"}),o(this,fd)&&this.div.setAttribute("aria-description",o(this,fd)),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-stamp-added-alert")},bg=function(t,s){const{width:i,height:r}=o(this,Ke);let a=i,l=r,c=o(this,Ke);for(;a>2*t||l>2*s;){const u=a,d=l;a>2*t&&(a=a>=16384?Math.floor(a/2)-1:Math.ceil(a/2)),l>2*s&&(l=l>=16384?Math.floor(l/2)-1:Math.ceil(l/2));const h=new OffscreenCanvas(a,l);h.getContext("2d").drawImage(c,0,0,u,d,0,0,a,l),c=h.transferToImageBitmap()}return c},Jx=function(){const[t,s]=this.parentDimensions,{width:i,height:r}=this,a=new $i,l=Math.ceil(i*t*a.sx),c=Math.ceil(r*s*a.sy),u=o(this,Dr);if(!u||u.width===l&&u.height===c)return;u.width=l,u.height=c;const d=o(this,nn)?o(this,Ke):A(this,we,bg).call(this,l,c),h=u.getContext("2d");h.filter=this._uiManager.hcmFilter,h.drawImage(d,0,0,d.width,d.height,0,0,l,c)},wg=function(t){if(t){if(o(this,nn)){const r=this._uiManager.imageManager.getSvgUrl(o(this,Rt));if(r)return r}const s=document.createElement("canvas");return{width:s.width,height:s.height}=o(this,Ke),s.getContext("2d").drawImage(o(this,Ke),0,0),s.toDataURL()}if(o(this,nn)){const[s,i]=this.pageDimensions,r=Math.round(this.width*s*ya.PDF_TO_CSS_UNITS),a=Math.round(this.height*i*ya.PDF_TO_CSS_UNITS),l=new OffscreenCanvas(r,a);return l.getContext("2d").drawImage(o(this,Ke),0,0,o(this,Ke).width,o(this,Ke).height,0,0,r,a),l.transferToImageBitmap()}return structuredClone(o(this,Ke))},WC=function(t){var l;const{pageIndex:s,accessibilityData:{altText:i}}=this._initialData,r=t.pageIndex===s,a=(((l=t.accessibilityData)==null?void 0:l.alt)||"")===i;return{isSame:!this.hasEditedComment&&!this._hasBeenMoved&&!this._hasBeenResized&&r&&a,isSameAltText:a}},M(Qx,"_type","stamp"),M(Qx,"_editorType",oe.STAMP);var Xl,md,ea,ta,Ir,Ms,sa,gd,vd,ni,Rr,Ft,Fr,na,yd,W,ia,ze,eb,GC,mi,tb,sb,Ag;const Wn=class Wn{constructor({uiManager:e,pageIndex:t,div:s,structTreeLayer:i,accessibilityManager:r,annotationLayer:a,drawLayer:l,textLayer:c,viewport:u,l10n:d}){x(this,ze);x(this,Xl);x(this,md,!1);x(this,ea,null);x(this,ta,null);x(this,Ir,null);x(this,Ms,new Map);x(this,sa,!1);x(this,gd,!1);x(this,vd,!1);x(this,ni,null);x(this,Rr,null);x(this,Ft,null);x(this,Fr,null);x(this,na,null);x(this,yd,-1);x(this,W);const h=[...o(Wn,ia).values()];if(!Wn._initialized){Wn._initialized=!0;for(const f of h)f.initialize(d,e)}e.registerEditorTypes(h),m(this,W,e),this.pageIndex=t,this.div=s,m(this,Xl,r),m(this,ea,a),this.viewport=u,m(this,Ft,c),this.drawLayer=l,this._structTree=i,o(this,W).addLayer(this)}updatePageIndex(e){this.pageIndex=e}get isEmpty(){return o(this,Ms).size===0}get isInvisible(){return this.isEmpty&&o(this,W).getMode()===oe.NONE}updateToolbar(e){o(this,W).updateToolbar(e)}updateMode(e=o(this,W).getMode()){switch(A(this,ze,Ag).call(this),e){case oe.NONE:this.div.classList.toggle("nonEditing",!0),this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case oe.INK:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick();break;case oe.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:t}=this.div;if(t.toggle("nonEditing",!1),e===oe.POPUP)t.toggle("commentEditing",!0);else{t.toggle("commentEditing",!1);for(const s of o(Wn,ia).values())t.toggle(`${s._type}Editing`,e===s._editorType)}this.div.hidden=!1}hasTextLayer(e){var t;return e===((t=o(this,Ft))==null?void 0:t.div)}setEditingState(e){o(this,W).setEditingState(e)}addCommands(e){o(this,W).addCommands(e)}cleanUndoStack(e){o(this,W).cleanUndoStack(e)}toggleDrawing(e=!1){this.div.classList.toggle("drawing",!e)}togglePointerEvents(e=!1){this.div.classList.toggle("disabled",!e)}toggleAnnotationLayerPointerEvents(e=!1){var t;(t=o(this,ea))==null||t.togglePointerEvents(e)}async enable(){var s;m(this,vd,!0),this.div.tabIndex=0,this.togglePointerEvents(!0),this.div.classList.toggle("nonEditing",!1),(s=o(this,na))==null||s.abort(),m(this,na,null);const e=new Set;for(const i of o(this,ze,eb))i.enableEditing(),i.show(!0),i.annotationElementId&&(o(this,W).removeChangedExistingAnnotation(i),e.add(i.annotationElementId));const t=o(this,ea);if(t)for(const i of t.getEditableAnnotations()){if(i.hide(),o(this,W).isDeletedAnnotationElement(i.data.id)||e.has(i.data.id))continue;const r=await this.deserialize(i);r&&(this.addOrRebuild(r),r.enableEditing())}m(this,vd,!1),o(this,W)._eventBus.dispatch("editorsrendered",{source:this,pageNumber:this.pageIndex+1})}disable(){var i;if(m(this,gd,!0),this.div.tabIndex=-1,this.togglePointerEvents(!1),this.div.classList.toggle("nonEditing",!0),o(this,Ft)&&!o(this,na)){m(this,na,new AbortController);const r=o(this,W).combinedSignal(o(this,na));o(this,Ft).div.addEventListener("pointerdown",a=>{const{clientX:c,clientY:u,timeStamp:d}=a,h=o(this,yd);if(d-h>500){m(this,yd,d);return}m(this,yd,-1);const{classList:f}=this.div;f.toggle("getElements",!0);const p=document.elementsFromPoint(c,u);if(f.toggle("getElements",!1),!this.div.contains(p[0]))return;let v;const b=new RegExp(`^${Vh}[0-9]+$`);for(const y of p)if(b.test(y.id)){v=y.id;break}if(!v)return;const S=o(this,Ms).get(v);(S==null?void 0:S.annotationElementId)===null&&(a.stopPropagation(),a.preventDefault(),S.dblclick(a))},{signal:r,capture:!0})}const e=o(this,ea),t=[];if(e){const r=new Map,a=new Map;for(const c of o(this,ze,eb)){if(c.disableEditing(),!c.annotationElementId){t.push(c);continue}if(c.serialize()!==null){r.set(c.annotationElementId,c);continue}else a.set(c.annotationElementId,c);(i=this.getEditableAnnotation(c.annotationElementId))==null||i.show(),c.remove()}const l=e.getEditableAnnotations();for(const c of l){const{id:u}=c.data;if(o(this,W).isDeletedAnnotationElement(u)){c.updateEdited({deleted:!0});continue}let d=a.get(u);if(d){d.resetAnnotationElement(c),d.show(!1),c.show();continue}d=r.get(u),d&&(o(this,W).addChangedExistingAnnotation(d),d.renderAnnotationElement(c)&&d.show(!1)),c.show()}}A(this,ze,Ag).call(this),this.isEmpty&&(this.div.hidden=!0);const{classList:s}=this.div;for(const r of o(Wn,ia).values())s.remove(`${r._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),e==null||e.updateFakeAnnotations(t),m(this,gd,!1)}getEditableAnnotation(e){var t;return((t=o(this,ea))==null?void 0:t.getEditableAnnotation(e))||null}setActiveEditor(e){o(this,W).getActive()!==e&&o(this,W).setActiveEditor(e)}enableTextSelection(){var e;if(this.div.tabIndex=-1,(e=o(this,Ft))!=null&&e.div&&!o(this,Fr)){m(this,Fr,new AbortController);const t=o(this,W).combinedSignal(o(this,Fr));o(this,Ft).div.addEventListener("pointerdown",A(this,ze,GC).bind(this),{signal:t}),o(this,Ft).div.classList.add("highlighting")}}disableTextSelection(){var e;this.div.tabIndex=0,(e=o(this,Ft))!=null&&e.div&&o(this,Fr)&&(o(this,Fr).abort(),m(this,Fr,null),o(this,Ft).div.classList.remove("highlighting"))}enableClick(){if(o(this,ta))return;m(this,ta,new AbortController);const e=o(this,W).combinedSignal(o(this,ta));this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:e});const t=this.pointerup.bind(this);this.div.addEventListener("pointerup",t,{signal:e}),this.div.addEventListener("pointercancel",t,{signal:e})}disableClick(){var e;(e=o(this,ta))==null||e.abort(),m(this,ta,null)}attach(e){o(this,Ms).set(e.id,e);const{annotationElementId:t}=e;t&&o(this,W).isDeletedAnnotationElement(t)&&o(this,W).removeDeletedAnnotationElement(e)}detach(e){var t;o(this,Ms).delete(e.id),(t=o(this,Xl))==null||t.removePointerInTextLayer(e.contentDiv),!o(this,gd)&&e.annotationElementId&&o(this,W).addDeletedAnnotationElement(e)}remove(e){this.detach(e),o(this,W).removeEditor(e),e.div.remove(),e.isAttachedToDOM=!1}changeParent(e){var t;e.parent!==this&&(e.parent&&e.annotationElementId&&(o(this,W).addDeletedAnnotationElement(e),Ve.deleteAnnotationElement(e),e.annotationElementId=null),this.attach(e),(t=e.parent)==null||t.detach(e),e.setParent(this),e.div&&e.isAttachedToDOM&&(e.div.remove(),this.div.append(e.div)))}add(e){if(!(e.parent===this&&e.isAttachedToDOM)){if(this.changeParent(e),o(this,W).addEditor(e),this.attach(e),!e.isAttachedToDOM){const t=e.render();this.div.append(t),e.isAttachedToDOM=!0}e.fixAndSetPosition(),e.onceAdded(!o(this,vd)),o(this,W).addToAnnotationStorage(e),e._reportTelemetry(e.telemetryInitialData)}}moveEditorInDOM(e){var s;if(!e.isAttachedToDOM)return;const{activeElement:t}=document;e.div.contains(t)&&!o(this,Ir)&&(e._focusEventsAllowed=!1,m(this,Ir,setTimeout(()=>{m(this,Ir,null),e.div.contains(document.activeElement)?e._focusEventsAllowed=!0:(e.div.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:o(this,W)._signal}),t.focus())},0))),e._structTreeParentId=(s=o(this,Xl))==null?void 0:s.moveElementInDOM(this.div,e.div,e.contentDiv,!0)}addOrRebuild(e){e.needsToBeRebuilt()?(e.parent||(e.parent=this),e.rebuild(),e.show()):this.add(e)}addUndoableEditor(e){const t=()=>e._uiManager.rebuild(e),s=()=>{e.remove()};this.addCommands({cmd:t,undo:s,mustExec:!1})}getEditorByUID(e){for(const t of o(this,Ms).values())if(t.uid===e)return t;return null}getNextId(){return o(this,W).getId()}combinedSignal(e){return o(this,W).combinedSignal(e)}canCreateNewEmptyEditor(){var e;return(e=o(this,ze,mi))==null?void 0:e.canCreateNewEmptyEditor()}async pasteEditor(e,t){this.updateToolbar(e),await o(this,W).updateMode(e.mode);const{offsetX:s,offsetY:i}=A(this,ze,sb).call(this),r=this.getNextId(),a=A(this,ze,tb).call(this,{parent:this,id:r,x:s,y:i,uiManager:o(this,W),isCentered:!0,...t});a&&this.add(a)}async deserialize(e){var t;return await((t=o(Wn,ia).get(e.annotationType??e.annotationEditorType))==null?void 0:t.deserialize(e,this,o(this,W)))||null}createAndAddNewEditor(e,t,s={}){const i=this.getNextId(),r=A(this,ze,tb).call(this,{parent:this,id:i,x:e.offsetX,y:e.offsetY,uiManager:o(this,W),isCentered:t,...s});return r&&this.add(r),r}get boundingClientRect(){return this.div.getBoundingClientRect()}addNewEditor(e={}){this.createAndAddNewEditor(A(this,ze,sb).call(this),!0,e)}setSelected(e){o(this,W).setSelected(e)}toggleSelected(e){o(this,W).toggleSelected(e)}unselect(e){o(this,W).unselect(e)}pointerup(e){var i;const{isMac:t}=Nt.platform;if(e.button!==0||e.ctrlKey&&t||e.target!==this.div||!o(this,sa)||(m(this,sa,!1),(i=o(this,ze,mi))!=null&&i.isDrawer&&o(this,ze,mi).supportMultipleDrawings))return;if(!o(this,md)){m(this,md,!0);return}const s=o(this,W).getMode();if(s===oe.STAMP||s===oe.SIGNATURE){o(this,W).unselectAll();return}this.createAndAddNewEditor(e,!1)}pointerdown(e){var i;if(o(this,W).getMode()===oe.HIGHLIGHT&&this.enableTextSelection(),o(this,sa)){m(this,sa,!1);return}const{isMac:t}=Nt.platform;if(e.button!==0||e.ctrlKey&&t||e.target!==this.div)return;if(m(this,sa,!0),(i=o(this,ze,mi))!=null&&i.isDrawer){this.startDrawingSession(e);return}const s=o(this,W).getActive();m(this,md,!s||s.isEmpty())}startDrawingSession(e){if(this.div.focus({preventScroll:!0}),o(this,ni)){o(this,ze,mi).startDrawing(this,o(this,W),!1,e);return}o(this,W).setCurrentDrawingSession(this),m(this,ni,new AbortController);const t=o(this,W).combinedSignal(o(this,ni));this.div.addEventListener("blur",({relatedTarget:s})=>{s&&!this.div.contains(s)&&(m(this,Rr,null),this.commitOrRemove())},{signal:t}),o(this,ze,mi).startDrawing(this,o(this,W),!1,e)}pause(e){if(e){const{activeElement:t}=document;this.div.contains(t)&&m(this,Rr,t);return}o(this,Rr)&&setTimeout(()=>{var t;(t=o(this,Rr))==null||t.focus(),m(this,Rr,null)},0)}endDrawingSession(e=!1){return o(this,ni)?(o(this,W).setCurrentDrawingSession(null),o(this,ni).abort(),m(this,ni,null),m(this,Rr,null),o(this,ze,mi).endDrawing(e)):null}findNewParent(e,t,s){const i=o(this,W).findParent(t,s);return i===null||i===this?!1:(i.changeParent(e),!0)}commitOrRemove(){return o(this,ni)?(this.endDrawingSession(),!0):!1}onScaleChanging(){o(this,ni)&&o(this,ze,mi).onScaleChangingWhenDrawing(this)}destroy(){var e,t;this.commitOrRemove(),((e=o(this,W).getActive())==null?void 0:e.parent)===this&&(o(this,W).commitOrRemove(),o(this,W).setActiveEditor(null)),o(this,Ir)&&(clearTimeout(o(this,Ir)),m(this,Ir,null));for(const s of o(this,Ms).values())(t=o(this,Xl))==null||t.removePointerInTextLayer(s.contentDiv),s.setParent(null),s.isAttachedToDOM=!1,s.div.remove();this.div=null,o(this,Ms).clear(),o(this,W).removeLayer(this)}render({viewport:e}){this.viewport=e,sc(this.div,e);for(const t of o(this,W).getEditors(this.pageIndex))this.add(t),t.rebuild();this.updateMode()}update({viewport:e}){o(this,W).commitOrRemove(),A(this,ze,Ag).call(this);const t=this.viewport.rotation,s=e.rotation;if(this.viewport=e,sc(this.div,{rotation:s}),t!==s)for(const i of o(this,Ms).values())i.rotate(s)}get pageDimensions(){const{pageWidth:e,pageHeight:t}=this.viewport.rawDims;return[e,t]}get scale(){return o(this,W).viewParameters.realScale}};Xl=new WeakMap,md=new WeakMap,ea=new WeakMap,ta=new WeakMap,Ir=new WeakMap,Ms=new WeakMap,sa=new WeakMap,gd=new WeakMap,vd=new WeakMap,ni=new WeakMap,Rr=new WeakMap,Ft=new WeakMap,Fr=new WeakMap,na=new WeakMap,yd=new WeakMap,W=new WeakMap,ia=new WeakMap,ze=new WeakSet,eb=function(){return o(this,Ms).size!==0?o(this,Ms).values():o(this,W).getEditors(this.pageIndex)},GC=function(e){o(this,W).unselectAll();const{target:t}=e;if(t===o(this,Ft).div||(t.getAttribute("role")==="img"||t.classList.contains("endOfContent"))&&o(this,Ft).div.contains(t)){const{isMac:s}=Nt.platform;if(e.button!==0||e.ctrlKey&&s)return;o(this,W).showAllEditors("highlight",!0,!0),o(this,Ft).div.classList.add("free"),this.toggleDrawing(),i0.startHighlighting(this,o(this,W).direction==="ltr",{target:o(this,Ft).div,x:e.x,y:e.y}),o(this,Ft).div.addEventListener("pointerup",()=>{o(this,Ft).div.classList.remove("free"),this.toggleDrawing(!0)},{once:!0,signal:o(this,W)._signal}),e.preventDefault()}},mi=function(){return o(Wn,ia).get(o(this,W).getMode())},tb=function(e){const t=o(this,ze,mi);return t?new t.prototype.constructor(e):null},sb=function(){const{x:e,y:t,width:s,height:i}=this.boundingClientRect,r=Math.max(0,e),a=Math.max(0,t),l=Math.min(window.innerWidth,e+s),c=Math.min(window.innerHeight,t+i),u=(r+l)/2-e,d=(a+c)/2-t,[h,f]=this.viewport.rotation%180===0?[u,d]:[d,u];return{offsetX:h,offsetY:f}},Ag=function(){for(const e of o(this,Ms).values())e.isEmpty()&&e.remove()},M(Wn,"_initialized",!1),x(Wn,ia,new Map([Ix,Vx,Qx,i0,Kx].map(e=>[e._editorType,e])));let Zx=Wn;var ii,fs,Yl,Wp,S0,XC,Wi,ib,YC,rb;const St=class St{constructor(){x(this,Wi);x(this,ii,null);x(this,fs,new Map);x(this,Yl,new Map)}setParent(e){if(!o(this,ii)){m(this,ii,e);return}if(o(this,ii)!==e){if(o(this,fs).size>0)for(const t of o(this,fs).values())t.remove(),e.append(t);m(this,ii,e)}}static get _svgFactory(){return ie(this,"_svgFactory",new s0)}draw(e,t=!1,s=!1){const i=At(St,Wp)._++,r=A(this,Wi,ib).call(this),a=St._svgFactory.createElement("defs");r.append(a);const l=St._svgFactory.createElement("path");a.append(l);const c=`path_${i}`;l.setAttribute("id",c),l.setAttribute("vector-effect","non-scaling-stroke"),t&&o(this,Yl).set(i,l);const u=s?A(this,Wi,YC).call(this,a,c):null,d=St._svgFactory.createElement("use");return r.append(d),d.setAttribute("href",`#${c}`),this.updateProperties(r,e),o(this,fs).set(i,r),{id:i,clipPathId:`url(#${u})`}}drawOutline(e,t){const s=At(St,Wp)._++,i=A(this,Wi,ib).call(this),r=St._svgFactory.createElement("defs");i.append(r);const a=St._svgFactory.createElement("path");r.append(a);const l=`path_${s}`;a.setAttribute("id",l),a.setAttribute("vector-effect","non-scaling-stroke");let c;if(t){const h=St._svgFactory.createElement("mask");r.append(h),c=`mask_${s}`,h.setAttribute("id",c),h.setAttribute("maskUnits","objectBoundingBox");const f=St._svgFactory.createElement("rect");h.append(f),f.setAttribute("width","1"),f.setAttribute("height","1"),f.setAttribute("fill","white");const p=St._svgFactory.createElement("use");h.append(p),p.setAttribute("href",`#${l}`),p.setAttribute("stroke","none"),p.setAttribute("fill","black"),p.setAttribute("fill-rule","nonzero"),p.classList.add("mask")}const u=St._svgFactory.createElement("use");i.append(u),u.setAttribute("href",`#${l}`),c&&u.setAttribute("mask",`url(#${c})`);const d=u.cloneNode();return i.append(d),u.classList.add("mainOutline"),d.classList.add("secondaryOutline"),this.updateProperties(i,e),o(this,fs).set(s,i),s}finalizeDraw(e,t){o(this,Yl).delete(e),this.updateProperties(e,t)}updateProperties(e,t){var c;if(!t)return;const{root:s,bbox:i,rootClass:r,path:a}=t,l=typeof e=="number"?o(this,fs).get(e):e;if(l){if(s&&A(this,Wi,rb).call(this,l,s),i&&A(c=St,S0,XC).call(c,l,i),r){const{classList:u}=l;for(const[d,h]of Object.entries(r))u.toggle(d,h)}if(a){const d=l.firstElementChild.firstElementChild;A(this,Wi,rb).call(this,d,a)}}}updateParent(e,t){if(t===this)return;const s=o(this,fs).get(e);s&&(o(t,ii).append(s),o(this,fs).delete(e),o(t,fs).set(e,s))}remove(e){o(this,Yl).delete(e),o(this,ii)!==null&&(o(this,fs).get(e).remove(),o(this,fs).delete(e))}destroy(){m(this,ii,null);for(const e of o(this,fs).values())e.remove();o(this,fs).clear(),o(this,Yl).clear()}};ii=new WeakMap,fs=new WeakMap,Yl=new WeakMap,Wp=new WeakMap,S0=new WeakSet,XC=function(e,[t,s,i,r]){const{style:a}=e;a.top=`${100*s}%`,a.left=`${100*t}%`,a.width=`${100*i}%`,a.height=`${100*r}%`},Wi=new WeakSet,ib=function(){const e=St._svgFactory.create(1,1,!0);return o(this,ii).append(e),e.setAttribute("aria-hidden",!0),e},YC=function(e,t){const s=St._svgFactory.createElement("clipPath");e.append(s);const i=`clip_${t}`;s.setAttribute("id",i),s.setAttribute("clipPathUnits","objectBoundingBox");const r=St._svgFactory.createElement("use");return s.append(r),r.setAttribute("href",`#${t}`),r.classList.add("clip"),i},rb=function(e,t){for(const[s,i]of Object.entries(t))i===null?e.removeAttribute(s):e.setAttribute(s,i)},x(St,S0),x(St,Wp,0);let nb=St;globalThis._pdfjsTestingUtils={HighlightOutliner:Fx};globalThis.pdfjsLib={AbortException:va,AnnotationEditorLayer:Zx,AnnotationEditorParamsType:ve,AnnotationEditorType:oe,AnnotationEditorUIManager:nc,AnnotationLayer:Lx,AnnotationMode:ao,AnnotationType:yt,applyOpacity:AN,build:_P,ColorPicker:e0,createValidAbsoluteUrl:ES,CSSConstants:wN,DOMSVGFactory:s0,DrawLayer:nb,FeatureTest:Nt,fetchData:Qp,findContrastColor:kN,getDocument:VE,getFilenameFromUrl:mN,getPdfFilenameFromUrl:gN,getRGB:Zp,getUuid:TS,getXfaPageViewport:yN,GlobalWorkerOptions:zi,ImageKind:Hm,InvalidPDFException:Ly,isDataScheme:W0,isPdfFile:sw,isValidExplicitDest:IN,MathClamp:Gt,noContextMenu:zn,normalizeUnicode:fN,OPS:Wh,OutputScale:$i,PagesMapper:Xh,PasswordResponses:nN,PDFDataRangeTransport:WE,PDFDateString:Yg,PDFWorker:qh,PermissionFlag:sN,PixelsPerInch:ya,RenderingCancelledException:tw,renderRichText:NS,ResponseException:Xg,setLayerDimensions:sc,shadow:ie,SignatureExtractor:jr,stopEvent:ut,SupportedImageMimeTypes:Iy,TextLayer:Yh,TouchManager:Kg,updateUrlHash:CS,Util:z,VerbosityLevel:U0,version:qE,XfaLayer:_S};zi.workerSrc=`//cdnjs.cloudflare.com/ajax/libs/pdf.js/${qE}/pdf.worker.min.js`;const JP="requirement-analyzer-secure-2026",qC=async()=>{const n=new TextEncoder,e=await window.crypto.subtle.importKey("raw",n.encode(JP),{name:"PBKDF2"},!1,["deriveBits","deriveKey"]);return await window.crypto.subtle.deriveKey({name:"PBKDF2",salt:n.encode("secure-telco-mode"),iterations:1e5,hash:"SHA-256"},e,{name:"AES-GCM",length:256},!0,["encrypt","decrypt"])},ZP=async n=>{try{const e=await qC(),t=new TextEncoder,s=window.crypto.getRandomValues(new Uint8Array(12)),i=await window.crypto.subtle.encrypt({name:"AES-GCM",iv:s},e,t.encode(n)),r=new Uint8Array(s.length+i.byteLength);return r.set(s),r.set(new Uint8Array(i),s.length),btoa(String.fromCharCode(...r))}catch(e){return console.error("Encryption failed:",e),n}},eM=async n=>{try{const e=await qC(),t=new TextDecoder,s=new Uint8Array(atob(n).split("").map(l=>l.charCodeAt(0))),i=s.slice(0,12),r=s.slice(12),a=await window.crypto.subtle.decrypt({name:"AES-GCM",iv:i},e,r);return t.decode(a)}catch(e){return console.error("Decryption failed:",e),n}},Rv={async setItem(n,e){const t=await ZP(e);localStorage.setItem(n,t)},async getItem(n){const e=localStorage.getItem(n);return e?await eM(e):null},removeItem(n){localStorage.removeItem(n)}},Hr=()=>Math.random().toString(36).slice(2,10),tM=[{id:"overview",label:"Overview",icon:""},{id:"problem",label:"Problem & Purpose",icon:""},{id:"context",label:"User Context",icon:""},{id:"assumptions",label:"Assumptions",icon:""},{id:"edges",label:"Edge Cases",icon:""},{id:"scope",label:"Scope & Versions",icon:""},{id:"questions",label:"Open Questions",icon:""},{id:"notes",label:"Notes",icon:""},{id:"summary",label:"Summary",icon:""},{id:"mapping",label:"Mapping",icon:""}],sM=["User Research","Business Metric","Competitor Analysis","Stakeholder Request","Technical Debt","Legal","Other"],lo=["MVP","V1","V2","V3","Future","Cut"],Or={MVP:{bg:"bg-violet-100",text:"text-violet-700",border:"border-violet-200",dot:"bg-violet-500"},V1:{bg:"bg-blue-100",text:"text-blue-700",border:"border-blue-200",dot:"bg-blue-500"},V2:{bg:"bg-teal-100",text:"text-teal-700",border:"border-teal-200",dot:"bg-teal-500"},V3:{bg:"bg-sky-100",text:"text-sky-700",border:"border-sky-200",dot:"bg-sky-500"},Future:{bg:"bg-slate-100",text:"text-slate-600",border:"border-slate-200",dot:"bg-slate-400"},Cut:{bg:"bg-red-50",text:"text-red-500",border:"border-red-200",dot:"bg-red-400"}},nM=["Must","Should","Could","Won't"],iM=["Unvalidated","Needs Research","Validated","Disproven"],Ea=["Stakeholder","User Research","Developer","Designer","Business Analyst"],rM=["Open","Answered"],oM=["Low","Medium","High"],Kh=[{id:"empty",label:"Empty state",hint:"What does the user see when there's no data?"},{id:"error",label:"Error state",hint:"What happens when something fails?"},{id:"loading",label:"Loading state",hint:"What's shown during data fetch or processing?"},{id:"firstTime",label:"First-time experience",hint:"How does a new user encounter this?"},{id:"returning",label:"Returning user",hint:"Does behavior change for repeat use?"},{id:"permissions",label:"Permission / access variations",hint:"Different roles, restricted access?"},{id:"offline",label:"Offline / connectivity",hint:"What if the connection drops?"},{id:"dataLimits",label:"Data extremes",hint:"Too much data? Too little? Unexpected formats?"},{id:"mobile",label:"Responsive / mobile",hint:"Does this need to work across breakpoints?"},{id:"accessibility",label:"Accessibility",hint:"Keyboard nav, screen readers, contrast?"}],Ch=(n="Untitled Design Task")=>({id:Hr(),name:n,phase:"",gistId:"",jiraTicket:"",secureMode:!1,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),overview:{featureName:"",date:"",requestor:"",description:"",origin:"",originOther:""},problem:{problem:"",who:"",outcome:"",metrics:"",ifNotBuilt:""},context:{segments:"",workflow:"",workarounds:"",triggers:"",beforeAfter:""},assumptions:[],edges:Kh.reduce((e,t)=>(e[t.id]={considered:!1,notes:""},e),{}),scope:{affected:"",newPatterns:"",technical:"",items:[]},questions:[],actions:[],mapping:{figmaUrl:"https://embed.figma.com/board/JiPxw8hWqRLsTs2cpUFU7O/Figjam-Concept?node-id=378-61&embed-host=share"},notes:"",summary:{confidence:"",concerns:"",nextSteps:""}}),Fv=n=>({...Ch(),...n,notes:n.notes??"",gistId:n.gistId??"",jiraTicket:n.jiraTicket??"",secureMode:n.secureMode??!1}),aM=async(n,e)=>{const t={Accept:"application/vnd.github+json",Authorization:`Bearer ${e}`,"X-GitHub-Api-Version":"2022-11-28"},s={description:`Requirement Analysis: ${n.name}`,public:!1,files:{"analysis.json":{content:JSON.stringify(n,null,2)}}};try{if(n.gistId){const i=await fetch(`https://api.github.com/gists/${n.gistId}`,{method:"PATCH",headers:t,body:JSON.stringify(s)});if(!i.ok)throw new Error(`GitHub API error: ${i.status}`);return await i.json()}else{const i=await fetch("https://api.github.com/gists",{method:"POST",headers:t,body:JSON.stringify(s)});if(!i.ok)throw new Error(`GitHub API error: ${i.status}`);return await i.json()}}catch(i){throw console.error("Failed to save gist:",i),i}},lM=async(n,e)=>{const t={Accept:"application/vnd.github+json","X-GitHub-Api-Version":"2022-11-28"};e&&(t.Authorization=`Bearer ${e}`);try{const s=await fetch(`https://api.github.com/gists/${n}`,{headers:t});if(!s.ok)throw new Error(`GitHub API error: ${s.status}`);const r=(await s.json()).files["analysis.json"];if(!r)throw new Error("No analysis.json found in gist");return JSON.parse(r.content)}catch(s){throw console.error("Failed to load gist:",s),s}};let co=null,ob=[],er=null;const cM=async n=>{try{const e=await navigator.mediaDevices.getUserMedia({audio:!0});co=new MediaRecorder(e),ob=[],co.ondataavailable=s=>{ob.push(s.data)};const t=window.SpeechRecognition||window.webkitSpeechRecognition;return t&&(er=new t,er.continuous=!0,er.interimResults=!0,er.lang="en-US",er.onresult=s=>{let i="",r="";for(let a=s.resultIndex;a<s.results.length;a++){const l=s.results[a][0].transcript;s.results[a].isFinal?r+=l+" ":i+=l}n(r,i)},er.start()),co.start(),!0}catch(e){return console.error("Error starting recording:",e),!1}},uM=()=>new Promise(n=>{co&&co.state!=="inactive"?(co.onstop=()=>{const e=new Blob(ob,{type:"audio/wav"});co.stream.getTracks().forEach(t=>t.stop()),n(e)},co.stop()):n(null),er&&(er.stop(),er=null)}),dM=async(n,e)=>{if(!e)return null;try{const t=await fetch("https://models.inference.ai.azure.com/chat/completions",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify({model:"gpt-4o",messages:[{role:"system",content:'You are a UX/product design assistant. Analyze the transcript and extract information into these sections: problem (what problem and why it matters), context (user context and personas), assumptions (unvalidated assumptions), edges (edge cases), scope (in/out of scope), questions (open questions), actions (requirement analysis action items like "Interview users", "Review analytics", "Create wireframes" - NOT development/implementation tasks), notes (additional notes). Return as compact JSON with section keys and string values. Be concise.'},{role:"user",content:n}],temperature:.7,max_tokens:1500})});if(!t.ok)throw new Error("GitHub API error");const i=(await t.json()).choices[0].message.content;try{return JSON.parse(i)}catch{return{notes:i}}}catch(t){return console.error("Failed to analyze with GitHub:",t),null}},hM=async(n,e)=>{if(!e)return{notes:"Image uploaded but no AI token provided.",_fallback:!0,_reason:"No GitHub token provided"};try{const t=await fetch("https://models.inference.ai.azure.com/chat/completions",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify({model:"gpt-4o",messages:[{role:"system",content:'You are analyzing images (screenshots of Jira tickets, requirements docs, wireframes, designs, emails, etc). Extract structured information and return ONLY a valid JSON object (no markdown, no code blocks, no explanation). Use these fields (omit if not found): featureName (short title), date (any date mentioned), requestor (who requested/stakeholders), origin (one of: User Research, Business Metric, Competitor Analysis, Stakeholder Request, Technical Debt, Legal, Other), description (brief summary), problem (problem statement), who (target users), outcome (business outcome), segments (user segments), workflow (current workflow), assumptions (array of strings), questions (array of strings), actions (array of requirement analysis tasks like "Schedule user interview", "Review competitor solutions", "Create user flow", NOT implementation/development tasks), notes (array of additional points). Return raw JSON only.'},{role:"user",content:[{type:"text",text:"Analyze this image and extract all relevant requirement information."},{type:"image_url",image_url:{url:n}}]}],temperature:.5,max_tokens:2e3})});if(!t.ok){const r=await t.text();throw new Error(`GitHub API returned ${t.status}: ${r}`)}let i=(await t.json()).choices[0].message.content;if(i=i.trim(),i.startsWith("```")){const r=i.match(/```(?:json)?\s*\n?([\s\S]*?)\n?```/);r&&(i=r[1].trim())}i=i.replace(/^`+|`+$/g,"").trim();try{const r=JSON.parse(i);return console.log("Successfully parsed AI image response:",r),r}catch(r){return console.error("Failed to parse JSON:",r,"Content:",i),{notes:`Failed to parse AI response. Raw content:

`+i,_fallback:!0,_reason:"JSON parsing failed: "+r.message}}}catch(t){return console.error("Failed to analyze image:",t),{notes:"Image analysis failed: "+t.message,_fallback:!0,_reason:t.message||"API request failed"}}},fM=async n=>{try{const e=await n.arrayBuffer(),t=await VE({data:e}).promise;let s="";for(let i=1;i<=t.numPages;i++){const l=(await(await t.getPage(i)).getTextContent()).items.map(c=>c.str).join(" ");s+=l+`
`}return s.trim()}catch(e){throw console.error("Failed to extract text from PDF:",e),new Error("Failed to read PDF file: "+e.message)}},oA=async(n,e)=>{if(!e)return{notes:n.split(`
`).filter(t=>t.trim()).map(t=>` ${t.trim()}`).join(`
`),_fallback:!0,_reason:"No GitHub token provided"};try{const t=await fetch("https://models.inference.ai.azure.com/chat/completions",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify({model:"gpt-4o",messages:[{role:"system",content:'You are analyzing pasted text (like Jira tickets, requirements docs, emails, etc). Extract structured information and return ONLY a valid JSON object (no markdown, no code blocks, no explanation). Use these fields (omit if not found): featureName (short title), date (any date mentioned), requestor (who requested/stakeholders), origin (one of: User Research, Business Metric, Competitor Analysis, Stakeholder Request, Technical Debt, Legal, Other), description (brief summary), problem (problem statement), who (target users), outcome (business outcome), segments (user segments), workflow (current workflow), assumptions (array of strings), questions (array of strings), actions (array of requirement analysis tasks like "Schedule user interview", "Review competitor solutions", "Create user flow", NOT implementation/development tasks), notes (array of additional points). Return raw JSON only.'},{role:"user",content:n}],temperature:.5,max_tokens:2e3})});if(!t.ok){const r=await t.text();throw new Error(`GitHub API returned ${t.status}: ${r}`)}let i=(await t.json()).choices[0].message.content;if(i=i.trim(),i.startsWith("```")){const r=i.match(/```(?:json)?\s*\n?([\s\S]*?)\n?```/);r&&(i=r[1].trim())}i=i.replace(/^`+|`+$/g,"").trim();try{const r=JSON.parse(i);return console.log("Successfully parsed AI response:",r),r}catch(r){return console.error("Failed to parse JSON:",r,"Content:",i),{notes:`Failed to parse AI response. Raw content:

`+i,_fallback:!0,_reason:"JSON parsing failed: "+r.message}}}catch(t){return console.error("Failed to analyze pasted text:",t),{notes:n.split(`
`).filter(s=>s.trim()).map(s=>` ${s.trim()}`).join(`
`),_fallback:!0,_reason:t.message||"API request failed"}}};function aA(n){let e=0,t=0;const s=i=>{t++,i&&String(i).trim()&&e++};return Object.values(n.overview).forEach(s),s(n.phase),Object.values(n.problem).forEach(s),Object.values(n.context).forEach(s),t++,n.assumptions.length>0&&e++,t++,Object.values(n.edges).filter(i=>i.considered).length>0&&e++,s(n.scope.affected),s(n.scope.newPatterns),s(n.scope.technical),t++,n.scope.items.length>0&&e++,t++,n.questions.length>0&&e++,t++,(n.actions||[]).length>0&&e++,Object.values(n.summary).forEach(s),t>0?Math.round(e/t*100):0}function pM(n){let e=0,t=0;const s=i=>{t++,i&&String(i).trim()&&e++};return Object.values(n.overview).forEach(s),s(n.phase),Object.values(n.problem).forEach(s),Object.values(n.context).forEach(s),t++,n.assumptions.length>0&&e++,t++,Object.values(n.edges).filter(i=>i.considered).length>0&&e++,s(n.scope.affected),s(n.scope.newPatterns),s(n.scope.technical),t++,n.scope.items.length>0&&e++,t++,n.questions.length>0&&e++,t++,(n.actions||[]).length>0&&e++,Object.values(n.summary).forEach(s),{filled:e,total:t}}function mM(n,e){var r,a;let t=0,s=0;const i=l=>{s++,l&&String(l).trim()&&t++};switch(e){case"overview":Object.values(n.overview).forEach(i),i(n.phase);break;case"problem":Object.values(n.problem).forEach(i);break;case"context":Object.values(n.context).forEach(i);break;case"assumptions":s=1,n.assumptions.length>0&&(t=1);break;case"edges":s=Kh.length,t=Object.values(n.edges).filter(l=>l.considered).length;break;case"scope":i(n.scope.affected),i(n.scope.newPatterns),i(n.scope.technical),s++,n.scope.items.length>0&&t++;break;case"questions":s=1,n.questions.length>0&&(t=1);break;case"actions":s=1,(n.actions||[]).length>0&&(t=1);break;case"mapping":s=1,(a=(r=n.mapping)==null?void 0:r.figmaUrl)!=null&&a.trim()&&(t=1);break;case"notes":i(n.notes);break;case"summary":Object.values(n.summary).forEach(i);break}return s>0?Math.round(t/s*100):0}function lA(n){var i,r;const e=[],t=a=>e.push(`
## ${a}`),s=(a,l)=>{l!=null&&l.trim()&&e.push(`**${a}:** ${l}`)};if(e.push(`# ${n.name||"Untitled Design Task"}`),e.push(`*Created: ${new Date(n.createdAt).toLocaleDateString()}*`),n.phase&&e.push(`*Target Phase: ${n.phase}*`),n.jiraTicket&&e.push(`*JIRA Ticket: ${n.jiraTicket}*`),t("Overview"),s("Feature",n.overview.featureName),s("Date",n.overview.date),s("Stakeholders",n.overview.requestor),s("Origin",n.overview.origin==="Other"&&n.overview.originOther?`Other: ${n.overview.originOther}`:n.overview.origin),n.overview.description&&e.push(`
${n.overview.description}`),t("Problem & Purpose"),s("Problem",n.problem.problem),s("Who",n.problem.who),s("Business Outcome",n.problem.outcome),s("Success Metrics",n.problem.metrics),s("If Not Built",n.problem.ifNotBuilt),t("User Context"),s("Target Segments",n.context.segments),s("Current Workflow",n.context.workflow),s("Workarounds",n.context.workarounds),s("Triggers",n.context.triggers),s("Before/After",n.context.beforeAfter),t("Assumptions"),n.assumptions.length===0&&e.push("*No assumptions logged yet.*"),n.assumptions.forEach((a,l)=>e.push(`${l+1}. [${a.status}] ${a.text}`)),t("Edge Cases"),Kh.forEach(a=>{const l=n.edges[a.id];l!=null&&l.considered?e.push(`- [x] **${a.label}**${l.notes?`: ${l.notes}`:""}`):e.push(`- [ ] ${a.label}`)}),t("Scope & Versions"),s("Affected Features",n.scope.affected),s("New Patterns Needed",n.scope.newPatterns),s("Technical Constraints",n.scope.technical),n.scope.items.length>0){e.push(`
### Scope Items by Version`);const a={};n.scope.items.forEach(l=>{const c=l.version||"Unassigned";a[c]||(a[c]=[]),a[c].push(l)}),Object.entries(a).forEach(([l,c])=>{e.push(`
**${l}**`),c.forEach(u=>{const d=u.priority?` [${u.priority}]`:"";e.push(`- ${u.item}${d}${u.description?`  ${u.description}`:""}`)})})}return t("Open Questions"),n.questions.length===0&&e.push("*No questions logged yet.*"),n.questions.forEach((a,l)=>{var u;const c=a.status==="Answered"?"Y":"?";e.push(`${l+1}. [${c}] (${a.type}) ${a.text}`),(u=a.answer)!=null&&u.trim()&&e.push(`   - ${a.answer}`)}),t("Design actions"),(n.actions||[]).length===0&&e.push("*No actions logged yet.*"),(n.actions||[]).forEach((a,l)=>e.push(`${l+1}. [${a.completed?"X":" "}] ${a.text}`)),t("Mapping"),(i=n.mapping)!=null&&i.figmaUrl?e.push(`Figma Embed: ${n.mapping.figmaUrl}`):e.push("*No mapping URL set.*"),t("Notes"),(r=n.notes)!=null&&r.trim()?e.push(n.notes):e.push("*No notes.*"),t("Summary"),s("Confidence",n.summary.confidence),s("Key Concerns",n.summary.concerns),s("Next Steps",n.summary.nextSteps),e.join(`
`)}function cA(n){const e=n.split(`
`),t=Ch();let s="",i=[];const r=l=>{const c=l.match(/\*\*([^:]+):\*\*\s*(.+)/);return c?{label:c[1].trim(),value:c[2].trim()}:null},a=()=>{const l=i.join(`
`).trim();switch(s){case"Overview":i.forEach(u=>{const d=r(u);if(!d){u&&!u.startsWith("**")&&t.overview.description===""&&(t.overview.description=l.split(`
`).filter(h=>!h.startsWith("**")).join(`
`).trim());return}d.label==="Feature"&&(t.overview.featureName=d.value),d.label==="Date"&&(t.overview.date=d.value),d.label==="Stakeholders"&&(t.overview.requestor=d.value),d.label==="Origin"&&(d.value.startsWith("Other: ")?(t.overview.origin="Other",t.overview.originOther=d.value.substring(7)):t.overview.origin=d.value)});break;case"Problem & Purpose":i.forEach(u=>{const d=r(u);d&&(d.label==="Problem"&&(t.problem.problem=d.value),d.label==="Who"&&(t.problem.who=d.value),d.label==="Business Outcome"&&(t.problem.outcome=d.value),d.label==="Success Metrics"&&(t.problem.metrics=d.value),d.label==="If Not Built"&&(t.problem.ifNotBuilt=d.value))});break;case"User Context":i.forEach(u=>{const d=r(u);d&&(d.label==="Target Segments"&&(t.context.segments=d.value),d.label==="Current Workflow"&&(t.context.workflow=d.value),d.label==="Workarounds"&&(t.context.workarounds=d.value),d.label==="Triggers"&&(t.context.triggers=d.value),d.label==="Before/After"&&(t.context.beforeAfter=d.value))});break;case"Assumptions":i.forEach(u=>{const d=u.match(/^\d+\.\s*\[([^\]]+)\]\s*(.+)/);d&&t.assumptions.push({id:Hr(),text:d[2].trim(),status:d[1].trim()})});break;case"Design actions":i.forEach(u=>{const d=u.match(/^\d+\.\s*\[([^\]]+)\]\s*(.+)/);d&&t.actions.push({id:Hr(),text:d[2].trim(),completed:d[1].trim()==="X",note:""})});break;case"Open Questions":i.forEach(u=>{const d=u.match(/^\d+\.\s*\[([^\]]+)\]\s*\(([^)]+)\)\s*(.+)/);d&&t.questions.push({id:Hr(),text:d[3].trim(),type:d[2].trim(),status:d[1].trim()==="Y"?"Answered":"Open",answer:""})});break;case"Mapping":const c=l.match(/Figma Embed:\s*(.+)/);c&&(t.mapping={figmaUrl:c[1].trim()});break;case"Notes":l&&!l.includes("*No notes.*")&&(t.notes=l);break;case"Summary":i.forEach(u=>{const d=r(u);d&&(d.label==="Confidence"&&(t.summary.confidence=d.value),d.label==="Key Concerns"&&(t.summary.concerns=d.value),d.label==="Next Steps"&&(t.summary.nextSteps=d.value))});break}i=[]};return e.forEach((l,c)=>{if(c===0&&l.startsWith("# ")){t.name=l.substring(2).trim();return}if(l.startsWith("*Target Phase:")){const u=l.match(/\*Target Phase:\s*([^*]+)\*/);u&&(t.phase=u[1].trim());return}if(l.startsWith("*JIRA Ticket:")){const u=l.match(/\*JIRA Ticket:\s*([^*]+)\*/);u&&(t.jiraTicket=u[1].trim());return}if(l.startsWith("## ")){s&&a(),s=l.substring(3).trim();return}!i.length&&!l.trim()||l.trim()&&i.push(l)}),s&&a(),t}const dt=({label:n,hint:e,placeholder:t,value:s,onChange:i,multiline:r=!1,rows:a=3})=>g.jsxs("div",{className:"mb-4",children:[g.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:n}),e&&g.jsx("p",{className:"text-xs text-slate-400 dark:text-slate-500 mb-1.5",children:e}),r?g.jsx("textarea",{className:"w-full px-3 py-2 text-sm border border-slate-200 dark:border-slate-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-slate-300 dark:focus:ring-slate-500 focus:border-slate-400 dark:focus:border-slate-500 resize-y bg-white dark:bg-slate-700 text-slate-800 dark:text-slate-200",rows:a,value:s||"",onChange:l=>i(l.target.value),placeholder:t}):g.jsx("input",{type:"text",className:"w-full px-3 py-2 text-sm border border-slate-200 dark:border-slate-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-slate-300 dark:focus:ring-slate-500 focus:border-slate-400 dark:focus:border-slate-500 bg-white dark:bg-slate-700 text-slate-800 dark:text-slate-200",value:s||"",onChange:l=>i(l.target.value),placeholder:t})]}),KC=({label:n,hint:e,value:t,options:s,onChange:i,allowEmpty:r=!0})=>g.jsxs("div",{className:"mb-4",children:[g.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:n}),e&&g.jsx("p",{className:"text-xs text-slate-400 dark:text-slate-500 mb-1.5",children:e}),g.jsxs("select",{className:"w-full px-3 py-2 text-sm border border-slate-200 dark:border-slate-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-slate-300 dark:focus:ring-slate-500 focus:border-slate-400 dark:focus:border-slate-500 bg-white dark:bg-slate-700 text-slate-800 dark:text-slate-200",value:t||"",onChange:a=>i(a.target.value),children:[r&&g.jsx("option",{value:"",children:"Select..."}),s.map(a=>g.jsx("option",{value:a,children:a},a))]})]}),uA=({version:n,size:e="sm"})=>{if(!n)return null;const t=Or[n]||Or.Future,s=e==="xs"?"text-xs px-1.5 py-0":"text-xs px-2 py-0.5";return g.jsx("span",{className:`${s} rounded-full font-medium ${t.bg} ${t.text} ${t.border} border`,children:n})},gM=({active:n,onClick:e,children:t,completion:s,count:i})=>g.jsxs("button",{onClick:e,className:`flex items-center gap-2 px-3 py-2 text-sm rounded-lg transition-all whitespace-nowrap ${n?"bg-slate-800 dark:bg-slate-600 text-white font-medium":"text-slate-600 dark:text-slate-300 hover:bg-slate-100 dark:hover:bg-slate-700"}`,children:[g.jsx("span",{children:t}),i!==void 0&&i>0&&g.jsx("span",{className:`text-xs px-1.5 py-0.5 rounded-full ${n?"bg-slate-600 dark:bg-slate-700 text-slate-200":"bg-slate-100 dark:bg-slate-700 text-slate-500 dark:text-slate-400"}`,children:i})]}),Gi=({title:n,description:e})=>g.jsxs("div",{className:"mb-6 pb-4 border-b border-slate-100 dark:border-slate-700",children:[g.jsx("h2",{className:"text-lg font-semibold text-slate-800 dark:text-slate-200",children:n}),e&&g.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400 mt-1",children:e})]}),vM=({data:n,phase:e,jiraTicket:t,secureMode:s,audioModalOpen:i,pasteModalOpen:r,onChange:a,onPhaseChange:l,onJiraTicketChange:c,onSecureModeChange:u,onOpenAudioModal:d,onOpenPasteModal:h})=>g.jsxs("div",{children:[g.jsx(Gi,{title:"Overview",description:"Basic information about the feature requirement."}),g.jsxs("div",{className:"mb-6 p-4 bg-slate-50 dark:bg-slate-800 rounded-lg border border-slate-200 dark:border-slate-700",children:[g.jsxs("div",{className:"flex items-center justify-between mb-3",children:[g.jsxs("div",{children:[g.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-200",children:"Secure Mode"}),g.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400 mt-0.5",children:"Enable encryption and disable external services for sensitive data"})]}),g.jsxs("button",{onClick:()=>u(!s),className:`px-4 py-2 text-sm font-medium rounded-lg transition-colors flex items-center gap-2 ${s?"bg-emerald-600 dark:bg-emerald-700 text-white hover:bg-emerald-700 dark:hover:bg-emerald-600":"bg-slate-200 dark:bg-slate-700 text-slate-700 dark:text-slate-300 hover:bg-slate-300 dark:hover:bg-slate-600"}`,children:[g.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"})}),s?"ON":"OFF"]})]}),!s&&g.jsxs("div",{className:"flex gap-2 pt-3 border-t border-slate-200 dark:border-slate-700",children:[g.jsxs("button",{onClick:d,className:"flex-1 px-4 py-2.5 text-sm text-slate-700 dark:text-slate-200 hover:text-slate-900 dark:hover:text-white border border-slate-300 dark:border-slate-600 rounded-lg hover:border-slate-400 dark:hover:border-slate-500 transition-colors flex items-center justify-center gap-2 font-medium",children:[g.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-8a3 3 0 01-3-3V5a3 3 0 116 0v6a3 3 0 01-3 3z"})}),"Audio Analysis"]}),g.jsxs("button",{onClick:h,className:"flex-1 px-4 py-2.5 text-sm text-slate-700 dark:text-slate-200 hover:text-slate-900 dark:hover:text-white border border-slate-300 dark:border-slate-600 rounded-lg hover:border-slate-400 dark:hover:border-slate-500 transition-colors flex items-center justify-center gap-2 font-medium",children:[g.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Text Analysis"]})]}),s&&g.jsx("p",{className:"text-xs text-emerald-600 dark:text-emerald-400 font-medium pt-3 border-t border-slate-200 dark:border-slate-700",children:" Data encrypted  External services disabled  GitHub sync hidden"})]}),g.jsx(dt,{label:"JIRA Ticket",value:t,onChange:c,placeholder:"e.g., PROJ-123"}),g.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[g.jsx(dt,{label:"Feature Name",value:n.featureName,onChange:f=>a({...n,featureName:f})}),g.jsx(dt,{label:"Date",value:n.date,onChange:f=>a({...n,date:f})})]}),g.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[g.jsx(dt,{label:"Stakeholders / Source",value:n.requestor,onChange:f=>a({...n,requestor:f})}),g.jsx(KC,{label:"Requirement Origin",value:n.origin,options:sM,onChange:f=>a({...n,origin:f})})]}),n.origin==="Other"&&g.jsx(dt,{label:"Specify Other Origin",value:n.originOther,onChange:f=>a({...n,originOther:f})}),g.jsxs("div",{className:"mb-4",children:[g.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Target Version"}),g.jsx("p",{className:"text-xs text-slate-400 mb-2",children:"Which release phase is this analysis targeting?"}),g.jsx("div",{className:"flex gap-2 flex-wrap",children:lo.filter(f=>f!=="Cut").map(f=>{const p=Or[f],v=e===f;return g.jsx("button",{onClick:()=>l(v?"":f),className:`px-3 py-1.5 text-xs font-medium rounded-full border transition-all ${v?`${p.bg} ${p.text} ${p.border} ring-2 ring-offset-1 ring-slate-300`:"bg-white text-slate-500 border-slate-200 hover:border-slate-300"}`,children:f},f)})})]}),g.jsx(dt,{label:"Brief Description",hint:"What is this feature in one or two sentences?",multiline:!0,value:n.description,onChange:f=>a({...n,description:f})})]}),yM=({data:n,onChange:e})=>g.jsxs("div",{children:[g.jsx(Gi,{title:"Problem & Purpose",description:"Understand the why before the what."}),g.jsx(dt,{label:"What problem does this solve?",multiline:!0,hint:"Be specific. Vague problems lead to vague solutions.",value:n.problem,onChange:t=>e({...n,problem:t})}),g.jsx(dt,{label:"Who experiences this problem?",multiline:!0,hint:"Which users, how often, and in what circumstances?",value:n.who,onChange:t=>e({...n,who:t})}),g.jsx(dt,{label:"What's the desired business outcome?",multiline:!0,value:n.outcome,onChange:t=>e({...n,outcome:t})}),g.jsx(dt,{label:"How will we measure success?",multiline:!0,hint:"If stakeholders can't define this, the requirement isn't ready.",value:n.metrics,onChange:t=>e({...n,metrics:t})}),g.jsx(dt,{label:"What happens if we don't build this?",multiline:!0,hint:"Helps gauge urgency and priority.",value:n.ifNotBuilt,onChange:t=>e({...n,ifNotBuilt:t})})]}),xM=({data:n,onChange:e})=>g.jsxs("div",{children:[g.jsx(Gi,{title:"User Context",description:"Map the who, when, and current reality."}),g.jsx(dt,{label:"Target user segment(s)",multiline:!0,value:n.segments,onChange:t=>e({...n,segments:t})}),g.jsx(dt,{label:"Current workflow",multiline:!0,hint:"What does the user do today without this feature?",value:n.workflow,onChange:t=>e({...n,workflow:t})}),g.jsx(dt,{label:"Existing workarounds",multiline:!0,hint:"If there's no workaround, question whether the problem is real. If there is, study it  your solution must beat it.",value:n.workarounds,onChange:t=>e({...n,workarounds:t})}),g.jsx(dt,{label:"What triggers the need?",multiline:!0,hint:"What moment or event causes the user to want this?",value:n.triggers,onChange:t=>e({...n,triggers:t})}),g.jsx(dt,{label:"What happens before and after?",multiline:!0,hint:"The surrounding flow shapes constraints on your design.",value:n.beforeAfter,onChange:t=>e({...n,beforeAfter:t})})]}),bM=({data:n,onChange:e})=>{const[t,s]=q.useState("Open"),i=()=>e([...n,{id:Hr(),text:"",status:"Unvalidated",tags:[]}]),r=(d,h,f)=>e(n.map(p=>p.id===d?{...p,[h]:f}:p)),a=d=>e(n.filter(h=>h.id!==d)),l=d=>{d.target.style.height="auto",d.target.style.height=d.target.scrollHeight+"px"},c=d=>{d&&(d.style.height="auto",d.style.height=d.scrollHeight+"px")},u=t==="Open"?n.filter(d=>d.status==="Unvalidated"||d.status==="Needs Research"):n.filter(d=>d.status==="Validated"||d.status==="Disproven");return g.jsxs("div",{children:[g.jsx(Gi,{title:"Assumptions",description:"Every requirement carries hidden assumptions. Name them so you can validate or flag them."}),n.length>0&&g.jsx("div",{className:"flex items-center justify-end mb-4",children:g.jsxs("div",{className:"flex gap-1",children:[g.jsx("button",{onClick:()=>s("Open"),className:`px-2 py-1 text-xs rounded ${t==="Open"?"bg-slate-800 dark:bg-slate-600 text-white":"bg-slate-100 dark:bg-slate-700 text-slate-700 dark:text-slate-200 hover:bg-slate-200 dark:hover:bg-slate-600"}`,children:"Open"}),g.jsx("button",{onClick:()=>s("Answered"),className:`px-2 py-1 text-xs rounded ${t==="Answered"?"bg-slate-800 dark:bg-slate-600 text-white":"bg-slate-100 dark:bg-slate-700 text-slate-700 dark:text-slate-200 hover:bg-slate-200 dark:hover:bg-slate-600"}`,children:"Answered"})]})}),n.length===0&&g.jsx("div",{className:"text-center py-8 text-slate-400 dark:text-slate-500 text-sm border border-dashed border-slate-200 dark:border-slate-600 rounded-lg mb-4",children:"No assumptions logged yet. Start adding them below."}),g.jsx("div",{className:"space-y-3 mb-4",children:u.map((d,h)=>g.jsxs("div",{className:"flex gap-2 items-start p-3 bg-slate-50 rounded-lg border border-slate-100",children:[g.jsx("span",{className:"text-xs text-slate-400 mt-2.5 font-mono w-5 shrink-0",children:h+1}),g.jsxs("div",{className:"flex-1 space-y-2",children:[g.jsx("textarea",{ref:c,className:"w-full px-2 py-1.5 text-sm border border-slate-200 rounded bg-white focus:outline-none focus:ring-1 focus:ring-slate-300 resize-none overflow-hidden",style:{minHeight:"36px"},placeholder:"Describe the assumption...",value:d.text,onChange:f=>{r(d.id,"text",f.target.value),l(f)},onInput:l,rows:1}),g.jsxs("div",{className:"flex gap-2 flex-wrap items-center",children:[g.jsx("select",{className:"px-2 py-1 text-xs border border-slate-200 rounded bg-white focus:outline-none focus:ring-1 focus:ring-slate-300",value:d.status,onChange:f=>r(d.id,"status",f.target.value),children:iM.map(f=>g.jsx("option",{value:f,children:f},f))}),g.jsxs("label",{className:"flex items-center gap-1.5 text-xs text-slate-600 cursor-pointer",children:[g.jsx("input",{type:"checkbox",checked:(d.tags||[]).includes("B2B"),onChange:f=>{const p=d.tags||[];r(d.id,"tags",f.target.checked?[...p.filter(v=>v!=="B2B"),"B2B"]:p.filter(v=>v!=="B2B"))},className:"rounded border-slate-300 text-slate-600 focus:ring-slate-300"}),"B2B"]}),g.jsxs("label",{className:"flex items-center gap-1.5 text-xs text-slate-600 cursor-pointer",children:[g.jsx("input",{type:"checkbox",checked:(d.tags||[]).includes("B2C"),onChange:f=>{const p=d.tags||[];r(d.id,"tags",f.target.checked?[...p.filter(v=>v!=="B2C"),"B2C"]:p.filter(v=>v!=="B2C"))},className:"rounded border-slate-300 text-slate-600 focus:ring-slate-300"}),"B2C"]})]})]}),g.jsx("button",{onClick:()=>a(d.id),className:"text-slate-300 dark:text-slate-600 hover:text-red-400 dark:hover:text-red-500 text-lg mt-1.5 px-1",children:""})]},d.id))}),g.jsx("button",{onClick:i,className:"text-sm text-slate-700 dark:text-slate-200 hover:text-slate-900 dark:hover:text-white border border-dashed border-slate-300 dark:border-slate-600 rounded-lg px-4 py-2 hover:border-slate-400 dark:hover:border-slate-500 transition-colors",children:"+ Add assumption"})]})},wM=({data:n,onChange:e})=>{const t=r=>e({...n,[r]:{...n[r],considered:!n[r].considered}}),s=(r,a)=>e({...n,[r]:{...n[r],notes:a}}),i=Object.values(n).filter(r=>r.considered).length;return g.jsxs("div",{children:[g.jsx(Gi,{title:"Edge Cases & States",description:"Requirements almost never cover these. They're where most design complexity lives."}),g.jsxs("p",{className:"text-xs text-slate-500 mb-4",children:[i," of ",Kh.length," considered"]}),g.jsx("div",{className:"space-y-2",children:Kh.map(r=>{const a=n[r.id]||{considered:!1,notes:""};return g.jsxs("div",{className:`border rounded-lg transition-colors ${a.considered?"border-emerald-200 bg-emerald-50/30":"border-slate-100 bg-white"}`,children:[g.jsxs("div",{className:"flex items-center gap-3 px-4 py-3 cursor-pointer",onClick:()=>t(r.id),children:[g.jsx("div",{className:`w-5 h-5 rounded border-2 flex items-center justify-center shrink-0 transition-colors ${a.considered?"border-emerald-500 bg-emerald-500":"border-slate-300"}`,children:a.considered&&g.jsx("svg",{className:"w-3 h-3 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M5 13l4 4L19 7"})})}),g.jsxs("div",{className:"flex-1",children:[g.jsx("span",{className:"text-sm font-medium text-slate-700",children:r.label}),g.jsx("span",{className:"text-xs text-slate-400 ml-2",children:r.hint})]})]}),a.considered&&g.jsx("div",{className:"px-4 pb-3 pl-12",children:g.jsx("textarea",{className:"w-full px-2 py-1.5 text-sm border border-slate-200 rounded bg-white focus:outline-none focus:ring-1 focus:ring-slate-300 resize-y",rows:2,placeholder:"Notes on how you'll handle this...",value:a.notes,onChange:l=>s(r.id,l.target.value),onClick:l=>l.stopPropagation()})})]},r.id)})})]})},AM=({data:n,onChange:e})=>{const t=n.items||[],s=(p,v)=>e({...n,[p]:v}),i=p=>e({...n,items:p}),r=()=>i([...t,{id:Hr(),item:"",description:"",version:"MVP",priority:"Must"}]),a=(p,v,b)=>i(t.map(S=>S.id===p?{...S,[v]:b}:S)),l=p=>i(t.filter(v=>v.id!==p)),c=p=>{p.target.style.height="auto",p.target.style.height=p.target.scrollHeight+"px"},u=p=>{p&&(p.style.height="auto",p.style.height=p.scrollHeight+"px")},d=q.useMemo(()=>{const p={};return lo.forEach(v=>{p[v]=[]}),p.Unassigned=[],t.forEach(v=>{const b=v.version||"Unassigned";p[b]||(p[b]=[]),p[b].push(v)}),p},[t]),[h,f]=q.useState("list");return g.jsxs("div",{children:[g.jsx(Gi,{title:"Scope & Versions",description:"Break the feature into scope items and assign each to a release version."}),g.jsx(dt,{label:"Affected existing features",multiline:!0,hint:"What current functionality does this change or interact with?",value:n.affected,onChange:p=>s("affected",p)}),g.jsx(dt,{label:"New components or patterns needed",multiline:!0,hint:"Can you reuse existing patterns, or does this require new ones?",value:n.newPatterns,onChange:p=>s("newPatterns",p)}),g.jsx(dt,{label:"Technical dependencies or constraints",multiline:!0,value:n.technical,onChange:p=>s("technical",p)}),g.jsxs("div",{className:"border-t border-slate-100 pt-5 mt-5",children:[g.jsxs("div",{className:"flex items-center justify-between mb-4",children:[g.jsxs("div",{children:[g.jsx("p",{className:"text-sm font-medium text-slate-700",children:"Scope Items"}),g.jsxs("p",{className:"text-xs text-slate-400 mt-0.5",children:[t.length," item",t.length!==1?"s":""," across ",Object.values(d).filter(p=>p.length>0).length," version",Object.values(d).filter(p=>p.length>0).length!==1?"s":""]})]}),g.jsxs("div",{className:"flex gap-1 bg-slate-100 rounded-lg p-0.5",children:[g.jsx("button",{onClick:()=>f("list"),className:`px-3 py-1 text-xs rounded-md transition-colors ${h==="list"?"bg-white text-slate-700 shadow-sm":"text-slate-500"}`,children:"List"}),g.jsx("button",{onClick:()=>f("versions"),className:`px-3 py-1 text-xs rounded-md transition-colors ${h==="versions"?"bg-white text-slate-700 shadow-sm":"text-slate-500"}`,children:"By Version"})]})]}),t.length===0&&g.jsx("div",{className:"text-center py-8 text-slate-400 text-sm border border-dashed border-slate-200 rounded-lg mb-4",children:"No scope items yet. Add items and assign them to versions."}),h==="list"&&t.length>0&&g.jsx("div",{className:"space-y-2 mb-4",children:t.map((p,v)=>{const b=Or[p.version]||Or.Future;return g.jsx("div",{className:`p-3 rounded-lg border ${b.border} bg-white`,children:g.jsxs("div",{className:"flex gap-2 items-start",children:[g.jsx("div",{className:`w-1 self-stretch rounded-full shrink-0 ${b.dot}`}),g.jsxs("div",{className:"flex-1 space-y-2",children:[g.jsx("textarea",{ref:u,className:"w-full px-2 py-1.5 text-sm border border-slate-200 rounded bg-white focus:outline-none focus:ring-1 focus:ring-slate-300 font-medium resize-none overflow-hidden",style:{minHeight:"36px"},placeholder:"Scope item name...",value:p.item,onChange:S=>{a(p.id,"item",S.target.value),c(S)},onInput:c,rows:1}),g.jsx("textarea",{ref:u,className:"w-full px-2 py-1.5 text-xs border border-slate-100 rounded bg-slate-50 focus:outline-none focus:ring-1 focus:ring-slate-300 resize-none overflow-hidden",style:{minHeight:"32px"},placeholder:"Brief description (optional)...",value:p.description,onChange:S=>{a(p.id,"description",S.target.value),c(S)},onInput:c,rows:1}),g.jsxs("div",{className:"flex gap-2 flex-wrap items-center",children:[g.jsx("select",{className:`px-2 py-1 text-xs rounded-full font-medium border ${b.bg} ${b.text} ${b.border} focus:outline-none`,value:p.version,onChange:S=>a(p.id,"version",S.target.value),children:lo.map(S=>g.jsx("option",{value:S,children:S},S))}),g.jsx("select",{className:"px-2 py-1 text-xs border border-slate-200 rounded bg-white focus:outline-none",value:p.priority,onChange:S=>a(p.id,"priority",S.target.value),children:nM.map(S=>g.jsx("option",{value:S,children:S},S))})]})]}),g.jsx("button",{onClick:()=>l(p.id),className:"text-slate-300 hover:text-red-400 text-lg mt-1 px-1",children:""})]})},p.id)})}),h==="versions"&&t.length>0&&g.jsx("div",{className:"space-y-4 mb-4",children:lo.map(p=>{const v=d[p]||[];if(v.length===0)return null;const b=Or[p];return g.jsxs("div",{className:`rounded-lg border ${b.border} overflow-hidden`,children:[g.jsxs("div",{className:`px-4 py-2 ${b.bg} flex items-center justify-between`,children:[g.jsx("span",{className:`text-sm font-semibold ${b.text}`,children:p}),g.jsxs("span",{className:`text-xs ${b.text} opacity-70`,children:[v.length," item",v.length!==1?"s":""]})]}),g.jsx("div",{className:"divide-y divide-slate-100",children:v.map(S=>g.jsxs("div",{className:"px-4 py-2.5 flex items-center gap-3 bg-white",children:[g.jsx("span",{className:`text-xs px-1.5 py-0.5 rounded border ${S.priority==="Must"?"bg-red-50 text-red-600 border-red-200":S.priority==="Should"?"bg-amber-50 text-amber-600 border-amber-200":S.priority==="Could"?"bg-blue-50 text-blue-600 border-blue-200":"bg-slate-50 text-slate-500 border-slate-200"}`,children:S.priority}),g.jsxs("div",{className:"flex-1 min-w-0",children:[g.jsx("p",{className:"text-sm font-medium text-slate-700 truncate",children:S.item||"Unnamed item"}),S.description&&g.jsx("p",{className:"text-xs text-slate-400 truncate",children:S.description})]})]},S.id))})]},p)})}),g.jsx("button",{onClick:r,className:"text-sm text-slate-700 dark:text-slate-200 hover:text-slate-900 dark:hover:text-white border border-dashed border-slate-300 dark:border-slate-600 rounded-lg px-4 py-2 hover:border-slate-400 dark:hover:border-slate-500 transition-colors",children:"+ Add scope item"}),t.length>0&&g.jsxs("div",{className:"mt-5 pt-4 border-t border-slate-100",children:[g.jsx("p",{className:"text-xs text-slate-500 mb-2",children:"Version distribution"}),g.jsx("div",{className:"flex h-3 rounded-full overflow-hidden bg-slate-100",children:lo.map(p=>{const v=(d[p]||[]).length;if(v===0)return null;const b=v/t.length*100;return g.jsx("div",{className:`${Or[p].dot} transition-all`,style:{width:`${b}%`},title:`${p}: ${v} item${v!==1?"s":""}`},p)})}),g.jsx("div",{className:"flex gap-3 mt-2 flex-wrap",children:lo.map(p=>{const v=(d[p]||[]).length;return v===0?null:g.jsxs("span",{className:"flex items-center gap-1.5 text-xs text-slate-500",children:[g.jsx("span",{className:`w-2 h-2 rounded-full ${Or[p].dot}`}),p,": ",v]},p)})})]})]})]})},kM=({data:n,onChange:e})=>{const[t,s]=q.useState("Open"),i=()=>e([...n,{id:Hr(),text:"",type:"Stakeholder",status:"Open",answer:"",dependency:!1,tags:[]}]),r=(v,b,S)=>e(n.map(y=>y.id===v?{...y,[b]:S}:y)),a=v=>e(n.filter(b=>b.id!==v));n.filter(v=>v.status==="Open").length;const l=v=>{v.target.style.height="auto",v.target.style.height=v.target.scrollHeight+"px"},c=v=>{v&&(v.style.height="auto",v.style.height=v.scrollHeight+"px")},u=n.filter(v=>v.status===t),d=u.filter(v=>!v.dependency||v.dependency&&!Ea.includes(v.type)),h=u.filter(v=>v.dependency&&Ea.includes(v.type)),f=Ea.reduce((v,b)=>(v[b]=h.filter(S=>S.type===b),v),{}),p=(v,b,S=!0)=>g.jsx("div",{className:`p-3 rounded-lg border ${v.status==="Answered"?"bg-slate-50 dark:bg-slate-700 border-slate-100 dark:border-slate-600":"bg-amber-50/30 dark:bg-amber-900/10 border-amber-200/60 dark:border-amber-800/40"}`,children:g.jsxs("div",{className:"flex gap-2 items-start",children:[S&&g.jsx("span",{className:"text-xs text-slate-400 dark:text-slate-500 mt-2 font-mono w-5 shrink-0",children:b+1}),g.jsxs("div",{className:"flex-1 space-y-2",children:[g.jsx("textarea",{ref:c,className:"w-full px-2 py-1.5 text-sm border border-slate-200 dark:border-slate-600 rounded bg-white dark:bg-slate-800 text-slate-900 dark:text-slate-100 focus:outline-none focus:ring-1 focus:ring-slate-300 dark:focus:ring-slate-500 resize-none overflow-hidden",style:{minHeight:"36px"},placeholder:"What do you need to find out?",value:v.text,onChange:y=>{r(v.id,"text",y.target.value),l(y)},onInput:l,rows:1}),g.jsxs("div",{className:"flex gap-2 flex-wrap items-center",children:[g.jsxs("label",{className:"flex items-center gap-1.5 text-xs text-slate-600 dark:text-slate-300 cursor-pointer",children:[g.jsx("input",{type:"checkbox",checked:v.dependency||!1,onChange:y=>r(v.id,"dependency",y.target.checked),className:"rounded border-slate-300 dark:border-slate-600 text-slate-600 dark:text-slate-400 focus:ring-slate-300 dark:focus:ring-slate-500"}),"Dependency"]}),v.dependency&&g.jsxs("select",{className:"px-2 py-1 text-xs border border-slate-200 dark:border-slate-600 rounded bg-white dark:bg-slate-800 text-slate-900 dark:text-slate-100",value:Ea.includes(v.type)?v.type:"",onChange:y=>r(v.id,"type",y.target.value),children:[!Ea.includes(v.type)&&g.jsx("option",{value:"",children:"Select type..."}),Ea.map(y=>g.jsx("option",{value:y,children:y},y))]}),g.jsx("select",{className:"px-2 py-1 text-xs border border-slate-200 dark:border-slate-600 rounded bg-white dark:bg-slate-800 text-slate-900 dark:text-slate-100",value:v.status,onChange:y=>r(v.id,"status",y.target.value),children:rM.map(y=>g.jsx("option",{value:y,children:y},y))}),g.jsxs("label",{className:"flex items-center gap-1.5 text-xs text-slate-600 dark:text-slate-300 cursor-pointer",children:[g.jsx("input",{type:"checkbox",checked:(v.tags||[]).includes("B2B"),onChange:y=>{const k=v.tags||[];r(v.id,"tags",y.target.checked?[...k.filter(w=>w!=="B2B"),"B2B"]:k.filter(w=>w!=="B2B"))},className:"rounded border-slate-300 dark:border-slate-600 text-slate-600 dark:text-slate-400 focus:ring-slate-300 dark:focus:ring-slate-500"}),"B2B"]}),g.jsxs("label",{className:"flex items-center gap-1.5 text-xs text-slate-600 dark:text-slate-300 cursor-pointer",children:[g.jsx("input",{type:"checkbox",checked:(v.tags||[]).includes("B2C"),onChange:y=>{const k=v.tags||[];r(v.id,"tags",y.target.checked?[...k.filter(w=>w!=="B2C"),"B2C"]:k.filter(w=>w!=="B2C"))},className:"rounded border-slate-300 dark:border-slate-600 text-slate-600 dark:text-slate-400 focus:ring-slate-300 dark:focus:ring-slate-500"}),"B2C"]})]}),v.status==="Answered"&&g.jsx("textarea",{ref:c,className:"w-full px-2 py-1.5 text-sm border border-emerald-200 dark:border-emerald-800 rounded bg-emerald-50 dark:bg-emerald-900/20 text-slate-900 dark:text-slate-100 focus:outline-none focus:ring-1 focus:ring-emerald-300 dark:focus:ring-emerald-700 resize-none overflow-hidden",style:{minHeight:"36px"},placeholder:"Answer...",value:v.answer,onChange:y=>{r(v.id,"answer",y.target.value),l(y)},onInput:l,rows:1})]}),g.jsx("button",{onClick:()=>a(v.id),className:"text-slate-300 dark:text-slate-600 hover:text-red-400 dark:hover:text-red-500 text-lg mt-1 px-1",children:""})]})},v.id);return g.jsxs("div",{children:[g.jsx(Gi,{title:"Open Questions",description:"What you don't know. Surface these early  they're your blocker list."}),n.length>0&&g.jsx("div",{className:"flex items-center justify-end mb-4",children:g.jsxs("div",{className:"flex gap-1",children:[g.jsx("button",{onClick:()=>s("Open"),className:`px-2 py-1 text-xs rounded ${t==="Open"?"bg-slate-800 dark:bg-slate-600 text-white":"bg-slate-100 dark:bg-slate-700 text-slate-700 dark:text-slate-200 hover:bg-slate-200 dark:hover:bg-slate-600"}`,children:"Open"}),g.jsx("button",{onClick:()=>s("Answered"),className:`px-2 py-1 text-xs rounded ${t==="Answered"?"bg-slate-800 dark:bg-slate-600 text-white":"bg-slate-100 dark:bg-slate-700 text-slate-700 dark:text-slate-200 hover:bg-slate-200 dark:hover:bg-slate-600"}`,children:"Answered"})]})}),n.length===0&&g.jsx("div",{className:"text-center py-8 text-slate-400 dark:text-slate-500 text-sm border border-dashed border-slate-200 dark:border-slate-600 rounded-lg mb-4",children:"No questions logged yet."}),g.jsxs("div",{className:"space-y-4 mb-4",children:[d.length>0&&g.jsx("div",{className:"space-y-3",children:d.map((v,b)=>p(v,b))}),Ea.map(v=>{const b=f[v];return!b||b.length===0?null:g.jsxs("div",{className:"space-y-3",children:[g.jsx("h3",{className:"text-xs font-semibold text-slate-600 dark:text-slate-400 uppercase tracking-wide mt-6",children:v}),b.map(S=>p(S,0,!1))]},v)})]}),g.jsx("button",{onClick:i,className:"text-sm text-slate-700 dark:text-slate-200 hover:text-slate-900 dark:hover:text-white border border-dashed border-slate-300 dark:border-slate-600 rounded-lg px-4 py-2 hover:border-slate-400 dark:hover:border-slate-500 transition-colors",children:"+ Add question"})]})},SM=({data:n,onChange:e})=>{const[t,s]=q.useState("To Do"),[i,r]=q.useState({}),a=()=>e([...n,{id:Hr(),text:"",completed:!1,note:""}]),l=(v,b,S)=>e(n.map(y=>y.id===v?{...y,[b]:S}:y)),c=v=>e(n.filter(b=>b.id!==v)),u=v=>r(b=>({...b,[v]:!b[v]})),d=v=>{v.target.style.height="auto",v.target.style.height=v.target.scrollHeight+"px"},h=v=>{v&&(v.style.height="auto",v.style.height=v.scrollHeight+"px")},f=n.filter(v=>v.completed).length,p=t==="To Do"?n.filter(v=>!v.completed):n.filter(v=>v.completed);return g.jsxs("div",{children:[n.length>0&&g.jsxs("div",{className:"flex items-center justify-between mb-4",children:[g.jsxs("p",{className:"text-sm text-slate-600 dark:text-slate-300",children:[f," of ",n.length," completed"]}),g.jsxs("div",{className:"flex gap-1",children:[g.jsx("button",{onClick:()=>s("To Do"),className:`px-2 py-1 text-xs rounded ${t==="To Do"?"bg-slate-800 dark:bg-slate-600 text-white":"bg-slate-100 dark:bg-slate-700 text-slate-700 dark:text-slate-200 hover:bg-slate-200 dark:hover:bg-slate-600"}`,children:"To Do"}),g.jsx("button",{onClick:()=>s("Done"),className:`px-2 py-1 text-xs rounded ${t==="Done"?"bg-slate-800 dark:bg-slate-600 text-white":"bg-slate-100 dark:bg-slate-700 text-slate-700 dark:text-slate-200 hover:bg-slate-200 dark:hover:bg-slate-600"}`,children:"Done"})]})]}),n.length===0&&g.jsx("div",{className:"text-center py-8 text-slate-400 dark:text-slate-500 text-sm border border-dashed border-slate-200 dark:border-slate-600 rounded-lg mb-4",children:"No design actions yet. Add tasks below."}),g.jsx("div",{className:"space-y-2 mb-4",children:p.map(v=>g.jsx("div",{className:`rounded-lg ${v.completed?"bg-green-50 dark:bg-green-900/20":"bg-white dark:bg-slate-700 border border-slate-200 dark:border-slate-600"}`,children:g.jsxs("div",{className:"flex gap-3 items-start p-3",children:[g.jsx("input",{type:"checkbox",checked:v.completed,onChange:b=>l(v.id,"completed",b.target.checked),className:`w-5 h-5 mt-1 rounded focus:ring-2 shrink-0 ${v.completed?"border-green-400 dark:border-green-500 text-green-600 dark:text-green-500 focus:ring-green-400 dark:focus:ring-green-500":"border-slate-300 dark:border-slate-500 text-slate-800 dark:text-slate-200 focus:ring-slate-400 dark:focus:ring-slate-500"}`}),g.jsxs("div",{className:"flex-1 min-w-0",children:[g.jsx("textarea",{ref:h,className:`w-full text-sm border-none bg-transparent focus:outline-none resize-none overflow-hidden ${v.completed?"text-green-700 dark:text-green-400":"text-slate-900 dark:text-slate-100"}`,style:{minHeight:"24px"},placeholder:"Describe the action...",value:v.text,onChange:b=>{l(v.id,"text",b.target.value),d(b)},onInput:d,rows:1}),i[v.id]&&g.jsx("textarea",{ref:h,className:"w-full mt-2 px-2 py-1.5 text-xs bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-600 rounded focus:outline-none focus:ring-2 focus:ring-slate-300 dark:focus:ring-slate-500 resize-none overflow-hidden text-slate-900 dark:text-slate-100",style:{minHeight:"36px"},placeholder:"Add a note or link...",value:v.note||"",onChange:b=>{l(v.id,"note",b.target.value),d(b)},onInput:d,rows:1})]}),g.jsxs("div",{className:"flex items-center gap-1",children:[v.completed&&g.jsx("button",{onClick:()=>u(v.id),className:"text-slate-400 dark:text-slate-500 hover:text-slate-600 dark:hover:text-slate-300 text-sm shrink-0",children:i[v.id]?"":""}),g.jsx("button",{onClick:()=>c(v.id),className:"text-slate-300 dark:text-slate-600 hover:text-red-400 dark:hover:text-red-500 text-lg shrink-0",children:""})]})]})},v.id))}),g.jsx("button",{onClick:a,className:"text-sm text-slate-700 dark:text-slate-200 hover:text-slate-900 dark:hover:text-slate-50 border border-dashed border-slate-300 dark:border-slate-600 rounded-lg px-4 py-2.5 hover:border-slate-400 dark:hover:border-slate-500 transition-colors font-medium",children:"+ Add Action"})]})},EM=({data:n,onChange:e})=>g.jsxs("div",{children:[g.jsx(Gi,{title:"Notes",description:"Additional notes, observations, or reminders about this requirement."}),g.jsx(dt,{label:"Notes",multiline:!0,hint:"Use this space for any additional information that doesn't fit elsewhere.",rows:10,value:n,onChange:e})]}),CM=({data:n,onChange:e})=>g.jsxs("div",{children:[g.jsx(Gi,{title:"Mapping",description:"Visual mapping and conceptual diagrams for this requirement."}),g.jsxs("div",{className:"mb-4",children:[g.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:"Figjam/Figma Embed URL"}),g.jsx("input",{type:"text",value:n.figmaUrl||"",onChange:t=>e({...n,figmaUrl:t.target.value}),placeholder:"https://embed.figma.com/...",className:"w-full px-3 py-2 text-sm border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-700 text-slate-700 dark:text-slate-200 focus:outline-none focus:ring-2 focus:ring-slate-400"}),g.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400 mt-1",children:"Paste a Figjam or Figma embed URL to display your mapping board"})]}),n.figmaUrl&&g.jsx("div",{className:"-mx-6",children:g.jsx("div",{className:"border-t border-b border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 w-full",style:{height:"calc(100vh - 280px)",minHeight:"600px"},children:g.jsx("iframe",{style:{border:"1px solid rgba(0, 0, 0, 0.1)"},width:"100%",height:"100%",src:n.figmaUrl,allowFullScreen:!0,className:"w-full h-full"})})})]}),TM=({data:n,onChange:e})=>g.jsxs("div",{children:[g.jsx(Gi,{title:"Summary & Next Steps",description:"Your overall assessment and what needs to happen next."}),g.jsx(KC,{label:"Overall Confidence",hint:"How ready is this requirement for design?",value:n.confidence,options:oM,onChange:t=>e({...n,confidence:t})}),g.jsx(dt,{label:"Key Concerns",multiline:!0,hint:"What worries you most about this requirement?",value:n.concerns,onChange:t=>e({...n,concerns:t})}),g.jsx(dt,{label:"Recommended Next Steps",multiline:!0,hint:"What actions should happen before design work begins?",rows:4,value:n.nextSteps,onChange:t=>e({...n,nextSteps:t})})]}),dA=({className:n="w-4 h-4"})=>g.jsxs("svg",{className:n,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[g.jsx("path",{d:"M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z"}),g.jsx("path",{d:"M19 10v2a7 7 0 0 1-14 0v-2"}),g.jsx("line",{x1:"12",y1:"19",x2:"12",y2:"23"}),g.jsx("line",{x1:"8",y1:"23",x2:"16",y2:"23"})]}),_M=({className:n="w-4 h-4"})=>g.jsx("svg",{className:n,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:g.jsx("path",{d:"M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"})}),NM=({isOpen:n,onClose:e,onImportNew:t,onImportExisting:s,analysisName:i})=>n?g.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50 p-8",onClick:e,children:g.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl shadow-2xl w-full max-w-md flex flex-col",onClick:r=>r.stopPropagation(),children:[g.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-b border-slate-100 dark:border-slate-700",children:[g.jsx("h3",{className:"font-semibold text-slate-800 dark:text-slate-200",children:"Import Markdown"}),g.jsx("button",{onClick:e,className:"text-slate-400 dark:text-slate-500 hover:text-slate-600 dark:hover:text-slate-300",children:""})]}),g.jsxs("div",{className:"p-6",children:[g.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-300 mb-6",children:"Choose how to import this markdown file:"}),g.jsxs("div",{className:"space-y-3",children:[g.jsxs("button",{onClick:t,className:"w-full px-4 py-3 text-left border-2 border-slate-200 dark:border-slate-600 rounded-lg hover:border-slate-400 dark:hover:border-slate-500 hover:bg-slate-50 dark:hover:bg-slate-700 transition-colors",children:[g.jsx("div",{className:"font-medium text-slate-800 dark:text-slate-200 mb-1",children:"Create New Task"}),g.jsx("div",{className:"text-sm text-slate-500 dark:text-slate-400",children:"Import as a new design task"})]}),g.jsxs("button",{onClick:s,className:"w-full px-4 py-3 text-left border-2 border-slate-200 dark:border-slate-600 rounded-lg hover:border-slate-400 dark:hover:border-slate-500 hover:bg-slate-50 dark:hover:bg-slate-700 transition-colors",children:[g.jsx("div",{className:"font-medium text-slate-800 dark:text-slate-200 mb-1",children:"Add to Current Task"}),g.jsxs("div",{className:"text-sm text-slate-500 dark:text-slate-400",children:['Merge with "',i,'"']})]})]})]}),g.jsx("div",{className:"px-6 py-4 border-t border-slate-100 dark:border-slate-700 flex justify-end",children:g.jsx("button",{onClick:e,className:"px-4 py-2 text-sm text-slate-700 dark:text-slate-200 hover:text-slate-900 dark:hover:text-white border border-slate-300 dark:border-slate-600 rounded-lg hover:border-slate-400 dark:hover:border-slate-500 transition-colors",children:"Cancel"})})]})}):null,PM=({isOpen:n,onClose:e,pastedText:t,onTextChange:s,onAnalyze:i,analyzing:r,results:a,onApply:l,githubAIKey:c,onSetGitHubAIKey:u,onDeleteField:d,pastedImage:h,onImageChange:f,onImageAnalyze:p,pastedPdf:v,onPdfChange:b,onPdfAnalyze:S})=>{const[y,k]=React.useState("text");if(!n)return null;const w=a&&Object.keys(a).length>0,E=async _=>{var D;const P=(D=_.clipboardData)==null?void 0:D.items;if(P){for(let I of P)if(I.type.startsWith("image/")){const F=I.getAsFile();if(F){const K=new FileReader;K.onload=Z=>{f(Z.target.result)},K.readAsDataURL(F)}}}},C=_=>{var D;const P=(D=_.target.files)==null?void 0:D[0];if(P&&P.type.startsWith("image/")){const I=new FileReader;I.onload=F=>{f(F.target.result)},I.readAsDataURL(P)}},T=_=>{var D;const P=(D=_.target.files)==null?void 0:D[0];P&&P.type==="application/pdf"&&b(P)};return g.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50 p-8",onClick:e,children:g.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl shadow-2xl w-full max-w-3xl max-h-full flex flex-col",onClick:_=>_.stopPropagation(),children:[g.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-b border-slate-100 dark:border-slate-700",children:[g.jsx("h3",{className:"font-semibold text-slate-800 dark:text-slate-200",children:"Paste & Analyze"}),g.jsx("button",{onClick:e,className:"text-slate-400 dark:text-slate-500 hover:text-slate-600 dark:hover:text-slate-300 text-2xl leading-none",children:""})]}),g.jsxs("div",{className:"flex border-b border-slate-200 dark:border-slate-700 px-6",children:[g.jsx("button",{onClick:()=>k("text"),className:`px-4 py-3 text-sm font-medium border-b-2 transition-colors ${y==="text"?"border-slate-800 dark:border-slate-200 text-slate-800 dark:text-slate-200":"border-transparent text-slate-500 dark:text-slate-400 hover:text-slate-700 dark:hover:text-slate-300"}`,children:"Text"}),g.jsx("button",{onClick:()=>k("image"),className:`px-4 py-3 text-sm font-medium border-b-2 transition-colors ${y==="image"?"border-slate-800 dark:border-slate-200 text-slate-800 dark:text-slate-200":"border-transparent text-slate-500 dark:text-slate-400 hover:text-slate-700 dark:hover:text-slate-300"}`,children:"Image"}),g.jsx("button",{onClick:()=>k("pdf"),className:`px-4 py-3 text-sm font-medium border-b-2 transition-colors ${y==="pdf"?"border-slate-800 dark:border-slate-200 text-slate-800 dark:text-slate-200":"border-transparent text-slate-500 dark:text-slate-400 hover:text-slate-700 dark:hover:text-slate-300"}`,children:"PDF"})]}),g.jsxs("div",{className:"flex-1 overflow-y-auto p-6",children:[y==="text"&&g.jsxs("div",{className:"mb-6",children:[g.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-200 mb-2",children:"Paste Text"}),g.jsx("textarea",{value:t,onChange:_=>s(_.target.value),placeholder:"Paste your Jira ticket, requirements, or any text here...",className:"w-full px-3 py-2 text-sm border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-700 text-slate-700 dark:text-slate-200 focus:outline-none focus:ring-2 focus:ring-slate-400 dark:focus:ring-slate-500",rows:10}),!w&&t.trim()&&g.jsx("button",{onClick:i,disabled:r,className:"mt-3 px-4 py-2 text-sm bg-slate-800 dark:bg-slate-700 text-white rounded-lg hover:bg-slate-700 dark:hover:bg-slate-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed font-medium",children:r?"Analyzing...":c?"Analyze with AI":"Analyze"})]}),y==="image"&&g.jsxs("div",{className:"mb-6",children:[g.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-200 mb-2",children:"Paste or Upload Image"}),g.jsx("div",{className:"w-full min-h-[240px] border-2 border-dashed border-slate-300 dark:border-slate-600 rounded-lg bg-slate-50 dark:bg-slate-700/50 flex items-center justify-center p-4",onPaste:E,children:h?g.jsxs("div",{className:"w-full",children:[g.jsx("img",{src:h,alt:"Pasted content",className:"max-w-full max-h-[400px] mx-auto rounded"}),g.jsx("button",{onClick:()=>f(null),className:"mt-3 px-3 py-1 text-xs text-red-600 dark:text-red-400 hover:text-red-800 dark:hover:text-red-300 border border-red-300 dark:border-red-600 hover:border-red-400 dark:hover:border-red-500 rounded transition-colors",children:"Clear Image"})]}):g.jsxs("div",{className:"text-center",children:[g.jsx("svg",{className:"w-12 h-12 mx-auto text-slate-400 dark:text-slate-500 mb-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})}),g.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-300 mb-2",children:"Press Ctrl+V (or Cmd+V) to paste image"}),g.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400 mb-3",children:"or"}),g.jsxs("label",{className:"inline-block px-4 py-2 text-sm bg-slate-200 dark:bg-slate-600 text-slate-700 dark:text-slate-200 rounded-lg hover:bg-slate-300 dark:hover:bg-slate-500 transition-colors cursor-pointer",children:["Choose File",g.jsx("input",{type:"file",accept:"image/*",onChange:C,className:"hidden"})]}),g.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400 mt-2",children:"Screenshot Jira tickets, wireframes, designs, etc."})]})}),!w&&h&&g.jsx("button",{onClick:p,disabled:r,className:"mt-3 px-4 py-2 text-sm bg-slate-800 dark:bg-slate-700 text-white rounded-lg hover:bg-slate-700 dark:hover:bg-slate-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed font-medium",children:r?"Analyzing...":c?"Analyze with AI":"Analyze"})]}),y==="pdf"&&g.jsxs("div",{className:"mb-6",children:[g.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-200 mb-2",children:"Upload PDF"}),g.jsx("div",{className:"w-full min-h-[240px] border-2 border-dashed border-slate-300 dark:border-slate-600 rounded-lg bg-slate-50 dark:bg-slate-700/50 flex items-center justify-center p-4",children:v?g.jsxs("div",{className:"w-full text-center",children:[g.jsx("svg",{className:"w-16 h-16 mx-auto text-red-500 dark:text-red-400 mb-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z"})}),g.jsx("p",{className:"text-sm font-medium text-slate-700 dark:text-slate-200 mb-1",children:v.name}),g.jsxs("p",{className:"text-xs text-slate-500 dark:text-slate-400 mb-3",children:[(v.size/1024).toFixed(1)," KB"]}),g.jsx("button",{onClick:()=>b(null),className:"px-3 py-1 text-xs text-red-600 dark:text-red-400 hover:text-red-800 dark:hover:text-red-300 border border-red-300 dark:border-red-600 hover:border-red-400 dark:hover:border-red-500 rounded transition-colors",children:"Clear PDF"})]}):g.jsxs("div",{className:"text-center",children:[g.jsx("svg",{className:"w-12 h-12 mx-auto text-slate-400 dark:text-slate-500 mb-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z"})}),g.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-300 mb-3",children:"Upload a PDF document"}),g.jsxs("label",{className:"inline-block px-4 py-2 text-sm bg-slate-200 dark:bg-slate-600 text-slate-700 dark:text-slate-200 rounded-lg hover:bg-slate-300 dark:hover:bg-slate-500 transition-colors cursor-pointer",children:["Choose PDF File",g.jsx("input",{type:"file",accept:"application/pdf,.pdf",onChange:T,className:"hidden"})]}),g.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400 mt-2",children:"Upload requirement documents, specifications, etc."})]})}),!w&&v&&g.jsx("button",{onClick:S,disabled:r,className:"mt-3 px-4 py-2 text-sm bg-slate-800 dark:bg-slate-700 text-white rounded-lg hover:bg-slate-700 dark:hover:bg-slate-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed font-medium",children:r?"Analyzing...":c?"Analyze with AI":"Analyze"})]}),!c&&(t.trim()||h||v)&&g.jsxs("div",{className:"mb-6 p-4 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg",children:[g.jsx("p",{className:"text-sm text-blue-800 dark:text-blue-200 mb-2",children:"Add a GitHub Personal Access Token for AI-powered field extraction. Without it, content will be added to notes as bullet points."}),g.jsx("input",{type:"password",placeholder:"github_pat_... or ghp_...",value:c||"",onChange:_=>u(_.target.value),className:"w-full px-3 py-2 text-sm border border-blue-300 dark:border-blue-700 rounded bg-white dark:bg-slate-700 text-slate-700 dark:text-slate-200 focus:outline-none focus:ring-2 focus:ring-blue-400 dark:focus:ring-blue-600"})]}),c&&(t.trim()||h||v)&&g.jsxs("div",{className:"mb-6 p-4 bg-slate-50 dark:bg-slate-700 border border-slate-200 dark:border-slate-600 rounded-lg flex items-start justify-between",children:[g.jsxs("div",{className:"flex-1",children:[g.jsx("p",{className:"text-sm font-medium text-slate-800 dark:text-slate-200 mb-1",children:"GitHub Token: Active"}),g.jsx("p",{className:"text-xs text-slate-600 dark:text-slate-400",children:w?"Token is saved. Clear to enter a new one.":'Click "Analyze with AI" to extract structured information.'})]}),g.jsx("button",{onClick:()=>u(""),className:"ml-4 px-3 py-1 text-xs text-red-600 dark:text-red-400 hover:text-red-800 dark:hover:text-red-300 border border-red-300 dark:border-red-600 hover:border-red-400 dark:hover:border-red-500 rounded transition-colors",children:"Clear Token"})]}),w&&g.jsxs("div",{children:[a._fallback&&g.jsxs("div",{className:"mb-4 p-3 bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 rounded-lg",children:[g.jsx("p",{className:"text-sm text-yellow-800 dark:text-yellow-200 font-medium mb-1",children:"Basic formatting applied"}),g.jsxs("p",{className:"text-xs text-yellow-700 dark:text-yellow-300",children:[a._reason||"AI extraction was not used.",a._reason&&a._reason.includes("token")?"":" Clear the token above and add a valid GitHub Personal Access Token to use AI-powered extraction."]})]}),g.jsx("h4",{className:"text-sm font-semibold text-slate-800 dark:text-slate-200 mb-3",children:a._fallback?"Extracted Information":"Fields to Populate"}),g.jsxs("div",{className:"space-y-2 mb-4",children:[a.featureName&&g.jsxs("div",{className:"border border-blue-200 rounded-lg p-3 bg-blue-50",children:[g.jsxs("div",{className:"flex items-center justify-between mb-1",children:[g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx("span",{className:"text-xs font-semibold text-blue-700 px-2 py-0.5 bg-blue-100 rounded",children:"Overview"}),g.jsx("span",{className:"text-xs font-medium text-slate-600",children:"Feature Name"})]}),g.jsx("button",{onClick:()=>d("featureName"),className:"text-slate-400 hover:text-red-600 transition-colors",title:"Delete this field",children:g.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),g.jsx("div",{className:"text-sm text-slate-700",children:a.featureName})]}),a.date&&g.jsxs("div",{className:"border border-blue-200 rounded-lg p-3 bg-blue-50",children:[g.jsxs("div",{className:"flex items-center justify-between mb-1",children:[g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx("span",{className:"text-xs font-semibold text-blue-700 px-2 py-0.5 bg-blue-100 rounded",children:"Overview"}),g.jsx("span",{className:"text-xs font-medium text-slate-600",children:"Date"})]}),g.jsx("button",{onClick:()=>d("date"),className:"text-slate-400 hover:text-red-600 transition-colors",title:"Delete this field",children:g.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),g.jsx("div",{className:"text-sm text-slate-700",children:a.date})]}),a.requestor&&g.jsxs("div",{className:"border border-blue-200 rounded-lg p-3 bg-blue-50",children:[g.jsxs("div",{className:"flex items-center justify-between mb-1",children:[g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx("span",{className:"text-xs font-semibold text-blue-700 px-2 py-0.5 bg-blue-100 rounded",children:"Overview"}),g.jsx("span",{className:"text-xs font-medium text-slate-600",children:"Requestor"})]}),g.jsx("button",{onClick:()=>d("requestor"),className:"text-slate-400 hover:text-red-600 transition-colors",title:"Delete this field",children:g.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),g.jsx("div",{className:"text-sm text-slate-700",children:a.requestor})]}),a.origin&&g.jsxs("div",{className:"border border-blue-200 rounded-lg p-3 bg-blue-50",children:[g.jsxs("div",{className:"flex items-center justify-between mb-1",children:[g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx("span",{className:"text-xs font-semibold text-blue-700 px-2 py-0.5 bg-blue-100 rounded",children:"Overview"}),g.jsx("span",{className:"text-xs font-medium text-slate-600",children:"Origin"})]}),g.jsx("button",{onClick:()=>d("origin"),className:"text-slate-400 hover:text-red-600 transition-colors",title:"Delete this field",children:g.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),g.jsx("div",{className:"text-sm text-slate-700",children:a.origin})]}),a.description&&g.jsxs("div",{className:"border border-blue-200 rounded-lg p-3 bg-blue-50",children:[g.jsxs("div",{className:"flex items-center justify-between mb-1",children:[g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx("span",{className:"text-xs font-semibold text-blue-700 px-2 py-0.5 bg-blue-100 rounded",children:"Overview"}),g.jsx("span",{className:"text-xs font-medium text-slate-600",children:"Description"})]}),g.jsx("button",{onClick:()=>d("description"),className:"text-slate-400 hover:text-red-600 transition-colors",title:"Delete this field",children:g.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),g.jsx("div",{className:"text-sm text-slate-700 whitespace-pre-wrap",children:a.description})]}),a.problem&&g.jsxs("div",{className:"border border-purple-200 rounded-lg p-3 bg-purple-50",children:[g.jsxs("div",{className:"flex items-center justify-between mb-1",children:[g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx("span",{className:"text-xs font-semibold text-purple-700 px-2 py-0.5 bg-purple-100 rounded",children:"Problem"}),g.jsx("span",{className:"text-xs font-medium text-slate-600",children:"Problem Statement"})]}),g.jsx("button",{onClick:()=>d("problem"),className:"text-slate-400 hover:text-red-600 transition-colors",title:"Delete this field",children:g.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),g.jsx("div",{className:"text-sm text-slate-700 whitespace-pre-wrap",children:a.problem})]}),a.who&&g.jsxs("div",{className:"border border-purple-200 rounded-lg p-3 bg-purple-50",children:[g.jsxs("div",{className:"flex items-center justify-between mb-1",children:[g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx("span",{className:"text-xs font-semibold text-purple-700 px-2 py-0.5 bg-purple-100 rounded",children:"Problem"}),g.jsx("span",{className:"text-xs font-medium text-slate-600",children:"Who (Target Users)"})]}),g.jsx("button",{onClick:()=>d("who"),className:"text-slate-400 hover:text-red-600 transition-colors",title:"Delete this field",children:g.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),g.jsx("div",{className:"text-sm text-slate-700 whitespace-pre-wrap",children:a.who})]}),a.outcome&&g.jsxs("div",{className:"border border-purple-200 rounded-lg p-3 bg-purple-50",children:[g.jsxs("div",{className:"flex items-center justify-between mb-1",children:[g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx("span",{className:"text-xs font-semibold text-purple-700 px-2 py-0.5 bg-purple-100 rounded",children:"Problem"}),g.jsx("span",{className:"text-xs font-medium text-slate-600",children:"Outcome"})]}),g.jsx("button",{onClick:()=>d("outcome"),className:"text-slate-400 hover:text-red-600 transition-colors",title:"Delete this field",children:g.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),g.jsx("div",{className:"text-sm text-slate-700 whitespace-pre-wrap",children:a.outcome})]}),a.segments&&g.jsxs("div",{className:"border border-green-200 rounded-lg p-3 bg-green-50",children:[g.jsxs("div",{className:"flex items-center justify-between mb-1",children:[g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx("span",{className:"text-xs font-semibold text-green-700 px-2 py-0.5 bg-green-100 rounded",children:"Context"}),g.jsx("span",{className:"text-xs font-medium text-slate-600",children:"User Segments"})]}),g.jsx("button",{onClick:()=>d("segments"),className:"text-slate-400 hover:text-red-600 transition-colors",title:"Delete this field",children:g.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),g.jsx("div",{className:"text-sm text-slate-700 whitespace-pre-wrap",children:a.segments})]}),a.workflow&&g.jsxs("div",{className:"border border-green-200 rounded-lg p-3 bg-green-50",children:[g.jsxs("div",{className:"flex items-center justify-between mb-1",children:[g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx("span",{className:"text-xs font-semibold text-green-700 px-2 py-0.5 bg-green-100 rounded",children:"Context"}),g.jsx("span",{className:"text-xs font-medium text-slate-600",children:"Current Workflow"})]}),g.jsx("button",{onClick:()=>d("workflow"),className:"text-slate-400 hover:text-red-600 transition-colors",title:"Delete this field",children:g.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),g.jsx("div",{className:"text-sm text-slate-700 whitespace-pre-wrap",children:a.workflow})]}),a.assumptions&&Array.isArray(a.assumptions)&&a.assumptions.length>0&&g.jsxs("div",{className:"border border-orange-200 rounded-lg p-3 bg-orange-50",children:[g.jsxs("div",{className:"flex items-center justify-between mb-1",children:[g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx("span",{className:"text-xs font-semibold text-orange-700 px-2 py-0.5 bg-orange-100 rounded",children:"Assumptions"}),g.jsxs("span",{className:"text-xs font-medium text-slate-600",children:[a.assumptions.length," item(s)"]})]}),g.jsx("button",{onClick:()=>d("assumptions"),className:"text-slate-400 hover:text-red-600 transition-colors",title:"Delete this field",children:g.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),g.jsx("div",{className:"text-sm text-slate-700",children:a.assumptions.map((_,P)=>g.jsxs("div",{children:[" ",_]},P))})]}),a.questions&&Array.isArray(a.questions)&&a.questions.length>0&&g.jsxs("div",{className:"border border-pink-200 rounded-lg p-3 bg-pink-50",children:[g.jsxs("div",{className:"flex items-center justify-between mb-1",children:[g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx("span",{className:"text-xs font-semibold text-pink-700 px-2 py-0.5 bg-pink-100 rounded",children:"Questions"}),g.jsxs("span",{className:"text-xs font-medium text-slate-600",children:[a.questions.length," item(s)"]})]}),g.jsx("button",{onClick:()=>d("questions"),className:"text-slate-400 hover:text-red-600 transition-colors",title:"Delete this field",children:g.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),g.jsx("div",{className:"text-sm text-slate-700",children:a.questions.map((_,P)=>g.jsxs("div",{children:[" ",_]},P))})]}),a.actions&&Array.isArray(a.actions)&&a.actions.length>0&&g.jsxs("div",{className:"border border-indigo-200 rounded-lg p-3 bg-indigo-50",children:[g.jsxs("div",{className:"flex items-center justify-between mb-1",children:[g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx("span",{className:"text-xs font-semibold text-indigo-700 px-2 py-0.5 bg-indigo-100 rounded",children:"Actions"}),g.jsxs("span",{className:"text-xs font-medium text-slate-600",children:[a.actions.length," item(s)"]})]}),g.jsx("button",{onClick:()=>d("actions"),className:"text-slate-400 hover:text-red-600 transition-colors",title:"Delete this field",children:g.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),g.jsx("div",{className:"text-sm text-slate-700",children:a.actions.map((_,P)=>g.jsxs("div",{children:[" ",_]},P))})]}),a.notes&&g.jsxs("div",{className:"border border-slate-200 rounded-lg p-3 bg-slate-50",children:[g.jsxs("div",{className:"flex items-center justify-between mb-1",children:[g.jsx("div",{className:"flex items-center gap-2",children:g.jsx("span",{className:"text-xs font-semibold text-slate-700 px-2 py-0.5 bg-slate-100 rounded",children:"Notes"})}),g.jsx("button",{onClick:()=>d("notes"),className:"text-slate-400 hover:text-red-600 transition-colors",title:"Delete this field",children:g.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),g.jsx("div",{className:"text-sm text-slate-700",children:Array.isArray(a.notes)?a.notes.map((_,P)=>g.jsxs("div",{children:[" ",_]},P)):g.jsx("div",{className:"whitespace-pre-wrap",children:a.notes})})]})]})]})]}),g.jsxs("div",{className:"px-6 py-4 border-t border-slate-100 flex justify-end gap-2",children:[g.jsx("button",{onClick:e,className:"px-4 py-2 text-sm text-slate-600 hover:text-slate-800 border border-slate-300 rounded-lg hover:border-slate-400 transition-colors",children:"Cancel"}),w&&g.jsx("button",{onClick:l,className:"px-4 py-2 text-sm font-medium bg-slate-800 text-white rounded-lg hover:bg-slate-700 transition-colors",children:"Apply to Task"})]})]})})},MM=({isOpen:n,onClose:e,isRecording:t,transcript:s,audioProcessing:i,aiSuggestions:r,selectedSections:a,onToggleSection:l,onUpdateSuggestion:c,onStartRecording:u,onStopRecording:d,onFileUpload:h,onAnalyze:f,onApply:p,githubAIKey:v,onSetGitHubAIKey:b})=>{const S=q.useRef(null);if(!n)return null;const y=s&&s.trim().length>0,k=Object.keys(r).length>0;return g.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50 p-8",onClick:e,children:g.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl shadow-2xl w-full max-w-3xl max-h-full flex flex-col",onClick:w=>w.stopPropagation(),children:[g.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-b border-slate-100 dark:border-slate-700",children:[g.jsxs("h3",{className:"font-semibold text-slate-800 dark:text-slate-200 flex items-center gap-2",children:[g.jsx(dA,{className:"w-5 h-5"}),"Audio Analysis"]}),g.jsx("button",{onClick:e,className:"text-slate-400 dark:text-slate-500 hover:text-slate-600 dark:hover:text-slate-300",children:""})]}),g.jsxs("div",{className:"flex-1 overflow-y-auto p-6",children:[g.jsxs("div",{className:"mb-6",children:[g.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[g.jsx("button",{onClick:t?d:u,disabled:i,className:`px-4 py-2.5 text-sm rounded-lg font-medium transition-colors flex items-center gap-2 ${t?"bg-red-500 text-white hover:bg-red-600":"bg-slate-800 dark:bg-slate-600 text-white hover:bg-slate-700 dark:hover:bg-slate-500"} disabled:opacity-50 disabled:cursor-not-allowed`,children:t?g.jsxs(g.Fragment,{children:[g.jsx("span",{className:"w-3 h-3 bg-white rounded-sm"}),"Stop Recording"]}):g.jsxs(g.Fragment,{children:[g.jsx(dA,{className:"w-4 h-4"}),"Start Recording"]})}),g.jsx("span",{className:"text-slate-400",children:"or"}),g.jsxs("label",{className:"px-4 py-2.5 text-sm text-slate-700 dark:text-slate-200 hover:text-slate-900 dark:hover:text-white border border-slate-300 dark:border-slate-600 rounded-lg hover:border-slate-400 dark:hover:border-slate-500 transition-colors cursor-pointer font-medium flex items-center gap-2",children:[g.jsx(_M,{className:"w-4 h-4"}),"Upload Audio",g.jsx("input",{ref:S,type:"file",accept:".mp3,.wav,.m4a,.ogg,.webm",onChange:h,className:"hidden",disabled:i||t})]}),i&&g.jsx("span",{className:"text-sm text-slate-500",children:"Processing..."})]}),t&&g.jsxs("div",{className:"flex items-center gap-2 text-red-500 text-sm",children:[g.jsx("span",{className:"inline-block w-3 h-3 bg-red-500 rounded-full animate-pulse"}),"Recording in progress..."]})]}),y&&g.jsxs("div",{className:"mb-6",children:[g.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Transcript"}),g.jsx("textarea",{value:s,readOnly:!0,className:"w-full px-3 py-2 text-sm border border-slate-300 rounded-lg bg-slate-50 text-slate-700 font-mono",rows:6}),!k&&g.jsx("button",{onClick:f,disabled:i,className:"mt-3 px-4 py-2 text-sm bg-slate-800 text-white rounded-lg hover:bg-slate-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed font-medium",children:v?"Analyze with AI":"Prepare Suggestions"})]}),k&&g.jsxs("div",{children:[g.jsx("h4",{className:"text-sm font-semibold text-slate-800 mb-3",children:"Suggested Updates"}),g.jsx("div",{className:"space-y-3",children:Object.entries(r).map(([w,E])=>g.jsxs("div",{className:"border border-slate-200 rounded-lg p-3",children:[g.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[g.jsx("input",{type:"checkbox",checked:a[w]!==!1,onChange:()=>l(w),className:"rounded border-slate-300 text-slate-800 focus:ring-slate-400"}),g.jsx("label",{className:"text-sm font-medium text-slate-700 capitalize",children:w})]}),g.jsx("textarea",{value:E,onChange:C=>c(w,C.target.value),className:"w-full px-2 py-1.5 text-sm border border-slate-200 rounded bg-white focus:outline-none focus:ring-2 focus:ring-slate-400 resize-none",rows:3})]},w))})]}),!v&&y&&g.jsxs("div",{className:"mt-6 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[g.jsx("p",{className:"text-sm text-blue-800 mb-2",children:"Add a GitHub Personal Access Token for AI-powered analysis, or continue manually."}),g.jsx("input",{type:"password",placeholder:"github_pat_... or ghp_...",value:v,onChange:w=>b(w.target.value),className:"w-full px-3 py-2 text-sm border border-blue-300 rounded bg-white focus:outline-none focus:ring-2 focus:ring-blue-400"})]}),v&&y&&g.jsxs("div",{className:"mt-6 p-4 bg-slate-50 border border-slate-200 rounded-lg flex items-start justify-between",children:[g.jsxs("div",{className:"flex-1",children:[g.jsx("p",{className:"text-sm font-medium text-slate-800 mb-1",children:"GitHub Token: Active"}),g.jsx("p",{className:"text-xs text-slate-600",children:"Token is saved. Clear to enter a new one."})]}),g.jsx("button",{onClick:()=>b(""),className:"ml-4 px-3 py-1 text-xs text-red-600 hover:text-red-800 border border-red-300 hover:border-red-400 rounded transition-colors",children:"Clear Token"})]})]}),g.jsxs("div",{className:"px-6 py-4 border-t border-slate-100 dark:border-slate-700 flex justify-end gap-2",children:[g.jsx("button",{onClick:e,className:"px-4 py-2 text-sm text-slate-700 dark:text-slate-200 hover:text-slate-900 dark:hover:text-white border border-slate-300 dark:border-slate-600 rounded-lg hover:border-slate-400 dark:hover:border-slate-500 transition-colors",children:"Cancel"}),k&&g.jsx("button",{onClick:p,className:"px-4 py-2 text-sm font-medium bg-slate-800 dark:bg-slate-600 text-white rounded-lg hover:bg-slate-700 dark:hover:bg-slate-500 transition-colors",children:"Apply Changes"})]})]})})};function LM(){const[n,e]=q.useState([Ch("Sample: Dark Mode Toggle")]),[t,s]=q.useState(!1),[i,r]=q.useState(()=>{var N;return(N=n[0])==null?void 0:N.id}),[a,l]=q.useState(()=>localStorage.getItem("activeSection")||"overview"),[c,u]=q.useState(!1),[d,h]=q.useState(!0),[f,p]=q.useState(!0),[v,b]=q.useState("All"),[S,y]=q.useState(()=>localStorage.getItem("githubToken")||""),[k,w]=q.useState(""),[E,C]=q.useState(!1),[T,_]=q.useState(!1),[P,D]=q.useState(!1),[I,F]=q.useState(!1),[K,Z]=q.useState(!1),[Q,se]=q.useState(""),[G,$]=q.useState(!1),[R,X]=q.useState(()=>localStorage.getItem("githubAIKey")||""),[Y,ae]=q.useState({}),[te,he]=q.useState({}),[ht,Ae]=q.useState(!1),[_e,ke]=q.useState(""),[sm,nm]=q.useState(""),[eo,Un]=q.useState(!1),[ka,cc]=q.useState(""),[Md,J0]=q.useState(null),[Z0,gw]=q.useState(null),[QC,uc]=q.useState(!1),[me,dc]=q.useState(null),[Sa,JC]=q.useState(()=>localStorage.getItem("darkMode")==="true"),vw=q.useRef(null),yw=q.useMemo(()=>n.some(N=>N.secureMode===!0),[n]);q.useEffect(()=>{(async()=>{try{let B;if(B=await Rv.getItem("requirementAnalyses"),B||(B=localStorage.getItem("requirementAnalyses")),B){const L=JSON.parse(B),fe=Array.isArray(L)?L.map(Fv):[];fe.length>0&&(e(fe),(!i||!fe.find(Hn=>Hn.id===i))&&r(fe[0].id))}}catch(B){console.error("Failed to load data:",B)}finally{s(!0)}})()},[]),q.useEffect(()=>{console.log("Dark mode changed:",Sa),Sa?(document.documentElement.classList.add("dark"),console.log("Added dark class")):(document.documentElement.classList.remove("dark"),console.log("Removed dark class")),localStorage.setItem("darkMode",Sa)},[Sa]),q.useEffect(()=>{const B=new URLSearchParams(window.location.search).get("data");if(B)try{const L=JSON.parse(atob(B)),fe=Fv(L);e([fe]),r(fe.id),window.history.replaceState({},document.title,window.location.pathname)}catch(L){console.error("Failed to decode shared link:",L)}},[]),q.useEffect(()=>{(async()=>{t&&(yw?(await Rv.setItem("requirementAnalyses",JSON.stringify(n)),localStorage.removeItem("requirementAnalyses")):(localStorage.setItem("requirementAnalyses",JSON.stringify(n)),Rv.removeItem("requirementAnalyses")))})()},[n,t,yw]),q.useEffect(()=>{localStorage.removeItem("secureMode")},[]),q.useEffect(()=>{localStorage.setItem("activeSection",a)},[a]),q.useEffect(()=>{S?localStorage.setItem("githubToken",S):localStorage.removeItem("githubToken")},[S]),q.useEffect(()=>{R?localStorage.setItem("githubAIKey",R):localStorage.removeItem("githubAIKey")},[R]);const ee=q.useMemo(()=>n.find(N=>N.id===i),[n,i]),xw=q.useMemo(()=>v==="All"?n:v==="Untagged"?n.filter(N=>!N.phase):n.filter(N=>N.phase===v),[n,v]),ws=q.useCallback((N,B)=>{e(L=>L.map(fe=>fe.id===i?{...fe,[N]:B,updatedAt:new Date().toISOString()}:fe))},[i]),ZC=q.useCallback(N=>{e(B=>B.map(L=>L.id===i?{...L,phase:N,updatedAt:new Date().toISOString()}:L))},[i]),e2=()=>{const N=Ch();e(B=>[N,...B]),r(N.id),l("overview"),b("All")},t2=N=>{e(B=>{const L=B.filter(fe=>fe.id!==N);if(L.length===0){const fe=Ch();return r(fe.id),[fe]}return i===N&&r(L[0].id),L})},s2=N=>{e(B=>B.map(L=>L.id===i?{...L,name:N}:L))},n2=()=>{ee&&u(!0)},i2=N=>{var fe;const B=(fe=N.target.files)==null?void 0:fe[0];if(!B)return;const L=new FileReader;L.onload=Hn=>{const Ld=Hn.target.result;ke(Ld),Ae(!0)},L.readAsText(B),N.target.value=""},r2=()=>{if(_e)try{const N=cA(_e);e(B=>[N,...B]),r(N.id),l("overview"),Ae(!1),ke(""),alert(`Created new task: ${N.name}`)}catch(N){alert(`Failed to import markdown:
${N.message}`)}},o2=()=>{if(!(!_e||!ee))try{const N=cA(_e);e(B=>B.map(L=>L.id!==i?L:{...L,assumptions:[...L.assumptions,...N.assumptions],questions:[...L.questions,...N.questions],actions:[...L.actions||[],...N.actions],notes:L.notes?`${L.notes}

${N.notes}`:N.notes,overview:{featureName:L.overview.featureName||N.overview.featureName,date:L.overview.date||N.overview.date,requestor:L.overview.requestor||N.overview.requestor,origin:L.overview.origin||N.overview.origin,originOther:L.overview.originOther||N.overview.originOther,description:L.overview.description?`${L.overview.description}

${N.overview.description}`:N.overview.description},problem:{problem:L.problem.problem||N.problem.problem,who:L.problem.who||N.problem.who,outcome:L.problem.outcome||N.problem.outcome,metrics:L.problem.metrics||N.problem.metrics,ifNotBuilt:L.problem.ifNotBuilt||N.problem.ifNotBuilt},context:{segments:L.context.segments||N.context.segments,workflow:L.context.workflow||N.context.workflow,workarounds:L.context.workarounds||N.context.workarounds,triggers:L.context.triggers||N.context.triggers,beforeAfter:L.context.beforeAfter||N.context.beforeAfter},summary:{confidence:L.summary.confidence||N.summary.confidence,concerns:L.summary.concerns||N.summary.concerns,nextSteps:L.summary.nextSteps||N.summary.nextSteps},updatedAt:new Date().toISOString()})),Ae(!1),ke(""),alert("Merged markdown content with current task")}catch(N){alert(`Failed to import markdown:
${N.message}`)}},a2=async()=>{if(ka.trim()){uc(!0);try{const N=await oA(ka,R);dc(N)}catch(N){alert(`Failed to analyze text:
${N.message}`)}finally{uc(!1)}}},l2=async()=>{if(Md){uc(!0);try{const N=await hM(Md,R);dc(N)}catch(N){alert(`Failed to analyze image:
${N.message}`)}finally{uc(!1)}}},c2=async()=>{if(Z0){uc(!0);try{const N=await fM(Z0),B=await oA(N,R);dc(B)}catch(N){alert(`Failed to analyze PDF:
${N.message}`)}finally{uc(!1)}}},u2=()=>{!me||!ee||(e(N=>N.map(B=>{if(B.id!==i)return B;const L={...B,updatedAt:new Date().toISOString()};if(me.featureName&&(L.overview={...L.overview,featureName:L.overview.featureName||me.featureName}),me.date&&(L.overview={...L.overview,date:L.overview.date||me.date}),me.requestor&&(L.overview={...L.overview,requestor:L.overview.requestor||me.requestor}),me.origin&&(L.overview={...L.overview,origin:L.overview.origin||me.origin}),me.description&&(L.overview={...L.overview,description:L.overview.description?`${L.overview.description}

${me.description}`:me.description}),me.problem&&(L.problem={...L.problem,problem:L.problem.problem||me.problem}),me.who&&(L.problem={...L.problem,who:L.problem.who||me.who}),me.outcome&&(L.problem={...L.problem,outcome:L.problem.outcome||me.outcome}),me.segments&&(L.context={...L.context,segments:L.context.segments||me.segments}),me.workflow&&(L.context={...L.context,workflow:L.context.workflow||me.workflow}),me.assumptions&&Array.isArray(me.assumptions)&&(L.assumptions=[...L.assumptions,...me.assumptions]),me.questions&&Array.isArray(me.questions)&&(L.questions=[...L.questions,...me.questions]),me.actions&&Array.isArray(me.actions)){const fe=me.actions.map(Hn=>({id:Hr(),text:Hn,completed:!1}));L.actions=[...L.actions||[],...fe]}if(me.notes){const fe=Array.isArray(me.notes)?me.notes.map(Hn=>` ${Hn}`).join(`
`):me.notes;L.notes=L.notes?`${L.notes}

${fe}`:fe}return L})),Un(!1),cc(""),J0(null),dc(null),alert("Applied extracted information to task"))},d2=N=>{dc(B=>{if(!B)return B;const L={...B};return delete L[N],L})},h2=()=>{if(!ee)return;const N=btoa(JSON.stringify(ee)),B=`${window.location.origin}${window.location.pathname}?data=${N}`;navigator.clipboard.writeText(B).then(()=>{alert("Share link copied to clipboard! Anyone with this link can view this analysis.")}).catch(()=>{const L=JSON.stringify(ee,null,2),fe=new Blob([L],{type:"application/json"}),Hn=URL.createObjectURL(fe),Ld=document.createElement("a");Ld.href=Hn,Ld.download=`${ee.name.replace(/\s+/g,"-").toLowerCase()}.json`,Ld.click(),URL.revokeObjectURL(Hn)})},f2=async()=>{if(!ee||!S){alert("Please enter your GitHub token first.");return}C(!0);try{const N=await aM(ee,S);e(B=>B.map(L=>L.id===i?{...L,gistId:N.id}:L)),navigator.clipboard.writeText(N.html_url),alert(`Saved to GitHub Gist!

Gist URL copied to clipboard:
${N.html_url}

Gist ID (for loading): ${N.id}`)}catch(N){alert(`Failed to save to GitHub Gist:
${N.message}

Make sure your token has 'gist' scope.`)}finally{C(!1)}},p2=async()=>{if(!k.trim()){alert("Please enter a Gist ID.");return}C(!0);try{const N=await lM(k.trim(),S),B=Fv(N);e(L=>[...L,B]),r(B.id),w(""),alert(`Loaded analysis: ${B.name}`)}catch(N){alert(`Failed to load from GitHub Gist:
${N.message}

Make sure the Gist ID is correct and the gist is accessible.`)}finally{C(!1)}},m2=async()=>{$(!0),se(""),await cM((B,L)=>{se(fe=>fe+B)})?Z(!0):alert("Failed to start recording. Please check microphone permissions."),$(!1)},bw=async()=>{$(!0),await uM(),Z(!1),$(!1)},g2=async N=>{var L;(L=N.target.files)!=null&&L[0]&&($(!0),alert("Audio file transcription from uploads is not yet supported in the browser. Please use the recording feature or manually enter your content."),$(!1))},v2=async()=>{if(Q){if($(!0),R){const N=await dM(Q,R);if(N){ae(N);const B={};Object.keys(N).forEach(L=>{B[L]=!0}),he(B)}else alert("Failed to analyze with OpenAI. Please check your API key.")}else ae({notes:Q}),he({notes:!0});$(!1)}},y2=N=>{he(B=>({...B,[N]:!B[N]}))},x2=(N,B)=>{ae(L=>({...L,[N]:B}))},b2=()=>{Object.entries(Y).forEach(([N,B])=>{te[N]!==!1&&B.trim()&&ws(N,B)}),F(!1),se(""),ae({}),he({}),Z(!1)},w2=()=>{K&&bw(),F(!1),se(""),ae({}),he({})};if(!ee)return null;const ww=aA(ee),{filled:A2,total:k2}=pM(ee),S2=q.useMemo(()=>{const N={All:n.length,Untagged:0};return lo.forEach(B=>{N[B]=0}),n.forEach(B=>{B.phase?N[B.phase]!==void 0&&N[B.phase]++:N.Untagged++}),N},[n]),E2=()=>{switch(a){case"overview":return g.jsx(vM,{data:ee.overview,phase:ee.phase,jiraTicket:ee.jiraTicket,secureMode:ee.secureMode||!1,audioModalOpen:I,pasteModalOpen:eo,onChange:N=>ws("overview",N),onPhaseChange:ZC,onJiraTicketChange:N=>ws("jiraTicket",N),onSecureModeChange:N=>ws("secureMode",N),onOpenAudioModal:()=>F(!0),onOpenPasteModal:()=>Un(!0)});case"problem":return g.jsx(yM,{data:ee.problem,onChange:N=>ws("problem",N)});case"context":return g.jsx(xM,{data:ee.context,onChange:N=>ws("context",N)});case"assumptions":return g.jsx(bM,{data:ee.assumptions,onChange:N=>ws("assumptions",N)});case"edges":return g.jsx(wM,{data:ee.edges,onChange:N=>ws("edges",N)});case"scope":return g.jsx(AM,{data:ee.scope,onChange:N=>ws("scope",N)});case"questions":return g.jsx(kM,{data:ee.questions,onChange:N=>ws("questions",N)});case"mapping":return g.jsx(CM,{data:ee.mapping||{figmaUrl:""},onChange:N=>ws("mapping",N)});case"notes":return g.jsx(EM,{data:ee.notes,onChange:N=>ws("notes",N)});case"summary":return g.jsx(TM,{data:ee.summary,onChange:N=>ws("summary",N)});default:return null}};return g.jsx("div",{className:"flex flex-col h-screen bg-slate-50 dark:bg-slate-900 text-slate-800 dark:text-slate-200",style:{fontFamily:"-apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif"},children:g.jsxs("div",{className:"flex flex-1 min-h-0",children:[d&&g.jsxs("div",{className:"w-64 bg-white dark:bg-slate-800 border-r border-slate-200 dark:border-slate-700 flex flex-col shrink-0",children:[g.jsx("div",{className:"px-4 py-4 border-b border-slate-100 dark:border-slate-700",children:g.jsxs("div",{className:"flex items-center justify-between",children:[g.jsx("h1",{className:"text-sm font-bold text-slate-800 dark:text-slate-100 tracking-tight",children:"Design task manager"}),g.jsx("button",{onClick:()=>h(!1),className:"text-slate-400 hover:text-slate-600 dark:text-slate-500 dark:hover:text-slate-300",title:"Close sidebar",children:g.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})})]})}),g.jsx("div",{className:"px-3 py-2 border-b border-slate-100 dark:border-slate-700",children:g.jsx("div",{className:"flex gap-1 flex-wrap",children:["All",...lo.filter(N=>N!=="Cut"),"Untagged"].map(N=>{const B=S2[N]||0;if(N!=="All"&&B===0)return null;const L=v===N,fe=Or[N];return g.jsxs("button",{onClick:()=>b(N),className:`px-2 py-0.5 text-xs rounded-full transition-colors ${L?fe?`${fe.bg} ${fe.text} font-medium`:"bg-slate-800 text-white font-medium":"text-slate-400 dark:text-slate-500 hover:text-slate-600 dark:hover:text-slate-300"}`,children:[N," ",B>0&&g.jsx("span",{className:"opacity-60",children:B})]},N)})})}),g.jsxs("div",{className:"flex-1 overflow-y-auto py-2",children:[xw.map(N=>{const B=aA(N);return g.jsxs("div",{onClick:()=>{r(N.id),l("overview")},className:`mx-2 mb-1 px-3 py-2.5 rounded-lg cursor-pointer group transition-colors ${N.id===i?"bg-slate-100 dark:bg-slate-700":"hover:bg-slate-50 dark:hover:bg-slate-700/50"}`,children:[N.jiraTicket&&g.jsx("div",{className:"text-[10px] font-semibold tracking-wider text-slate-400 dark:text-slate-500 uppercase mb-1",children:N.jiraTicket}),g.jsxs("div",{className:"flex items-start justify-between gap-1",children:[g.jsx("span",{className:"text-sm font-medium text-slate-700 dark:text-slate-200 flex-1 break-words",children:N.name||"Untitled Design Task"}),g.jsxs("div",{className:"flex items-center gap-1 shrink-0",children:[N.secureMode&&g.jsx("div",{className:"flex items-center gap-0.5 px-1.5 py-0.5 rounded-full bg-emerald-50 dark:bg-emerald-900/30 border border-emerald-200 dark:border-emerald-700",title:"Secure mode enabled",children:g.jsx("svg",{className:"w-2.5 h-2.5 text-emerald-600 dark:text-emerald-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"})})}),N.phase&&g.jsx(uA,{version:N.phase,size:"xs"}),n.length>1&&g.jsx("button",{onClick:L=>{L.stopPropagation(),t2(N.id)},className:"text-slate-300 dark:text-slate-600 hover:text-red-400 dark:hover:text-red-500 opacity-0 group-hover:opacity-100 text-sm ml-1",children:""})]})]}),g.jsx("div",{className:"mt-1.5",children:g.jsx("div",{className:"h-1 bg-slate-100 dark:bg-slate-700 rounded-full overflow-hidden",children:g.jsx("div",{className:"h-full bg-slate-400 dark:bg-slate-500 rounded-full transition-all",style:{width:`${B}%`}})})})]},N.id)}),xw.length===0&&g.jsx("div",{className:"px-4 py-6 text-center text-xs text-slate-400 dark:text-slate-500",children:"No analyses in this phase."})]}),g.jsxs("div",{className:"px-4 py-3 border-t border-slate-100 dark:border-slate-700 space-y-3",children:[g.jsx("button",{onClick:e2,className:"w-full py-2.5 text-sm text-slate-700 dark:text-slate-200 hover:text-slate-900 dark:hover:text-white border border-slate-200 dark:border-slate-600 rounded-lg hover:border-slate-300 dark:hover:border-slate-500 transition-colors font-medium",children:"+ New design task"}),P&&g.jsxs("div",{className:"space-y-2 mb-2",children:[!(ee!=null&&ee.secureMode)&&T&&g.jsxs("div",{className:"space-y-2 mb-3 pb-3 border-b border-slate-200 dark:border-slate-700",children:[g.jsxs("div",{children:[g.jsx("label",{className:"text-sm text-slate-700 dark:text-slate-200 mb-1 block font-medium",children:"GitHub Token"}),g.jsx("input",{type:"password",placeholder:"ghp_...",value:S,onChange:N=>y(N.target.value),className:"w-full px-3 py-2 text-sm border border-slate-300 dark:border-slate-600 rounded bg-white dark:bg-slate-700 text-slate-800 dark:text-slate-200 focus:outline-none focus:ring-2 focus:ring-slate-400 dark:focus:ring-slate-500"}),g.jsx("a",{href:"https://github.com/settings/tokens/new?description=Requirement%20Analyzer&scopes=gist",target:"_blank",rel:"noopener noreferrer",className:"text-xs text-blue-600 dark:text-blue-400 hover:text-blue-700 dark:hover:text-blue-300 underline mt-1 inline-block",children:"Create token"})]}),g.jsx("button",{onClick:f2,disabled:E||!S,className:"w-full py-2.5 text-sm text-white bg-slate-800 dark:bg-slate-600 hover:bg-slate-700 dark:hover:bg-slate-500 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed font-medium",children:E?"Saving...":ee!=null&&ee.gistId?"Update Gist":"Save to Gist"}),g.jsxs("div",{className:"flex gap-2",children:[g.jsx("input",{type:"text",placeholder:"Gist ID",value:k,onChange:N=>w(N.target.value),className:"flex-1 px-3 py-2 text-sm border border-slate-300 dark:border-slate-600 rounded bg-white dark:bg-slate-700 text-slate-800 dark:text-slate-200 focus:outline-none focus:ring-2 focus:ring-slate-400 dark:focus:ring-slate-500"}),g.jsx("button",{onClick:p2,disabled:E||!k.trim(),className:"px-4 py-2.5 text-sm text-slate-700 dark:text-slate-200 hover:text-slate-900 dark:hover:text-white border border-slate-300 dark:border-slate-600 rounded hover:border-slate-400 dark:hover:border-slate-500 transition-colors disabled:opacity-50 disabled:cursor-not-allowed font-medium",children:"Load"})]})]}),!(ee!=null&&ee.secureMode)&&g.jsxs("button",{onClick:()=>_(!T),className:"w-full py-2.5 text-sm text-slate-700 dark:text-slate-200 hover:text-slate-900 dark:hover:text-white border border-slate-200 dark:border-slate-600 rounded-lg hover:border-slate-300 dark:hover:border-slate-500 transition-colors flex items-center justify-center gap-1",title:"Cloud backup: Saves your active task to GitHub as a private gist. Share the Gist ID with others to let them import a copy. Changes don't auto-sync between people - each save/load creates an independent snapshot.",children:["GitHub Sync ",T?"":""]}),g.jsx("button",{onClick:h2,className:"w-full py-2.5 text-sm text-slate-700 dark:text-slate-200 hover:text-slate-900 dark:hover:text-white border border-slate-200 dark:border-slate-600 rounded-lg hover:border-slate-300 dark:hover:border-slate-500 transition-colors",children:"Share active task"}),g.jsx("input",{type:"file",ref:vw,onChange:i2,accept:".md,.markdown,.txt",className:"hidden"}),g.jsx("button",{onClick:()=>{var N;return(N=vw.current)==null?void 0:N.click()},className:"w-full py-2.5 text-sm text-slate-700 dark:text-slate-200 hover:text-slate-900 dark:hover:text-white border border-slate-200 dark:border-slate-600 rounded-lg hover:border-slate-300 dark:hover:border-slate-500 transition-colors",children:"Import Markdown"}),g.jsx("button",{onClick:n2,className:"w-full py-2.5 text-sm text-slate-700 dark:text-slate-200 hover:text-slate-900 dark:hover:text-white border border-slate-200 dark:border-slate-600 rounded-lg hover:border-slate-300 dark:hover:border-slate-500 transition-colors",children:"Export as Markdown"})]}),g.jsxs("button",{onClick:()=>D(!P),className:"w-full py-2.5 text-sm text-slate-700 dark:text-slate-200 hover:text-slate-900 dark:hover:text-white border border-slate-200 dark:border-slate-600 rounded-lg hover:border-slate-300 dark:hover:border-slate-500 transition-colors flex items-center justify-center gap-1",children:["Export options ",P?"":""]})]})]}),g.jsxs("div",{className:"flex-1 flex flex-col min-w-0",children:[g.jsxs("div",{className:"bg-white dark:bg-slate-800 border-b border-slate-200 dark:border-slate-700 px-6 py-3",children:[g.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[!d&&g.jsx("button",{onClick:()=>h(!0),className:"text-slate-400 hover:text-slate-600 dark:text-slate-500 dark:hover:text-slate-300 mr-1",title:"Show sidebar",children:g.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})}),g.jsx("input",{className:"text-lg font-semibold text-slate-800 dark:text-slate-100 bg-transparent border-none outline-none focus:ring-0 flex-1 px-0",value:ee.name,onChange:N=>s2(N.target.value),placeholder:"Analysis name..."}),g.jsxs("div",{className:"flex items-center gap-2 shrink-0",children:[ee.phase&&g.jsx(uA,{version:ee.phase}),g.jsx("div",{className:"w-24 h-1.5 bg-slate-100 rounded-full overflow-hidden",children:g.jsx("div",{className:`h-full rounded-full transition-all ${ww===100?"bg-emerald-500":"bg-slate-400"}`,style:{width:`${ww}%`}})}),g.jsxs("span",{className:"text-xs text-slate-400 w-10",children:[A2,"/",k2]}),g.jsx("button",{onClick:()=>JC(!Sa),className:"p-2 text-slate-600 dark:text-slate-300 hover:text-slate-800 dark:hover:text-slate-100 border border-slate-200 dark:border-slate-600 rounded-lg hover:border-slate-300 dark:hover:border-slate-500 transition-colors",title:Sa?"Switch to light mode":"Switch to dark mode",children:Sa?g.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"})}):g.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"})})}),g.jsx("button",{onClick:()=>p(!f),className:"text-slate-400 hover:text-slate-800 ml-2 transition-colors flex items-center gap-1.5",title:"Toggle actions panel",children:f?g.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})}):g.jsxs(g.Fragment,{children:[g.jsx("span",{className:"text-sm",children:"Actions"}),g.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})]})})]})]}),g.jsx("div",{className:"flex gap-1 overflow-x-auto pb-4 -mx-1 px-1",children:tM.map(N=>{const B=()=>{if(N.id==="assumptions")return`${ee.assumptions.filter(fe=>fe.status==="Unvalidated"||fe.status==="Needs Research").length}`;if(N.id==="questions")return`${ee.questions.filter(fe=>fe.status==="Open").length}`};return g.jsxs(gM,{active:a===N.id,onClick:()=>l(N.id),completion:N.id!=="assumptions"&&N.id!=="questions"?mM(ee,N.id):void 0,count:B(),children:[g.jsx("span",{className:"mr-1 opacity-60",children:N.icon}),N.label]},N.id)})})]}),g.jsx("div",{className:"flex-1 overflow-y-auto",children:g.jsx("div",{className:a==="mapping"?"px-6 py-8":"max-w-2xl mx-auto px-6 py-8",children:E2()})})]}),f&&g.jsxs("div",{className:"w-80 bg-white dark:bg-slate-800 border-l border-slate-200 dark:border-slate-700 flex flex-col shrink-0",children:[g.jsx("div",{className:"px-4 py-4 border-b border-slate-100 dark:border-slate-700",children:g.jsxs("div",{className:"flex items-center justify-between",children:[g.jsx("h2",{className:"text-sm font-bold text-slate-800 dark:text-slate-100 tracking-tight",children:"Design actions"}),g.jsx("button",{onClick:()=>p(!1),className:"text-slate-400 hover:text-slate-600 dark:text-slate-500 dark:hover:text-slate-300",title:"Close actions panel",children:g.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:g.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})]})}),g.jsx("div",{className:"flex-1 overflow-y-auto px-4 py-4",children:g.jsx(SM,{data:ee.actions||[],onChange:N=>ws("actions",N)})})]}),!(ee!=null&&ee.secureMode)&&g.jsx(MM,{isOpen:I,onClose:w2,isRecording:K,transcript:Q,audioProcessing:G,aiSuggestions:Y,selectedSections:te,onToggleSection:y2,onUpdateSuggestion:x2,onStartRecording:m2,onStopRecording:bw,onFileUpload:g2,onAnalyze:v2,onApply:b2,githubAIKey:R,onSetGitHubAIKey:X}),!(ee!=null&&ee.secureMode)&&g.jsx(PM,{isOpen:eo,onClose:()=>{Un(!1),cc(""),J0(null),gw(null),dc(null)},pastedText:ka,onTextChange:cc,pastedImage:Md,onImageChange:J0,pastedPdf:Z0,onPdfChange:gw,onAnalyze:a2,onImageAnalyze:l2,onPdfAnalyze:c2,analyzing:QC,results:me,onApply:u2,githubAIKey:R,onSetGitHubAIKey:X,onDeleteField:d2}),g.jsx(NM,{isOpen:ht,onClose:()=>{Ae(!1),ke("")},onImportNew:r2,onImportExisting:o2,hasActiveTask:!!ee}),c&&g.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50 p-8",onClick:()=>u(!1),children:g.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-2xl max-h-full flex flex-col",onClick:N=>N.stopPropagation(),children:[g.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-b border-slate-100",children:[g.jsx("h3",{className:"font-semibold text-slate-800",children:"Markdown Export"}),g.jsx("button",{onClick:()=>u(!1),className:"text-slate-400 dark:text-slate-500 hover:text-slate-600 dark:hover:text-slate-300",children:""})]}),g.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:g.jsx("pre",{className:"text-xs text-slate-700 whitespace-pre-wrap font-mono bg-slate-50 p-4 rounded-lg border border-slate-100",children:lA(ee)})}),g.jsx("div",{className:"px-6 py-4 border-t border-slate-100 flex justify-end gap-2",children:g.jsx("button",{onClick:()=>{navigator.clipboard.writeText(lA(ee))},className:"px-4 py-2 text-sm font-medium bg-slate-800 text-white rounded-lg hover:bg-slate-700 transition-colors",children:"Copy to Clipboard"})})]})})]})})}jv.createRoot(document.getElementById("root")).render(g.jsx(V2.StrictMode,{children:g.jsx(LM,{})}));
